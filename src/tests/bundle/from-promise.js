var IT=Object.create;var Of=Object.defineProperty;var NT=Object.getOwnPropertyDescriptor;var PT=Object.getOwnPropertyNames;var LT=Object.getPrototypeOf,DT=Object.prototype.hasOwnProperty;var Ue=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var qT=(e,t)=>()=>(e&&(t=e(e=0)),t);var $=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),my=(e,t)=>{for(var r in t)Of(e,r,{get:t[r],enumerable:!0})},HT=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of PT(t))!DT.call(e,n)&&n!==r&&Of(e,n,{get:()=>t[n],enumerable:!(o=NT(t,n))||o.enumerable});return e};var Ga=(e,t,r)=>(r=e!=null?IT(LT(e)):{},HT(t||!e||!e.__esModule?Of(r,"default",{value:e,enumerable:!0}):r,e));import{createRequire as WT}from"node:module";import UT from"node:path";import BT from"node:url";var u=qT(()=>{"use strict";globalThis.require=WT(import.meta.url);globalThis.__filename=BT.fileURLToPath(import.meta.url);globalThis.__dirname=UT.dirname(__filename)});var ct=$(Hg=>{"use strict";u();Hg.fromCallback=function(e){return Object.defineProperty(function(...t){if(typeof t[t.length-1]=="function")e.apply(this,t);else return new Promise((r,o)=>{t.push((n,s)=>n!=null?o(n):r(s)),e.apply(this,t)})},"name",{value:e.name})};Hg.fromPromise=function(e){return Object.defineProperty(function(...t){let r=t[t.length-1];if(typeof r!="function")return e.apply(this,t);t.pop(),e.apply(this,t).then(o=>r(null,o),r)},"name",{value:e.name})}});var XR=$((_8,ZR)=>{u();var On=Ue("constants"),lj=process.cwd,rf=null,pj=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return rf||(rf=lj.call(process)),rf};try{process.cwd()}catch{}typeof process.chdir=="function"&&(Wg=process.chdir,process.chdir=function(e){rf=null,Wg.call(process,e)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,Wg));var Wg;ZR.exports=fj;function fj(e){On.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&t(e),e.lutimes||r(e),e.chown=s(e.chown),e.fchown=s(e.fchown),e.lchown=s(e.lchown),e.chmod=o(e.chmod),e.fchmod=o(e.fchmod),e.lchmod=o(e.lchmod),e.chownSync=i(e.chownSync),e.fchownSync=i(e.fchownSync),e.lchownSync=i(e.lchownSync),e.chmodSync=n(e.chmodSync),e.fchmodSync=n(e.fchmodSync),e.lchmodSync=n(e.lchmodSync),e.stat=c(e.stat),e.fstat=c(e.fstat),e.lstat=c(e.lstat),e.statSync=a(e.statSync),e.fstatSync=a(e.fstatSync),e.lstatSync=a(e.lstatSync),e.chmod&&!e.lchmod&&(e.lchmod=function(f,h,d){d&&process.nextTick(d)},e.lchmodSync=function(){}),e.chown&&!e.lchown&&(e.lchown=function(f,h,d,g){g&&process.nextTick(g)},e.lchownSync=function(){}),pj==="win32"&&(e.rename=typeof e.rename!="function"?e.rename:function(f){function h(d,g,b){var M=Date.now(),T=0;f(d,g,function P(K){if(K&&(K.code==="EACCES"||K.code==="EPERM"||K.code==="EBUSY")&&Date.now()-M<6e4){setTimeout(function(){e.stat(g,function(ae,_e){ae&&ae.code==="ENOENT"?f(d,g,P):b(K)})},T),T<100&&(T+=10);return}b&&b(K)})}return Object.setPrototypeOf&&Object.setPrototypeOf(h,f),h}(e.rename)),e.read=typeof e.read!="function"?e.read:function(f){function h(d,g,b,M,T,P){var K;if(P&&typeof P=="function"){var ae=0;K=function(_e,lt,Zt){if(_e&&_e.code==="EAGAIN"&&ae<10)return ae++,f.call(e,d,g,b,M,T,K);P.apply(this,arguments)}}return f.call(e,d,g,b,M,T,K)}return Object.setPrototypeOf&&Object.setPrototypeOf(h,f),h}(e.read),e.readSync=typeof e.readSync!="function"?e.readSync:function(f){return function(h,d,g,b,M){for(var T=0;;)try{return f.call(e,h,d,g,b,M)}catch(P){if(P.code==="EAGAIN"&&T<10){T++;continue}throw P}}}(e.readSync);function t(f){f.lchmod=function(h,d,g){f.open(h,On.O_WRONLY|On.O_SYMLINK,d,function(b,M){if(b){g&&g(b);return}f.fchmod(M,d,function(T){f.close(M,function(P){g&&g(T||P)})})})},f.lchmodSync=function(h,d){var g=f.openSync(h,On.O_WRONLY|On.O_SYMLINK,d),b=!0,M;try{M=f.fchmodSync(g,d),b=!1}finally{if(b)try{f.closeSync(g)}catch{}else f.closeSync(g)}return M}}function r(f){On.hasOwnProperty("O_SYMLINK")&&f.futimes?(f.lutimes=function(h,d,g,b){f.open(h,On.O_SYMLINK,function(M,T){if(M){b&&b(M);return}f.futimes(T,d,g,function(P){f.close(T,function(K){b&&b(P||K)})})})},f.lutimesSync=function(h,d,g){var b=f.openSync(h,On.O_SYMLINK),M,T=!0;try{M=f.futimesSync(b,d,g),T=!1}finally{if(T)try{f.closeSync(b)}catch{}else f.closeSync(b)}return M}):f.futimes&&(f.lutimes=function(h,d,g,b){b&&process.nextTick(b)},f.lutimesSync=function(){})}function o(f){return f&&function(h,d,g){return f.call(e,h,d,function(b){p(b)&&(b=null),g&&g.apply(this,arguments)})}}function n(f){return f&&function(h,d){try{return f.call(e,h,d)}catch(g){if(!p(g))throw g}}}function s(f){return f&&function(h,d,g,b){return f.call(e,h,d,g,function(M){p(M)&&(M=null),b&&b.apply(this,arguments)})}}function i(f){return f&&function(h,d,g){try{return f.call(e,h,d,g)}catch(b){if(!p(b))throw b}}}function c(f){return f&&function(h,d,g){typeof d=="function"&&(g=d,d=null);function b(M,T){T&&(T.uid<0&&(T.uid+=4294967296),T.gid<0&&(T.gid+=4294967296)),g&&g.apply(this,arguments)}return d?f.call(e,h,d,b):f.call(e,h,b)}}function a(f){return f&&function(h,d){var g=d?f.call(e,h,d):f.call(e,h);return g&&(g.uid<0&&(g.uid+=4294967296),g.gid<0&&(g.gid+=4294967296)),g}}function p(f){if(!f||f.code==="ENOSYS")return!0;var h=!process.getuid||process.getuid()!==0;return!!(h&&(f.code==="EINVAL"||f.code==="EPERM"))}}});var rF=$((O8,tF)=>{u();var eF=Ue("stream").Stream;tF.exports=mj;function mj(e){return{ReadStream:t,WriteStream:r};function t(o,n){if(!(this instanceof t))return new t(o,n);eF.call(this);var s=this;this.path=o,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=64*1024,n=n||{};for(var i=Object.keys(n),c=0,a=i.length;c<a;c++){var p=i[c];this[p]=n[p]}if(this.encoding&&this.setEncoding(this.encoding),this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){s._read()});return}e.open(this.path,this.flags,this.mode,function(f,h){if(f){s.emit("error",f),s.readable=!1;return}s.fd=h,s.emit("open",h),s._read()})}function r(o,n){if(!(this instanceof r))return new r(o,n);eF.call(this),this.path=o,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,n=n||{};for(var s=Object.keys(n),i=0,c=s.length;i<c;i++){var a=s[i];this[a]=n[a]}if(this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],this.fd===null&&(this._open=e.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}});var nF=$((v8,oF)=>{"use strict";u();oF.exports=dj;var hj=Object.getPrototypeOf||function(e){return e.__proto__};function dj(e){if(e===null||typeof e!="object")return e;if(e instanceof Object)var t={__proto__:hj(e)};else var t=Object.create(null);return Object.getOwnPropertyNames(e).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}),t}});var ec=$((w8,jg)=>{u();var Ae=Ue("fs"),xj=XR(),gj=rF(),yj=nF(),of=Ue("util"),ht,sf;typeof Symbol=="function"&&typeof Symbol.for=="function"?(ht=Symbol.for("graceful-fs.queue"),sf=Symbol.for("graceful-fs.previous")):(ht="___graceful-fs.queue",sf="___graceful-fs.previous");function bj(){}function cF(e,t){Object.defineProperty(e,ht,{get:function(){return t}})}var qs=bj;of.debuglog?qs=of.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(qs=function(){var e=of.format.apply(of,arguments);e="GFS4: "+e.split(/\n/).join(`
GFS4: `),console.error(e)});Ae[ht]||(sF=global[ht]||[],cF(Ae,sF),Ae.close=function(e){function t(r,o){return e.call(Ae,r,function(n){n||iF(),typeof o=="function"&&o.apply(this,arguments)})}return Object.defineProperty(t,sf,{value:e}),t}(Ae.close),Ae.closeSync=function(e){function t(r){e.apply(Ae,arguments),iF()}return Object.defineProperty(t,sf,{value:e}),t}(Ae.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){qs(Ae[ht]),Ue("assert").equal(Ae[ht].length,0)}));var sF;global[ht]||cF(global,Ae[ht]);jg.exports=Ug(yj(Ae));process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!Ae.__patched&&(jg.exports=Ug(Ae),Ae.__patched=!0);function Ug(e){xj(e),e.gracefulify=Ug,e.createReadStream=lt,e.createWriteStream=Zt;var t=e.readFile;e.readFile=r;function r(D,Q,U){return typeof Q=="function"&&(U=Q,Q=null),fe(D,Q,U);function fe(Ie,be,me,se){return t(Ie,be,function(Z){Z&&(Z.code==="EMFILE"||Z.code==="ENFILE")?Xi([fe,[Ie,be,me],Z,se||Date.now(),Date.now()]):typeof me=="function"&&me.apply(this,arguments)})}}var o=e.writeFile;e.writeFile=n;function n(D,Q,U,fe){return typeof U=="function"&&(fe=U,U=null),Ie(D,Q,U,fe);function Ie(be,me,se,Z,we){return o(be,me,se,function(he){he&&(he.code==="EMFILE"||he.code==="ENFILE")?Xi([Ie,[be,me,se,Z],he,we||Date.now(),Date.now()]):typeof Z=="function"&&Z.apply(this,arguments)})}}var s=e.appendFile;s&&(e.appendFile=i);function i(D,Q,U,fe){return typeof U=="function"&&(fe=U,U=null),Ie(D,Q,U,fe);function Ie(be,me,se,Z,we){return s(be,me,se,function(he){he&&(he.code==="EMFILE"||he.code==="ENFILE")?Xi([Ie,[be,me,se,Z],he,we||Date.now(),Date.now()]):typeof Z=="function"&&Z.apply(this,arguments)})}}var c=e.copyFile;c&&(e.copyFile=a);function a(D,Q,U,fe){return typeof U=="function"&&(fe=U,U=0),Ie(D,Q,U,fe);function Ie(be,me,se,Z,we){return c(be,me,se,function(he){he&&(he.code==="EMFILE"||he.code==="ENFILE")?Xi([Ie,[be,me,se,Z],he,we||Date.now(),Date.now()]):typeof Z=="function"&&Z.apply(this,arguments)})}}var p=e.readdir;e.readdir=h;var f=/^v[0-5]\./;function h(D,Q,U){typeof Q=="function"&&(U=Q,Q=null);var fe=f.test(process.version)?function(me,se,Z,we){return p(me,Ie(me,se,Z,we))}:function(me,se,Z,we){return p(me,se,Ie(me,se,Z,we))};return fe(D,Q,U);function Ie(be,me,se,Z){return function(we,he){we&&(we.code==="EMFILE"||we.code==="ENFILE")?Xi([fe,[be,me,se],we,Z||Date.now(),Date.now()]):(he&&he.sort&&he.sort(),typeof se=="function"&&se.call(this,we,he))}}}if(process.version.substr(0,4)==="v0.8"){var d=gj(e);P=d.ReadStream,ae=d.WriteStream}var g=e.ReadStream;g&&(P.prototype=Object.create(g.prototype),P.prototype.open=K);var b=e.WriteStream;b&&(ae.prototype=Object.create(b.prototype),ae.prototype.open=_e),Object.defineProperty(e,"ReadStream",{get:function(){return P},set:function(D){P=D},enumerable:!0,configurable:!0}),Object.defineProperty(e,"WriteStream",{get:function(){return ae},set:function(D){ae=D},enumerable:!0,configurable:!0});var M=P;Object.defineProperty(e,"FileReadStream",{get:function(){return M},set:function(D){M=D},enumerable:!0,configurable:!0});var T=ae;Object.defineProperty(e,"FileWriteStream",{get:function(){return T},set:function(D){T=D},enumerable:!0,configurable:!0});function P(D,Q){return this instanceof P?(g.apply(this,arguments),this):P.apply(Object.create(P.prototype),arguments)}function K(){var D=this;et(D.path,D.flags,D.mode,function(Q,U){Q?(D.autoClose&&D.destroy(),D.emit("error",Q)):(D.fd=U,D.emit("open",U),D.read())})}function ae(D,Q){return this instanceof ae?(b.apply(this,arguments),this):ae.apply(Object.create(ae.prototype),arguments)}function _e(){var D=this;et(D.path,D.flags,D.mode,function(Q,U){Q?(D.destroy(),D.emit("error",Q)):(D.fd=U,D.emit("open",U))})}function lt(D,Q){return new e.ReadStream(D,Q)}function Zt(D,Q){return new e.WriteStream(D,Q)}var No=e.open;e.open=et;function et(D,Q,U,fe){return typeof U=="function"&&(fe=U,U=null),Ie(D,Q,U,fe);function Ie(be,me,se,Z,we){return No(be,me,se,function(he,Bs){he&&(he.code==="EMFILE"||he.code==="ENFILE")?Xi([Ie,[be,me,se,Z],he,we||Date.now(),Date.now()]):typeof Z=="function"&&Z.apply(this,arguments)})}}return e}function Xi(e){qs("ENQUEUE",e[0].name,e[1]),Ae[ht].push(e),Bg()}var nf;function iF(){for(var e=Date.now(),t=0;t<Ae[ht].length;++t)Ae[ht][t].length>2&&(Ae[ht][t][3]=e,Ae[ht][t][4]=e);Bg()}function Bg(){if(clearTimeout(nf),nf=void 0,Ae[ht].length!==0){var e=Ae[ht].shift(),t=e[0],r=e[1],o=e[2],n=e[3],s=e[4];if(n===void 0)qs("RETRY",t.name,r),t.apply(null,r);else if(Date.now()-n>=6e4){qs("TIMEOUT",t.name,r);var i=r.pop();typeof i=="function"&&i.call(null,o)}else{var c=Date.now()-s,a=Math.max(s-n,1),p=Math.min(a*1.2,100);c>=p?(qs("RETRY",t.name,r),t.apply(null,r.concat([n]))):Ae[ht].push(e)}nf===void 0&&(nf=setTimeout(Bg,0))}}});var Rt=$(Fo=>{"use strict";u();var aF=ct().fromCallback,Mt=ec(),Sj=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchmod","lchown","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter(e=>typeof Mt[e]=="function");Object.assign(Fo,Mt);Sj.forEach(e=>{Fo[e]=aF(Mt[e])});Fo.exists=function(e,t){return typeof t=="function"?Mt.exists(e,t):new Promise(r=>Mt.exists(e,r))};Fo.read=function(e,t,r,o,n,s){return typeof s=="function"?Mt.read(e,t,r,o,n,s):new Promise((i,c)=>{Mt.read(e,t,r,o,n,(a,p,f)=>{if(a)return c(a);i({bytesRead:p,buffer:f})})})};Fo.write=function(e,t,...r){return typeof r[r.length-1]=="function"?Mt.write(e,t,...r):new Promise((o,n)=>{Mt.write(e,t,...r,(s,i,c)=>{if(s)return n(s);o({bytesWritten:i,buffer:c})})})};Fo.readv=function(e,t,...r){return typeof r[r.length-1]=="function"?Mt.readv(e,t,...r):new Promise((o,n)=>{Mt.readv(e,t,...r,(s,i,c)=>{if(s)return n(s);o({bytesRead:i,buffers:c})})})};Fo.writev=function(e,t,...r){return typeof r[r.length-1]=="function"?Mt.writev(e,t,...r):new Promise((o,n)=>{Mt.writev(e,t,...r,(s,i,c)=>{if(s)return n(s);o({bytesWritten:i,buffers:c})})})};typeof Mt.realpath.native=="function"?Fo.realpath.native=aF(Mt.realpath.native):process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")});var lF=$((T8,uF)=>{"use strict";u();var _j=Ue("path");uF.exports.checkPath=function(t){if(process.platform==="win32"&&/[<>:"|?*]/.test(t.replace(_j.parse(t).root,""))){let o=new Error(`Path contains invalid characters: ${t}`);throw o.code="EINVAL",o}}});var hF=$((I8,zg)=>{"use strict";u();var pF=Rt(),{checkPath:fF}=lF(),mF=e=>{let t={mode:511};return typeof e=="number"?e:{...t,...e}.mode};zg.exports.makeDir=async(e,t)=>(fF(e),pF.mkdir(e,{mode:mF(t),recursive:!0}));zg.exports.makeDirSync=(e,t)=>(fF(e),pF.mkdirSync(e,{mode:mF(t),recursive:!0}))});var kr=$((P8,dF)=>{"use strict";u();var Ej=ct().fromPromise,{makeDir:Oj,makeDirSync:Gg}=hF(),$g=Ej(Oj);dF.exports={mkdirs:$g,mkdirsSync:Gg,mkdirp:$g,mkdirpSync:Gg,ensureDir:$g,ensureDirSync:Gg}});var Cn=$((D8,gF)=>{"use strict";u();var Cj=ct().fromPromise,xF=Rt();function vj(e){return xF.access(e).then(()=>!0).catch(()=>!1)}gF.exports={pathExists:Cj(vj),pathExistsSync:xF.existsSync}});var Vg=$((H8,yF)=>{"use strict";u();var tc=Rt(),kj=ct().fromPromise;async function wj(e,t,r){let o=await tc.open(e,"r+"),n=null;try{await tc.futimes(o,t,r)}finally{try{await tc.close(o)}catch(s){n=s}}if(n)throw n}function Mj(e,t,r){let o=tc.openSync(e,"r+");return tc.futimesSync(o,t,r),tc.closeSync(o)}yF.exports={utimesMillis:kj(wj),utimesMillisSync:Mj}});var Hs=$((U8,EF)=>{"use strict";u();var rc=Rt(),at=Ue("path"),bF=ct().fromPromise;function Rj(e,t,r){let o=r.dereference?n=>rc.stat(n,{bigint:!0}):n=>rc.lstat(n,{bigint:!0});return Promise.all([o(e),o(t).catch(n=>{if(n.code==="ENOENT")return null;throw n})]).then(([n,s])=>({srcStat:n,destStat:s}))}function Fj(e,t,r){let o,n=r.dereference?i=>rc.statSync(i,{bigint:!0}):i=>rc.lstatSync(i,{bigint:!0}),s=n(e);try{o=n(t)}catch(i){if(i.code==="ENOENT")return{srcStat:s,destStat:null};throw i}return{srcStat:s,destStat:o}}async function Tj(e,t,r,o){let{srcStat:n,destStat:s}=await Rj(e,t,o);if(s){if(Na(n,s)){let i=at.basename(e),c=at.basename(t);if(r==="move"&&i!==c&&i.toLowerCase()===c.toLowerCase())return{srcStat:n,destStat:s,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(n.isDirectory()&&!s.isDirectory())throw new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`);if(!n.isDirectory()&&s.isDirectory())throw new Error(`Cannot overwrite directory '${t}' with non-directory '${e}'.`)}if(n.isDirectory()&&Kg(e,t))throw new Error(cf(e,t,r));return{srcStat:n,destStat:s}}function Aj(e,t,r,o){let{srcStat:n,destStat:s}=Fj(e,t,o);if(s){if(Na(n,s)){let i=at.basename(e),c=at.basename(t);if(r==="move"&&i!==c&&i.toLowerCase()===c.toLowerCase())return{srcStat:n,destStat:s,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(n.isDirectory()&&!s.isDirectory())throw new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`);if(!n.isDirectory()&&s.isDirectory())throw new Error(`Cannot overwrite directory '${t}' with non-directory '${e}'.`)}if(n.isDirectory()&&Kg(e,t))throw new Error(cf(e,t,r));return{srcStat:n,destStat:s}}async function SF(e,t,r,o){let n=at.resolve(at.dirname(e)),s=at.resolve(at.dirname(r));if(s===n||s===at.parse(s).root)return;let i;try{i=await rc.stat(s,{bigint:!0})}catch(c){if(c.code==="ENOENT")return;throw c}if(Na(t,i))throw new Error(cf(e,r,o));return SF(e,t,s,o)}function _F(e,t,r,o){let n=at.resolve(at.dirname(e)),s=at.resolve(at.dirname(r));if(s===n||s===at.parse(s).root)return;let i;try{i=rc.statSync(s,{bigint:!0})}catch(c){if(c.code==="ENOENT")return;throw c}if(Na(t,i))throw new Error(cf(e,r,o));return _F(e,t,s,o)}function Na(e,t){return t.ino&&t.dev&&t.ino===e.ino&&t.dev===e.dev}function Kg(e,t){let r=at.resolve(e).split(at.sep).filter(n=>n),o=at.resolve(t).split(at.sep).filter(n=>n);return r.every((n,s)=>o[s]===n)}function cf(e,t,r){return`Cannot ${r} '${e}' to a subdirectory of itself, '${t}'.`}EF.exports={checkPaths:bF(Tj),checkPathsSync:Aj,checkParentPaths:bF(SF),checkParentPathsSync:_F,isSrcSubdir:Kg,areIdentical:Na}});var wF=$((j8,kF)=>{"use strict";u();var bt=Rt(),Pa=Ue("path"),{mkdirs:Ij}=kr(),{pathExists:Nj}=Cn(),{utimesMillis:Pj}=Vg(),La=Hs();async function Lj(e,t,r={}){typeof r=="function"&&(r={filter:r}),r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0001");let{srcStat:o,destStat:n}=await La.checkPaths(e,t,"copy",r);if(await La.checkParentPaths(e,o,t,"copy"),!await CF(e,t,r))return;let i=Pa.dirname(t);await Nj(i)||await Ij(i),await vF(n,e,t,r)}async function CF(e,t,r){return r.filter?r.filter(e,t):!0}async function vF(e,t,r,o){let s=await(o.dereference?bt.stat:bt.lstat)(t);if(s.isDirectory())return Wj(s,e,t,r,o);if(s.isFile()||s.isCharacterDevice()||s.isBlockDevice())return Dj(s,e,t,r,o);if(s.isSymbolicLink())return Uj(e,t,r,o);throw s.isSocket()?new Error(`Cannot copy a socket file: ${t}`):s.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${t}`):new Error(`Unknown file: ${t}`)}async function Dj(e,t,r,o,n){if(!t)return OF(e,r,o,n);if(n.overwrite)return await bt.unlink(o),OF(e,r,o,n);if(n.errorOnExist)throw new Error(`'${o}' already exists`)}async function OF(e,t,r,o){if(await bt.copyFile(t,r),o.preserveTimestamps){qj(e.mode)&&await Hj(r,e.mode);let n=await bt.stat(t);await Pj(r,n.atime,n.mtime)}return bt.chmod(r,e.mode)}function qj(e){return(e&128)===0}function Hj(e,t){return bt.chmod(e,t|128)}async function Wj(e,t,r,o,n){t||await bt.mkdir(o);let s=await bt.readdir(r);await Promise.all(s.map(async i=>{let c=Pa.join(r,i),a=Pa.join(o,i);if(!await CF(c,a,n))return;let{destStat:f}=await La.checkPaths(c,a,"copy",n);return vF(f,c,a,n)})),t||await bt.chmod(o,e.mode)}async function Uj(e,t,r,o){let n=await bt.readlink(t);if(o.dereference&&(n=Pa.resolve(process.cwd(),n)),!e)return bt.symlink(n,r);let s=null;try{s=await bt.readlink(r)}catch(i){if(i.code==="EINVAL"||i.code==="UNKNOWN")return bt.symlink(n,r);throw i}if(o.dereference&&(s=Pa.resolve(process.cwd(),s)),La.isSrcSubdir(n,s))throw new Error(`Cannot copy '${n}' to a subdirectory of itself, '${s}'.`);if(La.isSrcSubdir(s,n))throw new Error(`Cannot overwrite '${s}' with '${n}'.`);return await bt.unlink(r),bt.symlink(n,r)}kF.exports=Lj});var AF=$((G8,TF)=>{"use strict";u();var Ft=ec(),Da=Ue("path"),Bj=kr().mkdirsSync,jj=Vg().utimesMillisSync,qa=Hs();function zj(e,t,r){typeof r=="function"&&(r={filter:r}),r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0002");let{srcStat:o,destStat:n}=qa.checkPathsSync(e,t,"copy",r);if(qa.checkParentPathsSync(e,o,t,"copy"),r.filter&&!r.filter(e,t))return;let s=Da.dirname(t);return Ft.existsSync(s)||Bj(s),MF(n,e,t,r)}function MF(e,t,r,o){let s=(o.dereference?Ft.statSync:Ft.lstatSync)(t);if(s.isDirectory())return Qj(s,e,t,r,o);if(s.isFile()||s.isCharacterDevice()||s.isBlockDevice())return Gj(s,e,t,r,o);if(s.isSymbolicLink())return ez(e,t,r,o);throw s.isSocket()?new Error(`Cannot copy a socket file: ${t}`):s.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${t}`):new Error(`Unknown file: ${t}`)}function Gj(e,t,r,o,n){return t?$j(e,r,o,n):RF(e,r,o,n)}function $j(e,t,r,o){if(o.overwrite)return Ft.unlinkSync(r),RF(e,t,r,o);if(o.errorOnExist)throw new Error(`'${r}' already exists`)}function RF(e,t,r,o){return Ft.copyFileSync(t,r),o.preserveTimestamps&&Vj(e.mode,t,r),Jg(r,e.mode)}function Vj(e,t,r){return Kj(e)&&Jj(r,e),Yj(t,r)}function Kj(e){return(e&128)===0}function Jj(e,t){return Jg(e,t|128)}function Jg(e,t){return Ft.chmodSync(e,t)}function Yj(e,t){let r=Ft.statSync(e);return jj(t,r.atime,r.mtime)}function Qj(e,t,r,o,n){return t?FF(r,o,n):Zj(e.mode,r,o,n)}function Zj(e,t,r,o){return Ft.mkdirSync(r),FF(t,r,o),Jg(r,e)}function FF(e,t,r){Ft.readdirSync(e).forEach(o=>Xj(o,e,t,r))}function Xj(e,t,r,o){let n=Da.join(t,e),s=Da.join(r,e);if(o.filter&&!o.filter(n,s))return;let{destStat:i}=qa.checkPathsSync(n,s,"copy",o);return MF(i,n,s,o)}function ez(e,t,r,o){let n=Ft.readlinkSync(t);if(o.dereference&&(n=Da.resolve(process.cwd(),n)),e){let s;try{s=Ft.readlinkSync(r)}catch(i){if(i.code==="EINVAL"||i.code==="UNKNOWN")return Ft.symlinkSync(n,r);throw i}if(o.dereference&&(s=Da.resolve(process.cwd(),s)),qa.isSrcSubdir(n,s))throw new Error(`Cannot copy '${n}' to a subdirectory of itself, '${s}'.`);if(qa.isSrcSubdir(s,n))throw new Error(`Cannot overwrite '${s}' with '${n}'.`);return tz(n,r)}else return Ft.symlinkSync(n,r)}function tz(e,t){return Ft.unlinkSync(t),Ft.symlinkSync(e,t)}TF.exports=zj});var af=$((V8,IF)=>{"use strict";u();var rz=ct().fromPromise;IF.exports={copy:rz(wF()),copySync:AF()}});var Ha=$((J8,PF)=>{"use strict";u();var NF=ec(),oz=ct().fromCallback;function nz(e,t){NF.rm(e,{recursive:!0,force:!0},t)}function sz(e){NF.rmSync(e,{recursive:!0,force:!0})}PF.exports={remove:oz(nz),removeSync:sz}});var jF=$((Q8,BF)=>{"use strict";u();var iz=ct().fromPromise,qF=Rt(),HF=Ue("path"),WF=kr(),UF=Ha(),LF=iz(async function(t){let r;try{r=await qF.readdir(t)}catch{return WF.mkdirs(t)}return Promise.all(r.map(o=>UF.remove(HF.join(t,o))))});function DF(e){let t;try{t=qF.readdirSync(e)}catch{return WF.mkdirsSync(e)}t.forEach(r=>{r=HF.join(e,r),UF.removeSync(r)})}BF.exports={emptyDirSync:DF,emptydirSync:DF,emptyDir:LF,emptydir:LF}});var VF=$((X8,$F)=>{"use strict";u();var cz=ct().fromPromise,zF=Ue("path"),To=Rt(),GF=kr();async function az(e){let t;try{t=await To.stat(e)}catch{}if(t&&t.isFile())return;let r=zF.dirname(e),o=null;try{o=await To.stat(r)}catch(n){if(n.code==="ENOENT"){await GF.mkdirs(r),await To.writeFile(e,"");return}else throw n}o.isDirectory()?await To.writeFile(e,""):await To.readdir(r)}function uz(e){let t;try{t=To.statSync(e)}catch{}if(t&&t.isFile())return;let r=zF.dirname(e);try{To.statSync(r).isDirectory()||To.readdirSync(r)}catch(o){if(o&&o.code==="ENOENT")GF.mkdirsSync(r);else throw o}To.writeFileSync(e,"")}$F.exports={createFile:cz(az),createFileSync:uz}});var ZF=$((tX,QF)=>{"use strict";u();var lz=ct().fromPromise,KF=Ue("path"),vn=Rt(),JF=kr(),{pathExists:pz}=Cn(),{areIdentical:YF}=Hs();async function fz(e,t){let r;try{r=await vn.lstat(t)}catch{}let o;try{o=await vn.lstat(e)}catch(i){throw i.message=i.message.replace("lstat","ensureLink"),i}if(r&&YF(o,r))return;let n=KF.dirname(t);await pz(n)||await JF.mkdirs(n),await vn.link(e,t)}function mz(e,t){let r;try{r=vn.lstatSync(t)}catch{}try{let s=vn.lstatSync(e);if(r&&YF(s,r))return}catch(s){throw s.message=s.message.replace("lstat","ensureLink"),s}let o=KF.dirname(t);return vn.existsSync(o)||JF.mkdirsSync(o),vn.linkSync(e,t)}QF.exports={createLink:lz(fz),createLinkSync:mz}});var e0=$((oX,XF)=>{"use strict";u();var kn=Ue("path"),Wa=Rt(),{pathExists:hz}=Cn(),dz=ct().fromPromise;async function xz(e,t){if(kn.isAbsolute(e)){try{await Wa.lstat(e)}catch(s){throw s.message=s.message.replace("lstat","ensureSymlink"),s}return{toCwd:e,toDst:e}}let r=kn.dirname(t),o=kn.join(r,e);if(await hz(o))return{toCwd:o,toDst:e};try{await Wa.lstat(e)}catch(s){throw s.message=s.message.replace("lstat","ensureSymlink"),s}return{toCwd:e,toDst:kn.relative(r,e)}}function gz(e,t){if(kn.isAbsolute(e)){if(!Wa.existsSync(e))throw new Error("absolute srcpath does not exist");return{toCwd:e,toDst:e}}let r=kn.dirname(t),o=kn.join(r,e);if(Wa.existsSync(o))return{toCwd:o,toDst:e};if(!Wa.existsSync(e))throw new Error("relative srcpath does not exist");return{toCwd:e,toDst:kn.relative(r,e)}}XF.exports={symlinkPaths:dz(xz),symlinkPathsSync:gz}});var o0=$((sX,r0)=>{"use strict";u();var t0=Rt(),yz=ct().fromPromise;async function bz(e,t){if(t)return t;let r;try{r=await t0.lstat(e)}catch{return"file"}return r&&r.isDirectory()?"dir":"file"}function Sz(e,t){if(t)return t;let r;try{r=t0.lstatSync(e)}catch{return"file"}return r&&r.isDirectory()?"dir":"file"}r0.exports={symlinkType:yz(bz),symlinkTypeSync:Sz}});var c0=$((cX,i0)=>{"use strict";u();var _z=ct().fromPromise,n0=Ue("path"),Xr=Rt(),{mkdirs:Ez,mkdirsSync:Oz}=kr(),{symlinkPaths:Cz,symlinkPathsSync:vz}=e0(),{symlinkType:kz,symlinkTypeSync:wz}=o0(),{pathExists:Mz}=Cn(),{areIdentical:s0}=Hs();async function Rz(e,t,r){let o;try{o=await Xr.lstat(t)}catch{}if(o&&o.isSymbolicLink()){let[c,a]=await Promise.all([Xr.stat(e),Xr.stat(t)]);if(s0(c,a))return}let n=await Cz(e,t);e=n.toDst;let s=await kz(n.toCwd,r),i=n0.dirname(t);return await Mz(i)||await Ez(i),Xr.symlink(e,t,s)}function Fz(e,t,r){let o;try{o=Xr.lstatSync(t)}catch{}if(o&&o.isSymbolicLink()){let c=Xr.statSync(e),a=Xr.statSync(t);if(s0(c,a))return}let n=vz(e,t);e=n.toDst,r=wz(n.toCwd,r);let s=n0.dirname(t);return Xr.existsSync(s)||Oz(s),Xr.symlinkSync(e,t,r)}i0.exports={createSymlink:_z(Rz),createSymlinkSync:Fz}});var d0=$((uX,h0)=>{"use strict";u();var{createFile:a0,createFileSync:u0}=VF(),{createLink:l0,createLinkSync:p0}=ZF(),{createSymlink:f0,createSymlinkSync:m0}=c0();h0.exports={createFile:a0,createFileSync:u0,ensureFile:a0,ensureFileSync:u0,createLink:l0,createLinkSync:p0,ensureLink:l0,ensureLinkSync:p0,createSymlink:f0,createSymlinkSync:m0,ensureSymlink:f0,ensureSymlinkSync:m0}});var uf=$((pX,x0)=>{u();function Tz(e,{EOL:t=`
`,finalEOL:r=!0,replacer:o=null,spaces:n}={}){let s=r?t:"";return JSON.stringify(e,o,n).replace(/\n/g,t)+s}function Az(e){return Buffer.isBuffer(e)&&(e=e.toString("utf8")),e.replace(/^\uFEFF/,"")}x0.exports={stringify:Tz,stripBom:Az}});var S0=$((mX,b0)=>{u();var oc;try{oc=ec()}catch{oc=Ue("fs")}var lf=ct(),{stringify:g0,stripBom:y0}=uf();async function Iz(e,t={}){typeof t=="string"&&(t={encoding:t});let r=t.fs||oc,o="throws"in t?t.throws:!0,n=await lf.fromCallback(r.readFile)(e,t);n=y0(n);let s;try{s=JSON.parse(n,t?t.reviver:null)}catch(i){if(o)throw i.message=`${e}: ${i.message}`,i;return null}return s}var Nz=lf.fromPromise(Iz);function Pz(e,t={}){typeof t=="string"&&(t={encoding:t});let r=t.fs||oc,o="throws"in t?t.throws:!0;try{let n=r.readFileSync(e,t);return n=y0(n),JSON.parse(n,t.reviver)}catch(n){if(o)throw n.message=`${e}: ${n.message}`,n;return null}}async function Lz(e,t,r={}){let o=r.fs||oc,n=g0(t,r);await lf.fromCallback(o.writeFile)(e,n,r)}var Dz=lf.fromPromise(Lz);function qz(e,t,r={}){let o=r.fs||oc,n=g0(t,r);return o.writeFileSync(e,n,r)}var Hz={readFile:Nz,readFileSync:Pz,writeFile:Dz,writeFileSync:qz};b0.exports=Hz});var E0=$((dX,_0)=>{"use strict";u();var pf=S0();_0.exports={readJson:pf.readFile,readJsonSync:pf.readFileSync,writeJson:pf.writeFile,writeJsonSync:pf.writeFileSync}});var ff=$((gX,v0)=>{"use strict";u();var Wz=ct().fromPromise,Yg=Rt(),O0=Ue("path"),C0=kr(),Uz=Cn().pathExists;async function Bz(e,t,r="utf-8"){let o=O0.dirname(e);return await Uz(o)||await C0.mkdirs(o),Yg.writeFile(e,t,r)}function jz(e,...t){let r=O0.dirname(e);Yg.existsSync(r)||C0.mkdirsSync(r),Yg.writeFileSync(e,...t)}v0.exports={outputFile:Wz(Bz),outputFileSync:jz}});var w0=$((bX,k0)=>{"use strict";u();var{stringify:zz}=uf(),{outputFile:Gz}=ff();async function $z(e,t,r={}){let o=zz(t,r);await Gz(e,o,r)}k0.exports=$z});var R0=$((_X,M0)=>{"use strict";u();var{stringify:Vz}=uf(),{outputFileSync:Kz}=ff();function Jz(e,t,r){let o=Vz(t,r);Kz(e,o,r)}M0.exports=Jz});var T0=$((OX,F0)=>{"use strict";u();var Yz=ct().fromPromise,Tt=E0();Tt.outputJson=Yz(w0());Tt.outputJsonSync=R0();Tt.outputJSON=Tt.outputJson;Tt.outputJSONSync=Tt.outputJsonSync;Tt.writeJSON=Tt.writeJson;Tt.writeJSONSync=Tt.writeJsonSync;Tt.readJSON=Tt.readJson;Tt.readJSONSync=Tt.readJsonSync;F0.exports=Tt});var L0=$((vX,P0)=>{"use strict";u();var Qz=Rt(),A0=Ue("path"),{copy:Zz}=af(),{remove:N0}=Ha(),{mkdirp:Xz}=kr(),{pathExists:e3}=Cn(),I0=Hs();async function t3(e,t,r={}){let o=r.overwrite||r.clobber||!1,{srcStat:n,isChangingCase:s=!1}=await I0.checkPaths(e,t,"move",r);await I0.checkParentPaths(e,n,t,"move");let i=A0.dirname(t);return A0.parse(i).root!==i&&await Xz(i),r3(e,t,o,s)}async function r3(e,t,r,o){if(!o){if(r)await N0(t);else if(await e3(t))throw new Error("dest already exists.")}try{await Qz.rename(e,t)}catch(n){if(n.code!=="EXDEV")throw n;await o3(e,t,r)}}async function o3(e,t,r){return await Zz(e,t,{overwrite:r,errorOnExist:!0,preserveTimestamps:!0}),N0(e)}P0.exports=t3});var U0=$((wX,W0)=>{"use strict";u();var q0=ec(),Zg=Ue("path"),n3=af().copySync,H0=Ha().removeSync,s3=kr().mkdirpSync,D0=Hs();function i3(e,t,r){r=r||{};let o=r.overwrite||r.clobber||!1,{srcStat:n,isChangingCase:s=!1}=D0.checkPathsSync(e,t,"move",r);return D0.checkParentPathsSync(e,n,t,"move"),c3(t)||s3(Zg.dirname(t)),a3(e,t,o,s)}function c3(e){let t=Zg.dirname(e);return Zg.parse(t).root===t}function a3(e,t,r,o){if(o)return Qg(e,t,r);if(r)return H0(t),Qg(e,t,r);if(q0.existsSync(t))throw new Error("dest already exists.");return Qg(e,t,r)}function Qg(e,t,r){try{q0.renameSync(e,t)}catch(o){if(o.code!=="EXDEV")throw o;return u3(e,t,r)}}function u3(e,t,r){return n3(e,t,{overwrite:r,errorOnExist:!0,preserveTimestamps:!0}),H0(e)}W0.exports=i3});var j0=$((RX,B0)=>{"use strict";u();var l3=ct().fromPromise;B0.exports={move:l3(L0()),moveSync:U0()}});var Xg=$((TX,z0)=>{"use strict";u();z0.exports={...Rt(),...af(),...jF(),...d0(),...T0(),...kr(),...j0(),...ff(),...Cn(),...Ha()}});var Y0=$((zX,ey)=>{u();var K0=process.argv||[],df=process.env,f3=!("NO_COLOR"in df||K0.includes("--no-color"))&&("FORCE_COLOR"in df||K0.includes("--color")||process.platform==="win32"||Ue!=null&&Ue("tty").isatty(1)&&df.TERM!=="dumb"||"CI"in df),m3=(e,t,r=e)=>o=>{let n=""+o,s=n.indexOf(t,e.length);return~s?e+h3(n,t,r,s)+t:e+n+t},h3=(e,t,r,o)=>{let n="",s=0;do n+=e.substring(s,o)+r,s=o+t.length,o=e.indexOf(t,s);while(~o);return n+e.substring(s)},J0=(e=f3)=>{let t=e?m3:()=>String;return{isColorSupported:e,reset:t("\x1B[0m","\x1B[0m"),bold:t("\x1B[1m","\x1B[22m","\x1B[22m\x1B[1m"),dim:t("\x1B[2m","\x1B[22m","\x1B[22m\x1B[2m"),italic:t("\x1B[3m","\x1B[23m"),underline:t("\x1B[4m","\x1B[24m"),inverse:t("\x1B[7m","\x1B[27m"),hidden:t("\x1B[8m","\x1B[28m"),strikethrough:t("\x1B[9m","\x1B[29m"),black:t("\x1B[30m","\x1B[39m"),red:t("\x1B[31m","\x1B[39m"),green:t("\x1B[32m","\x1B[39m"),yellow:t("\x1B[33m","\x1B[39m"),blue:t("\x1B[34m","\x1B[39m"),magenta:t("\x1B[35m","\x1B[39m"),cyan:t("\x1B[36m","\x1B[39m"),white:t("\x1B[37m","\x1B[39m"),gray:t("\x1B[90m","\x1B[39m"),bgBlack:t("\x1B[40m","\x1B[49m"),bgRed:t("\x1B[41m","\x1B[49m"),bgGreen:t("\x1B[42m","\x1B[49m"),bgYellow:t("\x1B[43m","\x1B[49m"),bgBlue:t("\x1B[44m","\x1B[49m"),bgMagenta:t("\x1B[45m","\x1B[49m"),bgCyan:t("\x1B[46m","\x1B[49m"),bgWhite:t("\x1B[47m","\x1B[49m")}};ey.exports=J0();ey.exports.createColors=J0});var Z0=$(ty=>{u();var Q0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");ty.encode=function(e){if(0<=e&&e<Q0.length)return Q0[e];throw new TypeError("Must be between 0 and 63: "+e)};ty.decode=function(e){var t=65,r=90,o=97,n=122,s=48,i=57,c=43,a=47,p=26,f=52;return t<=e&&e<=r?e-t:o<=e&&e<=n?e-o+p:s<=e&&e<=i?e-s+f:e==c?62:e==a?63:-1}});var ny=$(oy=>{u();var X0=Z0(),ry=5,eT=1<<ry,tT=eT-1,rT=eT;function d3(e){return e<0?(-e<<1)+1:(e<<1)+0}function x3(e){var t=(e&1)===1,r=e>>1;return t?-r:r}oy.encode=function(t){var r="",o,n=d3(t);do o=n&tT,n>>>=ry,n>0&&(o|=rT),r+=X0.encode(o);while(n>0);return r};oy.decode=function(t,r,o){var n=t.length,s=0,i=0,c,a;do{if(r>=n)throw new Error("Expected more digits in base 64 VLQ value.");if(a=X0.decode(t.charCodeAt(r++)),a===-1)throw new Error("Invalid base64 digit: "+t.charAt(r-1));c=!!(a&rT),a&=tT,s=s+(a<<i),i+=ry}while(c);o.value=x3(s),o.rest=r}});var ic=$(ut=>{u();function g3(e,t,r){if(t in e)return e[t];if(arguments.length===3)return r;throw new Error('"'+t+'" is a required argument.')}ut.getArg=g3;var oT=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,y3=/^data:.+\,.+$/;function Ua(e){var t=e.match(oT);return t?{scheme:t[1],auth:t[2],host:t[3],port:t[4],path:t[5]}:null}ut.urlParse=Ua;function sc(e){var t="";return e.scheme&&(t+=e.scheme+":"),t+="//",e.auth&&(t+=e.auth+"@"),e.host&&(t+=e.host),e.port&&(t+=":"+e.port),e.path&&(t+=e.path),t}ut.urlGenerate=sc;var b3=32;function S3(e){var t=[];return function(r){for(var o=0;o<t.length;o++)if(t[o].input===r){var n=t[0];return t[0]=t[o],t[o]=n,t[0].result}var s=e(r);return t.unshift({input:r,result:s}),t.length>b3&&t.pop(),s}}var sy=S3(function(t){var r=t,o=Ua(t);if(o){if(!o.path)return t;r=o.path}for(var n=ut.isAbsolute(r),s=[],i=0,c=0;;)if(i=c,c=r.indexOf("/",i),c===-1){s.push(r.slice(i));break}else for(s.push(r.slice(i,c));c<r.length&&r[c]==="/";)c++;for(var a,p=0,c=s.length-1;c>=0;c--)a=s[c],a==="."?s.splice(c,1):a===".."?p++:p>0&&(a===""?(s.splice(c+1,p),p=0):(s.splice(c,2),p--));return r=s.join("/"),r===""&&(r=n?"/":"."),o?(o.path=r,sc(o)):r});ut.normalize=sy;function nT(e,t){e===""&&(e="."),t===""&&(t=".");var r=Ua(t),o=Ua(e);if(o&&(e=o.path||"/"),r&&!r.scheme)return o&&(r.scheme=o.scheme),sc(r);if(r||t.match(y3))return t;if(o&&!o.host&&!o.path)return o.host=t,sc(o);var n=t.charAt(0)==="/"?t:sy(e.replace(/\/+$/,"")+"/"+t);return o?(o.path=n,sc(o)):n}ut.join=nT;ut.isAbsolute=function(e){return e.charAt(0)==="/"||oT.test(e)};function _3(e,t){e===""&&(e="."),e=e.replace(/\/$/,"");for(var r=0;t.indexOf(e+"/")!==0;){var o=e.lastIndexOf("/");if(o<0||(e=e.slice(0,o),e.match(/^([^\/]+:\/)?\/*$/)))return t;++r}return Array(r+1).join("../")+t.substr(e.length+1)}ut.relative=_3;var sT=function(){var e=Object.create(null);return!("__proto__"in e)}();function iT(e){return e}function E3(e){return cT(e)?"$"+e:e}ut.toSetString=sT?iT:E3;function O3(e){return cT(e)?e.slice(1):e}ut.fromSetString=sT?iT:O3;function cT(e){if(!e)return!1;var t=e.length;if(t<9||e.charCodeAt(t-1)!==95||e.charCodeAt(t-2)!==95||e.charCodeAt(t-3)!==111||e.charCodeAt(t-4)!==116||e.charCodeAt(t-5)!==111||e.charCodeAt(t-6)!==114||e.charCodeAt(t-7)!==112||e.charCodeAt(t-8)!==95||e.charCodeAt(t-9)!==95)return!1;for(var r=t-10;r>=0;r--)if(e.charCodeAt(r)!==36)return!1;return!0}function C3(e,t,r){var o=Ao(e.source,t.source);return o!==0||(o=e.originalLine-t.originalLine,o!==0)||(o=e.originalColumn-t.originalColumn,o!==0||r)||(o=e.generatedColumn-t.generatedColumn,o!==0)||(o=e.generatedLine-t.generatedLine,o!==0)?o:Ao(e.name,t.name)}ut.compareByOriginalPositions=C3;function v3(e,t,r){var o;return o=e.originalLine-t.originalLine,o!==0||(o=e.originalColumn-t.originalColumn,o!==0||r)||(o=e.generatedColumn-t.generatedColumn,o!==0)||(o=e.generatedLine-t.generatedLine,o!==0)?o:Ao(e.name,t.name)}ut.compareByOriginalPositionsNoSource=v3;function k3(e,t,r){var o=e.generatedLine-t.generatedLine;return o!==0||(o=e.generatedColumn-t.generatedColumn,o!==0||r)||(o=Ao(e.source,t.source),o!==0)||(o=e.originalLine-t.originalLine,o!==0)||(o=e.originalColumn-t.originalColumn,o!==0)?o:Ao(e.name,t.name)}ut.compareByGeneratedPositionsDeflated=k3;function w3(e,t,r){var o=e.generatedColumn-t.generatedColumn;return o!==0||r||(o=Ao(e.source,t.source),o!==0)||(o=e.originalLine-t.originalLine,o!==0)||(o=e.originalColumn-t.originalColumn,o!==0)?o:Ao(e.name,t.name)}ut.compareByGeneratedPositionsDeflatedNoLine=w3;function Ao(e,t){return e===t?0:e===null?1:t===null?-1:e>t?1:-1}function M3(e,t){var r=e.generatedLine-t.generatedLine;return r!==0||(r=e.generatedColumn-t.generatedColumn,r!==0)||(r=Ao(e.source,t.source),r!==0)||(r=e.originalLine-t.originalLine,r!==0)||(r=e.originalColumn-t.originalColumn,r!==0)?r:Ao(e.name,t.name)}ut.compareByGeneratedPositionsInflated=M3;function R3(e){return JSON.parse(e.replace(/^\)]}'[^\n]*\n/,""))}ut.parseSourceMapInput=R3;function F3(e,t,r){if(t=t||"",e&&(e[e.length-1]!=="/"&&t[0]!=="/"&&(e+="/"),t=e+t),r){var o=Ua(r);if(!o)throw new Error("sourceMapURL could not be parsed");if(o.path){var n=o.path.lastIndexOf("/");n>=0&&(o.path=o.path.substring(0,n+1))}t=nT(sc(o),t)}return sy(t)}ut.computeSourceURL=F3});var ay=$(aT=>{u();var iy=ic(),cy=Object.prototype.hasOwnProperty,Ws=typeof Map<"u";function Io(){this._array=[],this._set=Ws?new Map:Object.create(null)}Io.fromArray=function(t,r){for(var o=new Io,n=0,s=t.length;n<s;n++)o.add(t[n],r);return o};Io.prototype.size=function(){return Ws?this._set.size:Object.getOwnPropertyNames(this._set).length};Io.prototype.add=function(t,r){var o=Ws?t:iy.toSetString(t),n=Ws?this.has(t):cy.call(this._set,o),s=this._array.length;(!n||r)&&this._array.push(t),n||(Ws?this._set.set(t,s):this._set[o]=s)};Io.prototype.has=function(t){if(Ws)return this._set.has(t);var r=iy.toSetString(t);return cy.call(this._set,r)};Io.prototype.indexOf=function(t){if(Ws){var r=this._set.get(t);if(r>=0)return r}else{var o=iy.toSetString(t);if(cy.call(this._set,o))return this._set[o]}throw new Error('"'+t+'" is not in the set.')};Io.prototype.at=function(t){if(t>=0&&t<this._array.length)return this._array[t];throw new Error("No element indexed by "+t)};Io.prototype.toArray=function(){return this._array.slice()};aT.ArraySet=Io});var pT=$(lT=>{u();var uT=ic();function T3(e,t){var r=e.generatedLine,o=t.generatedLine,n=e.generatedColumn,s=t.generatedColumn;return o>r||o==r&&s>=n||uT.compareByGeneratedPositionsInflated(e,t)<=0}function xf(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}xf.prototype.unsortedForEach=function(t,r){this._array.forEach(t,r)};xf.prototype.add=function(t){T3(this._last,t)?(this._last=t,this._array.push(t)):(this._sorted=!1,this._array.push(t))};xf.prototype.toArray=function(){return this._sorted||(this._array.sort(uT.compareByGeneratedPositionsInflated),this._sorted=!0),this._array};lT.MappingList=xf});var uy=$(fT=>{u();var Ba=ny(),$e=ic(),gf=ay().ArraySet,A3=pT().MappingList;function fr(e){e||(e={}),this._file=$e.getArg(e,"file",null),this._sourceRoot=$e.getArg(e,"sourceRoot",null),this._skipValidation=$e.getArg(e,"skipValidation",!1),this._ignoreInvalidMapping=$e.getArg(e,"ignoreInvalidMapping",!1),this._sources=new gf,this._names=new gf,this._mappings=new A3,this._sourcesContents=null}fr.prototype._version=3;fr.fromSourceMap=function(t,r){var o=t.sourceRoot,n=new fr(Object.assign(r||{},{file:t.file,sourceRoot:o}));return t.eachMapping(function(s){var i={generated:{line:s.generatedLine,column:s.generatedColumn}};s.source!=null&&(i.source=s.source,o!=null&&(i.source=$e.relative(o,i.source)),i.original={line:s.originalLine,column:s.originalColumn},s.name!=null&&(i.name=s.name)),n.addMapping(i)}),t.sources.forEach(function(s){var i=s;o!==null&&(i=$e.relative(o,s)),n._sources.has(i)||n._sources.add(i);var c=t.sourceContentFor(s);c!=null&&n.setSourceContent(s,c)}),n};fr.prototype.addMapping=function(t){var r=$e.getArg(t,"generated"),o=$e.getArg(t,"original",null),n=$e.getArg(t,"source",null),s=$e.getArg(t,"name",null);!this._skipValidation&&this._validateMapping(r,o,n,s)===!1||(n!=null&&(n=String(n),this._sources.has(n)||this._sources.add(n)),s!=null&&(s=String(s),this._names.has(s)||this._names.add(s)),this._mappings.add({generatedLine:r.line,generatedColumn:r.column,originalLine:o!=null&&o.line,originalColumn:o!=null&&o.column,source:n,name:s}))};fr.prototype.setSourceContent=function(t,r){var o=t;this._sourceRoot!=null&&(o=$e.relative(this._sourceRoot,o)),r!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[$e.toSetString(o)]=r):this._sourcesContents&&(delete this._sourcesContents[$e.toSetString(o)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))};fr.prototype.applySourceMap=function(t,r,o){var n=r;if(r==null){if(t.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);n=t.file}var s=this._sourceRoot;s!=null&&(n=$e.relative(s,n));var i=new gf,c=new gf;this._mappings.unsortedForEach(function(a){if(a.source===n&&a.originalLine!=null){var p=t.originalPositionFor({line:a.originalLine,column:a.originalColumn});p.source!=null&&(a.source=p.source,o!=null&&(a.source=$e.join(o,a.source)),s!=null&&(a.source=$e.relative(s,a.source)),a.originalLine=p.line,a.originalColumn=p.column,p.name!=null&&(a.name=p.name))}var f=a.source;f!=null&&!i.has(f)&&i.add(f);var h=a.name;h!=null&&!c.has(h)&&c.add(h)},this),this._sources=i,this._names=c,t.sources.forEach(function(a){var p=t.sourceContentFor(a);p!=null&&(o!=null&&(a=$e.join(o,a)),s!=null&&(a=$e.relative(s,a)),this.setSourceContent(a,p))},this)};fr.prototype._validateMapping=function(t,r,o,n){if(r&&typeof r.line!="number"&&typeof r.column!="number"){var s="original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.";if(this._ignoreInvalidMapping)return typeof console<"u"&&console.warn&&console.warn(s),!1;throw new Error(s)}if(!(t&&"line"in t&&"column"in t&&t.line>0&&t.column>=0&&!r&&!o&&!n)){if(t&&"line"in t&&"column"in t&&r&&"line"in r&&"column"in r&&t.line>0&&t.column>=0&&r.line>0&&r.column>=0&&o)return;var s="Invalid mapping: "+JSON.stringify({generated:t,source:o,original:r,name:n});if(this._ignoreInvalidMapping)return typeof console<"u"&&console.warn&&console.warn(s),!1;throw new Error(s)}};fr.prototype._serializeMappings=function(){for(var t=0,r=1,o=0,n=0,s=0,i=0,c="",a,p,f,h,d=this._mappings.toArray(),g=0,b=d.length;g<b;g++){if(p=d[g],a="",p.generatedLine!==r)for(t=0;p.generatedLine!==r;)a+=";",r++;else if(g>0){if(!$e.compareByGeneratedPositionsInflated(p,d[g-1]))continue;a+=","}a+=Ba.encode(p.generatedColumn-t),t=p.generatedColumn,p.source!=null&&(h=this._sources.indexOf(p.source),a+=Ba.encode(h-i),i=h,a+=Ba.encode(p.originalLine-1-n),n=p.originalLine-1,a+=Ba.encode(p.originalColumn-o),o=p.originalColumn,p.name!=null&&(f=this._names.indexOf(p.name),a+=Ba.encode(f-s),s=f)),c+=a}return c};fr.prototype._generateSourcesContent=function(t,r){return t.map(function(o){if(!this._sourcesContents)return null;r!=null&&(o=$e.relative(r,o));var n=$e.toSetString(o);return Object.prototype.hasOwnProperty.call(this._sourcesContents,n)?this._sourcesContents[n]:null},this)};fr.prototype.toJSON=function(){var t={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(t.file=this._file),this._sourceRoot!=null&&(t.sourceRoot=this._sourceRoot),this._sourcesContents&&(t.sourcesContent=this._generateSourcesContent(t.sources,t.sourceRoot)),t};fr.prototype.toString=function(){return JSON.stringify(this.toJSON())};fT.SourceMapGenerator=fr});var mT=$(Us=>{u();Us.GREATEST_LOWER_BOUND=1;Us.LEAST_UPPER_BOUND=2;function ly(e,t,r,o,n,s){var i=Math.floor((t-e)/2)+e,c=n(r,o[i],!0);return c===0?i:c>0?t-i>1?ly(i,t,r,o,n,s):s==Us.LEAST_UPPER_BOUND?t<o.length?t:-1:i:i-e>1?ly(e,i,r,o,n,s):s==Us.LEAST_UPPER_BOUND?i:e<0?-1:e}Us.search=function(t,r,o,n){if(r.length===0)return-1;var s=ly(-1,r.length,t,r,o,n||Us.GREATEST_LOWER_BOUND);if(s<0)return-1;for(;s-1>=0&&o(r[s],r[s-1],!0)===0;)--s;return s}});var xT=$(dT=>{u();function I3(e){function t(n,s,i){var c=n[s];n[s]=n[i],n[i]=c}function r(n,s){return Math.round(n+Math.random()*(s-n))}function o(n,s,i,c){if(i<c){var a=r(i,c),p=i-1;t(n,a,c);for(var f=n[c],h=i;h<c;h++)s(n[h],f,!1)<=0&&(p+=1,t(n,p,h));t(n,p+1,h);var d=p+1;o(n,s,i,d-1),o(n,s,d+1,c)}}return o}function N3(e){let t=I3.toString();return new Function(`return ${t}`)()(e)}var hT=new WeakMap;dT.quickSort=function(e,t,r=0){let o=hT.get(t);o===void 0&&(o=N3(t),hT.set(t,o)),o(e,t,r,e.length-1)}});var bT=$(yf=>{u();var A=ic(),fy=mT(),cc=ay().ArraySet,P3=ny(),ja=xT().quickSort;function Ce(e,t){var r=e;return typeof e=="string"&&(r=A.parseSourceMapInput(e)),r.sections!=null?new wr(r,t):new dt(r,t)}Ce.fromSourceMap=function(e,t){return dt.fromSourceMap(e,t)};Ce.prototype._version=3;Ce.prototype.__generatedMappings=null;Object.defineProperty(Ce.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}});Ce.prototype.__originalMappings=null;Object.defineProperty(Ce.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}});Ce.prototype._charIsMappingSeparator=function(t,r){var o=t.charAt(r);return o===";"||o===","};Ce.prototype._parseMappings=function(t,r){throw new Error("Subclasses must implement _parseMappings")};Ce.GENERATED_ORDER=1;Ce.ORIGINAL_ORDER=2;Ce.GREATEST_LOWER_BOUND=1;Ce.LEAST_UPPER_BOUND=2;Ce.prototype.eachMapping=function(t,r,o){var n=r||null,s=o||Ce.GENERATED_ORDER,i;switch(s){case Ce.GENERATED_ORDER:i=this._generatedMappings;break;case Ce.ORIGINAL_ORDER:i=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}for(var c=this.sourceRoot,a=t.bind(n),p=this._names,f=this._sources,h=this._sourceMapURL,d=0,g=i.length;d<g;d++){var b=i[d],M=b.source===null?null:f.at(b.source);M=A.computeSourceURL(c,M,h),a({source:M,generatedLine:b.generatedLine,generatedColumn:b.generatedColumn,originalLine:b.originalLine,originalColumn:b.originalColumn,name:b.name===null?null:p.at(b.name)})}};Ce.prototype.allGeneratedPositionsFor=function(t){var r=A.getArg(t,"line"),o={source:A.getArg(t,"source"),originalLine:r,originalColumn:A.getArg(t,"column",0)};if(o.source=this._findSourceIndex(o.source),o.source<0)return[];var n=[],s=this._findMapping(o,this._originalMappings,"originalLine","originalColumn",A.compareByOriginalPositions,fy.LEAST_UPPER_BOUND);if(s>=0){var i=this._originalMappings[s];if(t.column===void 0)for(var c=i.originalLine;i&&i.originalLine===c;)n.push({line:A.getArg(i,"generatedLine",null),column:A.getArg(i,"generatedColumn",null),lastColumn:A.getArg(i,"lastGeneratedColumn",null)}),i=this._originalMappings[++s];else for(var a=i.originalColumn;i&&i.originalLine===r&&i.originalColumn==a;)n.push({line:A.getArg(i,"generatedLine",null),column:A.getArg(i,"generatedColumn",null),lastColumn:A.getArg(i,"lastGeneratedColumn",null)}),i=this._originalMappings[++s]}return n};yf.SourceMapConsumer=Ce;function dt(e,t){var r=e;typeof e=="string"&&(r=A.parseSourceMapInput(e));var o=A.getArg(r,"version"),n=A.getArg(r,"sources"),s=A.getArg(r,"names",[]),i=A.getArg(r,"sourceRoot",null),c=A.getArg(r,"sourcesContent",null),a=A.getArg(r,"mappings"),p=A.getArg(r,"file",null);if(o!=this._version)throw new Error("Unsupported version: "+o);i&&(i=A.normalize(i)),n=n.map(String).map(A.normalize).map(function(f){return i&&A.isAbsolute(i)&&A.isAbsolute(f)?A.relative(i,f):f}),this._names=cc.fromArray(s.map(String),!0),this._sources=cc.fromArray(n,!0),this._absoluteSources=this._sources.toArray().map(function(f){return A.computeSourceURL(i,f,t)}),this.sourceRoot=i,this.sourcesContent=c,this._mappings=a,this._sourceMapURL=t,this.file=p}dt.prototype=Object.create(Ce.prototype);dt.prototype.consumer=Ce;dt.prototype._findSourceIndex=function(e){var t=e;if(this.sourceRoot!=null&&(t=A.relative(this.sourceRoot,t)),this._sources.has(t))return this._sources.indexOf(t);var r;for(r=0;r<this._absoluteSources.length;++r)if(this._absoluteSources[r]==e)return r;return-1};dt.fromSourceMap=function(t,r){var o=Object.create(dt.prototype),n=o._names=cc.fromArray(t._names.toArray(),!0),s=o._sources=cc.fromArray(t._sources.toArray(),!0);o.sourceRoot=t._sourceRoot,o.sourcesContent=t._generateSourcesContent(o._sources.toArray(),o.sourceRoot),o.file=t._file,o._sourceMapURL=r,o._absoluteSources=o._sources.toArray().map(function(g){return A.computeSourceURL(o.sourceRoot,g,r)});for(var i=t._mappings.toArray().slice(),c=o.__generatedMappings=[],a=o.__originalMappings=[],p=0,f=i.length;p<f;p++){var h=i[p],d=new yT;d.generatedLine=h.generatedLine,d.generatedColumn=h.generatedColumn,h.source&&(d.source=s.indexOf(h.source),d.originalLine=h.originalLine,d.originalColumn=h.originalColumn,h.name&&(d.name=n.indexOf(h.name)),a.push(d)),c.push(d)}return ja(o.__originalMappings,A.compareByOriginalPositions),o};dt.prototype._version=3;Object.defineProperty(dt.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function yT(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}var py=A.compareByGeneratedPositionsDeflatedNoLine;function gT(e,t){let r=e.length,o=e.length-t;if(!(o<=1))if(o==2){let n=e[t],s=e[t+1];py(n,s)>0&&(e[t]=s,e[t+1]=n)}else if(o<20)for(let n=t;n<r;n++)for(let s=n;s>t;s--){let i=e[s-1],c=e[s];if(py(i,c)<=0)break;e[s-1]=c,e[s]=i}else ja(e,py,t)}dt.prototype._parseMappings=function(t,r){var o=1,n=0,s=0,i=0,c=0,a=0,p=t.length,f=0,h={},d={},g=[],b=[],M,T,P,K,ae;let _e=0;for(;f<p;)if(t.charAt(f)===";")o++,f++,n=0,gT(b,_e),_e=b.length;else if(t.charAt(f)===",")f++;else{for(M=new yT,M.generatedLine=o,K=f;K<p&&!this._charIsMappingSeparator(t,K);K++);for(T=t.slice(f,K),P=[];f<K;)P3.decode(t,f,d),ae=d.value,f=d.rest,P.push(ae);if(P.length===2)throw new Error("Found a source, but no line and column");if(P.length===3)throw new Error("Found a source and line, but no column");if(M.generatedColumn=n+P[0],n=M.generatedColumn,P.length>1&&(M.source=c+P[1],c+=P[1],M.originalLine=s+P[2],s=M.originalLine,M.originalLine+=1,M.originalColumn=i+P[3],i=M.originalColumn,P.length>4&&(M.name=a+P[4],a+=P[4])),b.push(M),typeof M.originalLine=="number"){let Zt=M.source;for(;g.length<=Zt;)g.push(null);g[Zt]===null&&(g[Zt]=[]),g[Zt].push(M)}}gT(b,_e),this.__generatedMappings=b;for(var lt=0;lt<g.length;lt++)g[lt]!=null&&ja(g[lt],A.compareByOriginalPositionsNoSource);this.__originalMappings=[].concat(...g)};dt.prototype._findMapping=function(t,r,o,n,s,i){if(t[o]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+t[o]);if(t[n]<0)throw new TypeError("Column must be greater than or equal to 0, got "+t[n]);return fy.search(t,r,s,i)};dt.prototype.computeColumnSpans=function(){for(var t=0;t<this._generatedMappings.length;++t){var r=this._generatedMappings[t];if(t+1<this._generatedMappings.length){var o=this._generatedMappings[t+1];if(r.generatedLine===o.generatedLine){r.lastGeneratedColumn=o.generatedColumn-1;continue}}r.lastGeneratedColumn=1/0}};dt.prototype.originalPositionFor=function(t){var r={generatedLine:A.getArg(t,"line"),generatedColumn:A.getArg(t,"column")},o=this._findMapping(r,this._generatedMappings,"generatedLine","generatedColumn",A.compareByGeneratedPositionsDeflated,A.getArg(t,"bias",Ce.GREATEST_LOWER_BOUND));if(o>=0){var n=this._generatedMappings[o];if(n.generatedLine===r.generatedLine){var s=A.getArg(n,"source",null);s!==null&&(s=this._sources.at(s),s=A.computeSourceURL(this.sourceRoot,s,this._sourceMapURL));var i=A.getArg(n,"name",null);return i!==null&&(i=this._names.at(i)),{source:s,line:A.getArg(n,"originalLine",null),column:A.getArg(n,"originalColumn",null),name:i}}}return{source:null,line:null,column:null,name:null}};dt.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(t){return t==null}):!1};dt.prototype.sourceContentFor=function(t,r){if(!this.sourcesContent)return null;var o=this._findSourceIndex(t);if(o>=0)return this.sourcesContent[o];var n=t;this.sourceRoot!=null&&(n=A.relative(this.sourceRoot,n));var s;if(this.sourceRoot!=null&&(s=A.urlParse(this.sourceRoot))){var i=n.replace(/^file:\/\//,"");if(s.scheme=="file"&&this._sources.has(i))return this.sourcesContent[this._sources.indexOf(i)];if((!s.path||s.path=="/")&&this._sources.has("/"+n))return this.sourcesContent[this._sources.indexOf("/"+n)]}if(r)return null;throw new Error('"'+n+'" is not in the SourceMap.')};dt.prototype.generatedPositionFor=function(t){var r=A.getArg(t,"source");if(r=this._findSourceIndex(r),r<0)return{line:null,column:null,lastColumn:null};var o={source:r,originalLine:A.getArg(t,"line"),originalColumn:A.getArg(t,"column")},n=this._findMapping(o,this._originalMappings,"originalLine","originalColumn",A.compareByOriginalPositions,A.getArg(t,"bias",Ce.GREATEST_LOWER_BOUND));if(n>=0){var s=this._originalMappings[n];if(s.source===o.source)return{line:A.getArg(s,"generatedLine",null),column:A.getArg(s,"generatedColumn",null),lastColumn:A.getArg(s,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}};yf.BasicSourceMapConsumer=dt;function wr(e,t){var r=e;typeof e=="string"&&(r=A.parseSourceMapInput(e));var o=A.getArg(r,"version"),n=A.getArg(r,"sections");if(o!=this._version)throw new Error("Unsupported version: "+o);this._sources=new cc,this._names=new cc;var s={line:-1,column:0};this._sections=n.map(function(i){if(i.url)throw new Error("Support for url field in sections not implemented.");var c=A.getArg(i,"offset"),a=A.getArg(c,"line"),p=A.getArg(c,"column");if(a<s.line||a===s.line&&p<s.column)throw new Error("Section offsets must be ordered and non-overlapping.");return s=c,{generatedOffset:{generatedLine:a+1,generatedColumn:p+1},consumer:new Ce(A.getArg(i,"map"),t)}})}wr.prototype=Object.create(Ce.prototype);wr.prototype.constructor=Ce;wr.prototype._version=3;Object.defineProperty(wr.prototype,"sources",{get:function(){for(var e=[],t=0;t<this._sections.length;t++)for(var r=0;r<this._sections[t].consumer.sources.length;r++)e.push(this._sections[t].consumer.sources[r]);return e}});wr.prototype.originalPositionFor=function(t){var r={generatedLine:A.getArg(t,"line"),generatedColumn:A.getArg(t,"column")},o=fy.search(r,this._sections,function(s,i){var c=s.generatedLine-i.generatedOffset.generatedLine;return c||s.generatedColumn-i.generatedOffset.generatedColumn}),n=this._sections[o];return n?n.consumer.originalPositionFor({line:r.generatedLine-(n.generatedOffset.generatedLine-1),column:r.generatedColumn-(n.generatedOffset.generatedLine===r.generatedLine?n.generatedOffset.generatedColumn-1:0),bias:t.bias}):{source:null,line:null,column:null,name:null}};wr.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(t){return t.consumer.hasContentsOfAllSources()})};wr.prototype.sourceContentFor=function(t,r){for(var o=0;o<this._sections.length;o++){var n=this._sections[o],s=n.consumer.sourceContentFor(t,!0);if(s||s==="")return s}if(r)return null;throw new Error('"'+t+'" is not in the SourceMap.')};wr.prototype.generatedPositionFor=function(t){for(var r=0;r<this._sections.length;r++){var o=this._sections[r];if(o.consumer._findSourceIndex(A.getArg(t,"source"))!==-1){var n=o.consumer.generatedPositionFor(t);if(n){var s={line:n.line+(o.generatedOffset.generatedLine-1),column:n.column+(o.generatedOffset.generatedLine===n.line?o.generatedOffset.generatedColumn-1:0)};return s}}}return{line:null,column:null}};wr.prototype._parseMappings=function(t,r){this.__generatedMappings=[],this.__originalMappings=[];for(var o=0;o<this._sections.length;o++)for(var n=this._sections[o],s=n.consumer._generatedMappings,i=0;i<s.length;i++){var c=s[i],a=n.consumer._sources.at(c.source);a=A.computeSourceURL(n.consumer.sourceRoot,a,this._sourceMapURL),this._sources.add(a),a=this._sources.indexOf(a);var p=null;c.name&&(p=n.consumer._names.at(c.name),this._names.add(p),p=this._names.indexOf(p));var f={source:a,generatedLine:c.generatedLine+(n.generatedOffset.generatedLine-1),generatedColumn:c.generatedColumn+(n.generatedOffset.generatedLine===c.generatedLine?n.generatedOffset.generatedColumn-1:0),originalLine:c.originalLine,originalColumn:c.originalColumn,name:p};this.__generatedMappings.push(f),typeof f.originalLine=="number"&&this.__originalMappings.push(f)}ja(this.__generatedMappings,A.compareByGeneratedPositionsDeflated),ja(this.__originalMappings,A.compareByOriginalPositions)};yf.IndexedSourceMapConsumer=wr});var _T=$(ST=>{u();var L3=uy().SourceMapGenerator,bf=ic(),D3=/(\r?\n)/,q3=10,ac="$$$isSourceNode$$$";function Qt(e,t,r,o,n){this.children=[],this.sourceContents={},this.line=e??null,this.column=t??null,this.source=r??null,this.name=n??null,this[ac]=!0,o!=null&&this.add(o)}Qt.fromStringWithSourceMap=function(t,r,o){var n=new Qt,s=t.split(D3),i=0,c=function(){var d=b(),g=b()||"";return d+g;function b(){return i<s.length?s[i++]:void 0}},a=1,p=0,f=null;return r.eachMapping(function(d){if(f!==null)if(a<d.generatedLine)h(f,c()),a++,p=0;else{var g=s[i]||"",b=g.substr(0,d.generatedColumn-p);s[i]=g.substr(d.generatedColumn-p),p=d.generatedColumn,h(f,b),f=d;return}for(;a<d.generatedLine;)n.add(c()),a++;if(p<d.generatedColumn){var g=s[i]||"";n.add(g.substr(0,d.generatedColumn)),s[i]=g.substr(d.generatedColumn),p=d.generatedColumn}f=d},this),i<s.length&&(f&&h(f,c()),n.add(s.splice(i).join(""))),r.sources.forEach(function(d){var g=r.sourceContentFor(d);g!=null&&(o!=null&&(d=bf.join(o,d)),n.setSourceContent(d,g))}),n;function h(d,g){if(d===null||d.source===void 0)n.add(g);else{var b=o?bf.join(o,d.source):d.source;n.add(new Qt(d.originalLine,d.originalColumn,b,g,d.name))}}};Qt.prototype.add=function(t){if(Array.isArray(t))t.forEach(function(r){this.add(r)},this);else if(t[ac]||typeof t=="string")t&&this.children.push(t);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+t);return this};Qt.prototype.prepend=function(t){if(Array.isArray(t))for(var r=t.length-1;r>=0;r--)this.prepend(t[r]);else if(t[ac]||typeof t=="string")this.children.unshift(t);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+t);return this};Qt.prototype.walk=function(t){for(var r,o=0,n=this.children.length;o<n;o++)r=this.children[o],r[ac]?r.walk(t):r!==""&&t(r,{source:this.source,line:this.line,column:this.column,name:this.name})};Qt.prototype.join=function(t){var r,o,n=this.children.length;if(n>0){for(r=[],o=0;o<n-1;o++)r.push(this.children[o]),r.push(t);r.push(this.children[o]),this.children=r}return this};Qt.prototype.replaceRight=function(t,r){var o=this.children[this.children.length-1];return o[ac]?o.replaceRight(t,r):typeof o=="string"?this.children[this.children.length-1]=o.replace(t,r):this.children.push("".replace(t,r)),this};Qt.prototype.setSourceContent=function(t,r){this.sourceContents[bf.toSetString(t)]=r};Qt.prototype.walkSourceContents=function(t){for(var r=0,o=this.children.length;r<o;r++)this.children[r][ac]&&this.children[r].walkSourceContents(t);for(var n=Object.keys(this.sourceContents),r=0,o=n.length;r<o;r++)t(bf.fromSetString(n[r]),this.sourceContents[n[r]])};Qt.prototype.toString=function(){var t="";return this.walk(function(r){t+=r}),t};Qt.prototype.toStringWithSourceMap=function(t){var r={code:"",line:1,column:0},o=new L3(t),n=!1,s=null,i=null,c=null,a=null;return this.walk(function(p,f){r.code+=p,f.source!==null&&f.line!==null&&f.column!==null?((s!==f.source||i!==f.line||c!==f.column||a!==f.name)&&o.addMapping({source:f.source,original:{line:f.line,column:f.column},generated:{line:r.line,column:r.column},name:f.name}),s=f.source,i=f.line,c=f.column,a=f.name,n=!0):n&&(o.addMapping({generated:{line:r.line,column:r.column}}),s=null,n=!1);for(var h=0,d=p.length;h<d;h++)p.charCodeAt(h)===q3?(r.line++,r.column=0,h+1===d?(s=null,n=!1):n&&o.addMapping({source:f.source,original:{line:f.line,column:f.column},generated:{line:r.line,column:r.column},name:f.name})):r.column++}),this.walkSourceContents(function(p,f){o.setSourceContent(p,f)}),{code:r.code,map:o}};ST.SourceNode=Qt});var ET=$(Sf=>{u();Sf.SourceMapGenerator=uy().SourceMapGenerator;Sf.SourceMapConsumer=bT().SourceMapConsumer;Sf.SourceNode=_T().SourceNode});u();u();u();var js=e=>typeof e=="function",l=function(e,t){if(typeof e=="function")return function(){return e(arguments)?t.apply(this,arguments):r=>t(r,...arguments)};switch(e){case 0:case 1:throw new RangeError(`Invalid arity ${e}`);case 2:return function(r,o){return arguments.length>=2?t(r,o):function(n){return t(n,r)}};case 3:return function(r,o,n){return arguments.length>=3?t(r,o,n):function(s){return t(s,r,o)}};case 4:return function(r,o,n,s){return arguments.length>=4?t(r,o,n,s):function(i){return t(i,r,o,n)}};case 5:return function(r,o,n,s,i){return arguments.length>=5?t(r,o,n,s,i):function(c){return t(c,r,o,n,s)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);let r=arguments;return function(o){return t(o,...r)}}}};var B=e=>e;var zs=e=>()=>e,Po=zs(!0),eo=zs(!1),Cf=zs(null),$a=zs(void 0),Lo=$a;function m(e,t,r,o,n,s,i,c,a){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return r(t(e));case 4:return o(r(t(e)));case 5:return n(o(r(t(e))));case 6:return s(n(o(r(t(e)))));case 7:return i(s(n(o(r(t(e))))));case 8:return c(i(s(n(o(r(t(e)))))));case 9:return a(c(i(s(n(o(r(t(e))))))));default:{let p=arguments[0];for(let f=1;f<arguments.length;f++)p=arguments[f](p);return p}}}u();u();u();var Gs=e=>(t,r)=>t===r||e(t,r);var hy=l(2,(e,t)=>Gs((r,o)=>e(t(r),t(o))));var dy=e=>Gs((t,r)=>{if(t.length!==r.length)return!1;for(let o=0;o<t.length;o++)if(!e(t[o],r[o]))return!1;return!0});u();var Va=e=>l(3,(t,r,o)=>e(t,n=>Object.assign({},n,{[r]:o(n)}))),Ka=e=>l(2,(t,r)=>e(t,o=>({[r]:o}))),Ja=(e,t)=>l(3,(r,o,n)=>t(r,s=>e(n(s),i=>Object.assign({},s,{[o]:i}))));u();u();u();u();u();var jT="3.6.1",wn=()=>jT;var wf=Symbol.for(`effect/GlobalValue/globalStoreId/${wn()}`);wf in globalThis||(globalThis[wf]=new Map);var kf=globalThis[wf],q=(e,t)=>(kf.has(e)||kf.set(e,t()),kf.get(e));u();var Ya=e=>typeof e=="string",lc=e=>typeof e=="number";var gy=e=>typeof e=="bigint";var Do=js;var GT=e=>typeof e=="object"&&e!==null,Mn=e=>GT(e)||Do(e),k=l(2,(e,t)=>Mn(e)&&t in e),Rn=l(2,(e,t)=>k(e,"_tag")&&e._tag===t),Fn=e=>e==null;var mr=e=>k(e,Symbol.iterator);var Mf=e=>k(e,"then")&&Do(e.then);u();u();var Tn=e=>`BUG: ${e} - please report an issue at https://github.com/Effect-TS/effect/issues`;var Rf=Symbol.for("effect/Gen/GenKind"),Af=e=>Mn(e)&&Rf in e,Ff=class{value;constructor(t){this.value=t}get _F(){return B}get _R(){return t=>t}get _O(){return t=>t}get _E(){return t=>t}[Rf]=Rf;[Symbol.iterator](){return new pc(this)}},pc=class e{self;called=!1;constructor(t){this.self=t}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new e(this.self)}};var by=()=>function(){let e=arguments[0];for(let t=1;t<arguments.length;t++)e=arguments[t](e);return new Ff(e)},$T=335903614,VT=4150755663,KT=1481765933,JT=1284865837,YT=9007199254740992,QT=134217728,Za=class{_state;constructor(t,r,o,n){return Fn(r)&&Fn(t)?(r=Math.random()*4294967295>>>0,t=0):Fn(r)&&(r=t,t=0),Fn(n)&&Fn(o)?(n=this._state?this._state[3]:VT,o=this._state?this._state[2]:$T):Fn(n)&&(n=o,o=0),this._state=new Int32Array([0,0,o>>>0,((n||0)|1)>>>0]),this._next(),yy(this._state,this._state[0],this._state[1],t>>>0,r>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(t){this._state[0]=t[0],this._state[1]=t[1],this._state[2]=t[2],this._state[3]=t[3]|1}integer(t){if(!t)return this._next();if(t=t>>>0,!(t&t-1))return this._next()&t-1;let r=0,o=(-t>>>0)%t>>>0;for(r=this._next();r<o;r=this._next());return r%t}number(){let t=(this._next()&67108863)*1,r=(this._next()&134217727)*1;return(t*QT+r)/YT}_next(){let t=this._state[0]>>>0,r=this._state[1]>>>0;ZT(this._state,t,r,KT,JT),yy(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let o=t>>>18,n=(r>>>18|t<<14)>>>0;o=(o^t)>>>0,n=(n^r)>>>0;let s=(n>>>27|o<<5)>>>0,i=t>>>27,c=(-i>>>0&31)>>>0;return(s>>>i|s<<c)>>>0}};function ZT(e,t,r,o,n){let s=(r>>>16)*(n&65535)>>>0,i=(r&65535)*(n>>>16)>>>0,c=(r&65535)*(n&65535)>>>0,a=(r>>>16)*(n>>>16)+((i>>>16)+(s>>>16))>>>0;i=i<<16>>>0,c=c+i>>>0,c>>>0<i>>>0&&(a=a+1>>>0),s=s<<16>>>0,c=c+s>>>0,c>>>0<s>>>0&&(a=a+1>>>0),a=a+Math.imul(r,o)>>>0,a=a+Math.imul(t,n)>>>0,e[0]=a,e[1]=c}function yy(e,t,r,o,n){let s=t+o>>>0,i=r+n>>>0;i>>>0<r>>>0&&(s=s+1|0),e[0]=s,e[1]=i}var Tf=Symbol.for("effect/Utils/YieldWrap"),Mr=class{#e;constructor(t){this.#e=t}[Tf](){return this.#e}};function $s(e){if(typeof e=="object"&&e!==null&&Tf in e)return e[Tf]();throw new Error(Tn("yieldWrapGet"))}var At=q("effect/Utils/isStructuralRegion",()=>({enabled:!1,tester:void 0}));var XT=e=>{let t={[e](r){return r()}};return function(r){return t[e](r)}},Ne=XT("effect_internal_function");var Nf=q(Symbol.for("effect/Hash/randomHashCache"),()=>new WeakMap),F=Symbol.for("effect/Hash"),w=e=>{if(At.enabled===!0)return 0;switch(typeof e){case"number":return eu(e);case"bigint":return ce(e.toString(10));case"boolean":return ce(String(e));case"symbol":return ce(String(e));case"string":return ce(e);case"undefined":return ce("undefined");case"function":case"object":return e===null?ce("null"):e instanceof Date?w(e.toISOString()):eA(e)?e[F]():Vs(e);default:throw new Error(`BUG: unhandled typeof ${typeof e} - please report an issue at https://github.com/Effect-TS/effect/issues`)}},Vs=e=>(Nf.has(e)||Nf.set(e,eu(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER))),Nf.get(e)),L=e=>t=>t*53^e,Xa=e=>e&3221225471|e>>>1&1073741824,eA=e=>k(e,F),eu=e=>{if(e!==e||e===1/0)return 0;let t=e|0;for(t!==e&&(t^=e*4294967295);e>4294967295;)t^=e/=4294967295;return Xa(t)},ce=e=>{let t=5381,r=e.length;for(;r;)t=t*33^e.charCodeAt(--r);return Xa(t)},tA=(e,t)=>{let r=12289;for(let o=0;o<t.length;o++)r^=m(ce(t[o]),L(w(e[t[o]])));return Xa(r)},tu=e=>tA(e,Object.keys(e)),It=e=>{let t=6151;for(let r=0;r<e.length;r++)t=m(t,L(w(e[r])));return Xa(t)},V=function(){if(arguments.length===1){let r=arguments[0];return function(o){return Object.defineProperty(r,F,{value(){return o},enumerable:!1}),o}}let e=arguments[0],t=arguments[1];return Object.defineProperty(e,F,{value(){return t},enumerable:!1}),t};var R=Symbol.for("effect/Equal");function v(){return arguments.length===1?e=>ru(e,arguments[0]):ru(arguments[0],arguments[1])}function ru(e,t){if(e===t)return!0;let r=typeof e;if(r!==typeof t)return!1;if(r==="object"||r==="function"){if(e!==null&&t!==null){if(Ks(e)&&Ks(t))return w(e)===w(t)&&e[R](t)?!0:At.enabled&&At.tester?At.tester(e,t):!1;if(e instanceof Date&&t instanceof Date)return e.toISOString()===t.toISOString()}if(At.enabled){if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&e.every((o,n)=>ru(o,t[n]));if(Object.getPrototypeOf(e)===Object.prototype&&Object.getPrototypeOf(e)===Object.prototype){let o=Object.keys(e),n=Object.keys(t);if(o.length===n.length){for(let s of o)if(!(s in t&&ru(e[s],t[s])))return At.tester?At.tester(e,t):!1;return!0}}return At.tester?At.tester(e,t):!1}}return At.enabled&&At.tester?At.tester(e,t):!1}var Ks=e=>k(e,R),fc=()=>v;u();var j=Symbol.for("nodejs.util.inspect.custom"),J=e=>k(e,"toJSON")&&Do(e.toJSON)&&e.toJSON.length===0?e.toJSON():Array.isArray(e)?e.map(J):e,te=e=>JSON.stringify(e,null,2),EG={toJSON(){return J(this)},[j](){return this.toJSON()},toString(){return te(this.toJSON())}},Sy=class{[j](){return this.toJSON()}toString(){return te(this.toJSON())}},qo=(e,t=2)=>{try{return typeof e=="object"?_y(e,t):String(e)}catch{return String(e)}},_y=(e,t)=>{let r=[],o=JSON.stringify(e,(n,s)=>typeof s=="object"&&s!==null?r.includes(s)?void 0:r.push(s)&&s:s,t);return r=void 0,o};u();u();var O=(e,t)=>{switch(t.length){case 1:return t[0](e);case 2:return t[1](t[0](e));case 3:return t[2](t[1](t[0](e)));case 4:return t[3](t[2](t[1](t[0](e))));case 5:return t[4](t[3](t[2](t[1](t[0](e)))));case 6:return t[5](t[4](t[3](t[2](t[1](t[0](e))))));case 7:return t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))));case 8:return t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e))))))));case 9:return t[8](t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))))));default:{let r=e;for(let o=0,n=t.length;o<n;o++)r=t[o](r);return r}}};u();var An="Async",Js="Commit",Pe="Failure",Ys="OnFailure",Qs="OnSuccess",Zs="OnSuccessAndFailure",Le="Success",nu="Sync",Ey="Tag",ro="UpdateRuntimeFlags",Xs="While",su="WithRuntime",ei="Yield",mc="RevertFlags";var Pf=Symbol.for("effect/Effect"),Oy=Symbol.for("effect/Stream"),Cy=Symbol.for("effect/Sink"),vy=Symbol.for("effect/Channel"),Ho={_R:e=>e,_E:e=>e,_A:e=>e,_V:wn()},oA={_A:e=>e,_In:e=>e,_L:e=>e,_E:e=>e,_R:e=>e},nA={_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},oo={[Pf]:Ho,[Oy]:Ho,[Cy]:oA,[vy]:nA,[R](e){return this===e},[F](){return V(this,Vs(this))},[Symbol.iterator](){return new pc(new Mr(this))},pipe(){return O(this,arguments)}},ti={[F](){return V(this,tu(this))},[R](e){let t=Object.keys(this),r=Object.keys(e);if(t.length!==r.length)return!1;for(let o of t)if(!(o in e&&v(this[o],e[o])))return!1;return!0}},ky={...oo,_op:Js},Lf={...ky,...ti};u();var wy=Symbol.for("effect/Option"),My={...oo,[wy]:{_A:e=>e},[j](){return this.toJSON()},toString(){return te(this.toJSON())}},iA=Object.assign(Object.create(My),{_tag:"Some",_op:"Some",[R](e){return iu(e)&&Df(e)&&v(this.value,e.value)},[F](){return V(this,L(w(this._tag))(w(this.value)))},toJSON(){return{_id:"Option",_tag:this._tag,value:J(this.value)}}}),cA=w("None"),aA=Object.assign(Object.create(My),{_tag:"None",_op:"None",[R](e){return iu(e)&&cu(e)},[F](){return cA},toJSON(){return{_id:"Option",_tag:this._tag}}}),iu=e=>k(e,wy),cu=e=>e._tag==="None",Df=e=>e._tag==="Some",Wo=Object.create(aA),Uo=e=>{let t=Object.create(iA);return t.value=e,t};var Hf=Symbol.for("effect/Either"),Ry={...oo,[Hf]:{_R:e=>e},[j](){return this.toJSON()},toString(){return te(this.toJSON())}},uA=Object.assign(Object.create(Ry),{_tag:"Right",_op:"Right",[R](e){return Wf(e)&&au(e)&&v(this.right,e.right)},[F](){return L(w(this._tag))(w(this.right))},toJSON(){return{_id:"Either",_tag:this._tag,right:J(this.right)}}}),lA=Object.assign(Object.create(Ry),{_tag:"Left",_op:"Left",[R](e){return Wf(e)&&ri(e)&&v(this.left,e.left)},[F](){return L(w(this._tag))(w(this.left))},toJSON(){return{_id:"Either",_tag:this._tag,left:J(this.left)}}}),Wf=e=>k(e,Hf),ri=e=>e._tag==="Left",au=e=>e._tag==="Right",uu=e=>{let t=Object.create(lA);return t.left=e,t},lu=e=>{let t=Object.create(uA);return t.right=e,t},Uf=e=>au(e)?Wo:Uo(e.left),Bf=e=>ri(e)?Wo:Uo(e.right);var Ve=lu,St=uu;var no=ri,oi=au;var pA=l(2,(e,{onLeft:t,onRight:r})=>no(e)?t(e.left):r(e.right));var pu=pA({onLeft:B,onRight:B});var Ty=e=>{if(Symbol.iterator in e){let r=[];for(let o of e){if(no(o))return o;r.push(o.right)}return Ve(r)}let t={};for(let r of Object.keys(e)){let o=e[r];if(no(o))return o;t[r]=o.right}return Ve(t)};u();var jf=e=>e.length>0;var de={};my(de,{Do:()=>$A,TypeId:()=>mA,all:()=>Hy,andThen:()=>kA,ap:()=>IA,as:()=>Ly,asVoid:()=>CA,bind:()=>GA,bindTo:()=>jA,composeK:()=>FA,contains:()=>Vf,containsWith:()=>By,exists:()=>BA,filter:()=>LA,filterMap:()=>Uy,firstSomeOf:()=>SA,flatMap:()=>Xt,flatMapNullable:()=>wA,flatten:()=>MA,fromIterable:()=>dA,fromNullable:()=>hr,gen:()=>KA,getEquivalence:()=>DA,getLeft:()=>gA,getOrElse:()=>De,getOrNull:()=>EA,getOrThrow:()=>dc,getOrThrowWith:()=>Py,getOrUndefined:()=>pt,getOrder:()=>qA,getRight:()=>xA,isNone:()=>z,isOption:()=>Ny,isSome:()=>W,let:()=>zA,lift2:()=>HA,liftNullable:()=>_A,liftPredicate:()=>WA,liftThrowable:()=>OA,map:()=>Me,match:()=>Ke,none:()=>S,orElse:()=>yA,orElseEither:()=>bA,orElseSome:()=>Gf,partitionMap:()=>PA,product:()=>qy,productMany:()=>AA,reduceCompact:()=>NA,some:()=>_,tap:()=>Dy,toArray:()=>Wy,toRefinement:()=>hA,void:()=>vA,zipLeft:()=>TA,zipRight:()=>RA,zipWith:()=>$f});u();u();var fu=e=>(t,r)=>t===r?0:e(t,r);var Ay=fu((e,t)=>e<t?-1:1);var Iy=l(2,(e,t)=>fu((r,o)=>e(t(r),t(o))));var zf=e=>l(2,(t,r)=>e(t,r)===1);var mA=Symbol.for("effect/Option"),S=()=>Wo,_=Uo,Ny=iu,z=cu,W=Df,Ke=l(2,(e,{onNone:t,onSome:r})=>z(e)?t():r(e.value)),hA=e=>t=>W(e(t)),dA=e=>{for(let t of e)return _(t);return S()},xA=Bf,gA=Uf,De=l(2,(e,t)=>z(e)?t():e.value),yA=l(2,(e,t)=>z(e)?t():e),Gf=l(2,(e,t)=>z(e)?_(t()):e),bA=l(2,(e,t)=>z(e)?Me(t(),lu):Me(e,uu)),SA=e=>{let t=S();for(t of e)if(W(t))return t;return t},hr=e=>e==null?S():_(e),_A=e=>(...t)=>hr(e(...t)),EA=De(Cf),pt=De($a),OA=e=>(...t)=>{try{return _(e(...t))}catch{return S()}},Py=l(2,(e,t)=>{if(W(e))return e.value;throw t()}),dc=Py(()=>new Error("getOrThrow called on a None")),Me=l(2,(e,t)=>z(e)?S():_(t(e.value))),Ly=l(2,(e,t)=>Me(e,()=>t)),CA=Ly(void 0),vA=_(void 0);var Xt=l(2,(e,t)=>z(e)?S():t(e.value)),kA=l(2,(e,t)=>Xt(e,r=>{let o=js(t)?t(r):t;return Ny(o)?o:_(o)})),wA=l(2,(e,t)=>z(e)?S():hr(t(e.value))),MA=Xt(B),RA=l(2,(e,t)=>Xt(e,()=>t)),FA=l(2,(e,t)=>r=>Xt(e(r),t)),TA=l(2,(e,t)=>Dy(e,()=>t)),Dy=l(2,(e,t)=>Xt(e,r=>Me(t(r),()=>r))),qy=(e,t)=>W(e)&&W(t)?_([e.value,t.value]):S(),AA=(e,t)=>{if(z(e))return S();let r=[e.value];for(let o of t){if(z(o))return S();r.push(o.value)}return _(r)},Hy=e=>{if(Symbol.iterator in e){let r=[];for(let o of e){if(z(o))return S();r.push(o.value)}return _(r)}let t={};for(let r of Object.keys(e)){let o=e[r];if(z(o))return S();t[r]=o.value}return _(t)},$f=l(3,(e,t,r)=>Me(qy(e,t),([o,n])=>r(o,n))),IA=l(2,(e,t)=>$f(e,t,(r,o)=>r(o))),NA=l(3,(e,t,r)=>{let o=t;for(let n of e)W(n)&&(o=r(o,n.value));return o}),Wy=e=>z(e)?[]:[e.value],PA=l(2,(e,t)=>{if(z(e))return[S(),S()];let r=t(e.value);return ri(r)?[_(r.left),S()]:[S(),_(r.right)]}),Uy=l(2,(e,t)=>z(e)?S():t(e.value)),LA=l(2,(e,t)=>Uy(e,r=>t(r)?Uo(r):Wo)),DA=e=>Gs((t,r)=>z(t)?z(r):z(r)?!1:e(t.value,r.value)),qA=e=>fu((t,r)=>W(t)?W(r)?e(t.value,r.value):1:-1),HA=e=>l(2,(t,r)=>$f(t,r,e)),WA=l(2,(e,t)=>t(e)?_(e):S()),By=e=>l(2,(t,r)=>z(t)?!1:e(t.value,r)),UA=fc(),Vf=By(UA),BA=l(2,(e,t)=>z(e)?!1:t(e.value)),jA=Ka(Me),zA=Va(Me);var GA=Ja(Me,Xt),$A=_({}),VA=by(),KA=(...e)=>{let t;e.length===1?t=e[0]:t=e[1].bind(e[0]);let r=t(VA),o=r.next();if(o.done)return _(o.value);{let n=o.value;if(Af(n)?n=n.value:n=$s(n),z(n))return n;for(;!o.done;)if(o=r.next(n.value),!o.done&&(n=o.value,Af(n)?n=n.value:n=$s(n),z(n)))return n;return _(o.value)}};u();var jy=(...e)=>e;var xc=e=>new Array(e),Kf=(e,t)=>{let r=Math.max(1,Math.floor(e)),o=new Array(r);for(let n=0;n<r;n++)o[n]=t(n);return o};var ee=e=>Array.isArray(e)?e:Array.from(e),Gy=e=>Array.isArray(e)?e:[e];var ni=l(2,(e,t)=>[t,...e]);var $y=l(2,(e,t)=>[...e,t]),Jf=l(2,(e,t)=>ee(e).concat(ee(t)));var JA=Array.isArray,YA=e=>e.length===0,Vy=YA,Ky=jf,xt=jf;var Jy=(e,t)=>e<0||e>=t.length,QA=(e,t)=>Math.floor(Math.min(Math.max(0,e),t.length)),ZA=l(2,(e,t)=>{let r=Math.floor(t);return Jy(r,e)?S():_(e[r])}),Yf=l(2,(e,t)=>{let r=Math.floor(t);if(Jy(r,e))throw new Error(`Index ${r} out of bounds`);return e[r]});var Bo=ZA(0),gt=Yf(0),hu=e=>xt(e)?_(Qf(e)):S(),Qf=e=>e[e.length-1];var Rr=e=>e.slice(1);var XA=(e,t)=>{let r=0;for(let o of e){if(!t(o,r))break;r++}return r},Yy=l(2,(e,t)=>tI(e,XA(e,t))),Qy=l(2,(e,t)=>{let r=ee(e);return r.slice(QA(t,r),r.length)});var Zf=e=>Array.from(e).reverse(),Nn=l(2,(e,t)=>{let r=Array.from(e);return r.sort(t),r});var Xf=l(2,(e,t)=>Zy(e,t,jy)),Zy=l(3,(e,t,r)=>{let o=ee(e),n=ee(t);if(xt(o)&&xt(n)){let s=[r(gt(o),gt(n))],i=Math.min(o.length,n.length);for(let c=1;c<i;c++)s[c]=r(o[c],n[c]);return s}return[]});var eI=fc();var tI=l(2,(e,t)=>{let r=Array.from(e),o=Math.floor(t);return xt(r)?o>=1?rI(r,o):[[],r]:[r,[]]}),rI=l(2,(e,t)=>{let r=Math.max(1,Math.floor(t));return r>=e.length?[oI(e),[]]:[ni(e.slice(1,r),gt(e)),e.slice(r)]});var oI=e=>e.slice();var nI=l(3,(e,t,r)=>{let o=ee(e),n=ee(t);return xt(o)?xt(n)?tb(r)(Jf(o,n)):o:n}),Fr=l(2,(e,t)=>nI(e,t,eI));var Ut=()=>[],_t=e=>[e],Tr=l(2,(e,t)=>e.map(t)),Xy=l(2,(e,t)=>{if(Vy(e))return[];let r=[];for(let o=0;o<e.length;o++){let n=t(e[o],o);for(let s=0;s<n.length;s++)r.push(n[s])}return r}),du=Xy(B),si=l(2,(e,t)=>{let r=ee(e),o=[];for(let n=0;n<r.length;n++){let s=t(r[n],n);W(s)&&o.push(s.value)}return o});var eb=si(B);var er=l(3,(e,t,r)=>ee(e).reduce((o,n,s)=>r(o,n,s),t)),xu=l(3,(e,t,r)=>ee(e).reduceRight((o,n,s)=>r(o,n,s),t));var em=(e,t)=>{let r=[],o=e,n;for(;W(n=t(o));){let[s,i]=n.value;r.push(s),o=i}return r};var ii=dy;var tb=l(2,(e,t)=>{let r=ee(e);if(xt(r)){let o=[gt(r)],n=Rr(r);for(let s of n)o.every(i=>!t(s,i))&&o.push(s);return o}return[]}),tm=e=>tb(e,fc());var so=l(2,(e,t)=>ee(e).join(t));u();var rb=e=>!e;u();u();u();var nb=Symbol.for("effect/Context/Tag"),sI="effect/STM",iI=Symbol.for(sI),rm={...oo,_tag:"Tag",_op:"Tag",[iI]:Ho,[nb]:{_Service:e=>e,_Identifier:e=>e},toString(){return te(this.toJSON())},toJSON(){return{_id:"Tag",key:this.key,stack:this.stack}},[j](){return this.toJSON()},of(e){return e},context(e){return sm(this,e)}},sb=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=2;let r=new Error;Error.stackTraceLimit=t;let o=Object.create(rm);return Object.defineProperty(o,"stack",{get(){return r.stack}}),o.key=e,o};var om=Symbol.for("effect/Context"),cI={[om]:{_Services:e=>e},[R](e){if(nm(e)&&this.unsafeMap.size===e.unsafeMap.size){for(let t of this.unsafeMap.keys())if(!e.unsafeMap.has(t)||!v(this.unsafeMap.get(t),e.unsafeMap.get(t)))return!1;return!0}return!1},[F](){return V(this,eu(this.unsafeMap.size))},pipe(){return O(this,arguments)},toString(){return te(this.toJSON())},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(J)}},[j](){return this.toJSON()}},jo=e=>{let t=Object.create(cI);return t.unsafeMap=e,t},aI=e=>{let t=new Error(`Service not found${e.key?`: ${String(e.key)}`:""}`);if(e.stack){let r=e.stack.split(`
`);if(r.length>2){let o=r[2].match(/at (.*)/);o&&(t.message=t.message+` (defined at ${o[1]})`)}}if(t.stack){let r=t.stack.split(`
`);r.splice(1,3),t.stack=r.join(`
`)}return t},nm=e=>k(e,om);var uI=jo(new Map),ib=()=>uI,sm=(e,t)=>jo(new Map([[e.key,t]])),cb=l(3,(e,t,r)=>{let o=new Map(e.unsafeMap);return o.set(t.key,r),jo(o)}),im=l(2,(e,t)=>{if(!e.unsafeMap.has(t.key))throw aI(t);return e.unsafeMap.get(t.key)}),ab=im,ub=l(2,(e,t)=>e.unsafeMap.has(t.key)?Uo(e.unsafeMap.get(t.key)):Wo),lb=l(2,(e,t)=>{let r=new Map(e.unsafeMap);for(let[o,n]of t.unsafeMap)r.set(o,n);return jo(r)});var Et=sb;var pb=nm;var Ot=ib,cm=sm,ve=cb,Be=ab,ci=im,dr=ub,Pn=lb;u();u();u();var fb=Symbol.for("effect/Chunk");function pI(e,t,r,o,n){for(let s=t;s<Math.min(e.length,t+n);s++)r[o+s-t]=e[s];return r}var mb=[],fI=e=>Gs((t,r)=>t.length===r.length&&tr(t).every((o,n)=>e(o,Ln(r,n)))),mI=fI(v),hI={[fb]:{_A:e=>e},toString(){return te(this.toJSON())},toJSON(){return{_id:"Chunk",values:tr(this).map(J)}},[j](){return this.toJSON()},[R](e){return hb(e)&&mI(this,e)},[F](){return V(this,It(tr(this)))},[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return mb[Symbol.iterator]();default:return tr(this)[Symbol.iterator]()}},pipe(){return O(this,arguments)}},Ye=e=>{let t=Object.create(hI);switch(t.backing=e,e._tag){case"IEmpty":{t.length=0,t.depth=0,t.left=t,t.right=t;break}case"IConcat":{t.length=e.left.length+e.right.length,t.depth=1+Math.max(e.left.depth,e.right.depth),t.left=e.left,t.right=e.right;break}case"IArray":{t.length=e.array.length,t.depth=0,t.left=Ar,t.right=Ar;break}case"ISingleton":{t.length=1,t.depth=0,t.left=Ar,t.right=Ar;break}case"ISlice":{t.length=e.length,t.depth=e.chunk.depth+1,t.left=Ar,t.right=Ar;break}}return t},hb=e=>k(e,fb),Ar=Ye({_tag:"IEmpty"}),Nt=()=>Ar,gc=(...e)=>e.length===1?Re(e[0]):yI(e),Re=e=>Ye({_tag:"ISingleton",a:e}),Nr=e=>hb(e)?e:Ye({_tag:"IArray",array:ee(e)}),am=(e,t,r)=>{switch(e.backing._tag){case"IArray":{pI(e.backing.array,0,t,r,e.length);break}case"IConcat":{am(e.left,t,r),am(e.right,t,r+e.left.length);break}case"ISingleton":{t[r]=e.backing.a;break}case"ISlice":{let o=0,n=r;for(;o<e.length;)t[n]=Ln(e,o),o+=1,n+=1;break}}};var dI=e=>{switch(e.backing._tag){case"IEmpty":return mb;case"IArray":return e.backing.array;default:{let t=new Array(e.length);return am(e,t,0),e.backing={_tag:"IArray",array:t},e.left=Ar,e.right=Ar,e.depth=0,t}}},tr=dI,xI=e=>{switch(e.backing._tag){case"IEmpty":case"ISingleton":return e;case"IArray":return Ye({_tag:"IArray",array:Zf(e.backing.array)});case"IConcat":return Ye({_tag:"IConcat",left:Ir(e.backing.right),right:Ir(e.backing.left)});case"ISlice":return ai(Zf(tr(e)))}},Ir=xI,gI=l(2,(e,t)=>t<0||t>=e.length?S():_(Ln(e,t))),ai=e=>Ye({_tag:"IArray",array:e}),yI=e=>ai(e),Ln=l(2,(e,t)=>{switch(e.backing._tag){case"IEmpty":throw new Error("Index out of bounds");case"ISingleton":{if(t!==0)throw new Error("Index out of bounds");return e.backing.a}case"IArray":{if(t>=e.length||t<0)throw new Error("Index out of bounds");return e.backing.array[t]}case"IConcat":return t<e.left.length?Ln(e.left,t):Ln(e.right,t-e.left.length);case"ISlice":return Ln(e.backing.chunk,t+e.backing.offset)}}),gu=l(2,(e,t)=>Bt(e,Re(t))),Qe=l(2,(e,t)=>Bt(Re(t),e));var um=l(2,(e,t)=>{if(t<=0)return e;if(t>=e.length)return Ar;switch(e.backing._tag){case"ISlice":return Ye({_tag:"ISlice",chunk:e.backing.chunk,offset:e.backing.offset+t,length:e.backing.length-t});case"IConcat":return t>e.left.length?um(e.right,t-e.left.length):Ye({_tag:"IConcat",left:um(e.left,t),right:e.right});default:return Ye({_tag:"ISlice",chunk:e,offset:t,length:e.length-t})}});var Bt=l(2,(e,t)=>{if(e.backing._tag==="IEmpty")return t;if(t.backing._tag==="IEmpty")return e;let r=t.depth-e.depth;if(Math.abs(r)<=1)return Ye({_tag:"IConcat",left:e,right:t});if(r<-1)if(e.left.depth>=e.right.depth){let o=Bt(e.right,t);return Ye({_tag:"IConcat",left:e.left,right:o})}else{let o=Bt(e.right.right,t);if(o.depth===e.depth-3){let n=Ye({_tag:"IConcat",left:e.right.left,right:o});return Ye({_tag:"IConcat",left:e.left,right:n})}else{let n=Ye({_tag:"IConcat",left:e.left,right:e.right.left});return Ye({_tag:"IConcat",left:n,right:o})}}else if(t.right.depth>=t.left.depth){let o=Bt(e,t.left);return Ye({_tag:"IConcat",left:o,right:t.right})}else{let o=Bt(e,t.left.left);if(o.depth===t.depth-3){let n=Ye({_tag:"IConcat",left:o,right:t.left.right});return Ye({_tag:"IConcat",left:n,right:t.right})}else{let n=Ye({_tag:"IConcat",left:t.left.right,right:t.right});return Ye({_tag:"IConcat",left:o,right:n})}}});var lm=e=>e.length===0,tt=e=>e.length>0,yu=gI(0),pm=e=>Ln(e,0),Ze=pm;var ot=e=>um(e,1);u();var hm=Symbol.for("effect/Duration"),li=BigInt(0),fm=BigInt(24),ui=BigInt(60),bu=BigInt(1e3),mm=BigInt(1e6),dm=BigInt(1e9),db=/^(-?\d+(?:\.\d+)?)\s+(nanos?|micros?|millis?|seconds?|minutes?|hours?|days?|weeks?)$/,nt=e=>{if(gb(e))return e;if(lc(e))return pi(e);if(gy(e))return yc(e);if(Array.isArray(e)){if(e.length===2&&lc(e[0])&&lc(e[1]))return yc(BigInt(e[0])*dm+BigInt(e[1]))}else if(Ya(e)){db.lastIndex=0;let t=db.exec(e);if(t){let[r,o,n]=t,s=Number(o);switch(n){case"nano":case"nanos":return yc(BigInt(o));case"micro":case"micros":return _I(BigInt(o));case"milli":case"millis":return pi(s);case"second":case"seconds":return gm(s);case"minute":case"minutes":return EI(s);case"hour":case"hours":return OI(s);case"day":case"days":return CI(s);case"week":case"weeks":return vI(s)}}}throw new Error("Invalid DurationInput")};var xb={_tag:"Millis",millis:0},bI={_tag:"Infinity"},SI={[hm]:hm,[F](){return V(this,tu(this.value))},[R](e){return gb(e)&&RI(this,e)},toString(){return`Duration(${bm(this)})`},toJSON(){switch(this.value._tag){case"Millis":return{_id:"Duration",_tag:"Millis",millis:this.value.millis};case"Nanos":return{_id:"Duration",_tag:"Nanos",hrtime:wI(this)};case"Infinity":return{_id:"Duration",_tag:"Infinity"}}},[j](){return this.toJSON()},pipe(){return O(this,arguments)}},io=e=>{let t=Object.create(SI);return lc(e)?isNaN(e)||e<=0?t.value=xb:Number.isFinite(e)?Number.isInteger(e)?t.value={_tag:"Millis",millis:e}:t.value={_tag:"Nanos",nanos:BigInt(Math.round(e*1e6))}:t.value=bI:e<=li?t.value=xb:t.value={_tag:"Nanos",nanos:e},t},gb=e=>k(e,hm);var xm=io(0);var yc=e=>io(e),_I=e=>io(e*bu),pi=e=>io(e),gm=e=>io(e*1e3),EI=e=>io(e*6e4),OI=e=>io(e*36e5),CI=e=>io(e*864e5),vI=e=>io(e*6048e5),Pr=e=>{let t=nt(e);switch(t.value._tag){case"Infinity":return 1/0;case"Nanos":return Number(t.value.nanos)/1e6;case"Millis":return t.value.millis}};var kI=e=>{let t=nt(e);switch(t.value._tag){case"Infinity":throw new Error("Cannot convert infinite duration to nanos");case"Nanos":return t.value.nanos;case"Millis":return BigInt(Math.round(t.value.millis*1e6))}},wI=e=>{let t=nt(e);switch(t.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(t.value.nanos/dm),Number(t.value.nanos%dm)];case"Millis":return[Math.floor(t.value.millis/1e3),Math.round(t.value.millis%1e3*1e6)]}};var yb=l(3,(e,t,r)=>{let o=nt(e),n=nt(t);if(o.value._tag==="Infinity"||n.value._tag==="Infinity")return r.onMillis(Pr(o),Pr(n));if(o.value._tag==="Nanos"||n.value._tag==="Nanos"){let s=o.value._tag==="Nanos"?o.value.nanos:BigInt(Math.round(o.value.millis*1e6)),i=n.value._tag==="Nanos"?n.value.nanos:BigInt(Math.round(n.value.millis*1e6));return r.onNanos(s,i)}return r.onMillis(o.value.millis,n.value.millis)});var MI=(e,t)=>yb(e,t,{onMillis:(r,o)=>r===o,onNanos:(r,o)=>r===o});var ym=l(2,(e,t)=>yb(e,t,{onMillis:(r,o)=>r>=o,onNanos:(r,o)=>r>=o})),RI=l(2,(e,t)=>MI(nt(e),nt(t))),bm=e=>{let t=nt(e),r=[];if(t.value._tag==="Infinity")return"Infinity";let o=kI(t);o%mm&&r.push(`${o%mm}ns`);let n=o/mm;n%bu!==li&&r.push(`${n%bu}ms`);let s=n/bu;s%ui!==li&&r.push(`${s%ui}s`);let i=s/ui;i%ui!==li&&r.push(`${i%ui}m`);let c=i/ui;c%fm!==li&&r.push(`${c%fm}h`);let a=c/fm;return a!==li&&r.push(`${a}d`),r.reverse().join(" ")};u();u();u();u();u();u();u();var Sm=Math.pow(2,5),bb=Sm-1,Sb=Sm/2,_b=Sm/4;function FI(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function zo(e,t){return t>>>e&bb}function Go(e){return 1<<e}function Su(e,t){return FI(e&t-1)}u();u();var Eb=(e,t)=>({value:e,previous:t});u();function Dn(e,t,r,o){let n=o;if(!e){let s=o.length;n=new Array(s);for(let i=0;i<s;++i)n[i]=o[i]}return n[t]=r,n}function _m(e,t,r){let o=r.length-1,n=0,s=0,i=r;if(e)n=s=t;else for(i=new Array(o);n<t;)i[s++]=r[n++];for(++n;n<=o;)i[s++]=r[n++];return e&&(i.length=o),i}function Ob(e,t,r,o){let n=o.length;if(e){let a=n;for(;a>=t;)o[a--]=o[a];return o[t]=r,o}let s=0,i=0,c=new Array(n+1);for(;s<t;)c[i++]=o[s++];for(c[t]=r;s<n;)c[++i]=o[s++];return c}var ao=class e{_tag="EmptyNode";modify(t,r,o,n,s,i){let c=o(S());return z(c)?new e:(++i.value,new fi(t,n,s,c))}};function rr(e){return Rn(e,"EmptyNode")}function AI(e){return rr(e)||e._tag==="LeafNode"||e._tag==="CollisionNode"}function _u(e,t){return rr(e)?!1:t===e.edit}var fi=class e{edit;hash;key;value;_tag="LeafNode";constructor(t,r,o,n){this.edit=t,this.hash=r,this.key=o,this.value=n}modify(t,r,o,n,s,i){if(v(s,this.key)){let a=o(this.value);return a===this.value?this:z(a)?(--i.value,new ao):_u(this,t)?(this.value=a,this):new e(t,n,s,a)}let c=o(S());return z(c)?this:(++i.value,Cb(t,r,this.hash,this,n,new e(t,n,s,c)))}},Em=class e{edit;hash;children;_tag="CollisionNode";constructor(t,r,o){this.edit=t,this.hash=r,this.children=o}modify(t,r,o,n,s,i){if(n===this.hash){let a=_u(this,t),p=this.updateCollisionList(a,t,this.hash,this.children,o,s,i);return p===this.children?this:p.length>1?new e(t,this.hash,p):p[0]}let c=o(S());return z(c)?this:(++i.value,Cb(t,r,this.hash,this,n,new fi(t,n,s,c)))}updateCollisionList(t,r,o,n,s,i,c){let a=n.length;for(let f=0;f<a;++f){let h=n[f];if("key"in h&&v(i,h.key)){let d=h.value,g=s(d);return g===d?n:z(g)?(--c.value,_m(t,f,n)):Dn(t,f,new fi(r,o,i,g),n)}}let p=s(S());return z(p)?n:(++c.value,Dn(t,a,new fi(r,o,i,p),n))}},bc=class e{edit;mask;children;_tag="IndexedNode";constructor(t,r,o){this.edit=t,this.mask=r,this.children=o}modify(t,r,o,n,s,i){let c=this.mask,a=this.children,p=zo(r,n),f=Go(p),h=Su(c,f),d=c&f,g=_u(this,t);if(!d){let K=new ao().modify(t,r+5,o,n,s,i);return K?a.length>=Sb?NI(t,p,K,c,a):new e(t,c|f,Ob(g,h,K,a)):this}let b=a[h],M=b.modify(t,r+5,o,n,s,i);if(b===M)return this;let T=c,P;if(rr(M)){if(T&=~f,!T)return new ao;if(a.length<=2&&AI(a[h^1]))return a[h^1];P=_m(g,h,a)}else P=Dn(g,h,M,a);return g?(this.mask=T,this.children=P,this):new e(t,T,P)}},Om=class e{edit;size;children;_tag="ArrayNode";constructor(t,r,o){this.edit=t,this.size=r,this.children=o}modify(t,r,o,n,s,i){let c=this.size,a=this.children,p=zo(r,n),f=a[p],h=(f||new ao).modify(t,r+5,o,n,s,i);if(f===h)return this;let d=_u(this,t),g;if(rr(f)&&!rr(h))++c,g=Dn(d,p,h,a);else if(!rr(f)&&rr(h)){if(--c,c<=_b)return II(t,c,p,a);g=Dn(d,p,new ao,a)}else g=Dn(d,p,h,a);return d?(this.size=c,this.children=g,this):new e(t,c,g)}};function II(e,t,r,o){let n=new Array(t-1),s=0,i=0;for(let c=0,a=o.length;c<a;++c)if(c!==r){let p=o[c];p&&!rr(p)&&(n[s++]=p,i|=1<<c)}return new bc(e,i,n)}function NI(e,t,r,o,n){let s=[],i=o,c=0;for(let a=0;i;++a)i&1&&(s[a]=n[c++]),i>>>=1;return s[t]=r,new Om(e,c+1,s)}function PI(e,t,r,o,n,s){if(r===n)return new Em(e,r,[s,o]);let i=zo(t,r),c=zo(t,n);if(i===c)return a=>new bc(e,Go(i)|Go(c),[a]);{let a=i<c?[o,s]:[s,o];return new bc(e,Go(i)|Go(c),a)}}function Cb(e,t,r,o,n,s){let i,c=t;for(;;){let a=PI(e,c,r,o,n,s);if(typeof a=="function")i=Eb(a,i),c=c+5;else{let p=a;for(;i!=null;)p=i.value(p),i=i.previous;return p}}}var vb="effect/HashMap",Eu=Symbol.for(vb),DI={[Eu]:Eu,[Symbol.iterator](){return new Ou(this,(e,t)=>[e,t])},[F](){let e=w(vb);for(let t of this)e^=m(w(t[0]),L(w(t[1])));return V(this,e)},[R](e){if(Rb(e)){if(e._size!==this._size)return!1;for(let t of this){let r=m(e,vu(t[0],w(t[0])));if(z(r))return!1;if(!v(t[1],r.value))return!1}return!0}return!1},toString(){return te(this.toJSON())},toJSON(){return{_id:"HashMap",values:Array.from(this).map(J)}},[j](){return this.toJSON()},pipe(){return O(this,arguments)}},Cm=(e,t,r,o)=>{let n=Object.create(DI);return n._editable=e,n._edit=t,n._root=r,n._size=o,n},Ou=class e{map;f;v;constructor(t,r){this.map=t,this.f=r,this.v=kb(this.map._root,this.f,void 0)}next(){if(z(this.v))return{done:!0,value:void 0};let t=this.v.value;return this.v=Cu(t.cont),{done:!1,value:t.value}}[Symbol.iterator](){return new e(this.map,this.f)}},Cu=e=>e?wb(e[0],e[1],e[2],e[3],e[4]):S(),kb=(e,t,r=void 0)=>{switch(e._tag){case"LeafNode":return W(e.value)?_({value:t(e.key,e.value.value),cont:r}):Cu(r);case"CollisionNode":case"ArrayNode":case"IndexedNode":{let o=e.children;return wb(o.length,o,0,t,r)}default:return Cu(r)}},wb=(e,t,r,o,n)=>{for(;r<e;){let s=t[r++];if(s&&!rr(s))return kb(s,o,[e,t,r,o,n])}return Cu(n)},qI=Cm(!1,0,new ao,0),hi=()=>qI;var Mb=e=>{let t=Sc(hi());for(let r of e)qn(t,r[0],r[1]);return km(t)},Rb=e=>k(e,Eu),Fb=e=>e&&rr(e._root),Tb=l(2,(e,t)=>vu(e,t,w(t))),vu=l(3,(e,t,r)=>{let o=e._root,n=0;for(;;)switch(o._tag){case"LeafNode":return v(t,o.key)?o.value:S();case"CollisionNode":{if(r===o.hash){let s=o.children;for(let i=0,c=s.length;i<c;++i){let a=s[i];if("key"in a&&v(t,a.key))return a.value}}return S()}case"IndexedNode":{let s=zo(n,r),i=Go(s);if(o.mask&i){o=o.children[Su(o.mask,i)],n+=5;break}return S()}case"ArrayNode":{if(o=o.children[zo(n,r)],o){n+=5;break}return S()}default:return S()}});var vm=l(2,(e,t)=>W(vu(e,t,w(t))));var qn=l(3,(e,t,r)=>wu(e,t,()=>_(r))),HI=l(3,(e,t,r)=>e._editable?(e._root=t,e._size=r,e):t===e._root?e:Cm(e._editable,e._edit,t,r)),ku=e=>new Ou(e,t=>t);var di=e=>e._size,Sc=e=>Cm(!0,e._edit+1,e._root,e._size),km=e=>(e._editable=!1,e),Ab=l(2,(e,t)=>{let r=Sc(e);return t(r),km(r)}),wu=l(3,(e,t,r)=>Ib(e,t,w(t),r)),Ib=l(4,(e,t,r,o)=>{let n={value:e._size},s=e._root.modify(e._editable?e._edit:NaN,0,o,r,t,n);return m(e,HI(s,n.value))});var Mu=l(2,(e,t)=>wu(e,t,S));var Nb=l(2,(e,t)=>xi(e,hi(),(r,o,n)=>qn(r,n,t(o,n))));var Ru=l(2,(e,t)=>xi(e,void 0,(r,o,n)=>t(o,n))),xi=l(3,(e,t,r)=>{let o=e._root;if(o._tag==="LeafNode")return W(o.value)?r(t,o.value.value,o.key):t;if(o._tag==="EmptyNode")return t;let n=[o.children],s;for(;s=n.pop();)for(let i=0,c=s.length;i<c;){let a=s[i++];a&&!rr(a)&&(a._tag==="LeafNode"?W(a.value)&&(t=r(t,a.value.value,a.key)):n.push(a.children))}return t});var Lb="effect/HashSet",Fu=Symbol.for(Lb),WI={[Fu]:Fu,[Symbol.iterator](){return ku(this._keyMap)},[F](){return V(this,L(w(this._keyMap))(w(Lb)))},[R](e){return Db(e)?di(this._keyMap)===di(e._keyMap)&&v(this._keyMap,e._keyMap):!1},toString(){return te(this.toJSON())},toJSON(){return{_id:"HashSet",values:Array.from(this).map(J)}},[j](){return this.toJSON()},pipe(){return O(this,arguments)}},Tu=e=>{let t=Object.create(WI);return t._keyMap=e,t},Db=e=>k(e,Fu),UI=Tu(hi()),_c=()=>UI,qb=e=>{let t=Au(_c());for(let r of e)gi(t,r);return Iu(t)},Hb=(...e)=>{let t=Au(_c());for(let r of e)gi(t,r);return Iu(t)},Wb=l(2,(e,t)=>vm(e._keyMap,t));var Ub=e=>di(e._keyMap),Au=e=>Tu(Sc(e._keyMap)),Iu=e=>(e._keyMap._editable=!1,e),wm=l(2,(e,t)=>{let r=Au(e);return t(r),Iu(r)}),gi=l(2,(e,t)=>e._keyMap._editable?(qn(t,!0)(e._keyMap),e):Tu(qn(t,!0)(e._keyMap))),Mm=l(2,(e,t)=>e._keyMap._editable?(Mu(t)(e._keyMap),e):Tu(Mu(t)(e._keyMap))),Bb=l(2,(e,t)=>wm(e,r=>{for(let o of t)Mm(r,o)}));var jb=l(2,(e,t)=>wm(_c(),r=>{zb(e,o=>gi(r,o));for(let o of t)gi(r,o)}));var zb=l(2,(e,t)=>Ru(e._keyMap,(r,o)=>t(o))),Gb=l(3,(e,t,r)=>xi(e._keyMap,t,(o,n,s)=>r(o,s)));var Lr=_c,Nu=qb,Hn=Hb,$b=Wb;var Wn=Ub;var Un=gi,Rm=Mm,Fm=Bb;var uo=jb;var Bn=Gb;u();var Vb=Symbol.for("effect/MutableRef"),jI={[Vb]:Vb,toString(){return te(this.toJSON())},toJSON(){return{_id:"MutableRef",current:J(this.current)}},[j](){return this.toJSON()},pipe(){return O(this,arguments)}},Dr=e=>{let t=Object.create(jI);return t.current=e,t},Pu=l(3,(e,t,r)=>v(t,e.current)?(e.current=r,!0):!1);var Pt=e=>e.current;var or=l(2,(e,t)=>(e.current=t,e));var Du="effect/FiberId",$o=Symbol.for(Du),yi="None",Tm="Runtime",Am="Composite",zI=ce(`${Du}-${yi}`),Im=class{[$o]=$o;_tag=yi;id=-1;startTimeMillis=-1;[F](){return zI}[R](t){return Hu(t)&&t._tag===yi}toString(){return te(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag}}[j](){return this.toJSON()}},Nm=class{id;startTimeMillis;[$o]=$o;_tag=Tm;constructor(t,r){this.id=t,this.startTimeMillis=r}[F](){return V(this,ce(`${Du}-${this._tag}-${this.id}-${this.startTimeMillis}`))}[R](t){return Hu(t)&&t._tag===Tm&&this.id===t.id&&this.startTimeMillis===t.startTimeMillis}toString(){return te(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,id:this.id,startTimeMillis:this.startTimeMillis}}[j](){return this.toJSON()}},Pm=class{left;right;[$o]=$o;_tag=Am;constructor(t,r){this.left=t,this.right=r}_hash;[F](){return m(ce(`${Du}-${this._tag}`),L(w(this.left)),L(w(this.right)),V(this))}[R](t){return Hu(t)&&t._tag===Am&&v(this.left,t.left)&&v(this.right,t.right)}toString(){return te(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,left:J(this.left),right:J(this.right)}}[j](){return this.toJSON()}},qu=new Im;var Hu=e=>k(e,$o);var Jb=l(2,(e,t)=>e._tag===yi?t:t._tag===yi?e:new Pm(e,t));var Lu=e=>{switch(e._tag){case yi:return Lr();case Tm:return Hn(e.id);case Am:return m(Lu(e.left),uo(Lu(e.right)))}},Kb=q(Symbol.for("effect/Fiber/Id/_fiberCounter"),()=>Dr(0));var Wu=e=>Array.from(Lu(e)).map(r=>`#${r}`).join(",");var Yb=()=>{let e=Pt(Kb);return m(Kb,or(e+1)),new Nm(e,Date.now())};var zt=qu;var Lm=Jb;var Zb=Wu;var Uu=Yb;u();var zn=hi;var Xb=Mb,eS=Fb,Dm=Tb;var xr=qn,qm=ku;var tS=di;var rS=Ab,oS=wu;var Bu=Nb;var nS=Ru,Hm=xi;u();var Ec=Symbol.for("effect/List"),Wm=e=>ee(e),$I=e=>hy(ii(e),Wm),VI=$I(v),KI={[Ec]:Ec,_tag:"Cons",toString(){return te(this.toJSON())},toJSON(){return{_id:"List",_tag:"Cons",values:Wm(this).map(J)}},[j](){return this.toJSON()},[R](e){return iS(e)&&this._tag===e._tag&&VI(this,e)},[F](){return V(this,It(Wm(this)))},[Symbol.iterator](){let e=!1,t=this;return{next(){if(e)return this.return();if(t._tag==="Nil")return e=!0,this.return();let r=t.head;return t=t.tail,{done:e,value:r}},return(r){return e||(e=!0),{done:!0,value:r}}}},pipe(){return O(this,arguments)}},ju=(e,t)=>{let r=Object.create(KI);return r.head=e,r.tail=t,r},JI=ce("Nil"),YI={[Ec]:Ec,_tag:"Nil",toString(){return te(this.toJSON())},toJSON(){return{_id:"List",_tag:"Nil"}},[j](){return this.toJSON()},[F](){return JI},[R](e){return iS(e)&&this._tag===e._tag},[Symbol.iterator](){return{next(){return{done:!0,value:void 0}}}},pipe(){return O(this,arguments)}},sS=Object.create(YI),iS=e=>k(e,Ec),qr=e=>e._tag==="Nil",Oc=e=>e._tag==="Cons";var QI=()=>sS,po=(e,t)=>ju(e,t),Hr=QI,Cc=e=>ju(e,sS);var cS=l(2,(e,t)=>ZI(t,e)),zu=l(2,(e,t)=>po(t,e)),ZI=l(2,(e,t)=>{if(qr(e))return t;if(qr(t))return e;{let r=ju(t.head,e),o=r,n=t.tail;for(;!qr(n);){let s=ju(n.head,e);o.tail=s,o=s,n=n.tail}return r}});var aS=l(3,(e,t,r)=>{let o=t,n=e;for(;!qr(n);)o=r(o,n.head),n=n.tail;return o});var uS=e=>{let t=Hr(),r=e;for(;!qr(r);)t=zu(t,r.head),r=r.tail;return t};u();u();u();u();var oK=Object.assign(Object.create(Array.prototype),{[F](){return V(this,It(this))},[R](e){return Array.isArray(e)&&this.length===e.length?this.every((t,r)=>v(t,e[r])):!1}}),_i=function(){function e(t){t&&Object.assign(this,t)}return e.prototype=ti,e}(),Gu=e=>Object.assign(Object.create(ti),e);u();var XI=Symbol.for("effect/DifferContextPatch");function pS(e){return e}var kc={..._i.prototype,[XI]:{_Value:pS,_Patch:pS}},eN=Object.assign(Object.create(kc),{_tag:"Empty"}),tN=Object.create(eN),Um=()=>tN,rN=Object.assign(Object.create(kc),{_tag:"AndThen"}),oN=(e,t)=>{let r=Object.create(rN);return r.first=e,r.second=t,r},nN=Object.assign(Object.create(kc),{_tag:"AddService"}),sN=(e,t)=>{let r=Object.create(nN);return r.key=e,r.service=t,r},iN=Object.assign(Object.create(kc),{_tag:"RemoveService"}),cN=e=>{let t=Object.create(iN);return t.key=e,t},aN=Object.assign(Object.create(kc),{_tag:"UpdateService"}),uN=(e,t)=>{let r=Object.create(aN);return r.key=e,r.update=t,r},fS=(e,t)=>{let r=new Map(e.unsafeMap),o=Um();for(let[n,s]of t.unsafeMap.entries())if(r.has(n)){let i=r.get(n);r.delete(n),v(i,s)||(o=vc(uN(n,()=>s))(o))}else r.delete(n),o=vc(sN(n,s))(o);for(let[n]of r.entries())o=vc(cN(n))(o);return o},vc=l(2,(e,t)=>oN(e,t)),mS=l(2,(e,t)=>{if(e._tag==="Empty")return t;let r=!1,o=Re(e),n=new Map(t.unsafeMap);for(;tt(o);){let i=Ze(o),c=ot(o);switch(i._tag){case"Empty":{o=c;break}case"AddService":{n.set(i.key,i.service),o=c;break}case"AndThen":{o=Qe(Qe(c,i.second),i.first);break}case"RemoveService":{n.delete(i.key),o=c;break}case"UpdateService":{n.set(i.key,i.update(n.get(i.key))),r=!0,o=c;break}}}if(!r)return jo(n);let s=new Map;for(let[i]of t.unsafeMap)n.has(i)&&(s.set(i,n.get(i)),n.delete(i));for(let[i,c]of n)s.set(i,c);return jo(s)});u();var pN=Symbol.for("effect/DifferHashSetPatch");function Bm(e){return e}var Vu={..._i.prototype,[pN]:{_Value:Bm,_Key:Bm,_Patch:Bm}},fN=Object.assign(Object.create(Vu),{_tag:"Empty"}),mN=Object.create(fN),jm=()=>mN,hN=Object.assign(Object.create(Vu),{_tag:"AndThen"}),dN=(e,t)=>{let r=Object.create(hN);return r.first=e,r.second=t,r},xN=Object.assign(Object.create(Vu),{_tag:"Add"}),gN=e=>{let t=Object.create(xN);return t.value=e,t},yN=Object.assign(Object.create(Vu),{_tag:"Remove"}),bN=e=>{let t=Object.create(yN);return t.value=e,t},hS=(e,t)=>{let[r,o]=Bn([e,jm()],([n,s],i)=>$b(i)(n)?[Rm(i)(n),s]:[n,$u(gN(i))(s)])(t);return Bn(o,(n,s)=>$u(bN(s))(n))(r)},$u=l(2,(e,t)=>dN(e,t)),dS=l(2,(e,t)=>{if(e._tag==="Empty")return t;let r=t,o=Re(e);for(;tt(o);){let n=Ze(o),s=ot(o);switch(n._tag){case"Empty":{o=s;break}case"AndThen":{o=Qe(n.first)(Qe(n.second)(s));break}case"Add":{r=Un(n.value)(r),o=s;break}case"Remove":r=Rm(n.value)(r),o=s}}return r});u();var _N=Symbol.for("effect/DifferReadonlyArrayPatch");function xS(e){return e}var Mc={..._i.prototype,[_N]:{_Value:xS,_Patch:xS}},EN=Object.assign(Object.create(Mc),{_tag:"Empty"}),ON=Object.create(EN),zm=()=>ON,CN=Object.assign(Object.create(Mc),{_tag:"AndThen"}),vN=(e,t)=>{let r=Object.create(CN);return r.first=e,r.second=t,r},kN=Object.assign(Object.create(Mc),{_tag:"Append"}),wN=e=>{let t=Object.create(kN);return t.values=e,t},MN=Object.assign(Object.create(Mc),{_tag:"Slice"}),RN=(e,t)=>{let r=Object.create(MN);return r.from=e,r.until=t,r},FN=Object.assign(Object.create(Mc),{_tag:"Update"}),TN=(e,t)=>{let r=Object.create(FN);return r.index=e,r.patch=t,r},gS=e=>{let t=0,r=zm();for(;t<e.oldValue.length&&t<e.newValue.length;){let o=e.oldValue[t],n=e.newValue[t],s=e.differ.diff(o,n);v(s,e.differ.empty)||(r=wc(r,TN(t,s))),t=t+1}return t<e.oldValue.length&&(r=wc(r,RN(0,t))),t<e.newValue.length&&(r=wc(r,wN(Qy(t)(e.newValue)))),r},wc=l(2,(e,t)=>vN(e,t)),yS=l(3,(e,t,r)=>{if(e._tag==="Empty")return t;let o=t.slice(),n=_t(e);for(;Ky(n);){let s=gt(n),i=Rr(n);switch(s._tag){case"Empty":{n=i;break}case"AndThen":{i.unshift(s.first,s.second),n=i;break}case"Append":{for(let c of s.values)o.push(c);n=i;break}case"Slice":{o=o.slice(s.from,s.until),n=i;break}case"Update":{o[s.index]=r.patch(s.patch,o[s.index]),n=i;break}}}return o});var bS=Symbol.for("effect/Differ"),IN={[bS]:{_P:B,_V:B}},Vo=e=>{let t=Object.create(IN);return t.empty=e.empty,t.diff=e.diff,t.combine=e.combine,t.patch=e.patch,t},Gm=()=>Vo({empty:Um(),combine:(e,t)=>vc(t)(e),diff:(e,t)=>fS(e,t),patch:(e,t)=>mS(t)(e)});var $m=()=>Vo({empty:jm(),combine:(e,t)=>$u(t)(e),diff:(e,t)=>hS(e,t),patch:(e,t)=>dS(t)(e)});var Vm=e=>Vo({empty:zm(),combine:(t,r)=>wc(t,r),diff:(t,r)=>gS({oldValue:t,newValue:r,differ:e}),patch:(t,r)=>yS(t,r,e)});var Ku=()=>SS((e,t)=>t),SS=e=>Vo({empty:B,combine:(t,r)=>t===B?r:r===B?t:o=>r(t(o)),diff:(t,r)=>v(t,r)?B:zs(r),patch:(t,r)=>e(r,t(r))});u();var Rc=255,_S=8,Ju=e=>e&Rc,Yu=e=>e>>_S&Rc,$n=(e,t)=>(e&Rc)+((t&e&Rc)<<_S),Qu=$n(0,0),ES=e=>$n(e,e),OS=e=>$n(e,0);var CS=l(2,(e,t)=>$n(Ju(e)&~t,Yu(e)));var Jm=l(2,(e,t)=>e|t);var vS=e=>~e>>>0&Rc;var NN=0,Wr=1,wS=2,Ym=4,Zu=16,Qm=32;var MS=e=>Xu(e,Qm);var Zm=l(2,(e,t)=>e|t);var fo=e=>Fc(e)&&!PN(e),Fc=e=>Xu(e,Wr);var Xu=l(2,(e,t)=>(e&t)!==0),Xm=(...e)=>e.reduce((t,r)=>t|r,0),RS=Xm(NN);var eh=e=>Xu(e,Ym);var PN=e=>Xu(e,Zu);var nr=l(2,(e,t)=>$n(e^t,t)),mo=l(2,(e,t)=>e&(vS(Ju(t))|Yu(t))|Ju(t)&Yu(t));var th=Vo({empty:Qu,diff:(e,t)=>nr(e,t),combine:(e,t)=>Jm(t)(e),patch:(e,t)=>mo(t,e)});var FS=Qu;var rh=ES,oh=OS;var nh=CS;u();var TS={_tag:"Empty"},ah=(e,t)=>({_tag:"Par",left:e,right:t}),el=(e,t)=>({_tag:"Seq",left:e,right:t}),uh=(e,t)=>({_tag:"Single",dataSource:e,blockedRequest:t});var AS=e=>{let t=Cc(e),r=Hr();for(;;){let[o,n]=aS(t,[IS(),Hr()],([s,i],c)=>{let[a,p]=LN(c);return[jN(s,a),cS(i,p)]});if(r=DN(r,o),qr(n))return uS(r);t=n}throw new Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/effect/issues")},LN=e=>{let t=e,r=IS(),o=Hr(),n=Hr();for(;;)switch(t._tag){case"Empty":{if(qr(o))return[r,n];t=o.head,o=o.tail;break}case"Par":{o=po(t.right,o),t=t.left;break}case"Seq":{let s=t.left,i=t.right;switch(s._tag){case"Empty":{t=i;break}case"Par":{let c=s.left,a=s.right;t=ah(el(c,i),el(a,i));break}case"Seq":{let c=s.left,a=s.right;t=el(c,el(a,i));break}case"Single":{t=s,n=po(i,n);break}}break}case"Single":{if(r=BN(r,t),qr(o))return[r,n];t=o.head,o=o.tail;break}}throw new Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/effect/issues")},DN=(e,t)=>{if(qr(e))return Cc(ih(t));if(zN(t))return e;let r=YN(e.head),o=GN(t);return r.length===1&&o.length===1&&v(r[0],o[0])?po(JN(e.head,ih(t)),e.tail):po(ih(t),e)},qN=Symbol.for("effect/RequestBlock/Entry"),ch=class{request;result;listeners;ownerId;state;[qN]=HN;constructor(t,r,o,n,s){this.request=t,this.result=r,this.listeners=o,this.ownerId=n,this.state=s}},HN={_R:e=>e};var lh=e=>new ch(e.request,e.result,e.listeners,e.ownerId,e.state),WN=Symbol.for("effect/RequestBlock/RequestBlockParallel"),UN={_R:e=>e},Ac=class{map;[WN]=UN;constructor(t){this.map=t}},IS=()=>new Ac(zn());var BN=(e,t)=>new Ac(oS(e.map,t.dataSource,r=>Gf(Me(r,gu(t.blockedRequest)),()=>Re(t.blockedRequest)))),jN=(e,t)=>new Ac(Hm(e.map,t.map,(r,o,n)=>xr(r,n,Ke(Dm(r,n),{onNone:()=>o,onSome:s=>Bt(o,s)})))),zN=e=>eS(e.map),GN=e=>Array.from(qm(e.map)),ih=e=>KN(Bu(e.map,t=>Re(t))),$N=Symbol.for("effect/RequestBlock/RequestBlockSequential"),VN={_R:e=>e},tl=class{map;[$N]=VN;constructor(t){this.map=t}},KN=e=>new tl(e),JN=(e,t)=>new tl(Hm(t.map,e.map,(r,o,n)=>xr(r,n,Ke(Dm(r,n),{onNone:()=>Nt(),onSome:s=>Bt(s,o)}))));var YN=e=>Array.from(qm(e.map)),NS=e=>Array.from(e.map);u();u();var Vn="Die",Kn="Empty",Jn="Fail",Yn="Interrupt",Qn="Parallel",Zn="Sequential";var HS="effect/Cause",fh=Symbol.for(HS),ZN={_E:e=>e},Ei={[fh]:ZN,[F](){return m(w(HS),L(w(eP(this))),V(this))},[R](e){return ol(e)&&XN(this,e)},pipe(){return O(this,arguments)},toJSON(){switch(this._tag){case"Empty":return{_id:"Cause",_tag:this._tag};case"Die":return{_id:"Cause",_tag:this._tag,defect:J(this.defect)};case"Interrupt":return{_id:"Cause",_tag:this._tag,fiberId:this.fiberId.toJSON()};case"Fail":return{_id:"Cause",_tag:this._tag,failure:J(this.error)};case"Sequential":case"Parallel":return{_id:"Cause",_tag:this._tag,left:J(this.left),right:J(this.right)}}},toString(){return Yo(this)},[j](){return this.toJSON()}},gr=(()=>{let e=Object.create(Ei);return e._tag=Kn,e})(),Ko=e=>{let t=Object.create(Ei);return t._tag=Jn,t.error=e,t},ft=e=>{let t=Object.create(Ei);return t._tag=Vn,t.defect=e,t},Gt=e=>{let t=Object.create(Ei);return t._tag=Yn,t.fiberId=e,t},vt=(e,t)=>{let r=Object.create(Ei);return r._tag=Qn,r.left=e,r.right=t,r},je=(e,t)=>{let r=Object.create(Ei);return r._tag=Zn,r.left=e,r.right=t,r},ol=e=>k(e,fh);var Oi=e=>e._tag===Vn;var nl=e=>e._tag===Kn?!0:Xn(e,!0,(t,r)=>{switch(r._tag){case Kn:return _(t);case Vn:case Jn:case Yn:return _(!1);default:return S()}});var sl=e=>W(WS(e)),es=e=>Pc(void 0,rP)(e),Ic=e=>Ir(Xn(e,Nt(),(t,r)=>r._tag===Jn?_(m(t,Qe(r.error))):S())),il=e=>Ir(Xn(e,Nt(),(t,r)=>r._tag===Vn?_(m(t,Qe(r.defect))):S())),Nc=e=>Xn(e,Lr(),(t,r)=>r._tag===Yn?_(m(t,Un(r.fiberId))):S()),mh=e=>Jo(e,t=>t._tag===Jn?_(t.error):S()),Ur=e=>{let t=mh(e);switch(t._tag){case"None":return Ve(e);case"Some":return St(t.value)}};var WS=e=>Jo(e,t=>t._tag===Yn?_(t.fiberId):S()),hh=e=>Ci(e,{onEmpty:S(),onFail:()=>S(),onDie:t=>_(ft(t)),onInterrupt:()=>S(),onSequential:(t,r)=>W(t)&&W(r)?_(je(t.value,r.value)):W(t)&&z(r)?_(t.value):z(t)&&W(r)?_(r.value):S(),onParallel:(t,r)=>W(t)&&W(r)?_(vt(t.value,r.value)):W(t)&&z(r)?_(t.value):z(t)&&W(r)?_(r.value):S()}),US=e=>Ci(e,{onEmpty:S(),onFail:t=>_(ft(t)),onDie:t=>_(ft(t)),onInterrupt:()=>S(),onSequential:(t,r)=>W(t)&&W(r)?_(je(t.value,r.value)):W(t)&&z(r)?_(t.value):z(t)&&W(r)?_(r.value):S(),onParallel:(t,r)=>W(t)&&W(r)?_(vt(t.value,r.value)):W(t)&&z(r)?_(t.value):z(t)&&W(r)?_(r.value):S()});var cl=e=>Ci(e,{onEmpty:gr,onFail:()=>gr,onDie:t=>ft(t),onInterrupt:t=>Gt(t),onSequential:je,onParallel:vt}),BS=e=>Ci(e,{onEmpty:gr,onFail:t=>ft(t),onDie:t=>ft(t),onInterrupt:t=>Gt(t),onSequential:(t,r)=>je(t,r),onParallel:(t,r)=>vt(t,r)});var jS=l(2,(e,t)=>Ci(e,{onEmpty:gr,onFail:r=>t(r),onDie:r=>ft(r),onInterrupt:r=>Gt(r),onSequential:(r,o)=>je(r,o),onParallel:(r,o)=>vt(r,o)})),dh=e=>jS(e,B);var XN=(e,t)=>{let r=Re(e),o=Re(t);for(;tt(r)&&tt(o);){let[n,s]=m(Ze(r),Xn([Lr(),Nt()],([a,p],f)=>{let[h,d]=ph(f);return _([m(a,uo(h)),m(p,Bt(d))])})),[i,c]=m(Ze(o),Xn([Lr(),Nt()],([a,p],f)=>{let[h,d]=ph(f);return _([m(a,uo(h)),m(p,Bt(d))])}));if(!v(n,i))return!1;r=s,o=c}return!0},eP=e=>tP(Re(e),Nt()),tP=(e,t)=>{for(;;){let[r,o]=m(e,er([Lr(),Nt()],([s,i],c)=>{let[a,p]=ph(c);return[m(s,uo(a)),m(i,Bt(p))]})),n=Wn(r)>0?m(t,Qe(r)):t;if(lm(o))return Ir(n);e=o,t=n}throw new Error(Tn("Cause.flattenCauseLoop"))},Jo=l(2,(e,t)=>{let r=[e];for(;r.length>0;){let o=r.pop(),n=t(o);switch(n._tag){case"None":{switch(o._tag){case Zn:case Qn:{r.push(o.right),r.push(o.left);break}}break}case"Some":return n}}return S()});var ph=e=>{let t=e,r=[],o=Lr(),n=Nt();for(;t!==void 0;)switch(t._tag){case Kn:{if(r.length===0)return[o,n];t=r.pop();break}case Jn:{if(o=Un(o,gc(t._tag,t.error)),r.length===0)return[o,n];t=r.pop();break}case Vn:{if(o=Un(o,gc(t._tag,t.defect)),r.length===0)return[o,n];t=r.pop();break}case Yn:{if(o=Un(o,gc(t._tag,t.fiberId)),r.length===0)return[o,n];t=r.pop();break}case Zn:{switch(t.left._tag){case Kn:{t=t.right;break}case Zn:{t=je(t.left.left,je(t.left.right,t.right));break}case Qn:{t=vt(je(t.left.left,t.right),je(t.left.right,t.right));break}default:{n=Qe(n,t.right),t=t.left;break}}break}case Qn:{r.push(t.right),t=t.left;break}}throw new Error(Tn("Cause.evaluateCauseLoop"))};var rP={emptyCase:Po,failCase:eo,dieCase:eo,interruptCase:Po,sequentialCase:(e,t,r)=>t&&r,parallelCase:(e,t,r)=>t&&r};var LS="SequentialCase",DS="ParallelCase",Ci=l(2,(e,{onDie:t,onEmpty:r,onFail:o,onInterrupt:n,onParallel:s,onSequential:i})=>Pc(e,void 0,{emptyCase:()=>r,failCase:(c,a)=>o(a),dieCase:(c,a)=>t(a),interruptCase:(c,a)=>n(a),sequentialCase:(c,a,p)=>i(a,p),parallelCase:(c,a,p)=>s(a,p)})),Xn=l(3,(e,t,r)=>{let o=t,n=e,s=[];for(;n!==void 0;){let i=r(o,n);switch(o=W(i)?i.value:o,n._tag){case Zn:{s.push(n.right),n=n.left;break}case Qn:{s.push(n.right),n=n.left;break}default:{n=void 0;break}}n===void 0&&s.length>0&&(n=s.pop())}return o}),Pc=l(3,(e,t,r)=>{let o=[e],n=[];for(;o.length>0;){let i=o.pop();switch(i._tag){case Kn:{n.push(Ve(r.emptyCase(t)));break}case Jn:{n.push(Ve(r.failCase(t,i.error)));break}case Vn:{n.push(Ve(r.dieCase(t,i.defect)));break}case Yn:{n.push(Ve(r.interruptCase(t,i.fiberId)));break}case Zn:{o.push(i.right),o.push(i.left),n.push(St({_tag:LS}));break}case Qn:{o.push(i.right),o.push(i.left),n.push(St({_tag:DS}));break}}}let s=[];for(;n.length>0;){let i=n.pop();switch(i._tag){case"Left":{switch(i.left._tag){case LS:{let c=s.pop(),a=s.pop(),p=r.sequentialCase(t,c,a);s.push(p);break}case DS:{let c=s.pop(),a=s.pop(),p=r.parallelCase(t,c,a);s.push(p);break}}break}case"Right":{s.push(i.right);break}}}if(s.length===0)throw new Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return s.pop()}),Yo=(e,t)=>es(e)?"All fibers interrupted without errors.":al(e).map(function(r){return t?.renderErrorCause!==!0||r.cause===void 0?r.stack:`${r.stack} {
${zS(r.cause,"  ")}
}`}).join(`
`),zS=(e,t)=>{let r=e.stack.split(`
`),o=`${t}[cause]: ${r[0]}`;for(let n=1,s=r.length;n<s;n++)o+=`
${t}${r[n]}`;return e.cause&&(o+=` {
${zS(e.cause,`${t}  `)}
${t}}`),o},rl=class e extends globalThis.Error{span=void 0;constructor(t){let r=typeof t=="object"&&t!==null,o=Error.stackTraceLimit;Error.stackTraceLimit=1,super(oP(t),r&&"cause"in t&&typeof t.cause<"u"?{cause:new e(t.cause)}:void 0),this.message===""&&(this.message="An error has occurred"),Error.stackTraceLimit=o,this.name=t instanceof Error?t.name:"Error",r&&(qS in t&&(this.span=t[qS]),Object.keys(t).forEach(n=>{n in this||(this[n]=t[n])})),this.stack=sP(`${this.name}: ${this.message}`,t instanceof Error&&t.stack?t.stack:"",this.span)}},oP=e=>{if(typeof e=="string")return e;if(typeof e=="object"&&e!==null&&e instanceof Error)return e.message;try{if(k(e,"toString")&&Do(e.toString)&&e.toString!==Object.prototype.toString&&e.toString!==globalThis.Array.prototype.toString)return e.toString()}catch{}return JSON.stringify(e)},nP=/\((.*)\)/,Lc=q("effect/Tracer/spanToTrace",()=>new WeakMap),sP=(e,t,r)=>{let o=[e],n=t.startsWith(e)?t.slice(e.length).split(`
`):t.split(`
`);for(let s=1;s<n.length&&!n[s].includes("Generator.next");s++){if(n[s].includes("effect_internal_function")){o.pop();break}o.push(n[s].replace(/at .*effect_instruction_i.*\((.*)\)/,"at $1").replace(/EffectPrimitive\.\w+/,"<anonymous>"))}if(r){let s=r,i=0;for(;s&&s._tag==="Span"&&i<10;){let c=Lc.get(s);if(typeof c=="function"){let a=c();if(typeof a=="string"){let p=a.match(nP),f=p?p[1]:a.replace(/^at /,"");o.push(`    at ${s.name} (${f})`)}else o.push(`    at ${s.name}`)}else o.push(`    at ${s.name}`);s=pt(s.parent),i++}}return o.join(`
`)},qS=Symbol.for("effect/SpanAnnotation"),al=e=>Pc(e,void 0,{emptyCase:()=>[],dieCase:(t,r)=>[new rl(r)],failCase:(t,r)=>[new rl(r)],interruptCase:()=>[],parallelCase:(t,r,o)=>[...r,...o],sequentialCase:(t,r,o)=>[...r,...o]});u();u();var rs="Pending",Dc="Done";var iP="effect/Deferred",$S=Symbol.for(iP),VS={_E:e=>e,_A:e=>e},KS=e=>({_tag:rs,joiners:e}),xh=e=>({_tag:Dc,effect:e});u();var Qo=class e{self;called=!1;constructor(t){this.self=t}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new e(this.self)}};u();var JS=Symbol.for("effect/Tracer"),aP=e=>({[JS]:JS,...e}),Br=Et("effect/Tracer"),yr=Et("effect/ParentSpan"),YS=function(){let e="abcdef0123456789",t=e.length;return function(r){let o="";for(let n=0;n<r;n++)o+=e.charAt(Math.floor(Math.random()*t));return o}}(),gh=class{name;parent;context;links;startTime;kind;_tag="Span";spanId;traceId="native";sampled=!0;status;attributes;events=[];constructor(t,r,o,n,s,i){this.name=t,this.parent=r,this.context=o,this.links=n,this.startTime=s,this.kind=i,this.status={_tag:"Started",startTime:s},this.attributes=new Map,this.traceId=r._tag==="Some"?r.value.traceId:YS(32),this.spanId=YS(16)}end(t,r){this.status={_tag:"Ended",endTime:t,exit:r,startTime:this.status.startTime}}attribute(t,r){this.attributes.set(t,r)}event(t,r,o){this.events.push([t,r,o??{}])}},QS=aP({span:(e,t,r,o,n,s)=>new gh(e,t,r,o,n,s),context:e=>e()});var ho=e=>{if(e?.captureStackTrace===!1)return e;if(e?.captureStackTrace!==void 0&&typeof e.captureStackTrace!="boolean")return e;let t=Error.stackTraceLimit;Error.stackTraceLimit=3;let r=new Error;Error.stackTraceLimit=t;let o=!1;return{...e,captureStackTrace:()=>{if(o!==!1)return o;if(r.stack!==void 0){let n=r.stack.split(`
`);if(n[3]!==void 0)return o=n[3].trim(),o}}}};var pP="effect/EffectError",yh=Symbol.for(pP),i_=e=>k(e,yh),c_=e=>({[yh]:yh,_tag:"EffectError",cause:e}),xo=(e,t)=>{let r=new ze("Blocked");return r.effect_instruction_i0=e,r.effect_instruction_i1=t,r},dl=e=>{let t=new ze("RunBlocked");return t.effect_instruction_i0=e,t},vi=Symbol.for("effect/Effect"),pl=class{patch;op;_op=mc;constructor(t,r){this.patch=t,this.op=r}},ze=class{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[vi]=Ho;constructor(t){this._op=t}[R](t){return this===t}[F](){return V(this,Vs(this))}pipe(){return O(this,arguments)}toJSON(){return{_id:"Effect",_op:this._op,effect_instruction_i0:J(this.effect_instruction_i0),effect_instruction_i1:J(this.effect_instruction_i1),effect_instruction_i2:J(this.effect_instruction_i2)}}toString(){return te(this.toJSON())}[j](){return this.toJSON()}[Symbol.iterator](){return new Qo(new Mr(this))}},fl=class{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[vi]=Ho;constructor(t){this._op=t,this._tag=t}[R](t){return Gc(t)&&t._op==="Failure"&&v(this.effect_instruction_i0,t.effect_instruction_i0)}[F](){return m(ce(this._tag),L(w(this.effect_instruction_i0)),V(this))}get cause(){return this.effect_instruction_i0}pipe(){return O(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,cause:this.cause.toJSON()}}toString(){return te(this.toJSON())}[j](){return this.toJSON()}[Symbol.iterator](){return new Qo(new Mr(this))}},ml=class{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[vi]=Ho;constructor(t){this._op=t,this._tag=t}[R](t){return Gc(t)&&t._op==="Success"&&v(this.effect_instruction_i0,t.effect_instruction_i0)}[F](){return m(ce(this._tag),L(w(this.effect_instruction_i0)),V(this))}get value(){return this.effect_instruction_i0}pipe(){return O(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,value:J(this.value)}}toString(){return te(this.toJSON())}[j](){return this.toJSON()}[Symbol.iterator](){return new Qo(new Mr(this))}},ue=e=>k(e,vi),re=e=>{let t=new ze(su);return t.effect_instruction_i0=e,t},Zo=l(3,(e,t,r)=>Fe(o=>x(e,n=>x(ke(I(()=>o(t(n)))),s=>I(()=>r(n,s)).pipe(Se({onFailure:i=>{switch(s._tag){case Pe:return Y(vt(s.effect_instruction_i0,i));case Le:return Y(i)}},onSuccess:()=>s})))))),le=l(2,(e,t)=>x(e,()=>y(t))),Ee=e=>le(e,void 0),Hc=function(){let e=new ze(Js);switch(arguments.length){case 2:{e.effect_instruction_i0=arguments[0],e.commit=arguments[1];break}case 3:{e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.commit=arguments[2];break}case 4:{e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.effect_instruction_i2=arguments[2],e.commit=arguments[3];break}default:throw new Error(Tn("you're not supposed to end up here"))}return e},a_=(e,t=zt)=>{let r=new ze(An),o;return r.effect_instruction_i0=n=>{o=e(n)},r.effect_instruction_i1=t,o!==void 0?_r(r,n=>o):r},qe=(e,t=zt)=>Hc(e,function(){let r,o;function n(a){r?r(a):o===void 0&&(o=a)}let s=new ze(An);s.effect_instruction_i0=a=>{r=a,o&&a(o)},s.effect_instruction_i1=t;let i,c;return this.effect_instruction_i0.length!==1?(c=new AbortController,i=Ne(()=>this.effect_instruction_i0(n,c.signal))):i=Ne(()=>this.effect_instruction_i0(n)),i||c?_r(s,a=>(c&&c.abort(),i??H)):s}),jr=l(2,(e,t)=>{let r=new ze(Ys);return r.effect_instruction_i0=e,r.effect_instruction_i1=t,r}),br=l(2,(e,t)=>Xe(e,{onFailure:t,onSuccess:y})),Wc=l(3,(e,t,r)=>jr(e,o=>{let n=Ur(o);switch(n._tag){case"Left":return t(n.left)?r(n.left):Y(o);case"Right":return Y(n.right)}})),u_=l(2,(e,t)=>jr(e,r=>{let o=Ur(r);switch(o._tag){case"Left":return m(t(o.left),De(()=>Y(r)));case"Right":return Y(o.right)}})),l_=e=>re((t,r)=>e(Fc(r.runtimeFlags))),hl=Symbol.for("effect/SpanAnnotation"),ZS=Symbol.for("effect/OriginalAnnotation");var p_=(e,t)=>W(t)?new Proxy(e,{has(r,o){return o===hl||o===ZS||o in r},get(r,o){return o===hl?t.value:o===ZS?e:r[o]}}):e,go=e=>Mn(e)&&!(hl in e)?re(t=>Y(ft(p_(e,H_(t))))):Y(ft(e)),Xo=e=>tn(()=>ft(new SP(e))),en=e=>x(E(e),go),zr=e=>Xe(e,{onFailure:t=>y(St(t)),onSuccess:t=>y(Ve(t))}),ke=e=>Uc(e,{onFailure:ie,onSuccess:xe}),G=e=>Mn(e)&&!(hl in e)?re(t=>Y(Ko(p_(e,H_(t))))):Y(Ko(e)),Sr=e=>x(E(e),G),Y=e=>{let t=new fl(Pe);return t.effect_instruction_i0=e,t},tn=e=>x(E(e),Y),rn=re(e=>y(e.id())),Lt=e=>re(t=>e(t.id())),x=l(2,(e,t)=>{let r=new ze(Qs);return r.effect_instruction_i0=e,r.effect_instruction_i1=t,r}),ns=l(2,(e,t)=>x(e,r=>{let o=typeof t=="function"?t(r):t;return ue(o)?o:Mf(o)?qe(n=>{o.then(s=>n(y(s)),s=>n(G(new un(s))))}):y(o)})),xl=e=>{let t=new ze("OnStep");return t.effect_instruction_i0=e,t},kt=e=>x(e,B),on=e=>Xe(e,{onFailure:y,onSuccess:G}),Uc=l(2,(e,t)=>Se(e,{onFailure:r=>y(t.onFailure(r)),onSuccess:r=>y(t.onSuccess(r))})),Se=l(2,(e,t)=>{let r=new ze(Zs);return r.effect_instruction_i0=e,r.effect_instruction_i1=t.onFailure,r.effect_instruction_i2=t.onSuccess,r}),Xe=l(2,(e,t)=>Se(e,{onFailure:r=>{if(il(r).length>0)return Y(BS(r));let n=Ic(r);return n.length>0?t.onFailure(pm(n)):Y(r)},onSuccess:t.onSuccess})),st=l(2,(e,t)=>I(()=>{let r=ee(e),o=xc(r.length),n=0;return le(Mi({while:()=>n<r.length,body:()=>t(r[n],n),step:s=>{o[n++]=s}}),o)})),Dt=l(2,(e,t)=>I(()=>{let r=ee(e),o=0;return Mi({while:()=>o<r.length,body:()=>t(r[o],o),step:()=>{o++}})})),gl=l(e=>typeof e[0]=="boolean"||ue(e[0]),(e,t)=>ue(e)?x(e,r=>r?t.onTrue():t.onFalse()):e?t.onTrue():t.onFalse()),yl=x(rn,e=>bl(e)),bl=e=>Y(Gt(e)),Gr=e=>{let t=new ze(ro);return t.effect_instruction_i0=rh(Wr),t.effect_instruction_i1=()=>e,t},f_=e=>Hc(e,function(){let t=new ze(ro);return t.effect_instruction_i0=rh(Wr),t.effect_instruction_i1=r=>Fc(r)?Ne(()=>this.effect_instruction_i0(Gr)):Ne(()=>this.effect_instruction_i0(yo)),t}),$r=l(2,(e,t)=>Fe(r=>x(ke(r(e)),o=>Th(t,o)))),C=l(2,(e,t)=>x(e,r=>E(()=>t(r)))),Bc=l(2,(e,t)=>Xe(e,{onFailure:r=>Sr(()=>t.onFailure(r)),onSuccess:r=>E(()=>t.onSuccess(r))})),nn=l(2,(e,t)=>Se(e,{onFailure:r=>{let o=Ur(r);switch(o._tag){case"Left":return Sr(()=>t(o.left));case"Right":return Y(o.right)}},onSuccess:y})),Sl=l(2,(e,t)=>yt(e,r=>Al(r)?H:t(r.effect_instruction_i0))),yt=l(2,(e,t)=>Fe(r=>Se(r(e),{onFailure:o=>{let n=ie(o);return Se(t(n),{onFailure:s=>ie(je(o,s)),onSuccess:()=>n})},onSuccess:o=>{let n=xe(o);return ne(t(n),n)}}))),_r=l(2,(e,t)=>yt(e,Fi({onFailure:r=>es(r)?Ee(t(Nc(r))):H,onSuccess:()=>H}))),ss=l(2,(e,t)=>fP(e,t,y)),is=e=>_h(e,B),_h=l(2,(e,t)=>Xe(e,{onFailure:r=>go(t(r)),onSuccess:y})),m_=(e,t)=>ee(e).reduceRight(([r,o],n)=>{let s=t(n);switch(s._tag){case"Left":return[[s.left,...r],o];case"Right":return[r,[s.right,...o]]}},[Ut(),Ut()]),ki=re((e,t)=>y(t.runtimeFlags)),y=e=>{let t=new ml(Le);return t.effect_instruction_i0=e,t},I=e=>x(E(e),B),E=e=>{let t=new ze(nu);return t.effect_instruction_i0=e,t},$t=l(e=>e.length===3||e.length===2&&!(Mn(e[1])&&"onlyEffect"in e[1]),(e,t)=>x(e,r=>{let o=typeof t=="function"?t(r):t;return ue(o)?le(o,r):Mf(o)?qe(n=>{o.then(s=>n(y(r)),s=>n(G(new un(s))))}):y(r)})),_l=e=>re(t=>{let r=t.getFiberRef(qc),o=m(r,De(()=>t.scope()));return e(We(qc,_(o)))}),fP=l(3,(e,t,r)=>Se(e,{onFailure:o=>il(o).length>0?Y(dc(US(o))):t(),onSuccess:r})),yo=e=>{let t=new ze(ro);return t.effect_instruction_i0=oh(Wr),t.effect_instruction_i1=()=>e,t},Fe=e=>Hc(e,function(){let t=new ze(ro);return t.effect_instruction_i0=oh(Wr),t.effect_instruction_i1=r=>Fc(r)?Ne(()=>this.effect_instruction_i0(Gr)):Ne(()=>this.effect_instruction_i0(yo)),t}),H=y(void 0);var sn=e=>{let t=new ze(ro);return t.effect_instruction_i0=e,t.effect_instruction_i1=void 0,t},wi=l(2,(e,t)=>x(t,r=>r?m(e,C(_)):y(S()))),Mi=e=>{let t=new ze(Xs);return t.effect_instruction_i0=e.while,t.effect_instruction_i1=e.body,t.effect_instruction_i2=e.step,t},h_=l(2,(e,t)=>We(e,kl,t)),d_=l(2,(e,t)=>We(e,kh,t)),El=l(2,(e,t)=>{let r=new ze(ro);return r.effect_instruction_i0=t,r.effect_instruction_i1=()=>e,r}),x_=l(2,(e,t)=>We(e,Mh,t)),g_=l(2,(e,t)=>We(e,Ri,t)),Vr=e=>{let t=new ze(ei);return typeof e?.priority<"u"?vh(t,e.priority):t},cs=l(2,(e,t)=>x(e,r=>C(t,o=>[r,o])));var as=l(2,(e,t)=>x(e,r=>le(t,r))),ne=l(2,(e,t)=>x(e,()=>t)),Kr=l(3,(e,t,r)=>x(e,o=>C(t,n=>r(o,n)))),us=qe(()=>{let e=setInterval(()=>{},2147483647);return E(()=>clearInterval(e))}),ls=e=>x(rn,t=>m(e,qt(t))),qt=l(2,(e,t)=>x(e.interruptAsFork(t),()=>e.await)),y_={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return O(this,arguments)}},b_={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4,pipe(){return O(this,arguments)}},S_={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4,pipe(){return O(this,arguments)}},__={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4,pipe(){return O(this,arguments)}},Eh={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4,pipe(){return O(this,arguments)}},Oh={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return O(this,arguments)}},E_={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return O(this,arguments)}},O_={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return O(this,arguments)}};var mP="effect/FiberRef",hP=Symbol.for(mP),dP={_A:e=>e},Ht=e=>C_(e,t=>[t,t]);var He=l(2,(e,t)=>x(Ht(e),t)),os=l(2,(e,t)=>C_(e,()=>[void 0,t]));var C_=l(2,(e,t)=>re(r=>{let[o,n]=t(r.getFiberRef(e));return r.setFiberRef(e,n),y(o)}));var xP="effect/RequestResolver",v_=Symbol.for(xP),gP={_A:e=>e,_R:e=>e},XS=class e{runAll;target;[v_]=gP;constructor(t,r){this.runAll=t,this.target=r}[F](){return V(this,this.target?w(this.target):Vs(this))}[R](t){return this.target?yP(t)&&v(this.target,t.target):this===t}identified(...t){return new e(this.runAll,Nr(t))}pipe(){return O(this,arguments)}},yP=e=>k(e,v_);var We=l(3,(e,t,r)=>Zo(as(Ht(t),os(t,r)),()=>e,o=>os(t,o))),rt=l(3,(e,t,r)=>He(t,o=>We(e,t,r(o)))),Te=(e,t)=>ps(e,{differ:Ku(),fork:t?.fork??B,join:t?.join}),k_=e=>{let t=$m();return ps(e,{differ:t,fork:t.empty})},bP=e=>{let t=Vm(Ku());return ps(e,{differ:t,fork:t.empty})},Ol=e=>{let t=Gm();return ps(e,{differ:t,fork:t.empty})},ps=(e,t)=>({[hP]:dP,initial:e,diff:(r,o)=>t.differ.diff(r,o),combine:(r,o)=>t.differ.combine(r,o),patch:r=>o=>t.differ.patch(r,o),fork:t.fork,join:t.join??((r,o)=>o),pipe(){return O(this,arguments)}}),w_=e=>ps(e,{differ:th,fork:th.empty}),mt=q(Symbol.for("effect/FiberRef/currentContext"),()=>Ol(Ot())),cn=q(Symbol.for("effect/FiberRef/currentSchedulingPriority"),()=>Te(0)),Cl=q(Symbol.for("effect/FiberRef/currentMaxOpsBeforeYield"),()=>Te(2048)),an=q(Symbol.for("effect/FiberRef/currentLogAnnotation"),()=>Te(zn())),Ch=q(Symbol.for("effect/FiberRef/currentLogLevel"),()=>Te(Eh)),vl=q(Symbol.for("effect/FiberRef/currentLogSpan"),()=>Te(Hr())),vh=l(2,(e,t)=>We(e,cn,t)),M_=l(2,(e,t)=>We(e,Cl,t)),kl=q(Symbol.for("effect/FiberRef/currentConcurrency"),()=>Te("unbounded")),kh=q(Symbol.for("effect/FiberRef/currentRequestBatching"),()=>Te(!0)),wh=q(Symbol.for("effect/FiberRef/currentUnhandledErrorLogLevel"),()=>Te(_(Oh))),R_=l(2,(e,t)=>We(e,wh,t)),bo=q(Symbol.for("effect/FiberRef/currentMetricLabels"),()=>bP(Ut())),F_=Ht(bo),qc=q(Symbol.for("effect/FiberRef/currentForkScopeOverride"),()=>Te(S(),{fork:()=>S(),join:(e,t)=>e})),fs=q(Symbol.for("effect/FiberRef/currentInterruptedCause"),()=>Te(gr,{fork:()=>gr,join:(e,t)=>e})),Mh=q(Symbol.for("effect/FiberRef/currentTracerEnabled"),()=>Te(!0)),Ri=q(Symbol.for("effect/FiberRef/currentTracerTiming"),()=>Te(!0)),jc=q(Symbol.for("effect/FiberRef/currentTracerSpanAnnotations"),()=>Te(zn())),wl=q(Symbol.for("effect/FiberRef/currentTracerSpanLinks"),()=>Te(Nt())),Ml=Symbol.for("effect/Scope"),Rl=Symbol.for("effect/CloseableScope"),Fl=(e,t)=>e.addFinalizer(()=>Ee(t)),ms=(e,t)=>e.addFinalizer(t),So=(e,t)=>e.close(t),hs=(e,t)=>e.fork(t);var Tl=function(){class e extends globalThis.Error{commit(){return G(this)}toJSON(){return{...this}}[j](){return this.toString!==globalThis.Error.prototype.toString?this.stack?`${this.toString()}
${this.stack.split(`
`).slice(1).join(`
`)}`:this.toString():"Bun"in globalThis?Yo(Ko(this),{renderErrorCause:!0}):this}}return Object.assign(e.prototype,Lf),e}(),ds=(e,t)=>{class r extends Tl{_tag=t}return Object.assign(r.prototype,e),r.prototype.name=t,r},e_=Symbol.for("effect/Cause/errors/RuntimeException"),SP=ds({[e_]:e_},"RuntimeException");var bh=Symbol.for("effect/Cause/errors/InterruptedException"),eJ=ds({[bh]:bh},"InterruptedException"),T_=e=>k(e,bh),t_=Symbol.for("effect/Cause/errors/IllegalArgument"),zc=ds({[t_]:t_},"IllegalArgumentException");var Sh=Symbol.for("effect/Cause/errors/NoSuchElement"),Vt=ds({[Sh]:Sh},"NoSuchElementException"),A_=e=>k(e,Sh),r_=Symbol.for("effect/Cause/errors/InvalidPubSubCapacityException"),tJ=ds({[r_]:r_},"InvalidPubSubCapacityException"),o_=Symbol.for("effect/Cause/errors/ExceededCapacityException"),rJ=ds({[o_]:o_},"ExceededCapacityException");var n_=Symbol.for("effect/Cause/errors/Timeout"),_P=ds({[n_]:n_},"TimeoutException"),I_=e=>new _P(`Operation timed out before the specified duration of '${bm(e)}' elapsed`);var s_=Symbol.for("effect/Cause/errors/UnknownException"),un=function(){class e extends Tl{cause;_tag="UnknownException";error;constructor(r,o){super(o??"An unknown error occurred",{cause:r}),this.cause=r,this.error=r}}return Object.assign(e.prototype,{[s_]:s_,name:"UnknownException"}),e}();var Gc=e=>ue(e)&&"_tag"in e&&(e._tag==="Success"||e._tag==="Failure"),Rh=e=>e._tag==="Failure",Al=e=>e._tag==="Success";var N_=l(2,(e,t)=>{switch(e._tag){case Pe:return ie(e.effect_instruction_i0);case Le:return xe(t)}}),$c=e=>N_(e,void 0);var ln=(e,t)=>EP(e,t?.parallel?vt:je),Il=e=>ie(ft(e));var Vc=e=>ie(Ko(e)),ie=e=>{let t=new fl(Pe);return t.effect_instruction_i0=e,t},P_=l(2,(e,t)=>{switch(e._tag){case Pe:return ie(e.effect_instruction_i0);case Le:return t(e.effect_instruction_i0)}});var L_=e=>m(e,P_(B));var Nl=e=>ie(Gt(e)),ll=l(2,(e,t)=>{switch(e._tag){case Pe:return ie(e.effect_instruction_i0);case Le:return xe(t(e.effect_instruction_i0))}});var Fi=l(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case Pe:return t(e.effect_instruction_i0);case Le:return r(e.effect_instruction_i0)}}),xs=l(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case Pe:return t(e.effect_instruction_i0);case Le:return r(e.effect_instruction_i0)}}),xe=e=>{let t=new ml(Le);return t.effect_instruction_i0=e,t},Kt=xe(void 0);var Kc=l(3,(e,t,{onFailure:r,onSuccess:o})=>{switch(e._tag){case Pe:switch(t._tag){case Le:return ie(e.effect_instruction_i0);case Pe:return ie(r(e.effect_instruction_i0,t.effect_instruction_i0))}case Le:switch(t._tag){case Le:return xe(o(e.effect_instruction_i0,t.effect_instruction_i0));case Pe:return ie(t.effect_instruction_i0)}}}),EP=(e,t)=>{let r=Nr(e);return tt(r)?m(ot(r),er(m(Ze(r),ll(Re)),(o,n)=>m(o,Kc(n,{onSuccess:(s,i)=>m(s,Qe(i)),onFailure:t}))),ll(Ir),ll(o=>tr(o)),_):S()},Jc=e=>({[$S]:VS,state:Dr(KS([])),blockingOn:e,pipe(){return O(this,arguments)}}),wt=()=>x(rn,e=>D_(e)),D_=e=>E(()=>Jc(e)),it=e=>qe(t=>{let r=Pt(e.state);switch(r._tag){case Dc:return t(r.effect);case rs:return r.joiners.push(t),OP(e,t)}},e.blockingOn),Fh=l(2,(e,t)=>$r(t,e)),Yc=l(2,(e,t)=>E(()=>{let r=Pt(e.state);switch(r._tag){case Dc:return!1;case rs:{or(e.state,xh(t));for(let o=0,n=r.joiners.length;o<n;o++)r.joiners[o](t);return!0}}})),Th=l(2,(e,t)=>Yc(e,t));var gs=l(2,(e,t)=>Yc(e,Y(t)));var q_=e=>x(rn,t=>Yc(e,bl(t)));var Qc=l(2,(e,t)=>Yc(e,y(t)));var Zc=(e,t)=>{let r=Pt(e.state);if(r._tag===rs){or(e.state,xh(t));for(let o=0,n=r.joiners.length;o<n;o++)r.joiners[o](t)}},OP=(e,t)=>E(()=>{let r=Pt(e.state);if(r._tag===rs){let o=r.joiners.indexOf(t);o>=0&&r.joiners.splice(o,1)}}),CP=Ht(mt),sr=()=>CP;var ir=e=>x(sr(),e),Er=l(2,(e,t)=>We(mt,t)(e)),Pl=l(2,(e,t)=>rt(mt,r=>Pn(r,t))(e)),ys=l(2,(e,t)=>ir(r=>Er(e,t(r)))),H_=e=>{let t=e.getFiberRef(mt).unsafeMap.get(yr.key);return t!==void 0&&t._tag==="Span"?_(t):S()},vP={_tag:"Span",spanId:"noop",traceId:"noop",name:"noop",sampled:!1,parent:S(),context:Ot(),status:{_tag:"Ended",startTime:BigInt(0),endTime:BigInt(0),exit:Kt},attributes:new Map,links:[],kind:"internal",attribute(){},event(){},end(){}},W_=e=>{let t=Object.create(vP);return t.name=e,t};var bs=it;var U_=Th;var B_=q_;var Ah=Jc;u();var j_=L_;var z_=xe;u();var G_=Symbol.for("effect/MutableHashMap"),kP={[G_]:G_,[Symbol.iterator](){return new Ph(this)},toString(){return te(this.toJSON())},toJSON(){return{_id:"MutableHashMap",values:Array.from(this).map(J)}},[j](){return this.toJSON()},pipe(){return O(this,arguments)}},Ph=class e{self;referentialIterator;bucketIterator;constructor(t){this.self=t,this.referentialIterator=t.referential[Symbol.iterator]()}next(){if(this.bucketIterator!==void 0)return this.bucketIterator.next();let t=this.referentialIterator.next();return t.done?(this.bucketIterator=new Lh(this.self.buckets.values()),this.next()):t}[Symbol.iterator](){return new e(this.self)}},Lh=class{backing;constructor(t){this.backing=t}currentBucket;next(){if(this.currentBucket===void 0){let r=this.backing.next();if(r.done)return r;this.currentBucket=r.value[Symbol.iterator]()}let t=this.currentBucket.next();return t.done?(this.currentBucket=void 0,this.next()):t}},Ss=()=>{let e=Object.create(kP);return e.referential=new Map,e.buckets=new Map,e.bucketsSize=0,e};var Ge=l(2,(e,t)=>{if(Ks(t)===!1)return e.referential.has(t)?_(e.referential.get(t)):S();let r=t[F](),o=e.buckets.get(r);return o===void 0?S():wP(e,o,t)}),wP=(e,t,r,o=!1)=>{for(let n=0,s=t.length;n<s;n++)if(r[R](t[n][0])){let i=t[n][1];return o&&(t.splice(n,1),e.bucketsSize--),_(i)}return S()},Or=l(2,(e,t)=>W(Ge(e,t))),Wt=l(3,(e,t,r)=>{if(Ks(t)===!1)return e.referential.set(t,r),e;let o=t[F](),n=e.buckets.get(o);return n===void 0?(e.buckets.set(o,[[t,r]]),e.bucketsSize++,e):($_(e,n,t),n.push([t,r]),e.bucketsSize++,e)}),$_=(e,t,r)=>{for(let o=0,n=t.length;o<n;o++)if(r[R](t[o][0])){t.splice(o,1),e.bucketsSize--;return}};var _s=l(2,(e,t)=>{if(Ks(t)===!1)return e.referential.delete(t),e;let r=t[F](),o=e.buckets.get(r);return o===void 0||($_(e,o,t),o.length===0&&e.buckets.delete(r)),e});var Ll=e=>e.referential.size+e.bucketsSize;u();u();var V_=Symbol.for("effect/MutableList"),MP={[V_]:V_,[Symbol.iterator](){let e=!1,t=this.head;return{next(){if(e)return this.return();if(t==null)return e=!0,this.return();let r=t.value;return t=t.next,{done:e,value:r}},return(r){return e||(e=!0),{done:!0,value:r}}}},toString(){return te(this.toJSON())},toJSON(){return{_id:"MutableList",values:Array.from(this).map(J)}},[j](){return this.toJSON()},pipe(){return O(this,arguments)}},RP=e=>({value:e,removed:!1,prev:void 0,next:void 0}),K_=()=>{let e=Object.create(MP);return e.head=void 0,e.tail=void 0,e._length=0,e};var J_=e=>Dh(e)===0,Dh=e=>e._length;var Y_=l(2,(e,t)=>{let r=RP(t);return e.head===void 0&&(e.head=r),e.tail===void 0||(e.tail.next=r,r.prev=e.tail),e.tail=r,e._length+=1,e}),Q_=e=>{let t=e.head;if(t!==void 0)return FP(e,t),t.value};var FP=(e,t)=>{t.removed||(t.removed=!0,t.prev!==void 0&&t.next!==void 0?(t.prev.next=t.next,t.next.prev=t.prev):t.prev!==void 0?(e.tail=t.prev,t.prev.next=void 0):t.next!==void 0?(e.head=t.next,t.next.prev=void 0):(e.tail=void 0,e.head=void 0),e._length>0&&(e._length-=1))};var X_=Symbol.for("effect/MutableQueue"),qh=Symbol.for("effect/mutable/MutableQueue/Empty"),TP={[X_]:X_,[Symbol.iterator](){return Array.from(this.queue)[Symbol.iterator]()},toString(){return te(this.toJSON())},toJSON(){return{_id:"MutableQueue",values:Array.from(this).map(J)}},[j](){return this.toJSON()},pipe(){return O(this,arguments)}},AP=e=>{let t=Object.create(TP);return t.queue=K_(),t.capacity=e,t};var eE=()=>AP(void 0);var tE=l(2,(e,t)=>{let r=Dh(e.queue);return e.capacity!==void 0&&r===e.capacity?!1:(Y_(t)(e.queue),!0)});var rE=l(2,(e,t)=>J_(e.queue)?t:Q_(e.queue));u();u();u();var IP="effect/Clock",Hh=Symbol.for(IP),Jt=Et("effect/Clock"),NP=2**31-1,nE={unsafeSchedule(e,t){let r=Pr(t);if(r>NP)return eo;let o=!1,n=setTimeout(()=>{o=!0,e()},r);return()=>(clearTimeout(n),!o)}},sE=function(){let e=BigInt(1e6);if(typeof performance>"u")return()=>BigInt(Date.now())*e;if(typeof performance.timeOrigin=="number"&&performance.timeOrigin===0)return()=>BigInt(Math.round(performance.now()*1e6));let t=BigInt(Date.now())*e-BigInt(Math.round(performance.now()*1e6));return()=>t+BigInt(Math.round(performance.now()*1e6))}(),PP=function(){let e=typeof process=="object"&&"hrtime"in process&&typeof process.hrtime.bigint=="function"?process.hrtime:void 0;if(!e)return sE;let t=sE()-e.bigint();return()=>t+e.bigint()}(),Wh=class{[Hh]=Hh;unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return PP()}currentTimeMillis=E(()=>this.unsafeCurrentTimeMillis());currentTimeNanos=E(()=>this.unsafeCurrentTimeNanos());scheduler(){return y(nE)}sleep(t){return qe(r=>{let o=nE.unsafeSchedule(()=>r(H),t);return Ee(E(o))})}},Uh=()=>new Wh;u();u();u();var pn=Ay;u();var iE=e=>e.replace(/[/\\^$*+?.()|[\]{}]/g,"\\$&");u();u();var jh="And",zh="Or",Gh="InvalidData",$h="MissingData",Vh="SourceUnavailable",Kh="Unsupported";var WP="effect/ConfigError",aE=Symbol.for(WP),Ti={_tag:"ConfigError",[aE]:aE},Jh=(e,t)=>{let r=Object.create(Ti);return r._op=jh,r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),r},Yh=(e,t)=>{let r=Object.create(Ti);return r._op=zh,r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),r},UP=(e,t,r={pathDelim:"."})=>{let o=Object.create(Ti);return o._op=Gh,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Invalid data at ${m(this.path,so(r.pathDelim))}: "${this.message}")`}}),o},_o=(e,t,r={pathDelim:"."})=>{let o=Object.create(Ti);return o._op=$h,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Missing data at ${m(this.path,so(r.pathDelim))}: "${this.message}")`}}),o},BP=(e,t,r,o={pathDelim:"."})=>{let n=Object.create(Ti);return n._op=Vh,n.path=e,n.message=t,n.cause=r,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`(Source unavailable at ${m(this.path,so(o.pathDelim))}: "${this.message}")`}}),n},jP=(e,t,r={pathDelim:"."})=>{let o=Object.create(Ti);return o._op=Kh,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Unsupported operation at ${m(this.path,so(r.pathDelim))}: "${this.message}")`}}),o};var fn=l(2,(e,t)=>{switch(e._op){case jh:return Jh(fn(e.left,t),fn(e.right,t));case zh:return Yh(fn(e.left,t),fn(e.right,t));case Gh:return UP([...t,...e.path],e.message);case $h:return _o([...t,...e.path],e.message);case Vh:return BP([...t,...e.path],e.message,e.cause);case Kh:return jP([...t,...e.path],e.message)}});u();var lE={_tag:"Empty"};var Hl=l(2,(e,t)=>{let r=Cc(t),o=e;for(;Oc(r);){let n=r.head;switch(n._tag){case"Empty":{r=r.tail;break}case"AndThen":{r=po(n.first,po(n.second,r.tail));break}case"MapName":{o=Tr(o,n.f),r=r.tail;break}case"Nested":{o=ni(o,n.name),r=r.tail;break}case"Unnested":{if(m(Bo(o),Vf(n.name)))o=Rr(o),r=r.tail;else return St(_o(o,`Expected ${n.name} to be in path in ConfigProvider#unnested`));break}}}return Ve(o)});u();var pE="Constant",fE="Fail",mE="Fallback",hE="Described",dE="Lazy",xE="MapOrFail",gE="Nested",yE="Primitive",bE="Sequence",SE="HashMap",_E="ZipWith";var Wl=(e,t)=>[...e,...t],$P="effect/ConfigProvider",EE=Symbol.for($P),Ai=Et("effect/ConfigProvider"),VP="effect/ConfigProviderFlat",OE=Symbol.for(VP),KP=e=>({[EE]:EE,pipe(){return O(this,arguments)},...e}),JP=e=>({[OE]:OE,patch:e.patch,load:(t,r,o=!0)=>e.load(t,r,o),enumerateChildren:e.enumerateChildren}),YP=e=>KP({load:t=>x(cr(e,Ut(),t,!1),r=>Ke(Bo(r),{onNone:()=>G(_o(Ut(),`Expected a single value having structure: ${t}`)),onSome:y})),flattened:e}),CE=e=>{let{pathDelim:t,seqDelim:r}=Object.assign({},{pathDelim:"_",seqDelim:","},e),o=a=>m(a,so(t)),n=a=>a.split(t),s=()=>typeof process<"u"&&"env"in process&&typeof process.env=="object"?process.env:{};return YP(JP({load:(a,p,f=!0)=>{let h=o(a),d=s(),g=h in d?_(d[h]):S();return m(g,nn(()=>_o(a,`Expected ${h} to exist in the process context`)),x(b=>tL(b,a,p,r,f)))},enumerateChildren:a=>E(()=>{let p=s(),d=Object.keys(p).map(g=>n(g.toUpperCase())).filter(g=>{for(let b=0;b<a.length;b++){let M=m(a,Yf(b)),T=g[b];if(T===void 0||M!==T)return!1}return!0}).flatMap(g=>g.slice(a.length,a.length+1));return Nu(d)}),patch:lE}))};var QP=(e,t,r,o)=>{let n=em(r.length,a=>a>=o.length?S():_([e(a),a+1])),s=em(o.length,a=>a>=r.length?S():_([t(a),a+1])),i=Wl(r,n),c=Wl(o,s);return[i,c]},ZP=(e,t)=>{let r=t;if(r._tag==="Nested"){let o=e.slice();for(;r._tag==="Nested";)o.push(r.name),r=r.config;return o}return e},cr=(e,t,r,o)=>{let n=r;switch(n._tag){case pE:return y(_t(n.value));case hE:return I(()=>cr(e,t,n.config,o));case fE:return G(_o(t,n.message));case mE:return m(I(()=>cr(e,t,n.first,o)),br(s=>n.condition(s)?m(cr(e,t,n.second,o),br(i=>G(Yh(s,i)))):G(s)));case dE:return I(()=>cr(e,t,n.config(),o));case xE:return I(()=>m(cr(e,t,n.original,o),x(st(s=>m(n.mapOrFail(s),nn(fn(ZP(t,n.original))))))));case gE:return I(()=>cr(e,Wl(t,_t(n.name)),n.config,o));case yE:return m(Hl(t,e.patch),x(s=>m(e.load(s,n,o),x(i=>{if(i.length===0){let c=m(hu(s),De(()=>"<n/a>"));return G(_o([],`Expected ${n.description} with name ${c}`))}return y(i)}))));case bE:return m(Hl(t,e.patch),x(s=>m(e.enumerateChildren(s),x(oL),x(i=>i.length===0?I(()=>C(cr(e,s,n.config,!0),_t)):m(st(i,c=>cr(e,$y(t,`[${c}]`),n.config,!0)),C(c=>{let a=du(c);return a.length===0?_t(Ut()):_t(a)}))))));case SE:return I(()=>m(Hl(t,e.patch),x(s=>m(e.enumerateChildren(s),x(i=>m(i,st(c=>cr(e,Wl(s,_t(c)),n.valueConfig,o)),C(c=>c.length===0?_t(zn()):m(rL(c),Tr(a=>Xb(Xf(ee(i),a)))))))))));case _E:return I(()=>m(cr(e,t,n.left,o),zr,x(s=>m(cr(e,t,n.right,o),zr,x(i=>{if(no(s)&&no(i))return G(Jh(s.left,i.left));if(no(s)&&oi(i))return G(s.left);if(oi(s)&&no(i))return G(i.left);if(oi(s)&&oi(i)){let c=m(t,so(".")),a=XP(t,c),[p,f]=QP(a,a,m(s.right,Tr(Ve)),m(i.right,Tr(Ve)));return m(p,Xf(f),st(([h,d])=>m(cs(h,d),C(([g,b])=>n.zip(g,b)))))}throw new Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/effect/issues")})))))}},XP=(e,t)=>r=>St(_o(e,`The element at index ${r} in a sequence at path "${t}" was missing`));var eL=(e,t)=>e.split(new RegExp(`\\s*${iE(t)}\\s*`)),tL=(e,t,r,o,n)=>n?m(eL(e,o),st(s=>r.parse(s.trim())),nn(fn(t))):m(r.parse(e),Bc({onFailure:fn(t),onSuccess:_t})),rL=e=>Object.keys(e[0]).map(t=>e.map(r=>r[t])),oL=e=>m(st(e,sL),Bc({onFailure:()=>Ut(),onSuccess:Nn(pn)}),zr,C(pu));var nL=/^(\[(\d+)\])$/,sL=e=>{let t=e.match(nL);if(t!==null){let r=t[2];return m(r!==void 0&&r.length>0?_(r):S(),Xt(iL))}return S()};var iL=e=>{let t=Number.parseInt(e);return Number.isNaN(t)?S():_(t)};u();var vE=Symbol.for("effect/Console"),Eo=Et("effect/Console"),kE={[vE]:vE,assert(e,...t){return E(()=>{console.assert(e,...t)})},clear:E(()=>{console.clear()}),count(e){return E(()=>{console.count(e)})},countReset(e){return E(()=>{console.countReset(e)})},debug(...e){return E(()=>{console.debug(...e)})},dir(e,t){return E(()=>{console.dir(e,t)})},dirxml(...e){return E(()=>{console.dirxml(...e)})},error(...e){return E(()=>{console.error(...e)})},group(e){return e?.collapsed?E(()=>console.groupCollapsed(e?.label)):E(()=>console.group(e?.label))},groupEnd:E(()=>{console.groupEnd()}),info(...e){return E(()=>{console.info(...e)})},log(...e){return E(()=>{console.log(...e)})},table(e,t){return E(()=>{console.table(e,t)})},time(e){return E(()=>console.time(e))},timeEnd(e){return E(()=>console.timeEnd(e))},timeLog(e,...t){return E(()=>{console.timeLog(e,...t)})},trace(...e){return E(()=>{console.trace(...e)})},warn(...e){return E(()=>{console.warn(...e)})},unsafe:console};u();var aL="effect/Random",ME=Symbol.for(aL),Ii=Et("effect/Random"),Qh=class{seed;[ME]=ME;PRNG;constructor(t){this.seed=t,this.PRNG=new Za(t)}get next(){return E(()=>this.PRNG.number())}get nextBoolean(){return C(this.next,t=>t>.5)}get nextInt(){return E(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(t,r){return C(this.next,o=>(r-t)*o+t)}nextIntBetween(t,r){return E(()=>this.PRNG.integer(r-t)+t)}shuffle(t){return uL(t,r=>this.nextIntBetween(0,r))}},uL=(e,t)=>I(()=>m(E(()=>Array.from(e)),x(r=>{let o=[];for(let n=r.length;n>=2;n=n-1)o.push(n);return m(o,Dt(n=>m(t(n),C(s=>lL(r,n-1,s)))),le(Nr(r)))}))),lL=(e,t,r)=>{let o=e[t];return e[t]=e[r],e[r]=o,e},RE=e=>new Qh(w(e));var fL=m(Ot(),ve(Jt,Uh()),ve(Eo,kE),ve(Ii,RE(Math.random())),ve(Ai,CE()),ve(Br,QS)),ye=q(Symbol.for("effect/DefaultServices/currentServices"),()=>Ol(fL)),FE=e=>{let t=nt(e);return Xc(r=>r.sleep(t))},Xc=e=>He(ye,t=>e(Be(t,Jt))),TE=Xc(e=>e.currentTimeMillis),AE=Xc(e=>e.currentTimeNanos),IE=l(2,(e,t)=>rt(ye,ve(Jt,t))(e)),NE=l(2,(e,t)=>rt(ye,ve(Ai,t))(e)),PE=e=>He(ye,t=>e(Be(t,Ai)));var Ul=e=>He(ye,t=>e(Be(t,Ii))),LE=l(2,(e,t)=>rt(ye,ve(Ii,t))(e));var Bl=e=>He(ye,t=>e(Be(t,Br))),DE=l(2,(e,t)=>rt(ye,ve(Br,t))(e));var Zh=FE,jl=TE,qE=AE,HE=Xc,WE=Jt;u();u();function UE(e){return new Jr(e)}function BE(){return UE(new Map)}var ed=Symbol.for("effect/FiberRefs"),Jr=class{locals;[ed]=ed;constructor(t){this.locals=t}pipe(){return O(this,arguments)}},mL=(e,t,r,o=!1)=>{let n=e,s=t,i=r,c=o,a;for(;a===void 0;)if(xt(s)&&xt(i)){let p=gt(s)[0],f=Rr(s),h=gt(i)[0],d=gt(i)[1],g=Rr(i);p.startTimeMillis<h.startTimeMillis?(i=g,c=!0):p.startTimeMillis>h.startTimeMillis?s=f:p.id<h.id?(i=g,c=!0):p.id>h.id?s=f:a=[d,c]}else a=[n.initial,!0];return a},zl=l(3,(e,t,r)=>{let o=new Map(e.locals);return r.locals.forEach((n,s)=>{let i=n[0][1];if(!n[0][0][R](t)){if(!o.has(s)){if(v(i,s.initial))return;o.set(s,[[t,s.join(s.initial,i)]]);return}let c=o.get(s),[a,p]=mL(s,c,n);if(p){let f=s.diff(a,i),h=c[0][1],d=s.join(h,s.patch(f)(h));if(!v(h,d)){let g,b=c[0][0];b[R](t)?g=[[b,d],...c.slice(1)]:g=[[t,d],...c],o.set(s,g)}}}}),new Jr(o)}),rd=l(2,(e,t)=>{let r=new Map;return jE(e,r,t),new Jr(r)}),jE=(e,t,r)=>{e.locals.forEach((o,n)=>{let s=o[0][1],i=n.patch(n.fork)(s);v(s,i)?t.set(n,o):t.set(n,[[r,i],...o])})},zE=e=>Nu(e.locals.keys()),GE=e=>Dt(zE(e),t=>os(t,Es(e,t))),ea=l(2,(e,t)=>{let r=new Map(e.locals);return r.delete(t),new Jr(r)}),Pi=l(2,(e,t)=>e.locals.has(t)?_(gt(e.locals.get(t))[1]):S()),Es=l(2,(e,t)=>m(Pi(e,t),De(()=>t.initial))),Li=l(2,(e,{fiberId:t,fiberRef:r,value:o})=>{if(e.locals.size===0)return new Jr(new Map([[r,[[t,o]]]]));let n=new Map(e.locals);return td(n,t,r,o),new Jr(n)}),td=(e,t,r,o)=>{let n=e.get(r)??[],s;if(xt(n)){let[i,c]=gt(n);if(i[R](t)){if(v(c,o))return;s=[[t,o],...n.slice(1)]}else s=[[t,o],...n]}else s=[[t,o]];e.set(r,s)},$E=l(2,(e,{entries:t,forkAs:r})=>{if(e.locals.size===0)return new Jr(new Map(t));let o=new Map(e.locals);return r!==void 0&&jE(e,o,r),t.forEach(([n,s])=>{s.length===1?td(o,s[0][0],n,s[0][1]):s.forEach(([i,c])=>{td(o,i,n,c)})}),new Jr(o)});var nd=Pi,VE=Es,KE=zl,JE=GE;var YE=$E;var QE=BE;u();var hL=y_,sd=b_,id=S_,cd=__,ad=Eh,ud=Oh,ld=E_,dL=O_;var xL=m(pn,Iy(e=>e.ordinal));var ZE=zf(xL);var XE=e=>{switch(e){case"All":return hL;case"Debug":return ud;case"Error":return id;case"Fatal":return sd;case"Info":return ad;case"Trace":return ld;case"None":return dL;case"Warning":return cd}};u();u();var eO=(e,t)=>({label:e,startTime:t}),tO=e=>t=>`${t.label.replace(/[\s="]/g,"_")}=${e-t.startTime}ms`;var rO=eO,oO=tO;u();u();u();var Yr=Symbol.for("effect/Readable");var wY={[Yr]:Yr,pipe(){return O(this,arguments)}};var $l=Symbol.for("effect/Ref"),dd={_A:e=>e},hd=class{ref;[$l]=dd;[Yr];constructor(t){this.ref=t,this[Yr]=Yr,this.get=E(()=>Pt(this.ref))}get;modify(t){return E(()=>{let r=Pt(this.ref),[o,n]=t(r);return r!==n&&or(n)(this.ref),o})}pipe(){return O(this,arguments)}},Vl=e=>new hd(Dr(e)),Os=e=>E(()=>Vl(e)),ar=e=>e.get,Oo=l(2,(e,t)=>e.modify(()=>[void 0,t])),nO=l(2,(e,t)=>e.modify(r=>[r,t]));var Kl=l(2,(e,t)=>e.modify(t));var ta=l(2,(e,t)=>e.modify(r=>[void 0,t(r)]));var ra=Os,Yl=ar,sO=nO;var iO=Kl;var cO=ta;u();var aO=Bl;u();var lO="Empty",pO="Add",fO="Remove",mO="Update",hO="AndThen",dO={_tag:lO},oa=(e,t)=>{let r=new Map(e.locals),o=dO;for(let[n,s]of t.locals.entries()){let i=gt(s)[1],c=r.get(n);if(c!==void 0){let a=gt(c)[1];v(a,i)||(o=Ql({_tag:mO,fiberRef:n,patch:n.diff(a,i)})(o))}else o=Ql({_tag:pO,fiberRef:n,value:i})(o);r.delete(n)}for(let[n]of r.entries())o=Ql({_tag:fO,fiberRef:n})(o);return o},Ql=l(2,(e,t)=>({_tag:hO,first:e,second:t})),Zl=l(3,(e,t,r)=>{let o=r,n=_t(e);for(;xt(n);){let s=gt(n),i=Rr(n);switch(s._tag){case lO:{n=i;break}case pO:{o=Li(o,{fiberId:t,fiberRef:s.fiberRef,value:s.value}),n=i;break}case fO:{o=ea(o,s.fiberRef),n=i;break}case mO:{let c=Es(o,s.fiberRef);o=Li(o,{fiberId:t,fiberRef:s.fiberRef,value:s.fiberRef.patch(s.patch)(c)}),n=i;break}case hO:{n=ni(s.first)(ni(s.second)(i));break}}}return o});u();var gO="effect/MetricLabel",gd=Symbol.for(gO),yd=class{key;value;[gd]=gd;_hash;constructor(t,r){this.key=t,this.value=r,this._hash=ce(gO+this.key+this.value)}[F](){return this._hash}[R](t){return yL(t)&&this.key===t.key&&this.value===t.value}pipe(){return O(this,arguments)}},Cs=(e,t)=>new yd(e,t),yL=e=>k(e,gd);var yO=l(e=>ue(e[0]),function(){let e=arguments;return rt(e[0],an,typeof e[1]=="string"?xr(e[1],e[2]):t=>Object.entries(e[1]).reduce((r,[o,n])=>xr(r,o,n),t))}),tp=e=>C(e,_),bO=e=>nn(e,_),Sd=e=>{let t,r;return typeof e=="function"?t=e:(t=e.try,r=e.catch),E(()=>{try{return t()}catch(o){throw c_(Ko(r?r(o):new un(o)))}})},SO=l(3,(e,t,r)=>br(e,o=>k(o,t)&&o[t]===r.failure?r.onFailure(o):G(o))),_O=l(2,(e,t)=>jr(e,r=>{let o=Jo(r,n=>Oi(n)?_(n):S());switch(o._tag){case"None":return Y(r);case"Some":return t(o.value.defect)}})),EO=l(2,(e,t)=>Se(e,{onFailure:r=>{let o=t(r);switch(o._tag){case"None":return Y(r);case"Some":return o.value}},onSuccess:y})),OO=l(2,(e,t)=>jr(e,r=>{let o=Jo(r,n=>Oi(n)?_(n):S());switch(o._tag){case"None":return Y(r);case"Some":{let n=t(o.value.defect);return n._tag==="Some"?n.value:Y(r)}}})),CO=l(3,(e,t,r)=>Wc(e,Rn(t),r)),vO=l(2,(e,t)=>{let r;return Wc(e,o=>(r??=Object.keys(t),k(o,"_tag")&&Ya(o._tag)&&r.includes(o._tag)),o=>t[o._tag](o))}),kO=e=>Uc(e,{onFailure:B,onSuccess:()=>gr}),Qr=HE,wO=Qr(y),MO=l(2,(e,t)=>ne(Zh(t),e)),rp=e=>re((t,r)=>e({id:t.id(),status:r,interruptors:Nc(t.getFiberRef(fs))})),RO=rp(e=>Wn(e.interruptors)>0?yl:H),FO=rp(y),Di=e=>ca(e,op,oa),bL=e=>ca(e,cs(op,ki),([t,r],[o,n])=>[oa(t,o),nr(r,n)]),TO=y({}),AO=Ja(C,x),IO=Ka(C),NO=Va(C),PO=l(2,(e,t)=>I(()=>{let r=e[Symbol.iterator](),o=[],n,s=y(!1),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,a=i++;s=x(s,p=>p?(o.push(c),y(!0)):t(c,a))}return C(s,()=>o)})),LO=l(2,(e,t)=>I(()=>{let r=e[Symbol.iterator](),o=[],n,s=y(!0),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,a=i++;s=x(s,p=>C(p?t(c,a):y(!1),f=>(f||o.push(c),f)))}return C(s,()=>o)})),DO=e=>C(sr(),e),_d=e=>ss(e,()=>x(Vr(),()=>_d(e))),qO=l(2,(e,t)=>C(st(e,B),si(t))),HO=l(3,(e,t,r)=>na(e,t,o=>en(()=>r(o)))),WO=l(3,(e,t,r)=>na(e,t,()=>Xo(r))),na=l(3,(e,t,r)=>x(e,o=>t(o)?y(o):r(o))),UO=l(3,(e,t,r)=>I(()=>t(e)?y(e):G(r(e)))),BO=l(e=>ue(e[0]),(e,t,r)=>na(e,t,o=>r===void 0?G(new Vt):Sr(()=>r(o)))),jO=l(2,(e,t)=>I(()=>{let r=e[Symbol.iterator](),o=r.next();return o.done?y(S()):zO(r,0,t,o.value)})),zO=(e,t,r,o)=>x(r(o,t),n=>{if(n)return y(_(o));let s=e.next();return s.done?y(S()):zO(e,t+1,r,s.value)}),GO=e=>I(()=>{let t=Nr(e);return tt(t)?m(ot(t),er(Ze(t),(r,o)=>ss(r,()=>o))):en(()=>new zc("Received an empty collection of effects"))}),$O=l(2,(e,t)=>on(t(on(e)))),sa=l(2,(e,t)=>Xe(e,{onFailure:r=>y(t.onFailure(r)),onSuccess:r=>y(t.onSuccess(r))})),VO=l(2,(e,t)=>I(()=>KO(e[Symbol.iterator](),0,t))),KO=(e,t,r)=>{let o=e.next();return o.done?y(!0):x(r(o.value,t),n=>n?KO(e,t+1,r):y(n))},Ed=e=>{let t=x(x(e,()=>Vr()),()=>t);return t},JO=function(){let e;return arguments.length===1?e=arguments[0]:e=arguments[1].bind(arguments[0]),I(()=>{let t=e(m),r=Ne(()=>t.next()),o=n=>n.done?y(n.value):x($s(n.value),s=>o(Ne(()=>t.next(s))));return o(r)})},op=re(e=>y(e.getFiberRefs())),YO=e=>x(e,t=>{let o=t[Symbol.iterator]().next();return o.done?G(new Vt):y(o.value)}),Od=e=>sa(e,{onFailure:Lo,onSuccess:Lo}),QO=e=>Se(e,{onFailure:t=>vd(t,"An error was silently ignored because it is not anticipated to be useful"),onSuccess:()=>H}),ZO=e=>sp((t,r)=>KE(r,t,e)),XO=e=>sa(e,{onFailure:Po,onSuccess:eo}),eC=e=>sa(e,{onFailure:eo,onSuccess:Po}),Cd=(e,t)=>I(()=>t.while(e)?x(t.body(e),r=>Cd(r,t)):y(e)),Co=e=>(...t)=>{let r=hr(e),o;for(let n=0,s=t.length;n<s;n++){let i=t[n];ol(i)&&(o!==void 0?o=je(o,i):o=i,t=[...t.slice(0,n),...t.slice(n+1)],n--)}return o===void 0&&(o=gr),re(n=>(n.log(t,o,r),H))},tC=Co(),rC=Co(ld),vd=Co(ud),oC=Co(ad),nC=Co(cd),sC=Co(id),iC=Co(sd),cC=l(2,(e,t)=>x(jl,r=>rt(e,vl,zu(rO(t,r))))),aC=Ht(an),uC=(e,t)=>t.discard?pC(e,t.while,t.step,t.body):C(lC(e,t.while,t.step,t.body),ee),lC=(e,t,r,o)=>I(()=>t(e)?x(o(e),n=>C(lC(r(e),t,r,o),zu(n))):E(()=>Hr())),pC=(e,t,r,o)=>I(()=>t(e)?x(o(e),()=>pC(r(e),t,r,o)):H),fC=l(3,(e,t,r)=>I(()=>{let o=e[Symbol.iterator](),n=[],s=y(t),i,c=0;for(;!(i=o.next()).done;){let a=c++,p=i.value;s=x(s,f=>C(r(f,p,a),([h,d])=>(n.push(d),h)))}return C(s,a=>[a,n])})),qi=l(2,(e,t)=>Se(e,{onFailure:r=>tn(()=>t(r)),onSuccess:y})),kd=e=>m(wt(),x(t=>m(bL(e),$r(t),wd,C(r=>ne(r,m(it(t),x(([o,n])=>le(cs(vs(o[0]),sn(o[1])),n)))))))),mC=e=>Xe(e,{onFailure:t=>y(t),onSuccess:y}),np=e=>C(e,t=>!t),hC=e=>x(e,t=>{switch(t._tag){case"None":return H;case"Some":return G(new Vt)}}),wd=e=>C(ra(!0),t=>Ee(wi(e,sO(t,!1)))),dC=e=>Xe(e,{onFailure:()=>y(S()),onSuccess:t=>y(_(t))}),xC=l(2,(e,t)=>ss(e,()=>Sr(t))),gC=l(2,(e,t)=>ss(e,()=>E(t))),yC=e=>Se(e,{onFailure:t=>{let r=ee(Ic(t));return r.length===0?Y(t):G(r)},onSuccess:y}),vs=e=>sp((t,r)=>m(e,Zl(t,r))),bC=e=>e.length>=1?qe((t,r)=>{e(r).then(o=>t(xe(o)),o=>t(Il(o)))}):qe(t=>{e().then(r=>t(xe(r)),r=>t(Il(r)))}),Hi=l(3,(e,t,r)=>ir(o=>Er(e,ve(o,t,r)))),SC=l(3,(e,t,r)=>ir(o=>x(r,n=>Er(e,m(o,ve(t,n)))))),_C=Ul(y),EC=l(3,(e,t,r)=>ee(e).reduce((o,n,s)=>x(o,i=>r(i,n,s)),y(t))),OC=l(3,(e,t,r)=>ee(e).reduceRight((o,n,s)=>x(o,i=>r(n,i,s)),y(t))),CC=l(3,(e,t,r)=>x(E(()=>e[Symbol.iterator]()),o=>vC(o,0,t,r.while,r.body))),vC=(e,t,r,o,n)=>{let s=e.next();return!s.done&&o(r)?x(n(r,s.value,t),i=>vC(e,t+1,i,o,n)):y(r)},kC=l(2,(e,t)=>I(()=>wC(e,t))),wC=(e,t)=>x(e,r=>t<=0?y(r):ne(Vr(),wC(e,t-1))),MC=e=>Se(e,{onFailure:G,onSuccess:y}),RC=e=>I(()=>JE(e)),ks=Zh,ia=y(S()),FC=e=>y(_(e)),ca=l(3,(e,t,r)=>x(t,o=>x(e,n=>C(t,s=>[r(o,s),n])))),TC=l(e=>ue(e[0]),function(){return Md(arguments[0],typeof arguments[1]=="string"?[Cs(arguments[1],arguments[2])]:Object.entries(arguments[1]).map(([e,t])=>Cs(e,t)))}),Md=l(2,(e,t)=>rt(e,bo,r=>Fr(r,t))),AC=l(2,(e,t)=>I(()=>{let r=e[Symbol.iterator](),o=[],n,s=y(!1),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,a=i++;s=x(s,p=>p?y(!0):(o.push(c),t(c,a)))}return C(s,()=>o)})),IC=l(2,(e,t)=>I(()=>{let r=e[Symbol.iterator](),o=[],n,s=y(!0),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,a=i++;s=x(s,p=>m(p?t(c,a):y(!1),C(f=>(f&&o.push(c),f))))}return C(s,()=>o)})),NC=l(2,(e,{onFailure:t,onSuccess:r})=>Se(e,{onFailure:o=>{let n=Ur(o);switch(n._tag){case"Left":return ne(t(n.left),Y(o));case"Right":return Y(o)}},onSuccess:o=>le(r(o),o)})),PC=l(2,(e,t)=>jr(e,r=>Ke(hh(r),{onNone:()=>Y(r),onSome:o=>ne(t(o),Y(r))}))),Rd=l(2,(e,t)=>Se(e,{onFailure:r=>{let o=Ur(r);switch(o._tag){case"Left":return ne(t(o.left),Y(r));case"Right":return Y(r)}},onSuccess:y})),LC=l(3,(e,t,r)=>Rd(e,o=>Rn(o,t)?r(o):H)),DC=l(2,(e,t)=>Se(e,{onFailure:r=>ne(t(r),Y(r)),onSuccess:y})),qC=e=>Fd(e,qE),Fd=l(2,(e,t)=>ca(e,t,(r,o)=>yc(o-r))),SL=aO,HC=SL(y),Td=e=>{let t,r;return typeof e=="function"?t=e:(t=e.try,r=e.catch),t.length>=1?qe((o,n)=>{try{t(n).then(s=>o(xe(s)),s=>o(G(r?r(s):new un(s))))}catch(s){o(G(r?r(s):new un(s)))}}):qe(o=>{try{t().then(n=>o(xe(n)),n=>o(G(r?r(n):new un(n))))}catch(n){o(G(r?r(n):new un(n)))}})},WC=l(2,(e,t)=>x(e,r=>Sd({try:()=>t.try(r),catch:t.catch}))),UC=l(2,(e,t)=>x(e,r=>Td({try:t.try.length>=1?o=>t.try(r,o):()=>t.try(r),catch:t.catch}))),BC=l(2,(e,t)=>I(()=>t()?ia:tp(e))),jC=l(2,(e,t)=>x(t,r=>r?ia:tp(e))),zC=e=>qi(e,dh),sp=e=>re(t=>(t.setFiberRefs(e(t.id(),t.getFiberRefs())),H)),GC=l(3,(e,t,r)=>ys(e,o=>ve(o,t,r(ci(o,t))))),ip=l(2,(e,t)=>I(()=>t()?C(e,_):y(S()))),$C=l(3,(e,t,r)=>x(Ht(t),o=>r(o)?C(e,n=>[o,_(n)]):y([o,S()]))),VC=l(3,(e,t,r)=>x(Yl(t),o=>r(o)?C(e,n=>[o,_(n)]):y([o,S()]))),KC=l(2,(e,t)=>t(e)),JC=(e,t)=>(...r)=>x(e,o=>t(o)(...r)),YC=(e,t)=>(...r)=>C(e,o=>t(o)(...r)),Ad=e=>new Proxy({},{get(t,r,o){return(...n)=>x(e,s=>s[r](...n))}}),Id=e=>new Proxy({},{get(t,r,o){return x(e,n=>ue(n[r])?n[r]:y(n[r]))}}),QC=e=>({functions:Ad(e),constants:Id(e)}),ZC=e=>C(sr(),dr(e)),Nd=e=>x(sr(),dr(e)),XC=function(){let e=arguments;return Od(x(Pd,t=>E(()=>{if(typeof e[0]=="string")t.attribute(e[0],e[1]);else for(let r in e[0])t.attribute(r,e[0][r])})))},ev=l(e=>ue(e[0]),function(){let e=arguments;return rt(e[0],jc,typeof e[1]=="string"?xr(e[1],e[2]):t=>Object.entries(e[1]).reduce((r,[o,n])=>xr(r,o,n),t))}),tv=Nd(yr),Pd=x(sr(),e=>{let t=e.unsafeMap.get(yr.key);return t!==void 0&&t._tag==="Span"?y(t):G(new Vt)}),rv=l(e=>ue(e[0]),(e,t,r)=>rt(e,wl,gu({_tag:"SpanLink",span:t,attributes:r??{}}))),ov=BigInt(0),cp=(e,t,r)=>{if(e.getFiberRef(Mh)===!1)return W_(t);let n=e.getFiberRef(mt),s=e.getFiberRef(ye),i=Be(s,Br),c=Be(s,WE),a=e.getFiberRef(Ri),p=e.getFiberRefs(),f=nd(p,jc),h=nd(p,wl),d=r.parent?_(r.parent):r.root?S():dr(n,yr),g=h._tag==="Some"?r.links!==void 0?[...tr(h.value),...r.links??[]]:tr(h.value):r.links??Ut(),b=i.span(t,d,r.context??Ot(),g,a?c.unsafeCurrentTimeNanos():ov,r.kind??"internal");return typeof r.captureStackTrace=="function"&&Lc.set(b,r.captureStackTrace),f._tag==="Some"&&nS(f.value,(M,T)=>b.attribute(T,M)),r.attributes!==void 0&&Object.entries(r.attributes).forEach(([M,T])=>b.attribute(M,T)),b},nv=(e,t)=>(t=ho(t),re(r=>y(cp(r,e,t)))),sv=Ht(jc),iv=Ht(wl),Ld=(e,t,r,o)=>E(()=>{e.status._tag!=="Ended"&&(Rh(t)&&Lc.has(e)&&e.attribute("code.stacktrace",Lc.get(e)()),e.end(o?r.unsafeCurrentTimeNanos():ov,t))}),Xl=(e,...t)=>{let r=ho(t.length===1?void 0:t[0]),o=t[t.length-1];return re(n=>{let s=cp(n,e,r),i=n.getFiberRef(Ri),c=Be(n.getFiberRef(ye),Jt);return yt(o(s),a=>Ld(s,a,c,i))})},ep=l(2,(e,t)=>Hi(e,yr,t)),Dd=function(){let e=typeof arguments[0]!="string",t=e?arguments[1]:arguments[0],r=ho(e?arguments[2]:arguments[1]);if(e){let o=arguments[0];return Xl(t,r,n=>ep(o,n))}return o=>Xl(t,r,n=>ep(o,n))},cv=e=>function(){let t=e.captureStackTrace??!1;if(e.captureStackTrace!==!1){let r=Error.stackTraceLimit;Error.stackTraceLimit=2;let o=new Error;Error.stackTraceLimit=r;let n=!1;t=()=>{if(n!==!1)return n;if(o.stack)return n=o.stack.trim().split(`
`).slice(2).join(`
`).trim(),n}}return I(()=>{let r=typeof e.options=="function"?e.options.apply(null,arguments):e.options;return Dd(I(()=>Ne(()=>e.body.apply(this,arguments))),r.name,{...r,captureStackTrace:t})})},av=e=>e==null?G(new Vt):y(e),uv=e=>br(C(e,_),t=>A_(t)?ia:G(t));u();u();var qd=Pf;var lv=oo;u();u();var fv="Sequential",mv="Parallel",_L="ParallelN",Zr={_tag:fv},hv={_tag:mv},dv=e=>({_tag:_L,parallelism:e}),Hd=e=>e._tag===fv,Wd=e=>e._tag===mv;var up=Zr,lp=hv,pp=dv;u();var ws=oa;var Ms=Zl;u();u();var mp="effect/FiberStatus",mn=Symbol.for(mp),fp="Done",gv="Running",yv="Suspended",EL=ce(`${mp}-${fp}`),Bd=class{[mn]=mn;_tag=fp;[F](){return EL}[R](t){return hp(t)&&t._tag===fp}},jd=class{runtimeFlags;[mn]=mn;_tag=gv;constructor(t){this.runtimeFlags=t}[F](){return m(w(mp),L(w(this._tag)),L(w(this.runtimeFlags)),V(this))}[R](t){return hp(t)&&t._tag===gv&&this.runtimeFlags===t.runtimeFlags}},zd=class{runtimeFlags;blockingOn;[mn]=mn;_tag=yv;constructor(t,r){this.runtimeFlags=t,this.blockingOn=r}[F](){return m(w(mp),L(w(this._tag)),L(w(this.runtimeFlags)),L(w(this.blockingOn)),V(this))}[R](t){return hp(t)&&t._tag===yv&&this.runtimeFlags===t.runtimeFlags&&v(this.blockingOn,t.blockingOn)}},bv=new Bd,Sv=e=>new jd(e),_v=(e,t)=>new zd(e,t),hp=e=>k(e,mn),Ev=e=>e._tag===fp;var Ov=bv,Gd=Sv,Cv=_v;var vv=Ev;u();var Iv=Symbol.for("effect/Micro"),Yt=Symbol.for("effect/Micro/runSymbol"),wv=e=>typeof e=="object"&&e!==null&&Iv in e,Mv=Symbol.for("effect/Micro/MicroCause"),CL={_E:B},dp=class extends globalThis.Error{_tag;traces;[Mv];constructor(t,r,o){let n=`MicroCause.${t}`,s,i,c;if(r instanceof globalThis.Error){s=`(${n}) ${r.name}`,i=r.message;let a=i.split(`
`).length;c=r.stack?`(${n}) ${r.stack.split(`
`).slice(0,a+3).join(`
`)}`:`${s}: ${i}`}else s=n,i=qo(r,0),c=`${s}: ${i}`;o.length>0&&(c+=`
    ${o.join(`
    `)}`),super(i),this._tag=t,this.traces=o,this[Mv]=CL,this.name=s,this.stack=c}pipe(){return O(this,arguments)}toString(){return this.stack}[j](){return this.stack}};var Kd=class extends dp{defect;constructor(t,r=[]){super("Die",t,r),this.defect=t}},vL=(e,t=[])=>new Kd(e,t),Jd=class extends dp{constructor(t=[]){super("Interrupt","interrupted",t)}},kL=(e=[])=>new Jd(e);var xp=St(kL()),ua=Ve;var Nv=e=>St(vL(e));var wL=Symbol.for("effect/Micro/Env"),Rv=Symbol.for("effect/Micro/EnvRef"),ML={[wL]:{_R:B},pipe(){return O(this,arguments)}},Zd=e=>{let t=Object.create(ML);return t.refs=e,t},Pv=()=>{let e=new AbortController,t=Object.create(null);return t[bp.key]=e,t[Rs.key]=e.signal,t[Uv.key]=new gp,Zd(t)},Fs=l(2,(e,t)=>t.key in e.refs?e.refs[t.key]:t.initial),Lv=l(3,(e,t,r)=>{let o=Object.assign(Object.create(null),e.refs);return o[t.key]=r,Zd(o)}),Dv=l(2,(e,t)=>Zd(t(Object.assign(Object.create(null),e.refs))));var RL="setImmediate"in globalThis?globalThis.setImmediate:e=>setTimeout(e,0),gp=class{tasks=[];running=!1;scheduleTask(t,r){this.tasks.push(t),this.running||(this.running=!0,RL(this.afterScheduled))}afterScheduled=()=>{this.running=!1,this.runTasks()};runTasks(){let t=this.tasks;this.tasks=[];for(let r=0,o=t.length;r<o;r++)t[r]()}shouldYield(t){return!1}flush(){for(;this.tasks.length>0;)this.runTasks()}},FL={[Rv]:Rv},Ts=(e,t)=>q(e,()=>{let r=Object.create(FL);return r.key=e,r.initial=t(),r}),bp=Ts("effect/Micro/currentAbortController",()=>{}),Rs=Ts("effect/Micro/currentAbortSignal",()=>{}),qv=Ts("effect/Micro/currentContext",()=>Ot()),TL=Ts("effect/Micro/currentConcurrency",()=>"unbounded"),Hv=Ts("effect/Micro/currentMaxDepthBeforeYield",()=>2048),Wv=Ts("effect/Micro/currentInterruptible",()=>!0),Uv=Ts("effect/Micro/currentScheduler",()=>new gp);var AL={...lv,_op:"Micro",[Iv]:{_A:B,_E:B,_R:B},[Symbol.iterator](){return new Qo(new Mr(this))}},Ui=q("effect/Micro/microDepthState",()=>({depth:0,maxDepthBeforeYield:Hv.initial})),IL=e=>{let t=Object.create(AL);return t[Yt]=e,t},Bv=(e,t)=>IL(function r(o,n){if(t&&o.refs[Wv.key]!==!1&&o.refs[Rs.key].aborted)return n(xp);Ui.depth++,Ui.depth===1&&(Ui.maxDepthBeforeYield=Fs(o,Hv));let s=o.refs[Uv.key];if(Ui.depth>=Ui.maxDepthBeforeYield||s.shouldYield(o))s.scheduleTask(()=>r(o,n),0);else try{e(o,n)}catch(i){n(Nv(i))}Ui.depth--}),vo=e=>Bv(e,!0),aa=e=>vo(function(t,r){r(e)});var Yd=e=>aa(ua(e));var Qd=e=>vo(function(t,r){r(ua(e()))});var yp=e=>vo(function(t,r){e()[Yt](t,r)}),Fv=Yd(void 0);var NL=e=>vo(function(t,r){let o=!1,n=e.length>1?new AbortController:void 0,s=Fs(t,Rs),i;function c(){a(i?WL(LL(i,aa(xp))):aa(xp)),n!==void 0&&n.abort()}function a(p){o||(o=!0,s.removeEventListener("abort",c),p[Yt](t,r))}i=n===void 0?e(a):e(a,n.signal),!o&&s.addEventListener("abort",c)});var PL=l(2,(e,t)=>vo(function(r,o){e[Yt](r,function(n){o(n._tag==="Left"?n:ua(t(n.right)))})}));var jv=l(2,(e,t)=>vo(function(r,o){e[Yt](r,function(n){if(n._tag==="Left")return o(n);t(n.right)[Yt](r,o)})}));var LL=l(2,(e,t)=>vo(function(r,o){e[Yt](r,function(n){if(n._tag==="Left")return o(n);if(Fs(r,Rs).aborted)return o(xp);let s=wv(t)?t:typeof t=="function"?t(n.right):t;wv(s)?s[Yt](r,o):o(ua(s))})}));var DL=e=>PL(e,t=>{}),qL=e=>vo(function(t,r){e[Yt](t,function(o){r(ua(o))})});function HL(e){let t=new AbortController,r=Fs(e,Rs);function o(){t.abort(),r.removeEventListener("abort",o)}return r.addEventListener("abort",o),[Dv(e,function(s){return s[bp.key]=t,s[Rs.key]=t.signal,s}),o]}var $d=Symbol.for("effect/Micro/MicroScope");var Tv=class e{[$d];state={_tag:"Open",finalizers:new Set};constructor(){this[$d]=$d}unsafeAddFinalizer(t){this.state._tag==="Open"&&this.state.finalizers.add(t)}addFinalizer(t){return yp(()=>this.state._tag==="Open"?(this.state.finalizers.add(t),Fv):t(this.state.exit))}unsafeRemoveFinalizer(t){this.state._tag==="Open"&&this.state.finalizers.delete(t)}close(t){return yp(()=>{if(this.state._tag==="Open"){let r=Array.from(this.state.finalizers).reverse();return this.state={_tag:"Closed",exit:t},jv(UL(r,o=>qL(o(t))),o=>DL(aa(Ty(o))))}return Fv})}get fork(){return Qd(()=>{let t=new e;if(this.state._tag==="Closed")return t.state=this.state,t;function r(o){return t.close(o)}return this.state.finalizers.add(r),t.unsafeAddFinalizer(o=>Qd(()=>this.unsafeRemoveFinalizer(r))),t})}};var WL=e=>Bv(function(t,r){let o=Dv(t,function(n){return n[Wv.key]=!1,n[Rs.key]=new AbortController().signal,n});e[Yt](o,r)},!1);var UL=(e,t,r)=>vo(function(o,n){let s=r?.concurrency==="inherit"?Fs(o,TL):r?.concurrency??1,i=s==="unbounded"?Number.POSITIVE_INFINITY:Math.max(1,s),[c,a]=HL(o),p,f=Array.from(e),h=f.length,d=r?.discard?void 0:new Array(h),g=0,b=0,M=0,T=!1;function P(){for(T=!0;b<i&&g<h;){let K=g,ae=f[K];g++,b++;try{t(ae,K)[Yt](c,function(_e){_e._tag==="Left"?p===void 0&&(p=_e,h=g,a()):d!==void 0&&(d[K]=_e.right),M++,b--,M===h?n(p??Ve(d)):!T&&b<i&&P()})}catch(_e){p=Nv(_e),h=g,a()}}T=!1}P()});var Vd=Symbol.for("effect/Micro/Handle");var Av=class{parentSignal;[Vd];observers=new Set;_exit=void 0;_controller;isRoot;constructor(t,r){this.parentSignal=t,this[Vd]=Vd,this.isRoot=r!==void 0,this._controller=r??new AbortController,this.isRoot||t.addEventListener("abort",this.unsafeInterrupt)}unsafePoll(){return this._exit??null}unsafeInterrupt=()=>{this._controller.abort()};emit(t){this._exit||(this._exit=t,this.isRoot||this.parentSignal.removeEventListener("abort",this.unsafeInterrupt),this.observers.forEach(r=>r(t)),this.observers.clear())}addObserver(t){if(this._exit)return t(this._exit);this.observers.add(t)}removeObserver(t){this.observers.delete(t)}get await(){return yp(()=>this._exit?Yd(this._exit):NL(t=>{function r(o){t(Yd(o))}return this.addObserver(r),Qd(()=>{this.removeObserver(r)})}))}get join(){return jv(this.await,aa)}get interrupt(){return yp(()=>(this.unsafeInterrupt(),this.await))}};u();var Sp=class{buckets=[];scheduleTask(t,r){let o,n;for(n=0;n<this.buckets.length&&this.buckets[n][0]<=r;n++)o=this.buckets[n];if(o)o[1].push(t);else{let s=[];for(let i=0;i<n;i++)s.push(this.buckets[i]);s.push([r,[t]]);for(let i=n;i<this.buckets.length;i++)s.push(this.buckets[i]);this.buckets=s}}},Xd=class{maxNextTickBeforeTimer;running=!1;tasks=new Sp;constructor(t){this.maxNextTickBeforeTimer=t}starveInternal(t){let r=this.tasks.buckets;this.tasks.buckets=[];for(let[o,n]of r)for(let s=0;s<n.length;s++)n[s]();this.tasks.buckets.length===0?this.running=!1:this.starve(t)}starve(t=0){t>=this.maxNextTickBeforeTimer?setTimeout(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(t+1))}shouldYield(t){return t.currentOpCount>t.getFiberRef(Cl)?t.getFiberRef(cn):!1}scheduleTask(t,r){this.tasks.scheduleTask(t,r),this.running||(this.running=!0,this.starve())}},Gv=q(Symbol.for("effect/Scheduler/defaultScheduler"),()=>new Xd(2048)),_p=class{tasks=new Sp;deferred=!1;scheduleTask(t,r){this.deferred?Gv.scheduleTask(t,r):this.tasks.scheduleTask(t,r)}shouldYield(t){return t.currentOpCount>t.getFiberRef(Cl)?t.getFiberRef(cn):!1}flush(){for(;this.tasks.buckets.length>0;){let t=this.tasks.buckets;this.tasks.buckets=[];for(let[r,o]of t)for(let n=0;n<o.length;n++)o[n]()}this.deferred=!0}};var hn=q(Symbol.for("effect/FiberRef/currentScheduler"),()=>Te(Gv)),$v=l(2,(e,t)=>We(e,hn,t));u();var Ep=q(Symbol.for("effect/FiberRef/currentRequestMap"),()=>Te(new Map));u();var tx=(e,t,r,o)=>{switch(e){case void 0:return t();case"unbounded":return r();case"inherit":return He(kl,n=>n==="unbounded"?r():n>1?o(n):t());default:return e>1?o(e):t()}},la=(e,t,r)=>{switch(e){case void 0:return t();case"unbounded":return r();case"inherit":return He(kl,o=>o==="unbounded"||o>1?r():t());default:return e>1?r():t()}};u();u();u();var Op="InterruptSignal",Cp="Stateful",vp="Resume",kp="YieldNow",wp=e=>({_tag:Op,cause:e}),Bi=e=>({_tag:Cp,onFiber:e}),As=e=>({_tag:vp,effect:e}),Vv=()=>({_tag:kp});var zL="effect/FiberScope",Mp=Symbol.for(zL),rx=class{[Mp]=Mp;fiberId=zt;roots=new Set;add(t,r){this.roots.add(r),r.addObserver(()=>{this.roots.delete(r)})}},ox=class{fiberId;parent;[Mp]=Mp;constructor(t,r){this.fiberId=t,this.parent=r}add(t,r){this.parent.tell(Bi(o=>{o.addChild(r),r.addObserver(()=>{o.removeChild(r)})}))}},Jv=e=>new ox(e.id(),e),dn=q(Symbol.for("effect/FiberScope/Global"),()=>new rx);var GL="effect/Fiber",pa=Symbol.for(GL),fa={_E:e=>e,_A:e=>e},$L={[pa]:fa,pipe(){return O(this,arguments)}},VL="effect/Fiber",Qv=Symbol.for(VL);var nx=e=>e.await;var Zv=e=>e.inheritAll;var Xv=l(2,(e,t)=>e.interruptAsFork(t)),xn=e=>as(kt(e.await),e.inheritAll);var A4={...$L,id:()=>zt,await:us,children:y([]),inheritAll:us,poll:y(S()),interruptAsFork:()=>us};var gn="effect/FiberCurrent";u();var KL="effect/Logger",tk=Symbol.for(KL),rk={_Message:e=>e,_Output:e=>e},Rp=e=>({[tk]:rk,log:e,pipe(){return O(this,arguments)}});var L4={[tk]:rk,log:Lo,pipe(){return O(this,arguments)}};var ok=Rp(({annotations:e,cause:t,date:r,fiberId:o,logLevel:n,message:s,spans:i})=>{let c=r.getTime(),p=[`timestamp=${r.toISOString()}`,`level=${n.label}`,`fiber=${Wu(o)}`].join(" "),f=Gy(s);for(let h=0;h<f.length;h++){let d=qo(f[h]);d.length>0&&(p=p+" message=",p=sx(d,p))}if(t!=null&&t._tag!=="Empty"&&(p=p+" cause=",p=sx(Yo(t,{renderErrorCause:!0}),p)),Oc(i)){p=p+" ";let h=!0;for(let d of i)h?h=!1:p=p+" ",p=p+m(d,oO(c))}if(tS(e)>0){p=p+" ";let h=!0;for(let[d,g]of e)h?h=!1:p=p+" ",p=p+QL(d),p=p+"=",p=sx(qo(g),p)}return p}),JL=e=>`"${e.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`,YL=/^[^\s"=]+$/,sx=(e,t)=>t+(e.match(YL)?e:JL(e));var QL=e=>e.replace(/[\s="]/g,"_");var Is={bold:"1",red:"31",green:"32",yellow:"33",blue:"34",cyan:"36",white:"37",gray:"90",black:"30",bgBrightRed:"101"},D4={None:[],All:[],Trace:[Is.gray],Debug:[Is.blue],Info:[Is.green],Warning:[Is.yellow],Error:[Is.red],Fatal:[Is.bgBrightRed,Is.black]};var q4=typeof process=="object"&&process!==null&&typeof process.stdout=="object"&&process.stdout!==null&&process.stdout.isTTY===!0;var H4=typeof self=="object"&&self!==null&&typeof self.constructor=="function"&&self.constructor.name.includes("Worker");u();u();var nk="effect/MetricBoundaries",ix=Symbol.for(nk),cx=class{values;[ix]=ix;constructor(t){this.values=t,this._hash=m(ce(nk),L(It(this.values)))}_hash;[F](){return this._hash}[R](t){return XL(t)&&v(this.values,t.values)}pipe(){return O(this,arguments)}},XL=e=>k(e,ix),e2=e=>{let t=m(e,Jf(Re(Number.POSITIVE_INFINITY)),tm);return new cx(t)};var sk=e=>m(Kf(e.count-1,t=>e.start*Math.pow(e.factor,t)),ai,e2);u();u();var r2="effect/MetricKeyType",ma=Symbol.for(r2),uk="effect/MetricKeyType/Counter",ax=Symbol.for(uk),lk="effect/MetricKeyType/Frequency",ux=Symbol.for(lk),pk="effect/MetricKeyType/Gauge",lx=Symbol.for(pk),fk="effect/MetricKeyType/Histogram",px=Symbol.for(fk),mk="effect/MetricKeyType/Summary",fx=Symbol.for(mk),ha={_In:e=>e,_Out:e=>e},mx=class{incremental;bigint;[ma]=ha;[ax]=ax;constructor(t,r){this.incremental=t,this.bigint=r,this._hash=ce(uk)}_hash;[F](){return this._hash}[R](t){return dx(t)}pipe(){return O(this,arguments)}},o2=ce(lk),ik=class{preregisteredWords;[ma]=ha;[ux]=ux;constructor(t){this.preregisteredWords=t}[F](){return o2}[R](t){return xx(t)}pipe(){return O(this,arguments)}},n2=ce(pk),ck=class{bigint;[ma]=ha;[lx]=lx;constructor(t){this.bigint=t}[F](){return n2}[R](t){return gx(t)}pipe(){return O(this,arguments)}},hx=class{boundaries;[ma]=ha;[px]=px;constructor(t){this.boundaries=t,this._hash=m(ce(fk),L(w(this.boundaries)))}_hash;[F](){return this._hash}[R](t){return yx(t)&&v(this.boundaries,t.boundaries)}pipe(){return O(this,arguments)}},ak=class{maxAge;maxSize;error;quantiles;[ma]=ha;[fx]=fx;constructor(t,r,o,n){this.maxAge=t,this.maxSize=r,this.error=o,this.quantiles=n,this._hash=m(ce(mk),L(w(this.maxAge)),L(w(this.maxSize)),L(w(this.error)),L(It(this.quantiles)))}_hash;[F](){return this._hash}[R](t){return bx(t)&&v(this.maxAge,t.maxAge)&&this.maxSize===t.maxSize&&this.error===t.error&&v(this.quantiles,t.quantiles)}pipe(){return O(this,arguments)}},hk=e=>new mx(e?.incremental??!1,e?.bigint??!1);var dk=e=>new hx(e);var dx=e=>k(e,ax),xx=e=>k(e,ux),gx=e=>k(e,lx),yx=e=>k(e,px),bx=e=>k(e,fx);var s2="effect/MetricKey",gk=Symbol.for(s2),i2={_Type:e=>e},c2=ii(v),da=class{name;keyType;description;tags;[gk]=i2;constructor(t,r,o,n=[]){this.name=t,this.keyType=r,this.description=o,this.tags=n,this._hash=m(ce(this.name+this.description),L(w(this.keyType)),L(It(this.tags)))}_hash;[F](){return this._hash}[R](t){return a2(t)&&this.name===t.name&&v(this.keyType,t.keyType)&&v(this.description,t.description)&&c2(this.tags,t.tags)}pipe(){return O(this,arguments)}},a2=e=>k(e,gk),yk=(e,t)=>new da(e,hk(t),hr(t?.description));var bk=(e,t,r)=>new da(e,dk(t),hr(r));var Sk=l(2,(e,t)=>t.length===0?e:new da(e.name,e.keyType,e.description,Fr(e.tags,t)));u();u();u();var l2="effect/MetricState",xa=Symbol.for(l2),_k="effect/MetricState/Counter",Sx=Symbol.for(_k),Ek="effect/MetricState/Frequency",_x=Symbol.for(Ek),Ok="effect/MetricState/Gauge",Ex=Symbol.for(Ok),Ck="effect/MetricState/Histogram",Ox=Symbol.for(Ck),vk="effect/MetricState/Summary",Cx=Symbol.for(vk),ga={_A:e=>e},vx=class{count;[xa]=ga;[Sx]=Sx;constructor(t){this.count=t}[F](){return m(w(_k),L(w(this.count)),V(this))}[R](t){return f2(t)&&this.count===t.count}pipe(){return O(this,arguments)}},p2=ii(v),kx=class{occurrences;[xa]=ga;[_x]=_x;constructor(t){this.occurrences=t}_hash;[F](){return m(ce(Ek),L(It(ee(this.occurrences.entries()))),V(this))}[R](t){return m2(t)&&p2(ee(this.occurrences.entries()),ee(t.occurrences.entries()))}pipe(){return O(this,arguments)}},wx=class{value;[xa]=ga;[Ex]=Ex;constructor(t){this.value=t}[F](){return m(w(Ok),L(w(this.value)),V(this))}[R](t){return h2(t)&&this.value===t.value}pipe(){return O(this,arguments)}},Mx=class{buckets;count;min;max;sum;[xa]=ga;[Ox]=Ox;constructor(t,r,o,n,s){this.buckets=t,this.count=r,this.min=o,this.max=n,this.sum=s}[F](){return m(w(Ck),L(w(this.buckets)),L(w(this.count)),L(w(this.min)),L(w(this.max)),L(w(this.sum)),V(this))}[R](t){return d2(t)&&v(this.buckets,t.buckets)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return O(this,arguments)}},Rx=class{error;quantiles;count;min;max;sum;[xa]=ga;[Cx]=Cx;constructor(t,r,o,n,s,i){this.error=t,this.quantiles=r,this.count=o,this.min=n,this.max=s,this.sum=i}[F](){return m(w(vk),L(w(this.error)),L(w(this.quantiles)),L(w(this.count)),L(w(this.min)),L(w(this.max)),L(w(this.sum)),V(this))}[R](t){return x2(t)&&this.error===t.error&&v(this.quantiles,t.quantiles)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return O(this,arguments)}},kk=e=>new vx(e),wk=e=>new kx(e),Mk=e=>new wx(e),Rk=e=>new Mx(e.buckets,e.count,e.min,e.max,e.sum),Fk=e=>new Rx(e.error,e.quantiles,e.count,e.min,e.max,e.sum);var f2=e=>k(e,Sx),m2=e=>k(e,_x),h2=e=>k(e,Ex),d2=e=>k(e,Ox),x2=e=>k(e,Cx);var y2="effect/MetricHook",b2=Symbol.for(y2),S2={_In:e=>e,_Out:e=>e},ya=e=>({[b2]:S2,pipe(){return O(this,arguments)},...e});var Tk=BigInt(0),Ik=e=>{let t=e.keyType.bigint?Tk:0,r=e.keyType.incremental?e.keyType.bigint?o=>o>=Tk:o=>o>=0:o=>!0;return ya({get:()=>kk(t),update:o=>{r(o)&&(t=t+o)}})},Nk=e=>{let t=new Map;for(let o of e.keyType.preregisteredWords)t.set(o,0);return ya({get:()=>wk(t),update:o=>{let n=t.get(o)??0;t.set(o,n+1)}})},Pk=(e,t)=>{let r=t;return ya({get:()=>Mk(r),update:o=>{r=o}})},Lk=e=>{let t=e.keyType.boundaries.values,r=t.length,o=new Uint32Array(r+1),n=new Float32Array(r),s=0,i=0,c=Number.MAX_VALUE,a=Number.MIN_VALUE;m(t,Nn(pn),Tr((h,d)=>{n[d]=h}));let p=h=>{let d=0,g=r;for(;d!==g;){let b=Math.floor(d+(g-d)/2),M=n[b];h<=M?g=b:d=b,g===d+1&&(h<=n[d]?g=d:d=g)}o[d]=o[d]+1,s=s+1,i=i+h,h<c&&(c=h),h>a&&(a=h)},f=()=>{let h=xc(r),d=0;for(let g=0;g<r;g++){let b=n[g],M=o[g];d=d+M,h[g]=[b,d]}return h};return ya({get:()=>Rk({buckets:f(),count:s,min:c,max:a,sum:i}),update:p})},Dk=e=>{let{error:t,maxAge:r,maxSize:o,quantiles:n}=e.keyType,s=m(n,Nn(pn)),i=xc(o),c=0,a=0,p=0,f=Number.MAX_VALUE,h=Number.MIN_VALUE,d=b=>{let M=[],T=0;for(;T!==o-1;){let P=i[T];if(P!=null){let[K,ae]=P,_e=pi(b-K);ym(_e,xm)&&_e<=r&&M.push(ae)}T=T+1}return _2(t,s,Nn(M,pn))},g=(b,M)=>{if(o>0){c=c+1;let T=c%o;i[T]=[M,b]}a=a+1,p=p+b,b<f&&(f=b),b>h&&(h=b)};return ya({get:()=>Fk({error:t,quantiles:d(Date.now()),count:a,min:f,max:h,sum:p}),update:([b,M])=>g(b,M)})},_2=(e,t,r)=>{let o=r.length;if(!xt(t))return Ut();let n=t[0],s=t.slice(1),i=Ak(e,o,S(),0,n,r),c=_t(i);return s.forEach(a=>{c.push(Ak(e,o,i.value,i.consumed,a,i.rest))}),Tr(c,a=>[a.quantile,a.value])},Ak=(e,t,r,o,n,s)=>{let i=e,c=t,a=r,p=o,f=n,h=s,d=e,g=t,b=r,M=o,T=n,P=s;for(;;){if(!xt(h))return{quantile:f,value:S(),consumed:p,rest:[]};if(f===1)return{quantile:f,value:_(Qf(h)),consumed:p+h.length,rest:[]};let K=Yy(h,No=>No<=h[0]),ae=f*c,_e=i/2*ae,lt=p+K[0].length,Zt=Math.abs(lt-ae);if(lt<ae-_e){d=i,g=c,b=Bo(h),M=lt,T=f,P=K[1],i=d,c=g,a=b,p=M,f=T,h=P;continue}if(lt>ae+_e)return{quantile:f,value:a,consumed:p,rest:h};switch(a._tag){case"None":{d=i,g=c,b=Bo(h),M=lt,T=f,P=K[1],i=d,c=g,a=b,p=M,f=T,h=P;continue}case"Some":{let No=Math.abs(ae-a.value);if(Zt<No){d=i,g=c,b=Bo(h),M=lt,T=f,P=K[1],i=d,c=g,a=b,p=M,f=T,h=P;continue}return{quantile:f,value:_(a.value),consumed:p,rest:h}}}}throw new Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/effect/issues")};u();var O2="effect/MetricPair",C2=Symbol.for(O2),v2={_Type:e=>e};var qk=(e,t)=>({[C2]:v2,metricKey:e,metricState:t,pipe(){return O(this,arguments)}});var w2="effect/MetricRegistry",Hk=Symbol.for(w2),Fx=class{[Hk]=Hk;map=Ss();snapshot(){let t=[];for(let[r,o]of this.map)t.push(qk(r,o.get()));return t}get(t){let r=m(this.map,Ge(t),pt);if(r==null){if(dx(t.keyType))return this.getCounter(t);if(gx(t.keyType))return this.getGauge(t);if(xx(t.keyType))return this.getFrequency(t);if(yx(t.keyType))return this.getHistogram(t);if(bx(t.keyType))return this.getSummary(t);throw new Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/effect/issues")}else return r}getCounter(t){let r=m(this.map,Ge(t),pt);if(r==null){let o=Ik(t);m(this.map,Or(t))||m(this.map,Wt(t,o)),r=o}return r}getFrequency(t){let r=m(this.map,Ge(t),pt);if(r==null){let o=Nk(t);m(this.map,Or(t))||m(this.map,Wt(t,o)),r=o}return r}getGauge(t){let r=m(this.map,Ge(t),pt);if(r==null){let o=Pk(t,t.keyType.bigint?BigInt(0):0);m(this.map,Or(t))||m(this.map,Wt(t,o)),r=o}return r}getHistogram(t){let r=m(this.map,Ge(t),pt);if(r==null){let o=Lk(t);m(this.map,Or(t))||m(this.map,Wt(t,o)),r=o}return r}getSummary(t){let r=m(this.map,Ge(t),pt);if(r==null){let o=Dk(t);m(this.map,Or(t))||m(this.map,Wt(t,o)),r=o}return r}},Wk=()=>new Fx;var R2="effect/Metric",F2=Symbol.for(R2),T2={_Type:e=>e,_In:e=>e,_Out:e=>e},Uk=q(Symbol.for("effect/Metric/globalMetricRegistry"),()=>Wk()),Bk=function(e,t,r){let o=Object.assign(n=>$t(n,s=>I2(o,s)),{[F2]:T2,keyType:e,unsafeUpdate:t,unsafeValue:r,register(){return this.unsafeValue([]),this},pipe(){return O(this,arguments)}});return o};var ba=(e,t)=>jk(yk(e,t));var jk=e=>{let t,r=new WeakMap,o=n=>{if(n.length===0)return t!==void 0||(t=Uk.get(e)),t;let s=r.get(n);return s!==void 0||(s=Uk.get(Sk(e,n)),r.set(n,s)),s};return Bk(e.keyType,(n,s)=>o(s).update(n),n=>o(n).get())};var zk=(e,t,r)=>jk(bk(e,t,r));var Gk=l(3,(e,t,r)=>A2(e,[Cs(t,r)]));var A2=l(2,(e,t)=>Bk(e.keyType,(r,o)=>e.unsafeUpdate(r,Fr(t,o)),r=>e.unsafeValue(Fr(t,r))));var I2=l(2,(e,t)=>He(bo,r=>E(()=>e.unsafeUpdate(t,r))));u();var P2="effect/Request",Tx=Symbol.for(P2),L2={_E:e=>e,_A:e=>e},O6={...ti,[Tx]:L2},$k=e=>k(e,Tx);var Ax=l(2,(e,t)=>He(Ep,r=>E(()=>{if(r.has(e)){let o=r.get(e);o.state.completed||(o.state.completed=!0,Zc(o.result,t))}})));var ji=class{count=0;observers=new Set;interrupted=!1;addObserver(t){this.observers.add(t)}removeObserver(t){this.observers.delete(t)}increment(){this.count++,this.observers.forEach(t=>t(this.count))}decrement(){this.count--,this.observers.forEach(t=>t(this.count))}};u();u();u();u();u();var yn={Forward:0,Backward:1},Fp=class e{self;stack;direction;count=0;constructor(t,r,o){this.self=t,this.stack=r,this.direction=o}clone(){return new e(this.self,this.stack.slice(),this.direction)}reversed(){return new e(this.self,this.stack.slice(),this.direction===yn.Forward?yn.Backward:yn.Forward)}next(){let t=this.entry;switch(this.count++,this.direction===yn.Forward?this.moveNext():this.movePrev(),t._tag){case"None":return{done:!0,value:this.count};case"Some":return{done:!1,value:t.value}}}get key(){return this.stack.length>0?_(this.stack[this.stack.length-1].key):S()}get value(){return this.stack.length>0?_(this.stack[this.stack.length-1].value):S()}get entry(){return Me(hu(this.stack),t=>[t.key,t.value])}get index(){let t=0,r=this.stack;if(r.length===0){let o=this.self._root;return o!=null?o.count:0}else r[r.length-1].left!=null&&(t=r[r.length-1].left.count);for(let o=r.length-2;o>=0;--o)r[o+1]===r[o].right&&(++t,r[o].left!=null&&(t+=r[o].left.count));return t}moveNext(){let t=this.stack;if(t.length===0)return;let r=t[t.length-1];if(r.right!=null)for(r=r.right;r!=null;)t.push(r),r=r.left;else for(t.pop();t.length>0&&t[t.length-1].right===r;)r=t[t.length-1],t.pop()}get hasNext(){let t=this.stack;if(t.length===0)return!1;if(t[t.length-1].right!=null)return!0;for(let r=t.length-1;r>0;--r)if(t[r-1].left===t[r])return!0;return!1}movePrev(){let t=this.stack;if(t.length===0)return;let r=t[t.length-1];if(r!=null&&r.left!=null)for(r=r.left;r!=null;)t.push(r),r=r.right;else for(t.pop();t.length>0&&t[t.length-1].left===r;)r=t[t.length-1],t.pop()}get hasPrev(){let t=this.stack;if(t.length===0)return!1;if(t[t.length-1].left!=null)return!0;for(let r=t.length-1;r>0;--r)if(t[r-1].right===t[r])return!0;return!1}};u();var N={Red:0,Black:1},Cr=({color:e,count:t,key:r,left:o,right:n,value:s})=>({color:e,key:r,value:s,left:o,right:n,count:t});function Ix(e,t){e.key=t.key,e.value=t.value,e.left=t.left,e.right=t.right,e.color=t.color,e.count=t.count}var ko=({count:e,key:t,left:r,right:o,value:n},s)=>({color:s,key:t,value:n,left:r,right:o,count:e}),Oe=e=>{e.count=1+(e.left?.count??0)+(e.right?.count??0)};var Vk="effect/RedBlackTree",Nx=Symbol.for(Vk),H2={_Key:e=>e,_Value:e=>e},W2={[Nx]:H2,[F](){let e=w(Vk);for(let t of this)e^=m(w(t[0]),L(w(t[1])));return V(this,e)},[R](e){if(Kk(e)){if((this._root?.count??0)!==(e._root?.count??0))return!1;let t=Array.from(e);return Array.from(this).every((r,o)=>{let n=t[o];return v(r[0],n[0])&&v(r[1],n[1])})}return!1},[Symbol.iterator](){let e=[],t=this._root;for(;t!=null;)e.push(t),t=t.left;return new Fp(this,e,yn.Forward)},toString(){return te(this.toJSON())},toJSON(){return{_id:"RedBlackTree",values:Array.from(this).map(J)}},[j](){return this.toJSON()},pipe(){return O(this,arguments)}},Sa=(e,t)=>{let r=Object.create(W2);return r._ord=e,r._root=t,r},Kk=e=>k(e,Nx);var Jk=l(2,(e,t)=>{let r=e._ord,o=e._root;for(;o!==void 0;){let n=r(t,o.key);if(v(t,o.key))return _(o.value);n<=0?o=o.left:o=o.right}return S()});var Px=l(2,(e,t)=>W(Jk(e,t))),Yk=l(3,(e,t,r)=>{let o=e._ord,n=e._root,s=[],i=[];for(;n!=null;){let c=o(t,n.key);s.push(n),i.push(c),c<=0?n=n.left:n=n.right}s.push({color:N.Red,key:t,value:r,left:void 0,right:void 0,count:1});for(let c=s.length-2;c>=0;--c){let a=s[c];i[c]<=0?s[c]={color:a.color,key:a.key,value:a.value,left:s[c+1],right:a.right,count:a.count+1}:s[c]={color:a.color,key:a.key,value:a.value,left:a.left,right:s[c+1],count:a.count+1}}for(let c=s.length-1;c>1;--c){let a=s[c-1],p=s[c];if(a.color===N.Black||p.color===N.Black)break;let f=s[c-2];if(f.left===a)if(a.left===p){let h=f.right;if(h&&h.color===N.Red)a.color=N.Black,f.right=ko(h,N.Black),f.color=N.Red,c-=1;else{if(f.color=N.Red,f.left=a.right,a.color=N.Black,a.right=f,s[c-2]=a,s[c-1]=p,Oe(f),Oe(a),c>=3){let d=s[c-3];d.left===f?d.left=a:d.right=a}break}}else{let h=f.right;if(h&&h.color===N.Red)a.color=N.Black,f.right=ko(h,N.Black),f.color=N.Red,c-=1;else{if(a.right=p.left,f.color=N.Red,f.left=p.right,p.color=N.Black,p.left=a,p.right=f,s[c-2]=p,s[c-1]=a,Oe(f),Oe(a),Oe(p),c>=3){let d=s[c-3];d.left===f?d.left=p:d.right=p}break}}else if(a.right===p){let h=f.left;if(h&&h.color===N.Red)a.color=N.Black,f.left=ko(h,N.Black),f.color=N.Red,c-=1;else{if(f.color=N.Red,f.right=a.left,a.color=N.Black,a.left=f,s[c-2]=a,s[c-1]=p,Oe(f),Oe(a),c>=3){let d=s[c-3];d.right===f?d.right=a:d.left=a}break}}else{let h=f.left;if(h&&h.color===N.Red)a.color=N.Black,f.left=ko(h,N.Black),f.color=N.Red,c-=1;else{if(a.left=p.right,f.color=N.Red,f.right=p.left,p.color=N.Black,p.right=a,p.left=f,s[c-2]=p,s[c-1]=a,Oe(f),Oe(a),Oe(p),c>=3){let d=s[c-3];d.right===f?d.right=p:d.left=p}break}}}return s[0].color=N.Black,Sa(e._ord,s[0])}),Qk=e=>Zk(e,yn.Forward);var Zk=(e,t)=>{let r=e[Symbol.iterator](),o=0;return{[Symbol.iterator]:()=>Zk(e,t),next:()=>{o++;let n=r.key;switch(t===yn.Forward?r.moveNext():r.movePrev(),n._tag){case"None":return{done:!0,value:o};case"Some":return{done:!1,value:n.value}}}}};var Xk=l(2,(e,t)=>{if(!Px(e,t))return e;let r=e._ord,o=r,n=e._root,s=[];for(;n!==void 0;){let a=o(t,n.key);s.push(n),v(t,n.key)?n=void 0:a<=0?n=n.left:n=n.right}if(s.length===0)return e;let i=new Array(s.length),c=s[s.length-1];i[i.length-1]={color:c.color,key:c.key,value:c.value,left:c.left,right:c.right,count:c.count};for(let a=s.length-2;a>=0;--a)c=s[a],c.left===s[a+1]?i[a]={color:c.color,key:c.key,value:c.value,left:i[a+1],right:c.right,count:c.count}:i[a]={color:c.color,key:c.key,value:c.value,left:c.left,right:i[a+1],count:c.count};if(c=i[i.length-1],c.left!==void 0&&c.right!==void 0){let a=i.length;for(c=c.left;c.right!=null;)i.push(c),c=c.right;let p=i[a-1];i.push({color:c.color,key:p.key,value:p.value,left:c.left,right:c.right,count:c.count}),i[a-1].key=c.key,i[a-1].value=c.value;for(let f=i.length-2;f>=a;--f)c=i[f],i[f]={color:c.color,key:c.key,value:c.value,left:c.left,right:i[f+1],count:c.count};i[a-1].left=i[a]}if(c=i[i.length-1],c.color===N.Red){let a=i[i.length-2];a.left===c?a.left=void 0:a.right===c&&(a.right=void 0),i.pop();for(let p=0;p<i.length;++p)i[p].count--;return Sa(r,i[0])}else if(c.left!==void 0||c.right!==void 0){c.left!==void 0?Ix(c,c.left):c.right!==void 0&&Ix(c,c.right),c.color=N.Black;for(let a=0;a<i.length-1;++a)i[a].count--;return Sa(r,i[0])}else{if(i.length===1)return Sa(r,void 0);{for(let p=0;p<i.length;++p)i[p].count--;let a=i[i.length-2];U2(i),a.left===c?a.left=void 0:a.right=void 0}}return Sa(r,i[0])});var U2=e=>{let t,r,o,n;for(let s=e.length-1;s>=0;--s){if(t=e[s],s===0){t.color=N.Black;return}if(r=e[s-1],r.left===t){if(o=r.right,o!==void 0&&o.right!==void 0&&o.right.color===N.Red){if(o=r.right=Cr(o),n=o.right=Cr(o.right),r.right=o.left,o.left=r,o.right=n,o.color=r.color,t.color=N.Black,r.color=N.Black,n.color=N.Black,Oe(r),Oe(o),s>1){let i=e[s-2];i.left===r?i.left=o:i.right=o}e[s-1]=o;return}else if(o!==void 0&&o.left!==void 0&&o.left.color===N.Red){if(o=r.right=Cr(o),n=o.left=Cr(o.left),r.right=n.left,o.left=n.right,n.left=r,n.right=o,n.color=r.color,r.color=N.Black,o.color=N.Black,t.color=N.Black,Oe(r),Oe(o),Oe(n),s>1){let i=e[s-2];i.left===r?i.left=n:i.right=n}e[s-1]=n;return}if(o!==void 0&&o.color===N.Black)if(r.color===N.Red){r.color=N.Black,r.right=ko(o,N.Red);return}else{r.right=ko(o,N.Red);continue}else if(o!==void 0){if(o=Cr(o),r.right=o.left,o.left=r,o.color=r.color,r.color=N.Red,Oe(r),Oe(o),s>1){let i=e[s-2];i.left===r?i.left=o:i.right=o}e[s-1]=o,e[s]=r,s+1<e.length?e[s+1]=t:e.push(t),s=s+2}}else{if(o=r.left,o!==void 0&&o.left!==void 0&&o.left.color===N.Red){if(o=r.left=Cr(o),n=o.left=Cr(o.left),r.left=o.right,o.right=r,o.left=n,o.color=r.color,t.color=N.Black,r.color=N.Black,n.color=N.Black,Oe(r),Oe(o),s>1){let i=e[s-2];i.right===r?i.right=o:i.left=o}e[s-1]=o;return}else if(o!==void 0&&o.right!==void 0&&o.right.color===N.Red){if(o=r.left=Cr(o),n=o.right=Cr(o.right),r.left=n.right,o.right=n.left,n.right=r,n.left=o,n.color=r.color,r.color=N.Black,o.color=N.Black,t.color=N.Black,Oe(r),Oe(o),Oe(n),s>1){let i=e[s-2];i.right===r?i.right=n:i.left=n}e[s-1]=n;return}if(o!==void 0&&o.color===N.Black)if(r.color===N.Red){r.color=N.Black,r.left=ko(o,N.Red);return}else{r.left=ko(o,N.Red);continue}else if(o!==void 0){if(o=Cr(o),r.left=o.right,o.right=r,o.color=r.color,r.color=N.Red,Oe(r),Oe(o),s>1){let i=e[s-2];i.right===r?i.right=o:i.left=o}e[s-1]=o,e[s]=r,s+1<e.length?e[s+1]=t:e.push(t),s=s+2}}}};var ew=Px,tw=Yk,rw=Qk;var ow=Xk;var Lx=Symbol.for("effect/SortedSet"),j2={[Lx]:{_A:e=>e},[F](){return m(w(this.keyTree),L(w(Lx)),V(this))},[R](e){return z2(e)&&v(this.keyTree,e.keyTree)},[Symbol.iterator](){return rw(this.keyTree)},toString(){return te(this.toJSON())},toJSON(){return{_id:"SortedSet",values:Array.from(this).map(J)}},[j](){return this.toJSON()},pipe(){return O(this,arguments)}},sw=e=>{let t=Object.create(j2);return t.keyTree=e,t},z2=e=>k(e,Lx);var iw=l(2,(e,t)=>ew(e.keyTree,t)?e:sw(tw(e.keyTree,t,!0)));var cw=l(2,(e,t)=>sw(ow(e.keyTree,t)));var G2="effect/Supervisor",$i=Symbol.for(G2),_a={_T:e=>e},zi=class e{underlying;value0;[$i]=_a;constructor(t,r){this.underlying=t,this.value0=r}get value(){return this.value0}onStart(t,r,o,n){this.underlying.onStart(t,r,o,n)}onEnd(t,r){this.underlying.onEnd(t,r)}onEffect(t,r){this.underlying.onEffect(t,r)}onSuspend(t){this.underlying.onSuspend(t)}onResume(t){this.underlying.onResume(t)}map(t){return new e(this,m(this.value,C(t)))}zip(t){return new Gi(this,t)}},Gi=class e{left;right;_tag="Zip";[$i]=_a;constructor(t,r){this.left=t,this.right=r}get value(){return cs(this.left.value,this.right.value)}onStart(t,r,o,n){this.left.onStart(t,r,o,n),this.right.onStart(t,r,o,n)}onEnd(t,r){this.left.onEnd(t,r),this.right.onEnd(t,r)}onEffect(t,r){this.left.onEffect(t,r),this.right.onEffect(t,r)}onSuspend(t){this.left.onSuspend(t),this.right.onSuspend(t)}onResume(t){this.left.onResume(t),this.right.onResume(t)}map(t){return new zi(this,m(this.value,C(t)))}zip(t){return new e(this,t)}},Hx=e=>k(e,$i)&&Rn(e,"Zip"),Dx=class{[$i]=_a;fibers=new Set;get value(){return E(()=>Array.from(this.fibers))}onStart(t,r,o,n){this.fibers.add(n)}onEnd(t,r){this.fibers.delete(r)}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new zi(this,m(this.value,C(t)))}zip(t){return new Gi(this,t)}onRun(t,r){return t()}},qx=class{effect;[$i]=_a;constructor(t){this.effect=t}get value(){return this.effect}onStart(t,r,o,n){}onEnd(t,r){}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new zi(this,m(this.value,C(t)))}zip(t){return new Gi(this,t)}onRun(t,r){return t()}},uw=class{ref;[$i]=_a;constructor(t){this.ref=t}get value(){return E(()=>Pt(this.ref))}onStart(t,r,o,n){m(this.ref,or(m(Pt(this.ref),iw(n))))}onEnd(t,r){m(this.ref,or(m(Pt(this.ref),cw(r))))}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new zi(this,m(this.value,C(t)))}zip(t){return new Gi(this,t)}onRun(t,r){return t()}},$2=()=>new Dx,lw=E($2),V2=e=>new qx(e),Ns=q("effect/Supervisor/none",()=>V2(H));u();u();var pw=Vo;var mw="Empty",hw="AddSupervisor",dw="RemoveSupervisor",xw="AndThen",Vi={_tag:mw},Ap=(e,t)=>({_tag:xw,first:e,second:t}),K2=(e,t)=>J2(t,Re(e)),J2=(e,t)=>{let r=e,o=t;for(;tt(o);){let n=Ze(o);switch(n._tag){case mw:{o=ot(o);break}case hw:{r=r.zip(n.supervisor),o=ot(o);break}case dw:{r=Wx(r,n.supervisor),o=ot(o);break}case xw:{o=Qe(n.first)(Qe(n.second)(ot(o)));break}}}return r},Wx=(e,t)=>v(e,t)?Ns:Hx(e)?Wx(e.left,t).zip(Wx(e.right,t)):e,Ip=e=>v(e,Ns)?Lr():Hx(e)?m(Ip(e.left),uo(Ip(e.right))):Hn(e),Y2=(e,t)=>{if(v(e,t))return Vi;let r=Ip(e),o=Ip(t),n=m(o,Fm(r),Bn(Vi,(i,c)=>Ap(i,{_tag:hw,supervisor:c}))),s=m(r,Fm(o),Bn(Vi,(i,c)=>Ap(i,{_tag:dw,supervisor:c})));return Ap(n,s)},gw=pw({empty:Vi,patch:K2,combine:Ap,diff:Y2});var Z2=ba("effect_fiber_started",{incremental:!0}),yw=ba("effect_fiber_active"),X2=ba("effect_fiber_successes",{incremental:!0}),eD=ba("effect_fiber_failures",{incremental:!0}),tD=Gk(zk("effect_fiber_lifetimes",sk({start:.5,factor:2,count:35})),"time_unit","milliseconds"),Ea="Continue",rD="Done",bw="Yield",oD={_E:e=>e,_A:e=>e},Oa=e=>{throw new Error(`BUG: FiberRuntime - ${qo(e)} - please report an issue at https://github.com/Effect-TS/effect/issues`)},bn=Symbol.for("effect/internal/fiberRuntime/YieldedOp"),wo=q("effect/internal/fiberRuntime/yieldedOpChannel",()=>({currentOp:null})),Np={[Qs]:(e,t,r)=>Ne(()=>t.effect_instruction_i1(r)),OnStep:(e,t,r)=>xe(xe(r)),[Zs]:(e,t,r)=>Ne(()=>t.effect_instruction_i2(r)),[mc]:(e,t,r)=>(e.patchRuntimeFlags(e._runtimeFlags,t.patch),fo(e._runtimeFlags)&&e.isInterrupted()?ie(e.getInterruptedCause()):xe(r)),[Xs]:(e,t,r)=>(Ne(()=>t.effect_instruction_i2(r)),Ne(()=>t.effect_instruction_i0())?(e.pushStack(t),Ne(()=>t.effect_instruction_i1())):H)},nD={[Op]:(e,t,r,o)=>(e.processNewInterruptSignal(o.cause),fo(t)?ie(o.cause):r),[vp]:(e,t,r,o)=>{throw new Error("It is illegal to have multiple concurrent run loops in a single fiber")},[Cp]:(e,t,r,o)=>(o.onFiber(e,Gd(t)),r),[kp]:(e,t,r,o)=>x(Vr(),()=>r)},sD=e=>Dt(AS(e),t=>Ps(NS(t),([r,o])=>{let n=new Map,s=[];for(let c of o){s.push(tr(c));for(let a of c)n.set(a.request,a)}let i=s.flat();return We(_D(r.runAll(s),i,()=>i.forEach(c=>{c.listeners.interrupted=!0})),Ep,n)},!1,!1)),Ca=class{[pa]=fa;[Qv]=oD;pipe(){return O(this,arguments)}_fiberRefs;_fiberId;_runtimeFlags;_queue=new Array;_children=null;_observers=new Array;_running=!1;_stack=[];_asyncInterruptor=null;_asyncBlockingOn=null;_exitValue=null;_steps=[];_supervisor;_scheduler;_tracer;currentOpCount=0;isYielding=!1;constructor(t,r,o){if(this._runtimeFlags=o,this._fiberId=t,this._fiberRefs=r,this._supervisor=this.getFiberRef(Hp),this._scheduler=this.getFiberRef(hn),eh(o)){let n=this.getFiberRef(bo);Z2.unsafeUpdate(1,n),yw.unsafeUpdate(1,n)}this._tracer=Be(this.getFiberRef(ye),Br)}id(){return this._fiberId}resume(t){this.tell(As(t))}get status(){return this.ask((t,r)=>r)}get runtimeFlags(){return this.ask((t,r)=>vv(r)?t._runtimeFlags:r.runtimeFlags)}scope(){return Jv(this)}get children(){return this.ask(t=>Array.from(t.getChildren()))}getChildren(){return this._children===null&&(this._children=new Set),this._children}getInterruptedCause(){return this.getFiberRef(fs)}fiberRefs(){return this.ask(t=>t.getFiberRefs())}ask(t){return I(()=>{let r=Jc(this._fiberId);return this.tell(Bi((o,n)=>{Zc(r,E(()=>t(o,n)))})),it(r)})}tell(t){this._queue.push(t),this._running||(this._running=!0,this.drainQueueLaterOnExecutor())}get await(){return qe(t=>{let r=o=>t(y(o));return this.tell(Bi((o,n)=>{o._exitValue!==null?r(this._exitValue):o.addObserver(r)})),E(()=>this.tell(Bi((o,n)=>{o.removeObserver(r)})))},this.id())}get inheritAll(){return re((t,r)=>{let o=t.id(),n=t.getFiberRefs(),s=r.runtimeFlags,i=this.getFiberRefs(),c=zl(n,o,i);t.setFiberRefs(c);let a=t.getFiberRef(Ew),p=m(nr(s,a),nh(Wr),nh(Zu));return sn(p)})}get poll(){return E(()=>hr(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(t){return E(()=>this.tell(wp(Gt(t))))}unsafeInterruptAsFork(t){this.tell(wp(Gt(t)))}addObserver(t){this._exitValue!==null?t(this._exitValue):this._observers.push(t)}removeObserver(t){this._observers=this._observers.filter(r=>r!==t)}getFiberRefs(){return this.setFiberRef(Ew,this._runtimeFlags),this._fiberRefs}unsafeDeleteFiberRef(t){this._fiberRefs=ea(this._fiberRefs,t)}getFiberRef(t){return this._fiberRefs.locals.has(t)?this._fiberRefs.locals.get(t)[0][1]:t.initial}setFiberRef(t,r){this._fiberRefs=Li(this._fiberRefs,{fiberId:this._fiberId,fiberRef:t,value:r}),this.refreshRefCache()}refreshRefCache(){this._tracer=Be(this.getFiberRef(ye),Br),this._supervisor=this.getFiberRef(Hp),this._scheduler=this.getFiberRef(hn)}setFiberRefs(t){this._fiberRefs=t,this.refreshRefCache()}addChild(t){this.getChildren().add(t)}removeChild(t){this.getChildren().delete(t)}drainQueueOnCurrentThread(){let t=!0;for(;t;){let r=Ea,o=globalThis[gn];globalThis[gn]=this;try{for(;r===Ea;)r=this._queue.length===0?rD:this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[gn]=o}this._queue.length>0&&!this._running?(this._running=!0,r===bw?(this.drainQueueLaterOnExecutor(),t=!1):t=!0):t=!1}}drainQueueLaterOnExecutor(){this._scheduler.scheduleTask(this.run,this.getFiberRef(cn))}drainQueueWhileRunning(t,r){let o=r;for(;this._queue.length>0;){let n=this._queue.splice(0,1)[0];o=nD[n._tag](this,t,o,n)}return o}isInterrupted(){return!nl(this.getFiberRef(fs))}addInterruptedCause(t){let r=this.getFiberRef(fs);this.setFiberRef(fs,je(r,t))}processNewInterruptSignal(t){this.addInterruptedCause(t),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(this._children===null||this._children.size===0)return!1;let t=!1;for(let r of this._children)r.tell(wp(Gt(this.id()))),t=!0;return t}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){let t=this._children.values();this._children=null;let r=!1;return Mi({while:()=>!r,body:()=>{let n=t.next();return n.done?E(()=>{r=!0}):Ee(n.value.await)},step:()=>{}})}return null}reportExitValue(t){if(eh(this._runtimeFlags)){let r=this.getFiberRef(bo),o=this.id().startTimeMillis,n=Date.now();switch(tD.unsafeUpdate(n-o,r),yw.unsafeUpdate(-1,r),t._tag){case Le:{X2.unsafeUpdate(1,r);break}case Pe:{eD.unsafeUpdate(1,r);break}}}if(t._tag==="Failure"){let r=this.getFiberRef(wh);!es(t.cause)&&r._tag==="Some"&&this.log("Fiber terminated with an unhandled error",t.cause,r)}}setExitValue(t){this._exitValue=t,this.reportExitValue(t);for(let r=this._observers.length-1;r>=0;r--)this._observers[r](t)}getLoggers(){return this.getFiberRef(lD)}log(t,r,o){let n=W(o)?o.value:this.getFiberRef(Ch),s=this.getFiberRef(iD);if(ZE(s,n))return;let i=this.getFiberRef(vl),c=this.getFiberRef(an),a=this.getLoggers(),p=this.getFiberRefs();if(Wn(a)>0){let f=Be(this.getFiberRef(ye),Jt),h=new Date(f.unsafeCurrentTimeMillis());for(let d of a)d.log({fiberId:this.id(),logLevel:n,message:t,cause:r,context:p,spans:i,annotations:c,date:h})}}evaluateMessageWhileSuspended(t){switch(t._tag){case kp:return bw;case Op:return this.processNewInterruptSignal(t.cause),this._asyncInterruptor!==null&&(this._asyncInterruptor(ie(t.cause)),this._asyncInterruptor=null),Ea;case vp:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(t.effect),Ea;case Cp:return t.onFiber(this,this._exitValue!==null?Ov:Cv(this._runtimeFlags,this._asyncBlockingOn)),Ea;default:return Oa(t)}}evaluateEffect(t){this._supervisor.onResume(this);try{let r=fo(this._runtimeFlags)&&this.isInterrupted()?ie(this.getInterruptedCause()):t;for(;r!==null;){let o=r,n=this.runLoop(o);if(n===bn){let s=wo.currentOp;wo.currentOp=null,s._op===ei?MS(this._runtimeFlags)?(this.tell(Vv()),this.tell(As(Kt)),r=null):r=Kt:s._op===An&&(r=null)}else{this._runtimeFlags=m(this._runtimeFlags,Zm(Zu));let s=this.interruptAllChildren();s!==null?r=x(s,()=>n):(this._queue.length===0?this.setExitValue(n):this.tell(As(n)),r=null)}}}finally{this._supervisor.onSuspend(this)}}start(t){if(this._running)this.tell(As(t));else{this._running=!0;let r=globalThis[gn];globalThis[gn]=this;try{this.evaluateEffect(t)}finally{this._running=!1,globalThis[gn]=r,this._queue.length>0&&this.drainQueueLaterOnExecutor()}}}startFork(t){this.tell(As(t))}patchRuntimeFlags(t,r){let o=mo(t,r);return globalThis[gn]=this,this._runtimeFlags=o,o}initiateAsync(t,r){let o=!1,n=s=>{o||(o=!0,this.tell(As(s)))};fo(t)&&(this._asyncInterruptor=n);try{r(n)}catch(s){n(Y(ft(s)))}}pushStack(t){this._stack.push(t),t._op==="OnStep"&&this._steps.push({refs:this.getFiberRefs(),flags:this._runtimeFlags})}popStack(){let t=this._stack.pop();if(t)return t._op==="OnStep"&&this._steps.pop(),t}getNextSuccessCont(){let t=this.popStack();for(;t;){if(t._op!==Ys)return t;t=this.popStack()}}getNextFailCont(){let t=this.popStack();for(;t;){if(t._op!==Qs&&t._op!==Xs)return t;t=this.popStack()}}[Ey](t){return C(Ht(mt),r=>ci(r,t))}Left(t){return G(t.left)}None(t){return G(new Vt)}Right(t){return xe(t.right)}Some(t){return xe(t.value)}Micro(t){return a_(r=>{let o=Pv().pipe(Lv(qv,this.getFiberRef(mt))),n=r;return t[Yt](o,s=>{if(s._tag==="Right")return n(xe(s.right));switch(s.left._tag){case"Interrupt":return n(ie(Gt(zt)));case"Fail":return n(G(s.left.error));case"Die":return n(go(s.left.defect))}}),qe(s=>{n=i=>{s(H)},Fs(o,bp).abort()})})}[nu](t){let r=Ne(()=>t.effect_instruction_i0()),o=this.getNextSuccessCont();return o!==void 0?(o._op in Np||Oa(o),Np[o._op](this,o,r)):(wo.currentOp=xe(r),bn)}[Le](t){let r=t,o=this.getNextSuccessCont();return o!==void 0?(o._op in Np||Oa(o),Np[o._op](this,o,r.effect_instruction_i0)):(wo.currentOp=r,bn)}[Pe](t){let r=t.effect_instruction_i0,o=this.getNextFailCont();if(o!==void 0)switch(o._op){case Ys:case Zs:return fo(this._runtimeFlags)&&this.isInterrupted()?ie(cl(r)):Ne(()=>o.effect_instruction_i1(r));case"OnStep":return fo(this._runtimeFlags)&&this.isInterrupted()?ie(cl(r)):xe(ie(r));case mc:return this.patchRuntimeFlags(this._runtimeFlags,o.patch),fo(this._runtimeFlags)&&this.isInterrupted()?ie(je(r,this.getInterruptedCause())):ie(r);default:Oa(o)}else return wo.currentOp=ie(r),bn}[su](t){return Ne(()=>t.effect_instruction_i0(this,Gd(this._runtimeFlags)))}Blocked(t){let r=this.getFiberRefs(),o=this._runtimeFlags;if(this._steps.length>0){let n=[],s=this._steps[this._steps.length-1],i=this.popStack();for(;i&&i._op!=="OnStep";)n.push(i),i=this.popStack();this.setFiberRefs(s.refs),this._runtimeFlags=s.flags;let c=ws(s.refs,r),a=nr(s.flags,o);return xe(xo(t.effect_instruction_i0,re(p=>{for(;n.length>0;)p.pushStack(n.pop());return p.setFiberRefs(Ms(p.id(),p.getFiberRefs())(c)),p._runtimeFlags=mo(a)(p._runtimeFlags),t.effect_instruction_i1})))}return Fe(n=>x(Ls(dl(t.effect_instruction_i0)),()=>n(t.effect_instruction_i1)))}RunBlocked(t){return sD(t.effect_instruction_i0)}[ro](t){let r=t.effect_instruction_i0,o=this._runtimeFlags,n=mo(o,r);if(fo(n)&&this.isInterrupted())return ie(this.getInterruptedCause());if(this.patchRuntimeFlags(this._runtimeFlags,r),t.effect_instruction_i1){let s=nr(n,o);return this.pushStack(new pl(s,t)),Ne(()=>t.effect_instruction_i1(o))}else return Kt}[Qs](t){return this.pushStack(t),t.effect_instruction_i0}OnStep(t){return this.pushStack(t),t.effect_instruction_i0}[Ys](t){return this.pushStack(t),t.effect_instruction_i0}[Zs](t){return this.pushStack(t),t.effect_instruction_i0}[An](t){return this._asyncBlockingOn=t.effect_instruction_i1,this.initiateAsync(this._runtimeFlags,t.effect_instruction_i0),wo.currentOp=t,bn}[ei](t){return this.isYielding=!1,wo.currentOp=t,bn}[Xs](t){let r=t.effect_instruction_i0,o=t.effect_instruction_i1;return r()?(this.pushStack(t),o()):Kt}[Js](t){return Ne(()=>t.commit())}runLoop(t){let r=t;for(this.currentOpCount=0;;){if(this._runtimeFlags&wS&&this._supervisor.onEffect(this,r),this._queue.length>0&&(r=this.drainQueueWhileRunning(this._runtimeFlags,r)),!this.isYielding){this.currentOpCount+=1;let o=this._scheduler.shouldYield(this);if(o!==!1){this.isYielding=!0,this.currentOpCount=0;let n=r;r=x(Vr({priority:o}),()=>n)}}try{if((!("_op"in r)||!(r._op in this))&&Oa(r),r=this._tracer.context(()=>wn()!==r[qd]._V?Xo(`Cannot execute an Effect versioned ${r[qd]._V} with a Runtime of version ${wn()}`):this[r._op](r),this),r===bn){let o=wo.currentOp;return o._op===ei||o._op===An?bn:(wo.currentOp=null,o._op===Le||o._op===Pe?o:ie(ft(o)))}}catch(o){i_(o)?r=ie(o.cause):T_(o)?r=ie(je(ft(o),Gt(zt))):r=go(o)}}}run=()=>{this.drainQueueOnCurrentThread()}},iD=q("effect/FiberRef/currentMinimumLogLevel",()=>Te(XE("Info"))),cD=e=>Rp(t=>{let r=VE(t.context,ye);Be(r,Eo).unsafe.log(e.log(t))});var aD=q(Symbol.for("effect/Logger/defaultLogger"),()=>cD(ok));var uD=q(Symbol.for("effect/Logger/tracerLogger"),()=>Rp(({annotations:e,cause:t,context:r,fiberId:o,logLevel:n,message:s})=>{let i=Xt(Pi(r,mt),dr(yr)),c=Me(Pi(r,ye),p=>Be(p,Jt));if(i._tag==="None"||i.value._tag==="ExternalSpan"||c._tag==="None")return;let a=Object.fromEntries(Bu(e,qo));a["effect.fiberId"]=Zb(o),a["effect.logLevel"]=n.label,t!==null&&t._tag!=="Empty"&&(a["effect.cause"]=Yo(t)),i.value.event(String(s),c.value.unsafeCurrentTimeNanos(),a)}));var lD=q(Symbol.for("effect/FiberRef/currentLoggers"),()=>k_(Hn(aD,uD)));var Cw=function(){if(typeof arguments[0]=="string")return pr(an,xr(arguments[0],arguments[1]));let e=Object.entries(arguments[0]);return pr(an,rS(t=>{for(let r=0;r<e.length;r++){let[o,n]=e[r];xr(t,o,n)}return t}))},ka=l(e=>ue(e[0]),(e,t)=>yo($t(e,r=>Ki(o=>t(r,o))))),vw=l(e=>ue(e[0]),(e,t)=>vr(e,Ki(r=>t(r)))),Ki=e=>re(t=>{let r=t.getFiberRefs(),o=t._runtimeFlags;return x(Kx,n=>ms(n,s=>re(i=>{let c=i.getFiberRefs(),a=i._runtimeFlags,p=ws(c,r),f=nr(a,o),h=ws(r,c);return i.setFiberRefs(Ms(p,i.id(),r)),vr(El(e(s),f),E(()=>{i.setFiberRefs(Ms(h,i.id(),i.getFiberRefs()))}))})))}),kw=e=>We(qc,_(dn))(e),Sw=Symbol.for("effect/Effect/existsPar/found"),ww=l(e=>mr(e[0])&&!ue(e[0]),(e,t,r)=>la(r?.concurrency,()=>I(()=>Mw(e[Symbol.iterator](),0,t)),()=>Xe(lr(e,(o,n)=>gl(t(o,n),{onTrue:()=>G(Sw),onFalse:()=>H}),r),{onFailure:o=>o===Sw?y(!0):G(o),onSuccess:()=>y(!1)}))),Mw=(e,t,r)=>{let o=e.next();return o.done?y(!1):m(x(r(o.value,t),n=>n?y(n):Mw(e,t+1,r)))},Rw=l(e=>mr(e[0])&&!ue(e[0]),(e,t,r)=>{let o=r?.negate?(n,s)=>C(t(n,s),rb):t;return la(r?.concurrency,()=>I(()=>ee(e).reduceRight((n,s,i)=>Kr(n,I(()=>o(s,i)),(c,a)=>a?[s,...c]:c),E(()=>new Array))),()=>C(lr(e,(n,s)=>C(o(n,s),i=>i?_(n):S()),r),eb))}),pD=e=>{if(Array.isArray(e)||mr(e))return[e,S()];let t=Object.keys(e),r=t.length;return[t.map(o=>e[o]),_(o=>{let n={};for(let s=0;s<r;s++)n[t[s]]=o[s];return n})]},fD=(e,t,r)=>{let o=[];for(let n of e)o.push(zr(n));return x(lr(o,B,{concurrency:r?.concurrency,batching:r?.batching}),n=>{let s=S(),i=n.length,c=new Array(i),a=new Array(i),p=!1;for(let f=0;f<i;f++){let h=n[f];h._tag==="Left"?(c[f]=_(h.left),p=!0):(a[f]=h.right,c[f]=s)}return p?t._tag==="Some"?G(t.value(c)):G(c):r?.discard?H:t._tag==="Some"?y(t.value(a)):y(a)})},mD=(e,t,r)=>{let o=[];for(let n of e)o.push(zr(n));return r?.discard?lr(o,B,{concurrency:r?.concurrency,batching:r?.batching,discard:!0}):C(lr(o,B,{concurrency:r?.concurrency,batching:r?.batching}),n=>t._tag==="Some"?t.value(n):n)},Ji=(e,t)=>{let[r,o]=pD(e);return t?.mode==="validate"?fD(r,o,t):t?.mode==="either"?mD(r,o,t):t?.discard!==!0&&o._tag==="Some"?C(lr(r,B,t),o.value):lr(r,B,t)},Fw=e=>t=>Ji(t,e),Tw=(e,t)=>C(Ji(ee(e).map(ke),t),si(r=>Al(r)?_(r.effect_instruction_i0):S())),Bx=l(2,(e,t)=>Array.from({length:t},()=>e)),Aw=l(e=>ue(e[0]),(e,t,r)=>Ji(Bx(e,t),r)),lr=l(e=>mr(e[0]),(e,t,r)=>re(o=>{let n=r?.batching===!0||r?.batching==="inherit"&&o.getFiberRef(kh);return r?.discard?tx(r.concurrency,()=>Sn(up)(s=>n?Ps(e,(i,c)=>s(t(i,c)),!0,!1,1):Dt(e,(i,c)=>s(t(i,c)))),()=>Sn(lp)(s=>Ps(e,(i,c)=>s(t(i,c)),n,!1)),s=>Sn(pp(s))(i=>Ps(e,(c,a)=>i(t(c,a)),n,!1,s))):tx(r?.concurrency,()=>Sn(up)(s=>n?Ux(e,1,(i,c)=>s(t(i,c)),!0):st(e,(i,c)=>s(t(i,c)))),()=>Sn(lp)(s=>Pp(e,(i,c)=>s(t(i,c)),n)),s=>Sn(pp(s))(i=>Ux(e,s,(c,a)=>i(t(c,a)),n)))})),Pp=(e,t,r)=>I(()=>{let o=ee(e),n=new Array(o.length);return ne(Ps(o,(i,c)=>x(t(i,c),a=>E(()=>n[c]=a)),r,!1),y(n))}),Ps=(e,t,r,o,n)=>Fe(s=>_l(i=>re(c=>{let a=Array.from(e).reverse(),p=a.length;if(p===0)return H;let f=0,h=!1,d=n?Math.min(a.length,n):a.length,g=new Set,b=new Array,M=()=>g.forEach(et=>{et._scheduler.scheduleTask(()=>{et.unsafeInterruptAsFork(c.id())},0)}),T=new Array,P=new Array,K=new Array,ae=()=>{let et=b.filter(({exit:D})=>D._tag==="Failure").sort((D,Q)=>D.index<Q.index?-1:D.index===Q.index?0:1).map(({exit:D})=>D);return et.length===0&&et.push(Kt),et},_e=(et,D=!1)=>{let Q=yo(i(et)),U=hD(Q,c,c._runtimeFlags,dn);return c._scheduler.scheduleTask(()=>{D&&U.unsafeInterruptAsFork(c.id()),U.resume(Q)},0),U},lt=()=>{o||(p-=a.length,a=[]),h=!0,M()},Zt=r?xl:ke,No=_e(qe(et=>{let D=(U,fe)=>{U._op==="Blocked"?K.push(U):(b.push({index:fe,exit:U}),U._op==="Failure"&&!h&&lt())},Q=()=>{if(a.length>0){let U=a.pop(),fe=f++,Ie=()=>{let Z=a.pop();return fe=f++,x(Vr(),()=>x(Zt(s(t(Z,fe))),be))},be=Z=>a.length>0&&(D(Z,fe),a.length>0)?Ie():y(Z),me=x(Zt(s(t(U,fe))),be),se=_e(me);T.push(se),g.add(se),h&&se._scheduler.scheduleTask(()=>{se.unsafeInterruptAsFork(c.id())},0),se.addObserver(Z=>{let we;if(Z._op==="Failure"?we=Z:we=Z.effect_instruction_i0,P.push(se),g.delete(se),D(we,fe),b.length===p)et(y(De(ln(ae(),{parallel:!0}),()=>Kt)));else if(K.length+b.length===p){let he=K.map(Bs=>Bs.effect_instruction_i0).reduce(ah);et(y(xo(he,Ps([De(ln(ae(),{parallel:!0}),()=>Kt),...K.map(Bs=>Bs.effect_instruction_i1)],Bs=>Bs,r,!0,n))))}else Q()})}};for(let U=0;U<d;U++)Q()}));return Ee(yt(kt(s(xn(No))),Fi({onFailure:()=>{lt();let et=K.length+1,D=Math.min(typeof n=="number"?n:K.length,K.length),Q=Array.from(K);return qe(U=>{let fe=[],Ie=0,be=0,me=(Z,we)=>he=>{fe[Z]=he,Ie++,Ie===et&&U(dc(ln(fe,{parallel:!0}))),Q.length>0&&we&&se()},se=()=>{_e(Q.pop(),!0).addObserver(me(be,!0)),be++};No.addObserver(me(be,!1)),be++;for(let Z=0;Z<D;Z++)se()})},onSuccess:()=>st(P,et=>et.inheritAll)})))}))),Ux=(e,t,r,o)=>I(()=>{let n=ee(e),s=new Array(n.length);return ne(Ps(n,(c,a)=>C(r(c,a),p=>s[a]=p),o,!1,t),y(s))}),ur=e=>re((t,r)=>y(Nw(e,t,r.runtimeFlags))),Ls=e=>dD(e,dn),Iw=l(2,(e,t)=>ur(Sl(e,r=>{let o=Ur(r);switch(o._tag){case"Left":return t(o.left);case"Right":return Y(o.right)}}))),Nw=(e,t,r,o=null)=>{let n=Lp(e,t,r,o);return n.resume(e),n},hD=(e,t,r,o=null)=>Lp(e,t,r,o),Lp=(e,t,r,o=null)=>{let n=Uu(),s=t.getFiberRefs(),i=rd(s,n),c=new Ca(n,i,r),a=Es(i,mt),p=c._supervisor;return p.onStart(a,e,_(t),c),c.addObserver(h=>p.onEnd(h,c)),(o!==null?o:m(t.getFiberRef(qc),De(()=>t.scope()))).add(r,c),c},dD=(e,t)=>re((r,o)=>y(Nw(e,r,o.runtimeFlags,t))),jx=l(e=>Do(e[2]),(e,t,r,o)=>la(o?.concurrency,()=>ee(e).reduce((n,s,i)=>Kr(n,s,(c,a)=>r(c,a,i)),y(t)),()=>x(ra(t),n=>x(lr(e,(s,i)=>x(s,c=>cO(n,a=>r(a,c,i))),o),()=>Yl(n))))),zx=l(e=>mr(e[0]),(e,t,r)=>m(lr(e,(o,n)=>zr(t(o,n)),r),C(o=>m_(o,B)))),Pw=l(e=>mr(e[0]),(e,t,r)=>x(zx(e,t,{concurrency:r?.concurrency,batching:r?.batching}),([o,n])=>o.length===0?r?.discard?H:y(n):G(o))),Lw=e=>{let t=Nr(e);if(!tt(t))return en(()=>new zc("Received an empty collection of effects"));let r=Ze(t),o=ot(t),n=s=>m(Zv(s[1]),le(s[0]));return m(wt(),x(s=>m(ra(o.length),x(i=>Fe(c=>m(ur(Gr(r)),x(a=>m(o,st(p=>ur(Gr(p))),C(p=>ai(p)),C(p=>m(p,Qe(a))),$t(p=>m(p,er(H,(f,h)=>m(f,ne(m(nx(h),x(xD(p,h,s,i)),ur,Ee)))))),x(p=>m(c(m(bs(s),x(n))),_r(()=>m(p,er(H,(f,h)=>m(f,as(ls(h))))))))))))))))},xD=(e,t,r,o)=>n=>xs(n,{onFailure:s=>m(iO(o,i=>[i===0?m(gs(r,s),Ee):H,i-1]),kt),onSuccess:s=>m(Qc(r,[s,t]),x(i=>i?m(Nr(e),er(H,(c,a)=>a===t?c:m(c,as(ls(a))))):H))}),Dw=l(e=>mr(e[0])&&!ue(e[0]),(e,t,r,o)=>la(o?.concurrency,()=>ee(e).reduce((n,s,i)=>Kr(n,s,(c,a)=>r(c,a,i)),t),()=>I(()=>m(jx([t,...e],S(),(n,s,i)=>{switch(n._tag){case"None":return _(s);case"Some":return _(r(n.value,s,i))}},o),C(n=>{switch(n._tag){case"None":throw new Error("BUG: Effect.reduceEffect - please report an issue at https://github.com/Effect-TS/effect/issues");case"Some":return n.value}}))))),Dp=e=>ir(t=>Ke(dr(t,_n),{onNone:()=>e,onSome:r=>{switch(r.strategy._tag){case"Parallel":return e;case"Sequential":case"ParallelN":return x(hs(r,lp),o=>En(e,o))}}})),_w=e=>t=>ir(r=>Ke(dr(r,_n),{onNone:()=>t,onSome:o=>o.strategy._tag==="ParallelN"&&o.strategy.parallelism===e?t:x(hs(o,pp(e)),n=>En(t,n))})),Sn=e=>t=>ir(r=>Ke(dr(r,_n),{onNone:()=>t(B),onSome:o=>{let n=e._tag==="Parallel"?Dp:e._tag==="Sequential"?qp:_w(e.parallelism);switch(o.strategy._tag){case"Parallel":return n(t(Dp));case"Sequential":return n(t(qp));case"ParallelN":return n(t(_w(o.strategy.parallelism)))}}})),Ds=e=>x(_n,e),Gx=e=>x(wa(),t=>bD(e,t)),qp=e=>ir(t=>Ke(dr(t,_n),{onNone:()=>e,onSome:r=>{switch(r.strategy._tag){case"Sequential":return e;case"Parallel":case"ParallelN":return x(hs(r,up),o=>En(e,o))}}})),qw=(e,t)=>$x([Cs(e,t)]),$x=e=>pr(bo,t=>Fr(t,e)),Hw=l(2,(e,t)=>Zo(wa(),r=>x(En(e,r),t),(r,o)=>So(r,o))),Ww=l(e=>ue(e[1]),(e,t,r)=>Vx(e,t,(o,n)=>[o,n],r)),Vx=l(e=>ue(e[1]),(e,t,r,o)=>kt(Mo(ke(e),ke(t),(n,s)=>Kc(n,s,{onSuccess:r,onFailure:(i,c)=>o?.concurrent?vt(i,c):je(i,c)}),o)));var Uw=l(e=>mr(e[0]),(e,t,r)=>on(lr(e,(o,n)=>on(t(o,n)),r))),Bw=e=>pr(ye,ve(Jt,e)),jw=e=>pr(ye,ve(Ii,e)),zw=e=>pr(ye,ve(Ai,e)),Gw=e=>Ds(t=>x(hs(t,Zr),r=>m(e,En(r),C(o=>[Lt(n=>So(r,Nl(n))),o])))),$w=l(e=>ue(e[1]),(e,t,r)=>Mo(e,t,(o,n)=>[o,n],r)),Vw=l(e=>ue(e[1]),(e,t,r)=>r?.concurrent!==!0&&(r?.batching===void 0||r.batching===!1)?as(e,t):Mo(e,t,(o,n)=>o,r)),Kw=l(e=>ue(e[1]),(e,t,r)=>r?.concurrent!==!0&&(r?.batching===void 0||r.batching===!1)?ne(e,t):Mo(e,t,(o,n)=>n,r)),Mo=l(e=>ue(e[1]),(e,t,r,o)=>C(Ji([e,t],{concurrency:o?.concurrent?2:1,batching:o?.batching}),([n,s])=>r(n,s))),Jw=e=>e===FS?H:m(ki,x(t=>{let r=mo(t,e),o=nr(r,t);return m(sn(e),ne(Ki(()=>sn(o))),Ee)}),yo),_n=Et("effect/Scope"),Kx=_n,gD=(e,t)=>{e.state._tag==="Open"&&e.state.finalizers.add(t)},yD={[Ml]:Ml,[Rl]:Rl,pipe(){return O(this,arguments)},fork(e){return E(()=>{let t=Yw(e);if(this.state._tag==="Closed")return t.state=this.state,t;let r=o=>t.close(o);return this.state.finalizers.add(r),gD(t,o=>E(()=>{this.state._tag==="Open"&&this.state.finalizers.delete(r)})),t})},close(e){return I(()=>{if(this.state._tag==="Closed")return H;let t=Array.from(this.state.finalizers.values()).reverse();return this.state={_tag:"Closed",exit:e},t.length===0?H:Hd(this.strategy)?m(st(t,r=>ke(r(e))),x(r=>m(ln(r),Me($c),De(()=>Kt)))):Wd(this.strategy)?m(Pp(t,r=>ke(r(e)),!1),x(r=>m(ln(r,{parallel:!0}),Me($c),De(()=>Kt)))):m(Ux(t,this.strategy.parallelism,r=>ke(r(e)),!1),x(r=>m(ln(r,{parallel:!0}),Me($c),De(()=>Kt))))})},addFinalizer(e){return I(()=>this.state._tag==="Closed"?e(this.state.exit):(this.state.finalizers.add(e),H))}},Yw=(e=Zr)=>{let t=Object.create(yD);return t.strategy=e,t.state={_tag:"Open",finalizers:new Set},t},wa=(e=Zr)=>E(()=>Yw(e)),En=l(2,(e,t)=>ys(e,Pn(cm(_n,t)))),bD=l(2,(e,t)=>m(e,En(t),yt(r=>t.close(r)))),SD=e=>ps(e,{differ:gw,fork:Vi}),Wp=l(2,(e,t)=>Ee(ka(x(Ht(e),r=>le(os(e,t),r)),r=>os(e,r)))),pr=l(2,(e,t)=>He(e,r=>Wp(e,t(r))));var Ew=w_(RS),Hp=SD(Ns),Qw=e=>Ee(nx(Up(e))),Up=e=>({[pa]:fa,id:()=>ee(e).reduce((t,r)=>Lm(t,r.id()),zt),await:ke(Pp(e,t=>kt(t.await),!1)),children:C(Pp(e,t=>t.children,!1),du),inheritAll:Dt(e,t=>t.inheritAll),poll:C(st(e,t=>t.poll),xu(_(xe(new Array)),(t,r)=>{switch(r._tag){case"None":return S();case"Some":switch(t._tag){case"None":return S();case"Some":return _(Kc(r.value,t.value,{onSuccess:(o,n)=>[o,...n],onFailure:vt}))}}})),interruptAsFork:t=>Dt(e,r=>r.interruptAsFork(t)),pipe(){return O(this,arguments)}});var Jx=l(3,(e,t,r)=>Yx(e,t,{onSelfWin:(o,n)=>x(o.await,s=>{switch(s._tag){case Le:return x(o.inheritAll,()=>r.onSelfDone(s,n));case Pe:return r.onSelfDone(s,n)}}),onOtherWin:(o,n)=>x(o.await,s=>{switch(s._tag){case Le:return x(o.inheritAll,()=>r.onOtherDone(s,n));case Pe:return r.onOtherDone(s,n)}})})),Zw=e=>Fe(t=>Lt(r=>x(Ls(t(e)),o=>m(t(xn(o)),_r(()=>m(o,Xv(r))))))),Bp=l(2,(e,t)=>Lt(r=>Jx(e,t,{onSelfDone:(o,n)=>xs(o,{onFailure:s=>m(xn(n),qi(i=>vt(s,i))),onSuccess:s=>m(n,qt(r),le(s))}),onOtherDone:(o,n)=>xs(o,{onFailure:s=>m(xn(n),qi(i=>vt(i,s))),onSuccess:s=>m(n,qt(r),le(s))})}))),Yx=l(3,(e,t,r)=>re((o,n)=>{let s=n.runtimeFlags,i=Dr(!0),c=Lp(e,o,s,r.selfScope),a=Lp(t,o,s,r.otherScope);return qe(p=>{c.addObserver(()=>Ow(c,a,r.onSelfWin,i,p)),a.addObserver(()=>Ow(a,c,r.onOtherWin,i,p)),c.startFork(e),a.startFork(t)},Lm(c.id(),a.id()))})),Ow=(e,t,r,o,n)=>{Pu(!0,!1)(o)&&n(r(e,t))},vr=l(2,(e,t)=>Fe(r=>Se(r(e),{onFailure:o=>Se(t,{onFailure:n=>Y(je(o,n)),onSuccess:()=>Y(o)}),onSuccess:o=>le(t,o)}))),_D=(e,t,r)=>Lt(o=>x(x(Ls(Gr(e)),n=>qe(s=>{let i=t.map(p=>p.listeners.count),c=()=>{i.every(p=>p===0)&&t.every(p=>p.result.state.current._tag==="Pending"?!0:!!(p.result.state.current._tag==="Done"&&Gc(p.result.state.current.effect)&&p.result.state.current.effect._tag==="Failure"&&sl(p.result.state.current.effect.cause)))&&(a.forEach(p=>p()),r?.(),s(ls(n)))};n.addObserver(p=>{a.forEach(f=>f()),s(p)});let a=t.map((p,f)=>{let h=d=>{i[f]=d,c()};return p.listeners.addObserver(h),()=>p.listeners.removeObserver(h)});return c(),E(()=>{a.forEach(p=>p())})})),()=>I(()=>{let n=t.flatMap(s=>s.state.completed?[]:[s]);return Dt(n,s=>Ax(s.request,Nl(o)))})));var va=(e,t)=>(t=ho(t),yo(re(r=>{let o=ci(r.getFiberRef(mt),_n),n=cp(r,e,t),s=r.getFiberRef(Ri),i=Be(r.getFiberRef(ye),Jt);return le(ms(o,c=>Ld(n,c,i,s)),n)}))),Xw=e=>pr(ye,ve(Br,e)),eM=function(){let e=typeof arguments[0]!="string",t=e?arguments[1]:arguments[0],r=ho(e?arguments[2]:arguments[1]);if(e){let o=arguments[0];return x(va(t,ho(r)),n=>Hi(o,yr,n))}return o=>x(va(t,ho(r)),n=>Hi(o,yr,n))};var tM=(e,t,r,o)=>Gu({_tag:"Complete",key:e,exit:t,entryStats:r,timeToLiveMillis:o}),rM=(e,t)=>Gu({_tag:"Pending",key:e,deferred:t}),ED=(e,t)=>Gu({_tag:"Refreshing",deferred:e,complete:t}),Qx=Symbol.for("effect/Cache/MapKey"),Zx=class{current;[Qx]=Qx;previous=void 0;next=void 0;constructor(t){this.current=t}[F](){return m(w(this.current),L(w(this.previous)),L(w(this.next)),V(this))}[R](t){return this===t?!0:OD(t)&&v(this.current,t.current)&&v(this.previous,t.previous)&&v(this.next,t.next)}},Yi=e=>new Zx(e),OD=e=>k(e,Qx),Xx=class{head=void 0;tail=void 0;add(t){if(t!==this.tail)if(this.tail===void 0)this.head=t,this.tail=t;else{let r=t.previous,o=t.next;o!==void 0&&(t.next=void 0,r!==void 0?(r.next=o,o.previous=r):(this.head=o,this.head.previous=void 0)),this.tail.next=t,t.previous=this.tail,this.tail=t}}remove(){let t=this.head;if(t!==void 0){let r=t.next;r!==void 0?(t.next=void 0,this.head=r,this.head.previous=void 0):(this.head=void 0,this.tail=void 0)}return t}},CD=()=>new Xx,vD=(e,t,r,o,n,s)=>({map:e,keys:t,accesses:r,updating:o,hits:n,misses:s}),kD=()=>vD(Ss(),CD(),eE(),Dr(!1),0,0),wD="effect/Cache",MD=Symbol.for(wD),RD={_Key:e=>e,_Error:e=>e,_Value:e=>e},FD=e=>e,jp=e=>({loadedMillis:e}),eg=class{capacity;context;fiberId;lookup;timeToLive;[MD]=RD;cacheState;constructor(t,r,o,n,s){this.capacity=t,this.context=r,this.fiberId=o,this.lookup=n,this.timeToLive=s,this.cacheState=kD()}get(t){return C(this.getEither(t),pu)}get cacheStats(){return E(()=>FD({hits:this.cacheState.hits,misses:this.cacheState.misses,size:Ll(this.cacheState.map)}))}getOption(t){return I(()=>Ke(Ge(this.cacheState.map,t),{onNone:()=>{let r=Yi(t);return this.trackAccess(r),this.trackMiss(),y(S())},onSome:r=>this.resolveMapValue(r)}))}getOptionComplete(t){return I(()=>Ke(Ge(this.cacheState.map,t),{onNone:()=>{let r=Yi(t);return this.trackAccess(r),this.trackMiss(),y(S())},onSome:r=>this.resolveMapValue(r,!0)}))}contains(t){return E(()=>Or(this.cacheState.map,t))}entryStats(t){return E(()=>{let r=Ge(this.cacheState.map,t);if(W(r))switch(r.value._tag){case"Complete":{let o=r.value.entryStats.loadedMillis;return _(jp(o))}case"Pending":return S();case"Refreshing":{let o=r.value.complete.entryStats.loadedMillis;return _(jp(o))}}return S()})}getEither(t){return I(()=>{let r=t,o,n,s=pt(Ge(this.cacheState.map,r));return s===void 0&&(n=Ah(this.fiberId),o=Yi(r),Or(this.cacheState.map,r)?s=pt(Ge(this.cacheState.map,r)):Wt(this.cacheState.map,r,rM(o,n))),s===void 0?(this.trackAccess(o),this.trackMiss(),C(this.lookupValueOf(t,n),Ve)):x(this.resolveMapValue(s),Ke({onNone:()=>this.getEither(t),onSome:i=>y(St(i))}))})}invalidate(t){return E(()=>{_s(this.cacheState.map,t)})}invalidateWhen(t,r){return E(()=>{let o=Ge(this.cacheState.map,t);W(o)&&o.value._tag==="Complete"&&o.value.exit._tag==="Success"&&r(o.value.exit.value)&&_s(this.cacheState.map,t)})}get invalidateAll(){return E(()=>{this.cacheState.map=Ss()})}refresh(t){return Qr(r=>I(()=>{let o=t,n=Ah(this.fiberId),s=pt(Ge(this.cacheState.map,o));if(s===void 0&&(Or(this.cacheState.map,o)?s=pt(Ge(this.cacheState.map,o)):Wt(this.cacheState.map,o,rM(Yi(o),n))),s===void 0)return Ee(this.lookupValueOf(t,n));switch(s._tag){case"Complete":{if(this.hasExpired(r,s.timeToLiveMillis)){let i=pt(Ge(this.cacheState.map,o));return v(i,s)&&_s(this.cacheState.map,o),Ee(this.get(t))}return m(this.lookupValueOf(t,n),ip(()=>{let i=pt(Ge(this.cacheState.map,o));if(v(i,s)){let c=ED(n,s);return Wt(this.cacheState.map,o,c),!0}return!1}),Ee)}case"Pending":return bs(s.deferred);case"Refreshing":return bs(s.deferred)}}))}set(t,r){return Qr(o=>E(()=>{let n=o.unsafeCurrentTimeMillis(),s=t,i=z_(r),c=tM(Yi(s),i,jp(n),n+Pr(nt(this.timeToLive(i))));Wt(this.cacheState.map,s,c)}))}get size(){return E(()=>Ll(this.cacheState.map))}get values(){return E(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push(r[1].exit.value);return t})}get entries(){return E(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push([r[0],r[1].exit.value]);return t})}get keys(){return E(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push(r[0]);return t})}resolveMapValue(t,r=!1){return Qr(o=>{switch(t._tag){case"Complete":return this.trackAccess(t.key),this.hasExpired(o,t.timeToLiveMillis)?(_s(this.cacheState.map,t.key.current),y(S())):(this.trackHit(),C(t.exit,_));case"Pending":return this.trackAccess(t.key),this.trackHit(),r?y(S()):C(bs(t.deferred),_);case"Refreshing":return this.trackAccess(t.complete.key),this.trackHit(),this.hasExpired(o,t.complete.timeToLiveMillis)?r?y(S()):C(bs(t.deferred),_):C(t.complete.exit,_)}})}trackHit(){this.cacheState.hits=this.cacheState.hits+1}trackMiss(){this.cacheState.misses=this.cacheState.misses+1}trackAccess(t){if(tE(this.cacheState.accesses,t),Pu(this.cacheState.updating,!1,!0)){let r=!0;for(;r;){let n=rE(this.cacheState.accesses,qh);n===qh?r=!1:this.cacheState.keys.add(n)}let o=Ll(this.cacheState.map);for(r=o>this.capacity;r;){let n=this.cacheState.keys.remove();n!==void 0?Or(this.cacheState.map,n.current)&&(_s(this.cacheState.map,n.current),o=o-1,r=o>this.capacity):r=!1}or(this.cacheState.updating,!1)}}hasExpired(t,r){return t.unsafeCurrentTimeMillis()>r}lookupValueOf(t,r){return Qr(o=>I(()=>{let n=t;return m(this.lookup(t),Er(this.context),ke,x(s=>{let i=o.unsafeCurrentTimeMillis(),c=jp(i),a=tM(Yi(n),s,c,i+Pr(nt(this.timeToLive(s))));return Wt(this.cacheState.map,n,a),ne(U_(r,s),s)}),_r(()=>ne(B_(r),E(()=>{_s(this.cacheState.map,n)}))))}))}};var oM=(e,t,r)=>new eg(e,Ot(),qu,t,o=>nt(r(o)));u();var nM=es;var sM=Pc;var X={};my(X,{Do:()=>NW,EffectTypeId:()=>Eq,Tag:()=>cj,acquireRelease:()=>dH,acquireReleaseInterruptible:()=>xH,acquireUseRelease:()=>gH,addFinalizer:()=>yH,all:()=>Rq,allSuccesses:()=>Tq,allWith:()=>Fq,allowInterrupt:()=>G1,andThen:()=>eU,annotateCurrentSpan:()=>$B,annotateLogs:()=>VU,annotateLogsScoped:()=>KU,annotateSpans:()=>GB,ap:()=>FB,as:()=>rH,asSome:()=>oH,asSomeError:()=>nH,asVoid:()=>sH,async:()=>e1,asyncEffect:()=>t1,awaitAllChildren:()=>FH,bind:()=>PW,bindTo:()=>LW,blocked:()=>TB,cacheRequestResult:()=>PB,cached:()=>kq,cachedFunction:()=>wq,cachedInvalidateWithTTL:()=>vq,cachedWithTTL:()=>Cq,catch:()=>E1,catchAll:()=>O1,catchAllCause:()=>C1,catchAllDefect:()=>v1,catchIf:()=>k1,catchSome:()=>w1,catchSomeCause:()=>M1,catchSomeDefect:()=>R1,catchTag:()=>F1,catchTags:()=>T1,cause:()=>A1,checkInterruptible:()=>$1,clock:()=>XH,clockWith:()=>eW,configProviderWith:()=>xW,console:()=>oW,consoleWith:()=>nW,context:()=>bW,contextWith:()=>SW,contextWithEffect:()=>_W,currentParentSpan:()=>KB,currentSpan:()=>VB,custom:()=>r1,daemonChildren:()=>TH,delay:()=>cW,descriptor:()=>AH,descriptorWith:()=>IH,die:()=>a1,dieMessage:()=>u1,dieSync:()=>l1,diffFiberRefs:()=>NH,disconnect:()=>V1,dropUntil:()=>Aq,dropWhile:()=>Iq,either:()=>qW,ensuring:()=>bH,ensuringChild:()=>PH,ensuringChildren:()=>LH,eventually:()=>I1,every:()=>Nq,exists:()=>Pq,exit:()=>HW,fail:()=>n1,failCause:()=>i1,failCauseSync:()=>c1,failSync:()=>s1,fiberId:()=>DH,fiberIdWith:()=>qH,filter:()=>Lq,filterMap:()=>Dq,filterOrDie:()=>jW,filterOrDieMessage:()=>zW,filterOrElse:()=>GW,filterOrFail:()=>$W,finalizersMask:()=>OH,findFirst:()=>qq,firstSuccessOf:()=>Hq,flatMap:()=>XW,flatten:()=>tU,flip:()=>iH,flipWith:()=>cH,forEach:()=>Wq,forever:()=>mU,fork:()=>HH,forkAll:()=>UH,forkDaemon:()=>WH,forkIn:()=>BH,forkScoped:()=>jH,forkWithErrorHandler:()=>zH,fromFiber:()=>GH,fromFiberEffect:()=>$H,fromNullable:()=>sj,functionWithSpan:()=>rj,gen:()=>p1,getFiberRefs:()=>OU,getRuntimeFlags:()=>cB,head:()=>Uq,if:()=>BW,ignore:()=>N1,ignoreLogged:()=>P1,inheritFiberRefs:()=>CU,interrupt:()=>K1,interruptWith:()=>J1,interruptible:()=>Y1,interruptibleMask:()=>Q1,intoDeferred:()=>WW,isEffect:()=>Oq,isFailure:()=>AU,isSuccess:()=>IU,iterate:()=>hU,labelMetrics:()=>fB,labelMetricsScoped:()=>hB,let:()=>DW,liftPredicate:()=>tH,linkSpans:()=>QB,locally:()=>vU,locallyScoped:()=>wU,locallyScopedWith:()=>MU,locallyWith:()=>kU,log:()=>qU,logAnnotations:()=>JU,logDebug:()=>UU,logError:()=>zU,logFatal:()=>GU,logInfo:()=>BU,logTrace:()=>WU,logWarning:()=>jU,logWithLevel:()=>HU,loop:()=>dU,makeSemaphore:()=>yB,makeSpan:()=>ZB,makeSpanScoped:()=>XB,map:()=>aH,mapAccum:()=>uH,mapBoth:()=>lH,mapError:()=>pH,mapErrorCause:()=>fH,mapInputContext:()=>EW,match:()=>NU,matchCause:()=>PU,matchCauseEffect:()=>LU,matchEffect:()=>DU,merge:()=>mH,mergeAll:()=>Bq,metricLabels:()=>dB,negate:()=>hH,never:()=>f1,none:()=>m1,onError:()=>SH,onExit:()=>_H,onInterrupt:()=>Z1,once:()=>Mq,option:()=>UW,optionFromOptional:()=>ij,orDie:()=>QU,orDieWith:()=>ZU,orElse:()=>XU,orElseFail:()=>eB,orElseSucceed:()=>tB,parallelErrors:()=>L1,parallelFinalizers:()=>EH,partition:()=>jq,patchFiberRefs:()=>RU,patchRuntimeFlags:()=>aB,promise:()=>h1,provide:()=>OW,provideService:()=>CW,provideServiceEffect:()=>vW,race:()=>oU,raceAll:()=>rU,raceFirst:()=>nU,raceWith:()=>sU,random:()=>rB,randomWith:()=>oB,reduce:()=>zq,reduceEffect:()=>Gq,reduceRight:()=>$q,reduceWhile:()=>Vq,repeat:()=>xU,repeatN:()=>gU,repeatOrElse:()=>yU,replicate:()=>Kq,replicateEffect:()=>Jq,request:()=>NB,retry:()=>q1,retryOrElse:()=>H1,runCallback:()=>SB,runFork:()=>bB,runPromise:()=>_B,runPromiseExit:()=>EB,runRequestBlock:()=>AB,runSync:()=>OB,runSyncExit:()=>CB,runtime:()=>iB,sandbox:()=>D1,schedule:()=>bU,scheduleForked:()=>SU,scheduleFrom:()=>_U,scope:()=>vH,scopeWith:()=>kH,scoped:()=>wH,sequentialFinalizers:()=>CH,serviceConstants:()=>RW,serviceFunction:()=>kW,serviceFunctionEffect:()=>wW,serviceFunctions:()=>MW,serviceMembers:()=>FW,serviceOption:()=>TW,serviceOptional:()=>AW,setFiberRefs:()=>FU,sleep:()=>aW,spanAnnotations:()=>JB,spanLinks:()=>YB,step:()=>IB,succeed:()=>d1,succeedNone:()=>x1,succeedSome:()=>g1,summarized:()=>iU,supervised:()=>VH,suspend:()=>y1,sync:()=>b1,tagMetrics:()=>pB,tagMetricsScoped:()=>mB,takeUntil:()=>Yq,takeWhile:()=>Qq,tap:()=>cU,tapBoth:()=>aU,tapDefect:()=>uU,tapError:()=>lU,tapErrorCause:()=>fU,tapErrorTag:()=>pU,timed:()=>uW,timedWith:()=>lW,timeout:()=>pW,timeoutFail:()=>mW,timeoutFailCause:()=>hW,timeoutOption:()=>fW,timeoutTo:()=>dW,tracer:()=>HB,tracerWith:()=>WB,transplant:()=>KH,try:()=>W1,tryMap:()=>U1,tryMapPromise:()=>B1,tryPromise:()=>j1,uninterruptible:()=>X1,uninterruptibleMask:()=>eH,unless:()=>VW,unlessEffect:()=>KW,unsafeMakeSemaphore:()=>gB,unsandbox:()=>z1,updateFiberRefs:()=>TU,updateService:()=>IW,useSpan:()=>ej,using:()=>MH,validate:()=>vB,validateAll:()=>Zq,validateFirst:()=>Xq,validateWith:()=>kB,void:()=>S1,when:()=>JW,whenEffect:()=>YW,whenFiberRef:()=>QW,whenRef:()=>ZW,whileLoop:()=>EU,withClock:()=>rW,withClockScoped:()=>tW,withConcurrency:()=>JH,withConfigProvider:()=>gW,withConfigProviderScoped:()=>yW,withConsole:()=>iW,withConsoleScoped:()=>sW,withEarlyRelease:()=>RH,withFiberRuntime:()=>o1,withLogSpan:()=>$U,withMaxOpsBeforeYield:()=>ZH,withMetric:()=>xB,withParentSpan:()=>nj,withRandom:()=>nB,withRandomScoped:()=>sB,withRequestBatching:()=>LB,withRequestCache:()=>qB,withRequestCaching:()=>DB,withRuntimeFlagsPatch:()=>uB,withRuntimeFlagsPatchScoped:()=>lB,withScheduler:()=>YH,withSchedulingPriority:()=>QH,withSpan:()=>tj,withSpanScoped:()=>oj,withTracer:()=>UB,withTracerEnabled:()=>jB,withTracerScoped:()=>BB,withTracerTiming:()=>zB,withUnhandledErrorLogLevel:()=>YU,yieldNow:()=>_1,zip:()=>wB,zipLeft:()=>MB,zipRight:()=>RB,zipWith:()=>jR});u();u();u();u();u();u();u();u();u();var AD="effect/ScheduleInterval",Ra=Symbol.for(AD),tg={[Ra]:Ra,startMillis:0,endMillis:0},rg=(e,t)=>e>t?tg:{[Ra]:Ra,startMillis:e,endMillis:t},iM=l(2,(e,t)=>cM(e,t)===e),cM=l(2,(e,t)=>e.endMillis<=t.startMillis?e:t.endMillis<=e.startMillis?t:e.startMillis<t.startMillis?e:t.startMillis<e.startMillis?t:e.endMillis<=t.endMillis?e:t);var aM=e=>e.startMillis>=e.endMillis;var uM=l(2,(e,t)=>{let r=Math.max(e.startMillis,t.startMillis),o=Math.min(e.endMillis,t.endMillis);return rg(r,o)});var lM=e=>rg(e,Number.POSITIVE_INFINITY);var og=tg,pM=iM;var fM=aM;var mM=uM;var hM=lM;var PD="effect/ScheduleIntervals",sg=Symbol.for(PD),ig=e=>({[sg]:sg,intervals:e});var dM=l(2,(e,t)=>LD(e.intervals,t.intervals,Nt())),LD=(e,t,r)=>{let o=e,n=t,s=r;for(;tt(o)&&tt(n);){let i=m(Ze(o),mM(Ze(n))),c=fM(i)?s:m(s,Qe(i));m(Ze(o),pM(Ze(n)))?o=ot(o):n=ot(n),s=c}return ig(Ir(s))},zp=e=>m(e.intervals,yu,De(()=>og)).startMillis,xM=e=>m(e.intervals,yu,De(()=>og)).endMillis,gM=l(2,(e,t)=>zp(e)<zp(t)),yM=e=>tt(e.intervals);var bM=ig;var SM=dM,_M=zp,cg=xM,EM=gM,OM=yM;var ug="Continue",CM="Done",vM=e=>({_tag:ug,intervals:e}),kM=e=>({_tag:ug,intervals:bM(Re(e))}),wM={_tag:CM},MM=e=>e._tag===ug,RM=e=>e._tag===CM;var FM=vM;var TM=kM,Qi=wM,lg=MM,Fa=RM;u();var IM=So;var NM=hs;u();u();var HD="effect/Schedule",qM=Symbol.for(HD),HM=e=>k(e,qM),WD="effect/ScheduleDriver",UD=Symbol.for(WD),BD={_Out:e=>e,_In:e=>e,_R:e=>e},jD={_Out:e=>e,_In:e=>e,_R:e=>e},pg=class{initial;step;[qM]=BD;constructor(t,r){this.initial=t,this.step=r}pipe(){return O(this,arguments)}},fg=class{schedule;ref;[UD]=jD;constructor(t,r){this.schedule=t,this.ref=r}get state(){return C(ar(this.ref),t=>t[1])}get last(){return x(ar(this.ref),([t,r])=>{switch(t._tag){case"None":return Sr(()=>new Vt);case"Some":return y(t.value)}})}get reset(){return Oo(this.ref,[S(),this.schedule.initial])}next(t){return m(C(ar(this.ref),r=>r[1]),x(r=>m(jl,x(o=>m(I(()=>this.schedule.step(o,t,r)),x(([n,s,i])=>{let c=Oo(this.ref,[_(s),n]);if(Fa(i))return ne(c,G(S()));let a=_M(i.intervals)-o;return a<=0?le(c,s):m(c,ne(ks(pi(a))),le(s))}))))))}},Ta=(e,t)=>new pg(e,t);var zD=l(2,(e,t)=>dg(e,(r,o)=>E(()=>t(r,o)))),dg=l(2,(e,t)=>Ta(e.initial,(r,o,n)=>x(e.step(r,o,n),([s,i,c])=>Fa(c)?y([s,i,Qi]):C(t(o,i),a=>a?[s,i,c]:[s,i,Qi]))));var xg=e=>m(Os([S(),e.initial]),C(t=>new fg(e,t)));var WM=l(2,(e,t)=>GD(e,t,SM)),GD=l(3,(e,t,r)=>Ta([e.initial,t.initial],(o,n,s)=>m(Kr(e.step(o,n,s[0]),t.step(o,n,s[1]),(i,c)=>[i,c]),x(([[i,c,a],[p,f,h]])=>lg(a)&&lg(h)?mg(e,t,n,i,c,a.intervals,p,f,h.intervals,r):y([[i,p],[c,f],Qi]))))),mg=(e,t,r,o,n,s,i,c,a,p)=>{let f=p(s,a);return OM(f)?y([[o,i],[n,c],FM(f)]):m(s,EM(a))?x(e.step(cg(s),r,o),([h,d,g])=>Fa(g)?y([[h,i],[d,c],Qi]):mg(e,t,r,h,d,g.intervals,i,c,a,p)):x(t.step(cg(a),r,i),([h,d,g])=>Fa(g)?y([[o,h],[n,d],Qi]):mg(e,t,r,o,n,s,h,d,g.intervals,p))};var $D=l(2,(e,t)=>VD(e,r=>E(()=>t(r)))),VD=l(2,(e,t)=>Ta(e.initial,(r,o,n)=>x(e.step(r,o,n),([s,i,c])=>C(t(i),a=>[s,a,c]))));var KD=e=>Ta(e.initial,(t,r,o)=>m(e.step(t,r,o),C(([n,s,i])=>[n,r,i])));var UM=e=>YD(Sg,t=>t<e);var JD=(e,t)=>Ta(e,(r,o,n)=>E(()=>[t(n),n,TM(hM(r))]));var BM=l(2,(e,t)=>dg(e,(r,o)=>np(t(r))));var jM=l(2,(e,t)=>dg(e,(r,o)=>t(r))),YD=l(2,(e,t)=>zD(e,(r,o)=>t(o)));var Gp=Symbol.for("effect/Schedule/ScheduleDefect"),hg=class{error;[Gp];constructor(t){this.error=t,this[Gp]=Gp}},QD=e=>k(e,Gp),$p=e=>br(e,t=>go(new hg(t))),zM=e=>jr(e,t=>Ke(Jo(t,r=>Oi(r)&&QD(r.defect)?_(r.defect):S()),{onNone:()=>Y(t),onSome:r=>G(r.error)})),LM=l(2,(e,t)=>gg(e,t,(r,o)=>G(r))),GM=l(2,(e,t)=>{if(HM(t))return LM(e,t);let r=t.schedule??KD(Sg),o=t.while?jM(r,i=>{let c=t.while(i);return typeof c=="boolean"?y(c):$p(c)}):r,n=t.until?BM(o,i=>{let c=t.until(i);return typeof c=="boolean"?y(c):$p(c)}):o,s=t.times?WM(n,UM(t.times)).pipe($D(i=>i[0])):n;return zM(LM(e,s))}),gg=l(3,(e,t,r)=>x(xg(t),o=>Xe(e,{onFailure:n=>r(n,S()),onSuccess:n=>$M(e,o,r,n)}))),$M=(e,t,r,o)=>Xe(t.next(o),{onFailure:()=>is(t.last),onSuccess:n=>Xe(e,{onFailure:s=>r(s,_(n)),onSuccess:s=>$M(e,t,r,s)})}),DM=l(2,(e,t)=>yg(e,t,(r,o)=>G(r))),VM=l(2,(e,t)=>{if(HM(t))return DM(e,t);let r=t.schedule??Sg,o=t.while?jM(r,i=>{let c=t.while(i);return typeof c=="boolean"?y(c):$p(c)}):r,n=t.until?BM(o,i=>{let c=t.until(i);return typeof c=="boolean"?y(c):$p(c)}):o,s=t.times?WM(n,UM(t.times)):n;return zM(DM(e,s))}),yg=l(3,(e,t,r)=>x(xg(t),o=>KM(e,o,r))),KM=(e,t,r)=>br(e,o=>Xe(t.next(o),{onFailure:()=>m(t.last,is,x(n=>r(o,n))),onSuccess:()=>KM(e,t,r)})),Vp=l(2,(e,t)=>bg(e,void 0,t)),bg=l(3,(e,t,r)=>x(xg(r),o=>JM(e,t,o))),JM=(e,t,r)=>Xe(r.next(t),{onFailure:()=>is(r.last),onSuccess:()=>x(e,o=>JM(e,o,r))});var Sg=JD(0,e=>e+1);var Eg=class{permits;waiters=new Set;taken=0;constructor(t){this.permits=t}get free(){return this.permits-this.taken}take=t=>qe(r=>{if(this.free<t){let o=()=>{this.free<t||(this.waiters.delete(o),this.taken+=t,r(y(t)))};return this.waiters.add(o),E(()=>{this.waiters.delete(o)})}return this.taken+=t,r(y(t))});updateTaken=t=>re(r=>(this.taken=t(this.taken),this.waiters.size>0&&r.getFiberRef(hn).scheduleTask(()=>{let o=this.waiters.values(),n=o.next();for(;n.done===!1&&this.free>0;)n.value(),n=o.next()},r.getFiberRef(cn)),y(this.free)));release=t=>this.updateTaken(r=>r-t);releaseAll=this.updateTaken(t=>0);withPermits=t=>r=>Fe(o=>x(o(this.take(t)),n=>vr(o(r),this.release(n))))},Jp=e=>new Eg(e),ZM=e=>E(()=>Jp(e)),XM=e=>Yp(e,Qw),eR=l(2,(e,t)=>C(Cg(e,t),r=>r[0])),Cg=l(2,(e,t)=>{let r=nt(t);return x(sr(),o=>C(Qp(S()),n=>[Er(ZD(e,r,n),o),XD(n)]))}),QM=(e,t,r)=>{let o=Pr(nt(t));return m(wt(),$t(n=>$r(e,n)),C(n=>_([r+o,n])))},ZD=(e,t,r)=>Fe(o=>m(Qr(n=>n.currentTimeMillis),x(n=>oq(r,s=>{switch(s._tag){case"None":return _(QM(e,t,n));case"Some":{let[i]=s.value;return i-n<=0?_(QM(e,t,n)):S()}}})),x(n=>z(n)?Xo("BUG: Effect.cachedInvalidate - please report an issue at https://github.com/Effect-TS/effect/issues"):o(it(n.value[1]))))),XD=e=>Oo(e,S()),tR=l(2,(e,t)=>Yp(e,r=>t(Up(r)))),Yp=l(2,(e,t)=>x(lw,r=>m(wg(e,r),vr(x(r.value,t))))),rR=l(e=>mr(e[0]),(e,t)=>t?.discard?Dt(e,ur):C(st(e,ur),Up)),vg=l(2,(e,t)=>Fe(r=>x(t.fork(Zr),o=>m(r(e),yt(n=>o.close(n)),Ls,$t(n=>o.addFinalizer(()=>Lt(s=>v(s,n.id())?H:Ee(ls(n))))))))),kg=e=>Ds(t=>vg(e,t)),oR=e=>xn(e),nR=e=>I(()=>x(e,xn)),_g=Symbol.for("effect/Effect/memoizeFunction.key"),Kp=class{a;eq;[_g]=_g;constructor(t,r){this.a=t,this.eq=r}[R](t){return k(t,_g)?this.eq?this.eq(this.a,t.a):v(this.a,t.a):!1}[F](){return this.eq?0:V(this,w(this.a))}},sR=(e,t)=>m(E(()=>Ss()),x(Qp),C(r=>o=>m(r.modifyEffect(n=>{let s=m(n,Ge(new Kp(o,t)));return z(s)?m(wt(),$t(i=>m(Di(e(o)),$r(i),ur)),C(i=>[i,m(n,Wt(new Kp(o,t),i))])):y([s.value,n])}),x(it),x(([n,s])=>m(vs(n),le(s)))))),iR=l(2,(e,t)=>m(ke(e),Bp(ke(t)),r=>kt(r))),cR=l(2,(e,t)=>m(e,Vp(t),kg)),wg=l(2,(e,t)=>rt(Hp,o=>o.zip(t))(e)),aR=l(2,(e,t)=>Mg(e,{onTimeout:()=>I_(t),duration:t})),Mg=l(2,(e,{duration:t,onTimeout:r})=>kt(Aa(e,{onTimeout:()=>Sr(r),onSuccess:y,duration:t}))),uR=l(2,(e,{duration:t,onTimeout:r})=>kt(Aa(e,{onTimeout:()=>tn(r),onSuccess:y,duration:t}))),lR=l(2,(e,t)=>Aa(e,{duration:t,onSuccess:_,onTimeout:S})),Aa=l(2,(e,{duration:t,onSuccess:r,onTimeout:o})=>Lt(n=>Yx(e,Gr(ks(t)),{onSelfWin:(s,i)=>x(s.await,c=>c._tag==="Success"?x(s.inheritAll,()=>le(qt(i,n),r(c.value))):x(qt(i,n),()=>ie(c.cause))),onOtherWin:(s,i)=>x(s.await,c=>c._tag==="Success"?x(s.inheritAll,()=>le(qt(i,n),o())):x(qt(i,n),()=>ie(c.cause))),otherScope:dn}))),eq="effect/Ref/SynchronizedRef",tq=Symbol.for(eq),rq={_A:e=>e},Og=class{ref;withLock;[tq]=rq;[$l]=dd;[Yr];constructor(t,r){this.ref=t,this.withLock=r,this[Yr]=Yr,this.get=ar(this.ref)}get;modify(t){return this.modifyEffect(r=>y(t(r)))}modifyEffect(t){return this.withLock(m(x(ar(this.ref),t),x(([r,o])=>le(Oo(this.ref,o),r))))}pipe(){return O(this,arguments)}},Qp=e=>E(()=>pR(e)),pR=e=>{let t=Vl(e),r=Jp(1);return new Og(t,r.withPermits(1))},oq=l(2,(e,t)=>e.modifyEffect(r=>{let o=t(r);switch(o._tag){case"None":return y([r,r]);case"Some":return C(o.value,n=>[n,n])}}));u();var mR="Fresh";u();u();var hR=qt;var Xp=e=>(t,r)=>{let o=Uu(),n=[[mt,[[o,e.context]]]];r?.scheduler&&n.push([hn,[[o,r.scheduler]]]);let s=YE(e.fiberRefs,{entries:n,forkAs:o});r?.updateRefs&&(s=r.updateRefs(s,o));let i=new Ca(o,s,e.runtimeFlags),c=t;r?.scope&&(c=x(NM(r.scope,Zr),p=>ne(Fl(p,Lt(f=>v(f,i.id())?H:qt(i,f))),yt(t,f=>IM(p,f)))));let a=i._supervisor;return a!==Ns&&(a.onStart(e.context,c,S(),i),i.addObserver(p=>a.onEnd(p,i))),dn.add(e.runtimeFlags,i),r?.immediate===!1?i.resume(c):i.start(c),i},Ig=e=>(t,r={})=>{let o=Xp(e)(t,r);return r.onExit&&o.addObserver(n=>{r.onExit(n)}),(n,s)=>Ig(e)(m(o,hR(n??zt)),{...s,onExit:s?.onExit?i=>s.onExit(j_(i)):void 0})},sq=e=>t=>{let r=yR(e)(t);if(r._tag==="Failure")throw xR(r.effect_instruction_i0);return r.effect_instruction_i0},Tg=class extends Error{fiber;_tag="AsyncFiberException";constructor(t){super(`Fiber #${t.id().id} cannot be resolved synchronously. This is caused by using runSync on an effect that performs async work`),this.fiber=t,this.name=this._tag,this.stack=this.message}},iq=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=0;let r=new Tg(e);return Error.stackTraceLimit=t,r};var Rg=Symbol.for("effect/Runtime/FiberFailure"),Fg=Symbol.for("effect/Runtime/FiberFailure/Cause"),Ag=class extends Error{[Rg];[Fg];constructor(t){super(),this[Rg]=Rg,this[Fg]=t;let r=al(t);if(r.length>0){let o=r[0];this.name=o.name,this.message=o.message,this.stack=o.stack}this.name=`(FiberFailure) ${this.name}`,(this.message===void 0||this.message.length===0)&&(this.message="An error has occurred")}toJSON(){return{_id:"FiberFailure",cause:this[Fg].toJSON()}}toString(){return"(FiberFailure) "+(this.stack??this.message)}[j](){return this.toString()}},xR=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=0;let r=new Ag(e);return Error.stackTraceLimit=t,r};var gR=e=>{let t=e;switch(t._op){case"Failure":case"Success":return t;case"Left":return Vc(t.left);case"Right":return xe(t.right);case"Some":return xe(t.value);case"None":return Vc(Vt())}},yR=e=>t=>{let r=gR(t);if(r)return r;let o=new _p,n=Xp(e)(t,{scheduler:o});o.flush();let s=n.unsafePoll();if(s)return s;throw iq(n)},cq=e=>(t,r)=>bR(e)(t,r).then(o=>{switch(o._tag){case Le:return o.effect_instruction_i0;case Pe:throw xR(o.effect_instruction_i0)}}),bR=e=>(t,r)=>new Promise(o=>{let n=gR(t);n&&o(n);let s=Xp(e)(t);s.addObserver(i=>{o(i)}),r?.signal!==void 0&&(r.signal.aborted?s.unsafeInterruptAsFork(s.id()):r.signal.addEventListener("abort",()=>{s.unsafeInterruptAsFork(s.id())},{once:!0}))}),Zp=class{context;runtimeFlags;fiberRefs;constructor(t,r,o){this.context=t,this.runtimeFlags=r,this.fiberRefs=o}pipe(){return O(this,arguments)}},aq=e=>new Zp(e.context,e.runtimeFlags,e.fiberRefs),ef=()=>re((e,t)=>y(new Zp(e.getFiberRef(mt),t.runtimeFlags,e.getFiberRefs()))),uq=Xm(Wr,Qm,Ym),Ro=aq({context:Ot(),runtimeFlags:uq,fiberRefs:QE()});var SR=Ig(Ro),_R=Xp(Ro),ER=cq(Ro),OR=bR(Ro),CR=sq(Ro),vR=yR(Ro),kR=e=>I(()=>{let t;return x(wt(),r=>x(ef(),o=>Fe(n=>ne(ur(n(Se(e(s=>Ig(o)($r(s,r))),{onFailure:s=>gs(r,s),onSuccess:s=>(t=s,H)}))),n(_r(it(r),()=>t??H))))))});u();var MR=l(2,(e,t)=>e.modifyEffect(t));var pq="effect/Layer",RR=Symbol.for(pq),fq={_RIn:e=>e,_E:e=>e,_ROut:e=>e},_9={[RR]:fq,pipe(){return O(this,arguments)}},mq="effect/Layer/MemoMap",Ng=Symbol.for(mq),hq=e=>k(e,RR),dq=e=>e._tag===mR,Pg=class{ref;[Ng];constructor(t){this.ref=t,this[Ng]=Ng}getOrElseMemoize(t,r){return m(MR(this.ref,o=>{let n=o.get(t);if(n!==void 0){let[s,i]=n,c=m(s,x(([a,p])=>m(vs(a),le(p))),yt(Fi({onFailure:()=>H,onSuccess:()=>ms(r,i)})));return y([c,o])}return m(Os(0),x(s=>m(wt(),x(i=>m(Os(()=>H),C(c=>{let a=Fe(f=>m(wa(),x(h=>m(f(x(TR(t,h,!0),d=>Di(d(this)))),ke,x(d=>{switch(d._tag){case Pe:return m(gs(i,d.effect_instruction_i0),ne(So(h,d)),ne(Y(d.effect_instruction_i0)));case Le:return m(Oo(c,g=>m(So(h,g),wi(Kl(s,b=>[b===1,b-1])),Ee)),ne(ta(s,g=>g+1)),ne(ms(r,g=>m(E(()=>o.delete(t)),ne(ar(c)),x(b=>b(g))))),ne(Qc(i,d.effect_instruction_i0)),le(d.effect_instruction_i0[1]))}}))))),p=[m(it(i),yt(xs({onFailure:()=>H,onSuccess:()=>ta(s,f=>f+1)}))),f=>m(ar(c),x(h=>h(f)))];return[a,dq(t)?o:o.set(t,p)]}))))))}),kt)}},xq=I(()=>C(Qp(new Map),e=>new Pg(e)));var FR=l(2,(e,t)=>x(xq,r=>x(TR(e,t),o=>o(r))));var TR=(e,t,r=!1)=>{let o=e;switch(o._tag){case"Locally":return E(()=>n=>o.f(n.getOrElseMemoize(o.self,t)));case"ExtendScope":return E(()=>n=>Ds(s=>n.getOrElseMemoize(o.layer,s)));case"Fold":return E(()=>n=>m(n.getOrElseMemoize(o.layer,t),Se({onFailure:s=>n.getOrElseMemoize(o.failureK(s),t),onSuccess:s=>n.getOrElseMemoize(o.successK(s),t)})));case"Fresh":return E(()=>n=>m(o.layer,FR(t)));case"FromEffect":return r?E(()=>n=>o.effect):E(()=>n=>n.getOrElseMemoize(e,t));case"Provide":return E(()=>n=>m(n.getOrElseMemoize(o.first,t),x(s=>m(n.getOrElseMemoize(o.second,t),Er(s)))));case"Scoped":return r?E(()=>n=>En(o.effect,t)):E(()=>n=>n.getOrElseMemoize(e,t));case"Suspend":return E(()=>n=>n.getOrElseMemoize(o.evaluate(),t));case"ProvideMerge":return E(()=>n=>m(n.getOrElseMemoize(o.first,t),Kr(n.getOrElseMemoize(o.second,t),o.zipK)));case"ZipWith":return E(()=>n=>m(n.getOrElseMemoize(o.first,t),Mo(n.getOrElseMemoize(o.second,t),o.zipK,{concurrent:!0})))}};var gq=l(2,(e,t)=>Zo(wa(),r=>x(FR(t,r),o=>Pl(e,o)),(r,o)=>So(r,o))),yq=l(2,(e,t)=>{let r=ws(Ro.fiberRefs,t.fiberRefs),o=nr(Ro.runtimeFlags,t.runtimeFlags);return Fe(n=>re(s=>{let i=s.getFiberRef(mt),c=s.getFiberRefs(),a=Ms(s.id(),c)(r),p=s._runtimeFlags,f=mo(o)(p),h=ws(a,c),d=nr(f,p);return s.setFiberRefs(a),s._runtimeFlags=f,vr(Pl(n(e),Pn(i,t.context)),re(g=>(g.setFiberRefs(Ms(g.id(),g.getFiberRefs())(h)),g._runtimeFlags=mo(d)(g._runtimeFlags),H)))}))}),AR=l(2,(e,t)=>hq(t)?gq(e,t):pb(t)?Pl(e,t):yq(e,t));var IR=C(Ht(ye),Be(Eo)),NR=e=>He(ye,t=>e(Be(t,Eo))),PR=l(2,(e,t)=>rt(e,ye,ve(Eo,t))),LR=e=>pr(ye,ve(Eo,e));u();var Lg=q(Symbol.for("effect/FiberRef/currentCache"),()=>Te(oM(65536,()=>C(wt(),e=>({listeners:new ji,handle:e})),()=>gm(60)))),Dg=q(Symbol.for("effect/FiberRef/currentCacheEnabled"),()=>Te(!1)),DR=(e,t)=>x(ue(t)?t:y(t),r=>Lt(o=>{let n=new Proxy(e,{});return He(Dg,s=>{if(s){let c=He(Lg,a=>x(a.getEither(n),p=>{switch(p._tag){case"Left":return p.left.listeners.interrupted?x(a.invalidateWhen(n,f=>f.handle===p.left.handle),()=>c):(p.left.listeners.increment(),Fe(f=>x(ke(xo(TS,f(it(p.left.handle)))),h=>(p.left.listeners.decrement(),h))));case"Right":return p.right.listeners.increment(),Fe(f=>x(ke(xo(uh(r,lh({request:n,result:p.right.handle,listeners:p.right.listeners,ownerId:o,state:{completed:!1}})),f(it(p.right.handle)))),()=>(p.right.listeners.decrement(),it(p.right.handle))))}}));return c}let i=new ji;return i.increment(),x(wt(),c=>vr(xo(uh(r,lh({request:n,result:c,listeners:i,ownerId:o,state:{completed:!1}})),it(c)),E(()=>i.decrement())))})})),qR=(e,t)=>He(Dg,r=>r?He(Lg,o=>x(o.getEither(e),n=>{switch(n._tag){case"Left":return H;case"Right":return Fh(n.right.handle,t)}})):H),HR=l(2,(e,t)=>We(e,Dg,t)),WR=l(2,(e,t)=>We(e,Lg,t));u();var UR=$k;var Eq=vi,Oq=ue,Cq=eR,vq=Cg,kq=kd,wq=sR,Mq=wd,Rq=Ji,Fq=Fw,Tq=Tw,Aq=PO,Iq=LO,Nq=VO,Pq=ww,Lq=Rw,Dq=qO,qq=jO,Hq=GO,Wq=lr,Uq=YO,Bq=jx,jq=zx,zq=EC,Gq=Dw,$q=OC,Vq=CC,Kq=Bx,Jq=Aw,Yq=AC,Qq=IC,Zq=Pw,Xq=Uw,e1=qe,t1=kR,r1=Hc,o1=re,n1=G,s1=Sr,i1=Y,c1=tn,a1=go,u1=Xo,l1=en,p1=JO,f1=us,m1=hC,h1=bC,d1=y,x1=ia,g1=FC,y1=I,b1=E,S1=H;var _1=Vr,E1=SO;var O1=br,C1=jr,v1=_O,k1=Wc,w1=u_,M1=EO,R1=OO,F1=CO,T1=vO,A1=kO,I1=_d,N1=Od,P1=QO,L1=yC,D1=MC,q1=VM,H1=yg,W1=Sd;var U1=WC,B1=UC,j1=Td,z1=zC,G1=RO,$1=l_,V1=Zw,K1=yl,J1=bl,Y1=Gr,Q1=f_,Z1=_r,X1=yo,eH=Fe,tH=UO,rH=le,oH=tp,nH=bO,sH=Ee,iH=on,cH=$O,aH=C,uH=fC,lH=Bc,pH=nn,fH=qi,mH=mC,hH=np,dH=ka,xH=vw,gH=Zo,yH=Ki,bH=vr,SH=Sl,_H=yt,EH=Dp,OH=Sn,CH=qp,vH=Kx,kH=Ds,wH=Gx,MH=Hw,RH=Gw,FH=XM,TH=kw,AH=FO,IH=rp,NH=Di,PH=tR,LH=Yp,DH=rn,qH=Lt,HH=ur,WH=Ls,UH=rR,BH=vg,jH=kg,zH=Iw,GH=oR,$H=nR,VH=wg,KH=_l,JH=h_,YH=$v,QH=vh,ZH=M_,XH=wO,eW=Qr,tW=Bw,rW=IE,oW=IR,nW=NR,sW=LR,iW=PR,cW=MO,aW=ks,uW=qC,lW=Fd,pW=aR,fW=lR,mW=Mg,hW=uR,dW=Aa,xW=PE,gW=NE,yW=zw,bW=sr,SW=DO,_W=ir,EW=ys,OW=AR,CW=Hi,vW=SC,kW=YC,wW=JC,MW=Ad,RW=Id,FW=QC,TW=ZC,AW=Nd,IW=GC,NW=TO,PW=AO,LW=IO,DW=NO;var qW=zr,HW=ke,WW=$r,UW=dC,BW=gl;var jW=HO,zW=WO,GW=na,$W=BO,VW=BC,KW=jC,JW=ip,YW=wi,QW=$C,ZW=VC,XW=x,eU=ns,tU=kt,rU=Lw,oU=Bp,nU=iR,sU=Jx,iU=ca,cU=$t,aU=NC,uU=PC,lU=Rd,pU=LC,fU=DC,mU=Ed,hU=Cd,dU=uC,xU=GM,gU=kC,yU=gg,bU=Vp,SU=cR,_U=bg,EU=Mi,OU=op,CU=ZO,vU=We,kU=rt,wU=Wp,MU=pr,RU=vs,FU=RC,TU=sp,AU=XO,IU=eC,NU=sa,PU=Uc,LU=Se,DU=Xe,qU=tC,HU=(e,...t)=>Co(e)(...t),WU=rC,UU=vd,BU=oC,jU=nC,zU=sC,GU=iC,$U=cC,VU=yO,KU=Cw,JU=aC,YU=R_,QU=is,ZU=_h,XU=ss,eB=xC,tB=gC,rB=_C,oB=Ul,nB=LE,sB=jw,iB=ef,cB=ki,aB=sn,uB=El,lB=Jw,pB=TC,fB=Md,mB=qw,hB=$x,dB=F_,xB=KC,gB=Jp,yB=ZM,bB=_R,SB=SR,_B=ER,EB=OR,OB=CR,CB=vR,vB=Ww,kB=Vx,wB=$w,MB=Vw,RB=Kw,jR=Mo,FB=l(2,(e,t)=>jR(e,t,(r,o)=>r(o))),TB=xo,AB=dl,IB=xl,NB=l(e=>UR(e[0]),DR),PB=qR,LB=d_,DB=HR,qB=WR,HB=HC,WB=Bl,UB=DE,BB=Xw,jB=x_,zB=g_,GB=ev,$B=XC,VB=Pd,KB=tv,JB=sv,YB=iv,QB=rv,ZB=nv,XB=va,ej=Xl,tj=Dd,rj=cv,oj=eM,nj=ep,sj=av,ij=uv,cj=e=>()=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=2;let r=new Error;Error.stackTraceLimit=t;function o(){}Object.setPrototypeOf(o,rm),o.key=e,Object.defineProperty(o,"stack",{get(){return r.stack}});let n=new Map;return new Proxy(o,{get(i,c,a){if(c==="use")return h=>ns(o,h);if(c in o)return o[c];if(n.has(c))return n.get(c);let p=(...h)=>ns(o,d=>typeof d[c]=="function"?(n.set(c,(...g)=>ns(o,b=>b[c](...g))),d[c](...h)):(n.set(c,ns(o,g=>g[c])),d[c])),f=ns(o,h=>h[c]);return Object.assign(p,f),Object.setPrototypeOf(p,Object.getPrototypeOf(f)),n.set(c,p),p}})};u();var aj=function(){let e=Symbol.for("effect/Data/Error/plainArgs");return class extends Tl{constructor(r){super(r?.message,r?.cause?{cause:r.cause}:void 0),r&&(Object.assign(this,r),Object.defineProperty(this,e,{value:r,enumerable:!1}))}toJSON(){return{...this[e],...this}}}}(),Zi=e=>{class t extends aj{_tag=e}return t.prototype.name=e,t};u();u();u();u();var Ia=class{constructor(t,r,o,n,s){this.message=t;this.stack=r;this.span=o;this.isPlainString=n;this.errorType=s}};u();var zR=e=>{if(typeof e=="string")return{isPlainString:!0,message:e};if(e instanceof Error&&k(e,"cause")&&k(e,"_tag"))return{isPlainString:!1,type:e._tag,message:e.cause};if(e instanceof Error&&k(e,"error"))return{isPlainString:!1,type:e.name,message:e.error};if(k(e,"_tag")&&k(e,"message"))return{isPlainString:!1,type:e._tag,message:e.message};if(k(e,"toString")&&js(e.toString)&&e.toString!==Object.prototype.toString&&e.toString!==Array.prototype.toString){let t=e.toString(),r=t.split(": ");if(r.length>1){let[o,...n]=r;return{isPlainString:!1,type:o,message:n}}return{message:t,isPlainString:!1}}return{message:`Error: ${JSON.stringify(e)}`,isPlainString:!1}};var GR=Symbol.for("effect/SpanAnnotation"),qg=e=>{let t=k(e,GR)?e[GR]:void 0,{message:r,type:o,isPlainString:n}=zR(e);return e instanceof Error?new Ia(r,e.stack?.split(`
`).filter(s=>/at (.*)/.exec(s)).join(`\r
`),t,!1,o):new Ia(r,void 0,t,n,o)};var $R=e=>sM(e,void 0,{emptyCase:()=>[],dieCase:(t,r)=>[qg(r)],failCase:(t,r)=>[qg(r)],interruptCase:()=>[],parallelCase:(t,r,o)=>[...r,...o],sequentialCase:(t,r,o)=>[...r,...o]});u();u();var VR=e=>Array.from(e.entries()).reduce((t,[r,o])=>r==="code.stacktrace"?{attributes:t.attributes,stacktrace:[...t.stacktrace,o]}:{attributes:new Map([...t.attributes,[r,o]]),stacktrace:t.stacktrace},{stacktrace:[],attributes:new Map});u();var tf=/ {4}at /g,KR=/^(file:\/\/)?(.*.([jt])s)(\?.*)?:(\d*):(\d*)$/;u();var JR=global.process!==void 0?new RegExp(global.process.cwd(),"g"):null,YR=e=>JR===null?e:e.replace(JR,".");u();u();u();var QR=e=>{let t=KR.exec(e);if(t===null||t.length!==7)return;let r=t[2],o=+t[5],n=+t[6];return{filePath:r,line:o,column:n}};u();u();var mf=Ga(Xg(),1);u();var nc=class extends Zi("fs-error"){};var G0=e=>m(X.tryPromise({try:async()=>await mf.default.readFile(e,{encoding:"utf8"}),catch:t=>new nc({cause:t})}),X.withSpan("readFile",{attributes:{path:e}})),$0=e=>m(X.tryPromise({try:async()=>await mf.default.exists(e),catch:t=>new nc({cause:t})}),X.withSpan("exists",{attributes:{path:e}})),V0=e=>m(X.tryPromise({try:async()=>await mf.default.readJson(e),catch:t=>new nc({cause:t})}),X.withSpan("readJson",{attributes:{path:e}}));var p3=7,hf=({filePath:e,line:t,column:r},o=!1)=>X.gen(function*(){let n=t>=4?t-4:0;return(yield*G0(e)).split(`
`).splice(n,p3).map((i,c)=>{let a=c+n+1,p=o?r+1:r;return{line:a,code:i,column:a===t?p:void 0}})});u();import H3 from"path";var _f=Ga(Y0(),1),OT=Ga(ET(),1);var CT=e=>X.gen(function*(){if(!(yield*$0(`${e.filePath}.map`))){let c=_f.default.yellow(`${e.filePath}.map does not exist: unable to retrieve spans sourcemaps.`);console.warn(`${_f.default.blue(_f.default.underline("effect-errors"))}: ${c}`);return}let r=yield*V0(`${e.filePath}.map`);if(r.version===void 0||r.sources===void 0)return;let n=new OT.SourceMapConsumer(r).originalPositionFor({column:e.column,line:e.line});if(n.source===null||n.line===null||n.column===null)return;let s=H3.resolve(e.filePath.substring(0,e.filePath.lastIndexOf("/")),n.source),i=yield*hf({filePath:s,line:n.line,column:n.column},!0);return{runPath:`${e.filePath}:${e.line}:${e.column}`,sourcesPath:`${s}:${n.line}:${n.column+1}`,source:i}});var vT=e=>X.gen(function*(){let t=QR(e);if(t===void 0)return;let{filePath:r,line:o,column:n}=t;if(r.endsWith(".ts")){let i=yield*hf(t);return{runPath:`${r}:${o}:${n}`,sourcesPath:void 0,source:i}}return yield*CT(t)});var kT=e=>X.forEach(e,t=>X.gen(function*(){let r=t.split(" "),o=r.length===2?r[1]:r[r.length-1].slice(1,-1),n=yield*vT(o);return n===void 0?{runPath:t.replaceAll(tf,"at "),source:void 0,sourcesPath:void 0}:{runPath:n.runPath,sourcesPath:n.sourcesPath,source:n.source}}));var wT=({reverseSpans:e,stripCwd:t})=>({message:r,stack:o,span:n,errorType:s,isPlainString:i})=>X.gen(function*(){let c=[],a=[];if(n!==void 0){let f=n;for(;f!==void 0&&f._tag==="Span";){let{name:h,attributes:d,status:g}=f,{attributes:b,stacktrace:M}=VR(d),T=yield*kT(M);c.push(...T),a.push({name:h,attributes:b,status:g}),f=de.getOrUndefined(f.parent)}}let p;return o!==void 0&&(p=t===!0?YR(o):o),{errorType:s,message:r,stack:p?.replaceAll(tf,"at ").split(`\r
`),sources:c.length>0?c:void 0,spans:e===!0?a.toReversed():a,isPlainString:i}});var MT=(e,t={reverseSpans:!0,stripCwd:!0})=>X.gen(function*(){if(nM(e))return{interrupted:!0,errors:[]};let r=$R(e);return{interrupted:!1,errors:yield*X.forEach(r,wT(t))}});u();var RT=(e,t)=>typeof t=="bigint"?{type:"bigint",value:t.toString()}:t;u();import{fileURLToPath as U3}from"node:url";var TT=Ga(Xg(),1);u();var za=class extends Zi("FetchError"){};u();var Ef=class extends Zi("FileError"){};u();var W3=new RegExp(process.cwd(),"g"),FT=e=>X.sync(()=>{console.info(`\r
\u{1F4C1} ${e.replace(W3,".")}`)});var B3=U3(import.meta.url),j3=X.withSpan("readUser")(X.tryPromise({try:async()=>await TT.default.readJson("./src/examples/data/user.json"),catch:e=>new Ef({cause:e})})),z3=e=>X.withSpan("fetchUser",{attributes:{userId:e}})(X.tryPromise({try:async()=>await fetch(`https://yolo-bro-oh-no.org/users/${e}`),catch:t=>new za({cause:t})})),G3=e=>X.withSpan("unwrapFetchUserResponse")(X.tryPromise({try:async()=>await e.json(),catch:t=>new za({cause:t})})),$3=X.withSpan("fromPromiseTask")(X.gen(function*(){yield*FT(B3);let{id:e}=yield*j3,t=yield*z3(e);return yield*G3(t)})),AT=$3;X.runPromise(m(AT,X.sandbox,X.catchAll(e=>X.gen(function*(){let t=yield*MT(e);return yield*X.fail(JSON.stringify(t,RT,2))})))).catch(console.error);
