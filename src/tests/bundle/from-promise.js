var hA=Object.create;var Mf=Object.defineProperty;var dA=Object.getOwnPropertyDescriptor;var xA=Object.getOwnPropertyNames;var gA=Object.getPrototypeOf,yA=Object.prototype.hasOwnProperty;var rt=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var bA=(e,t)=>()=>(e&&(t=e(e=0)),t);var J=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),ky=(e,t)=>{for(var r in t)Mf(e,r,{get:t[r],enumerable:!0})},SA=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of xA(t))!yA.call(e,n)&&n!==r&&Mf(e,n,{get:()=>t[n],enumerable:!(o=dA(t,n))||o.enumerable});return e};var Ff=(e,t,r)=>(r=e!=null?hA(gA(e)):{},SA(t||!e||!e.__esModule?Mf(r,"default",{value:e,enumerable:!0}):r,e));import{createRequire as _A}from"node:module";import EA from"node:path";import OA from"node:url";var u=bA(()=>{"use strict";globalThis.require=_A(import.meta.url);globalThis.__filename=OA.fileURLToPath(import.meta.url);globalThis.__dirname=EA.dirname(__filename)});var st=J(Xg=>{"use strict";u();Xg.fromCallback=function(e){return Object.defineProperty(function(...t){if(typeof t[t.length-1]=="function")e.apply(this,t);else return new Promise((r,o)=>{t.push((n,s)=>n!=null?o(n):r(s)),e.apply(this,t)})},"name",{value:e.name})};Xg.fromPromise=function(e){return Object.defineProperty(function(...t){let r=t[t.length-1];if(typeof r!="function")return e.apply(this,t);t.pop(),e.apply(this,t).then(o=>r(null,o),r)},"name",{value:e.name})}});var P0=J((pX,N0)=>{u();var Tn=rt("constants"),sz=process.cwd,lf=null,iz=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return lf||(lf=sz.call(process)),lf};try{process.cwd()}catch{}typeof process.chdir=="function"&&(ey=process.chdir,process.chdir=function(e){lf=null,ey.call(process,e)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,ey));var ey;N0.exports=cz;function cz(e){Tn.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&t(e),e.lutimes||r(e),e.chown=s(e.chown),e.fchown=s(e.fchown),e.lchown=s(e.lchown),e.chmod=o(e.chmod),e.fchmod=o(e.fchmod),e.lchmod=o(e.lchmod),e.chownSync=i(e.chownSync),e.fchownSync=i(e.fchownSync),e.lchownSync=i(e.lchownSync),e.chmodSync=n(e.chmodSync),e.fchmodSync=n(e.fchmodSync),e.lchmodSync=n(e.lchmodSync),e.stat=c(e.stat),e.fstat=c(e.fstat),e.lstat=c(e.lstat),e.statSync=a(e.statSync),e.fstatSync=a(e.fstatSync),e.lstatSync=a(e.lstatSync),e.chmod&&!e.lchmod&&(e.lchmod=function(f,h,d){d&&process.nextTick(d)},e.lchmodSync=function(){}),e.chown&&!e.lchown&&(e.lchown=function(f,h,d,g){g&&process.nextTick(g)},e.lchownSync=function(){}),iz==="win32"&&(e.rename=typeof e.rename!="function"?e.rename:function(f){function h(d,g,b){var R=Date.now(),I=0;f(d,g,function P(K){if(K&&(K.code==="EACCES"||K.code==="EPERM"||K.code==="EBUSY")&&Date.now()-R<6e4){setTimeout(function(){e.stat(g,function(ue,Se){ue&&ue.code==="ENOENT"?f(d,g,P):b(K)})},I),I<100&&(I+=10);return}b&&b(K)})}return Object.setPrototypeOf&&Object.setPrototypeOf(h,f),h}(e.rename)),e.read=typeof e.read!="function"?e.read:function(f){function h(d,g,b,R,I,P){var K;if(P&&typeof P=="function"){var ue=0;K=function(Se,at,er){if(Se&&Se.code==="EAGAIN"&&ue<10)return ue++,f.call(e,d,g,b,R,I,K);P.apply(this,arguments)}}return f.call(e,d,g,b,R,I,K)}return Object.setPrototypeOf&&Object.setPrototypeOf(h,f),h}(e.read),e.readSync=typeof e.readSync!="function"?e.readSync:function(f){return function(h,d,g,b,R){for(var I=0;;)try{return f.call(e,h,d,g,b,R)}catch(P){if(P.code==="EAGAIN"&&I<10){I++;continue}throw P}}}(e.readSync);function t(f){f.lchmod=function(h,d,g){f.open(h,Tn.O_WRONLY|Tn.O_SYMLINK,d,function(b,R){if(b){g&&g(b);return}f.fchmod(R,d,function(I){f.close(R,function(P){g&&g(I||P)})})})},f.lchmodSync=function(h,d){var g=f.openSync(h,Tn.O_WRONLY|Tn.O_SYMLINK,d),b=!0,R;try{R=f.fchmodSync(g,d),b=!1}finally{if(b)try{f.closeSync(g)}catch{}else f.closeSync(g)}return R}}function r(f){Tn.hasOwnProperty("O_SYMLINK")&&f.futimes?(f.lutimes=function(h,d,g,b){f.open(h,Tn.O_SYMLINK,function(R,I){if(R){b&&b(R);return}f.futimes(I,d,g,function(P){f.close(I,function(K){b&&b(P||K)})})})},f.lutimesSync=function(h,d,g){var b=f.openSync(h,Tn.O_SYMLINK),R,I=!0;try{R=f.futimesSync(b,d,g),I=!1}finally{if(I)try{f.closeSync(b)}catch{}else f.closeSync(b)}return R}):f.futimes&&(f.lutimes=function(h,d,g,b){b&&process.nextTick(b)},f.lutimesSync=function(){})}function o(f){return f&&function(h,d,g){return f.call(e,h,d,function(b){p(b)&&(b=null),g&&g.apply(this,arguments)})}}function n(f){return f&&function(h,d){try{return f.call(e,h,d)}catch(g){if(!p(g))throw g}}}function s(f){return f&&function(h,d,g,b){return f.call(e,h,d,g,function(R){p(R)&&(R=null),b&&b.apply(this,arguments)})}}function i(f){return f&&function(h,d,g){try{return f.call(e,h,d,g)}catch(b){if(!p(b))throw b}}}function c(f){return f&&function(h,d,g){typeof d=="function"&&(g=d,d=null);function b(R,I){I&&(I.uid<0&&(I.uid+=4294967296),I.gid<0&&(I.gid+=4294967296)),g&&g.apply(this,arguments)}return d?f.call(e,h,d,b):f.call(e,h,b)}}function a(f){return f&&function(h,d){var g=d?f.call(e,h,d):f.call(e,h);return g&&(g.uid<0&&(g.uid+=4294967296),g.gid<0&&(g.gid+=4294967296)),g}}function p(f){if(!f||f.code==="ENOSYS")return!0;var h=!process.getuid||process.getuid()!==0;return!!(h&&(f.code==="EINVAL"||f.code==="EPERM"))}}});var q0=J((mX,D0)=>{u();var L0=rt("stream").Stream;D0.exports=az;function az(e){return{ReadStream:t,WriteStream:r};function t(o,n){if(!(this instanceof t))return new t(o,n);L0.call(this);var s=this;this.path=o,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=64*1024,n=n||{};for(var i=Object.keys(n),c=0,a=i.length;c<a;c++){var p=i[c];this[p]=n[p]}if(this.encoding&&this.setEncoding(this.encoding),this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){s._read()});return}e.open(this.path,this.flags,this.mode,function(f,h){if(f){s.emit("error",f),s.readable=!1;return}s.fd=h,s.emit("open",h),s._read()})}function r(o,n){if(!(this instanceof r))return new r(o,n);L0.call(this),this.path=o,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,n=n||{};for(var s=Object.keys(n),i=0,c=s.length;i<c;i++){var a=s[i];this[a]=n[a]}if(this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],this.fd===null&&(this._open=e.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}});var W0=J((dX,H0)=>{"use strict";u();H0.exports=lz;var uz=Object.getPrototypeOf||function(e){return e.__proto__};function lz(e){if(e===null||typeof e!="object")return e;if(e instanceof Object)var t={__proto__:uz(e)};else var t=Object.create(null);return Object.getOwnPropertyNames(e).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}),t}});var sc=J((gX,oy)=>{u();var Fe=rt("fs"),pz=P0(),fz=q0(),mz=W0(),pf=rt("util"),mt,mf;typeof Symbol=="function"&&typeof Symbol.for=="function"?(mt=Symbol.for("graceful-fs.queue"),mf=Symbol.for("graceful-fs.previous")):(mt="___graceful-fs.queue",mf="___graceful-fs.previous");function hz(){}function j0(e,t){Object.defineProperty(e,mt,{get:function(){return t}})}var Ks=hz;pf.debuglog?Ks=pf.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(Ks=function(){var e=pf.format.apply(pf,arguments);e="GFS4: "+e.split(/\n/).join(`
GFS4: `),console.error(e)});Fe[mt]||(U0=global[mt]||[],j0(Fe,U0),Fe.close=function(e){function t(r,o){return e.call(Fe,r,function(n){n||B0(),typeof o=="function"&&o.apply(this,arguments)})}return Object.defineProperty(t,mf,{value:e}),t}(Fe.close),Fe.closeSync=function(e){function t(r){e.apply(Fe,arguments),B0()}return Object.defineProperty(t,mf,{value:e}),t}(Fe.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){Ks(Fe[mt]),rt("assert").equal(Fe[mt].length,0)}));var U0;global[mt]||j0(global,Fe[mt]);oy.exports=ty(mz(Fe));process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!Fe.__patched&&(oy.exports=ty(Fe),Fe.__patched=!0);function ty(e){pz(e),e.gracefulify=ty,e.createReadStream=at,e.createWriteStream=er;var t=e.readFile;e.readFile=r;function r(D,Z,j){return typeof Z=="function"&&(j=Z,Z=null),me(D,Z,j);function me(Te,ye,he,se){return t(Te,ye,function(ee){ee&&(ee.code==="EMFILE"||ee.code==="ENFILE")?nc([me,[Te,ye,he],ee,se||Date.now(),Date.now()]):typeof he=="function"&&he.apply(this,arguments)})}}var o=e.writeFile;e.writeFile=n;function n(D,Z,j,me){return typeof j=="function"&&(me=j,j=null),Te(D,Z,j,me);function Te(ye,he,se,ee,we){return o(ye,he,se,function(de){de&&(de.code==="EMFILE"||de.code==="ENFILE")?nc([Te,[ye,he,se,ee],de,we||Date.now(),Date.now()]):typeof ee=="function"&&ee.apply(this,arguments)})}}var s=e.appendFile;s&&(e.appendFile=i);function i(D,Z,j,me){return typeof j=="function"&&(me=j,j=null),Te(D,Z,j,me);function Te(ye,he,se,ee,we){return s(ye,he,se,function(de){de&&(de.code==="EMFILE"||de.code==="ENFILE")?nc([Te,[ye,he,se,ee],de,we||Date.now(),Date.now()]):typeof ee=="function"&&ee.apply(this,arguments)})}}var c=e.copyFile;c&&(e.copyFile=a);function a(D,Z,j,me){return typeof j=="function"&&(me=j,j=0),Te(D,Z,j,me);function Te(ye,he,se,ee,we){return c(ye,he,se,function(de){de&&(de.code==="EMFILE"||de.code==="ENFILE")?nc([Te,[ye,he,se,ee],de,we||Date.now(),Date.now()]):typeof ee=="function"&&ee.apply(this,arguments)})}}var p=e.readdir;e.readdir=h;var f=/^v[0-5]\./;function h(D,Z,j){typeof Z=="function"&&(j=Z,Z=null);var me=f.test(process.version)?function(he,se,ee,we){return p(he,Te(he,se,ee,we))}:function(he,se,ee,we){return p(he,se,Te(he,se,ee,we))};return me(D,Z,j);function Te(ye,he,se,ee){return function(we,de){we&&(we.code==="EMFILE"||we.code==="ENFILE")?nc([me,[ye,he,se],we,ee||Date.now(),Date.now()]):(de&&de.sort&&de.sort(),typeof se=="function"&&se.call(this,we,de))}}}if(process.version.substr(0,4)==="v0.8"){var d=fz(e);P=d.ReadStream,ue=d.WriteStream}var g=e.ReadStream;g&&(P.prototype=Object.create(g.prototype),P.prototype.open=K);var b=e.WriteStream;b&&(ue.prototype=Object.create(b.prototype),ue.prototype.open=Se),Object.defineProperty(e,"ReadStream",{get:function(){return P},set:function(D){P=D},enumerable:!0,configurable:!0}),Object.defineProperty(e,"WriteStream",{get:function(){return ue},set:function(D){ue=D},enumerable:!0,configurable:!0});var R=P;Object.defineProperty(e,"FileReadStream",{get:function(){return R},set:function(D){R=D},enumerable:!0,configurable:!0});var I=ue;Object.defineProperty(e,"FileWriteStream",{get:function(){return I},set:function(D){I=D},enumerable:!0,configurable:!0});function P(D,Z){return this instanceof P?(g.apply(this,arguments),this):P.apply(Object.create(P.prototype),arguments)}function K(){var D=this;Qe(D.path,D.flags,D.mode,function(Z,j){Z?(D.autoClose&&D.destroy(),D.emit("error",Z)):(D.fd=j,D.emit("open",j),D.read())})}function ue(D,Z){return this instanceof ue?(b.apply(this,arguments),this):ue.apply(Object.create(ue.prototype),arguments)}function Se(){var D=this;Qe(D.path,D.flags,D.mode,function(Z,j){Z?(D.destroy(),D.emit("error",Z)):(D.fd=j,D.emit("open",j))})}function at(D,Z){return new e.ReadStream(D,Z)}function er(D,Z){return new e.WriteStream(D,Z)}var Wo=e.open;e.open=Qe;function Qe(D,Z,j,me){return typeof j=="function"&&(me=j,j=null),Te(D,Z,j,me);function Te(ye,he,se,ee,we){return Wo(ye,he,se,function(de,Zs){de&&(de.code==="EMFILE"||de.code==="ENFILE")?nc([Te,[ye,he,se,ee],de,we||Date.now(),Date.now()]):typeof ee=="function"&&ee.apply(this,arguments)})}}return e}function nc(e){Ks("ENQUEUE",e[0].name,e[1]),Fe[mt].push(e),ry()}var ff;function B0(){for(var e=Date.now(),t=0;t<Fe[mt].length;++t)Fe[mt][t].length>2&&(Fe[mt][t][3]=e,Fe[mt][t][4]=e);ry()}function ry(){if(clearTimeout(ff),ff=void 0,Fe[mt].length!==0){var e=Fe[mt].shift(),t=e[0],r=e[1],o=e[2],n=e[3],s=e[4];if(n===void 0)Ks("RETRY",t.name,r),t.apply(null,r);else if(Date.now()-n>=6e4){Ks("TIMEOUT",t.name,r);var i=r.pop();typeof i=="function"&&i.call(null,o)}else{var c=Date.now()-s,a=Math.max(s-n,1),p=Math.min(a*1.2,100);c>=p?(Ks("RETRY",t.name,r),t.apply(null,r.concat([n]))):Fe[mt].push(e)}ff===void 0&&(ff=setTimeout(ry,0))}}});var Tt=J(Lo=>{"use strict";u();var z0=st().fromCallback,Ft=sc(),dz=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchmod","lchown","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter(e=>typeof Ft[e]=="function");Object.assign(Lo,Ft);dz.forEach(e=>{Lo[e]=z0(Ft[e])});Lo.exists=function(e,t){return typeof t=="function"?Ft.exists(e,t):new Promise(r=>Ft.exists(e,r))};Lo.read=function(e,t,r,o,n,s){return typeof s=="function"?Ft.read(e,t,r,o,n,s):new Promise((i,c)=>{Ft.read(e,t,r,o,n,(a,p,f)=>{if(a)return c(a);i({bytesRead:p,buffer:f})})})};Lo.write=function(e,t,...r){return typeof r[r.length-1]=="function"?Ft.write(e,t,...r):new Promise((o,n)=>{Ft.write(e,t,...r,(s,i,c)=>{if(s)return n(s);o({bytesWritten:i,buffer:c})})})};Lo.readv=function(e,t,...r){return typeof r[r.length-1]=="function"?Ft.readv(e,t,...r):new Promise((o,n)=>{Ft.readv(e,t,...r,(s,i,c)=>{if(s)return n(s);o({bytesRead:i,buffers:c})})})};Lo.writev=function(e,t,...r){return typeof r[r.length-1]=="function"?Ft.writev(e,t,...r):new Promise((o,n)=>{Ft.writev(e,t,...r,(s,i,c)=>{if(s)return n(s);o({bytesWritten:i,buffers:c})})})};typeof Ft.realpath.native=="function"?Lo.realpath.native=z0(Ft.realpath.native):process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")});var $0=J((_X,G0)=>{"use strict";u();var xz=rt("path");G0.exports.checkPath=function(t){if(process.platform==="win32"&&/[<>:"|?*]/.test(t.replace(xz.parse(t).root,""))){let o=new Error(`Path contains invalid characters: ${t}`);throw o.code="EINVAL",o}}});var Y0=J((OX,ny)=>{"use strict";u();var V0=Tt(),{checkPath:K0}=$0(),J0=e=>{let t={mode:511};return typeof e=="number"?e:{...t,...e}.mode};ny.exports.makeDir=async(e,t)=>(K0(e),V0.mkdir(e,{mode:J0(t),recursive:!0}));ny.exports.makeDirSync=(e,t)=>(K0(e),V0.mkdirSync(e,{mode:J0(t),recursive:!0}))});var Rr=J((vX,Q0)=>{"use strict";u();var gz=st().fromPromise,{makeDir:yz,makeDirSync:sy}=Y0(),iy=gz(yz);Q0.exports={mkdirs:iy,mkdirsSync:sy,mkdirp:iy,mkdirpSync:sy,ensureDir:iy,ensureDirSync:sy}});var An=J((wX,X0)=>{"use strict";u();var bz=st().fromPromise,Z0=Tt();function Sz(e){return Z0.access(e).then(()=>!0).catch(()=>!1)}X0.exports={pathExists:bz(Sz),pathExistsSync:Z0.existsSync}});var cy=J((MX,eF)=>{"use strict";u();var ic=Tt(),_z=st().fromPromise;async function Ez(e,t,r){let o=await ic.open(e,"r+"),n=null;try{await ic.futimes(o,t,r)}finally{try{await ic.close(o)}catch(s){n=s}}if(n)throw n}function Oz(e,t,r){let o=ic.openSync(e,"r+");return ic.futimesSync(o,t,r),ic.closeSync(o)}eF.exports={utimesMillis:_z(Ez),utimesMillisSync:Oz}});var Js=J((TX,nF)=>{"use strict";u();var cc=Tt(),it=rt("path"),tF=st().fromPromise;function Cz(e,t,r){let o=r.dereference?n=>cc.stat(n,{bigint:!0}):n=>cc.lstat(n,{bigint:!0});return Promise.all([o(e),o(t).catch(n=>{if(n.code==="ENOENT")return null;throw n})]).then(([n,s])=>({srcStat:n,destStat:s}))}function vz(e,t,r){let o,n=r.dereference?i=>cc.statSync(i,{bigint:!0}):i=>cc.lstatSync(i,{bigint:!0}),s=n(e);try{o=n(t)}catch(i){if(i.code==="ENOENT")return{srcStat:s,destStat:null};throw i}return{srcStat:s,destStat:o}}async function kz(e,t,r,o){let{srcStat:n,destStat:s}=await Cz(e,t,o);if(s){if(Wa(n,s)){let i=it.basename(e),c=it.basename(t);if(r==="move"&&i!==c&&i.toLowerCase()===c.toLowerCase())return{srcStat:n,destStat:s,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(n.isDirectory()&&!s.isDirectory())throw new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`);if(!n.isDirectory()&&s.isDirectory())throw new Error(`Cannot overwrite directory '${t}' with non-directory '${e}'.`)}if(n.isDirectory()&&ay(e,t))throw new Error(hf(e,t,r));return{srcStat:n,destStat:s}}function wz(e,t,r,o){let{srcStat:n,destStat:s}=vz(e,t,o);if(s){if(Wa(n,s)){let i=it.basename(e),c=it.basename(t);if(r==="move"&&i!==c&&i.toLowerCase()===c.toLowerCase())return{srcStat:n,destStat:s,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(n.isDirectory()&&!s.isDirectory())throw new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`);if(!n.isDirectory()&&s.isDirectory())throw new Error(`Cannot overwrite directory '${t}' with non-directory '${e}'.`)}if(n.isDirectory()&&ay(e,t))throw new Error(hf(e,t,r));return{srcStat:n,destStat:s}}async function rF(e,t,r,o){let n=it.resolve(it.dirname(e)),s=it.resolve(it.dirname(r));if(s===n||s===it.parse(s).root)return;let i;try{i=await cc.stat(s,{bigint:!0})}catch(c){if(c.code==="ENOENT")return;throw c}if(Wa(t,i))throw new Error(hf(e,r,o));return rF(e,t,s,o)}function oF(e,t,r,o){let n=it.resolve(it.dirname(e)),s=it.resolve(it.dirname(r));if(s===n||s===it.parse(s).root)return;let i;try{i=cc.statSync(s,{bigint:!0})}catch(c){if(c.code==="ENOENT")return;throw c}if(Wa(t,i))throw new Error(hf(e,r,o));return oF(e,t,s,o)}function Wa(e,t){return t.ino&&t.dev&&t.ino===e.ino&&t.dev===e.dev}function ay(e,t){let r=it.resolve(e).split(it.sep).filter(n=>n),o=it.resolve(t).split(it.sep).filter(n=>n);return r.every((n,s)=>o[s]===n)}function hf(e,t,r){return`Cannot ${r} '${e}' to a subdirectory of itself, '${t}'.`}nF.exports={checkPaths:tF(kz),checkPathsSync:wz,checkParentPaths:tF(rF),checkParentPathsSync:oF,isSrcSubdir:ay,areIdentical:Wa}});var uF=J((IX,aF)=>{"use strict";u();var yt=Tt(),Ua=rt("path"),{mkdirs:Rz}=Rr(),{pathExists:Mz}=An(),{utimesMillis:Fz}=cy(),Ba=Js();async function Tz(e,t,r={}){typeof r=="function"&&(r={filter:r}),r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0001");let{srcStat:o,destStat:n}=await Ba.checkPaths(e,t,"copy",r);if(await Ba.checkParentPaths(e,o,t,"copy"),!await iF(e,t,r))return;let i=Ua.dirname(t);await Mz(i)||await Rz(i),await cF(n,e,t,r)}async function iF(e,t,r){return r.filter?r.filter(e,t):!0}async function cF(e,t,r,o){let s=await(o.dereference?yt.stat:yt.lstat)(t);if(s.isDirectory())return Pz(s,e,t,r,o);if(s.isFile()||s.isCharacterDevice()||s.isBlockDevice())return Az(s,e,t,r,o);if(s.isSymbolicLink())return Lz(e,t,r,o);throw s.isSocket()?new Error(`Cannot copy a socket file: ${t}`):s.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${t}`):new Error(`Unknown file: ${t}`)}async function Az(e,t,r,o,n){if(!t)return sF(e,r,o,n);if(n.overwrite)return await yt.unlink(o),sF(e,r,o,n);if(n.errorOnExist)throw new Error(`'${o}' already exists`)}async function sF(e,t,r,o){if(await yt.copyFile(t,r),o.preserveTimestamps){Iz(e.mode)&&await Nz(r,e.mode);let n=await yt.stat(t);await Fz(r,n.atime,n.mtime)}return yt.chmod(r,e.mode)}function Iz(e){return(e&128)===0}function Nz(e,t){return yt.chmod(e,t|128)}async function Pz(e,t,r,o,n){t||await yt.mkdir(o);let s=await yt.readdir(r);await Promise.all(s.map(async i=>{let c=Ua.join(r,i),a=Ua.join(o,i);if(!await iF(c,a,n))return;let{destStat:f}=await Ba.checkPaths(c,a,"copy",n);return cF(f,c,a,n)})),t||await yt.chmod(o,e.mode)}async function Lz(e,t,r,o){let n=await yt.readlink(t);if(o.dereference&&(n=Ua.resolve(process.cwd(),n)),!e)return yt.symlink(n,r);let s=null;try{s=await yt.readlink(r)}catch(i){if(i.code==="EINVAL"||i.code==="UNKNOWN")return yt.symlink(n,r);throw i}if(o.dereference&&(s=Ua.resolve(process.cwd(),s)),Ba.isSrcSubdir(n,s))throw new Error(`Cannot copy '${n}' to a subdirectory of itself, '${s}'.`);if(Ba.isSrcSubdir(s,n))throw new Error(`Cannot overwrite '${s}' with '${n}'.`);return await yt.unlink(r),yt.symlink(n,r)}aF.exports=Tz});var hF=J((PX,mF)=>{"use strict";u();var At=sc(),ja=rt("path"),Dz=Rr().mkdirsSync,qz=cy().utimesMillisSync,za=Js();function Hz(e,t,r){typeof r=="function"&&(r={filter:r}),r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0002");let{srcStat:o,destStat:n}=za.checkPathsSync(e,t,"copy",r);if(za.checkParentPathsSync(e,o,t,"copy"),r.filter&&!r.filter(e,t))return;let s=ja.dirname(t);return At.existsSync(s)||Dz(s),lF(n,e,t,r)}function lF(e,t,r,o){let s=(o.dereference?At.statSync:At.lstatSync)(t);if(s.isDirectory())return $z(s,e,t,r,o);if(s.isFile()||s.isCharacterDevice()||s.isBlockDevice())return Wz(s,e,t,r,o);if(s.isSymbolicLink())return Jz(e,t,r,o);throw s.isSocket()?new Error(`Cannot copy a socket file: ${t}`):s.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${t}`):new Error(`Unknown file: ${t}`)}function Wz(e,t,r,o,n){return t?Uz(e,r,o,n):pF(e,r,o,n)}function Uz(e,t,r,o){if(o.overwrite)return At.unlinkSync(r),pF(e,t,r,o);if(o.errorOnExist)throw new Error(`'${r}' already exists`)}function pF(e,t,r,o){return At.copyFileSync(t,r),o.preserveTimestamps&&Bz(e.mode,t,r),uy(r,e.mode)}function Bz(e,t,r){return jz(e)&&zz(r,e),Gz(t,r)}function jz(e){return(e&128)===0}function zz(e,t){return uy(e,t|128)}function uy(e,t){return At.chmodSync(e,t)}function Gz(e,t){let r=At.statSync(e);return qz(t,r.atime,r.mtime)}function $z(e,t,r,o,n){return t?fF(r,o,n):Vz(e.mode,r,o,n)}function Vz(e,t,r,o){return At.mkdirSync(r),fF(t,r,o),uy(r,e)}function fF(e,t,r){At.readdirSync(e).forEach(o=>Kz(o,e,t,r))}function Kz(e,t,r,o){let n=ja.join(t,e),s=ja.join(r,e);if(o.filter&&!o.filter(n,s))return;let{destStat:i}=za.checkPathsSync(n,s,"copy",o);return lF(i,n,s,o)}function Jz(e,t,r,o){let n=At.readlinkSync(t);if(o.dereference&&(n=ja.resolve(process.cwd(),n)),e){let s;try{s=At.readlinkSync(r)}catch(i){if(i.code==="EINVAL"||i.code==="UNKNOWN")return At.symlinkSync(n,r);throw i}if(o.dereference&&(s=ja.resolve(process.cwd(),s)),za.isSrcSubdir(n,s))throw new Error(`Cannot copy '${n}' to a subdirectory of itself, '${s}'.`);if(za.isSrcSubdir(s,n))throw new Error(`Cannot overwrite '${s}' with '${n}'.`);return Yz(n,r)}else return At.symlinkSync(n,r)}function Yz(e,t){return At.unlinkSync(t),At.symlinkSync(e,t)}mF.exports=Hz});var df=J((DX,dF)=>{"use strict";u();var Qz=st().fromPromise;dF.exports={copy:Qz(uF()),copySync:hF()}});var Ga=J((HX,gF)=>{"use strict";u();var xF=sc(),Zz=st().fromCallback;function Xz(e,t){xF.rm(e,{recursive:!0,force:!0},t)}function eG(e){xF.rmSync(e,{recursive:!0,force:!0})}gF.exports={remove:Zz(Xz),removeSync:eG}});var vF=J((UX,CF)=>{"use strict";u();var tG=st().fromPromise,SF=Tt(),_F=rt("path"),EF=Rr(),OF=Ga(),yF=tG(async function(t){let r;try{r=await SF.readdir(t)}catch{return EF.mkdirs(t)}return Promise.all(r.map(o=>OF.remove(_F.join(t,o))))});function bF(e){let t;try{t=SF.readdirSync(e)}catch{return EF.mkdirsSync(e)}t.forEach(r=>{r=_F.join(e,r),OF.removeSync(r)})}CF.exports={emptyDirSync:bF,emptydirSync:bF,emptyDir:yF,emptydir:yF}});var MF=J((jX,RF)=>{"use strict";u();var rG=st().fromPromise,kF=rt("path"),Do=Tt(),wF=Rr();async function oG(e){let t;try{t=await Do.stat(e)}catch{}if(t&&t.isFile())return;let r=kF.dirname(e),o=null;try{o=await Do.stat(r)}catch(n){if(n.code==="ENOENT"){await wF.mkdirs(r),await Do.writeFile(e,"");return}else throw n}o.isDirectory()?await Do.writeFile(e,""):await Do.readdir(r)}function nG(e){let t;try{t=Do.statSync(e)}catch{}if(t&&t.isFile())return;let r=kF.dirname(e);try{Do.statSync(r).isDirectory()||Do.readdirSync(r)}catch(o){if(o&&o.code==="ENOENT")wF.mkdirsSync(r);else throw o}Do.writeFileSync(e,"")}RF.exports={createFile:rG(oG),createFileSync:nG}});var NF=J((GX,IF)=>{"use strict";u();var sG=st().fromPromise,FF=rt("path"),In=Tt(),TF=Rr(),{pathExists:iG}=An(),{areIdentical:AF}=Js();async function cG(e,t){let r;try{r=await In.lstat(t)}catch{}let o;try{o=await In.lstat(e)}catch(i){throw i.message=i.message.replace("lstat","ensureLink"),i}if(r&&AF(o,r))return;let n=FF.dirname(t);await iG(n)||await TF.mkdirs(n),await In.link(e,t)}function aG(e,t){let r;try{r=In.lstatSync(t)}catch{}try{let s=In.lstatSync(e);if(r&&AF(s,r))return}catch(s){throw s.message=s.message.replace("lstat","ensureLink"),s}let o=FF.dirname(t);return In.existsSync(o)||TF.mkdirsSync(o),In.linkSync(e,t)}IF.exports={createLink:sG(cG),createLinkSync:aG}});var LF=J((VX,PF)=>{"use strict";u();var Nn=rt("path"),$a=Tt(),{pathExists:uG}=An(),lG=st().fromPromise;async function pG(e,t){if(Nn.isAbsolute(e)){try{await $a.lstat(e)}catch(s){throw s.message=s.message.replace("lstat","ensureSymlink"),s}return{toCwd:e,toDst:e}}let r=Nn.dirname(t),o=Nn.join(r,e);if(await uG(o))return{toCwd:o,toDst:e};try{await $a.lstat(e)}catch(s){throw s.message=s.message.replace("lstat","ensureSymlink"),s}return{toCwd:e,toDst:Nn.relative(r,e)}}function fG(e,t){if(Nn.isAbsolute(e)){if(!$a.existsSync(e))throw new Error("absolute srcpath does not exist");return{toCwd:e,toDst:e}}let r=Nn.dirname(t),o=Nn.join(r,e);if($a.existsSync(o))return{toCwd:o,toDst:e};if(!$a.existsSync(e))throw new Error("relative srcpath does not exist");return{toCwd:e,toDst:Nn.relative(r,e)}}PF.exports={symlinkPaths:lG(pG),symlinkPathsSync:fG}});var HF=J((JX,qF)=>{"use strict";u();var DF=Tt(),mG=st().fromPromise;async function hG(e,t){if(t)return t;let r;try{r=await DF.lstat(e)}catch{return"file"}return r&&r.isDirectory()?"dir":"file"}function dG(e,t){if(t)return t;let r;try{r=DF.lstatSync(e)}catch{return"file"}return r&&r.isDirectory()?"dir":"file"}qF.exports={symlinkType:mG(hG),symlinkTypeSync:dG}});var jF=J((QX,BF)=>{"use strict";u();var xG=st().fromPromise,WF=rt("path"),eo=Tt(),{mkdirs:gG,mkdirsSync:yG}=Rr(),{symlinkPaths:bG,symlinkPathsSync:SG}=LF(),{symlinkType:_G,symlinkTypeSync:EG}=HF(),{pathExists:OG}=An(),{areIdentical:UF}=Js();async function CG(e,t,r){let o;try{o=await eo.lstat(t)}catch{}if(o&&o.isSymbolicLink()){let[c,a]=await Promise.all([eo.stat(e),eo.stat(t)]);if(UF(c,a))return}let n=await bG(e,t);e=n.toDst;let s=await _G(n.toCwd,r),i=WF.dirname(t);return await OG(i)||await gG(i),eo.symlink(e,t,s)}function vG(e,t,r){let o;try{o=eo.lstatSync(t)}catch{}if(o&&o.isSymbolicLink()){let c=eo.statSync(e),a=eo.statSync(t);if(UF(c,a))return}let n=SG(e,t);e=n.toDst,r=EG(n.toCwd,r);let s=WF.dirname(t);return eo.existsSync(s)||yG(s),eo.symlinkSync(e,t,r)}BF.exports={createSymlink:xG(CG),createSymlinkSync:vG}});var QF=J((XX,YF)=>{"use strict";u();var{createFile:zF,createFileSync:GF}=MF(),{createLink:$F,createLinkSync:VF}=NF(),{createSymlink:KF,createSymlinkSync:JF}=jF();YF.exports={createFile:zF,createFileSync:GF,ensureFile:zF,ensureFileSync:GF,createLink:$F,createLinkSync:VF,ensureLink:$F,ensureLinkSync:VF,createSymlink:KF,createSymlinkSync:JF,ensureSymlink:KF,ensureSymlinkSync:JF}});var xf=J((tee,ZF)=>{u();function kG(e,{EOL:t=`
`,finalEOL:r=!0,replacer:o=null,spaces:n}={}){let s=r?t:"";return JSON.stringify(e,o,n).replace(/\n/g,t)+s}function wG(e){return Buffer.isBuffer(e)&&(e=e.toString("utf8")),e.replace(/^\uFEFF/,"")}ZF.exports={stringify:kG,stripBom:wG}});var rT=J((oee,tT)=>{u();var ac;try{ac=sc()}catch{ac=rt("fs")}var gf=st(),{stringify:XF,stripBom:eT}=xf();async function RG(e,t={}){typeof t=="string"&&(t={encoding:t});let r=t.fs||ac,o="throws"in t?t.throws:!0,n=await gf.fromCallback(r.readFile)(e,t);n=eT(n);let s;try{s=JSON.parse(n,t?t.reviver:null)}catch(i){if(o)throw i.message=`${e}: ${i.message}`,i;return null}return s}var MG=gf.fromPromise(RG);function FG(e,t={}){typeof t=="string"&&(t={encoding:t});let r=t.fs||ac,o="throws"in t?t.throws:!0;try{let n=r.readFileSync(e,t);return n=eT(n),JSON.parse(n,t.reviver)}catch(n){if(o)throw n.message=`${e}: ${n.message}`,n;return null}}async function TG(e,t,r={}){let o=r.fs||ac,n=XF(t,r);await gf.fromCallback(o.writeFile)(e,n,r)}var AG=gf.fromPromise(TG);function IG(e,t,r={}){let o=r.fs||ac,n=XF(t,r);return o.writeFileSync(e,n,r)}var NG={readFile:MG,readFileSync:FG,writeFile:AG,writeFileSync:IG};tT.exports=NG});var nT=J((see,oT)=>{"use strict";u();var yf=rT();oT.exports={readJson:yf.readFile,readJsonSync:yf.readFileSync,writeJson:yf.writeFile,writeJsonSync:yf.writeFileSync}});var bf=J((cee,cT)=>{"use strict";u();var PG=st().fromPromise,ly=Tt(),sT=rt("path"),iT=Rr(),LG=An().pathExists;async function DG(e,t,r="utf-8"){let o=sT.dirname(e);return await LG(o)||await iT.mkdirs(o),ly.writeFile(e,t,r)}function qG(e,...t){let r=sT.dirname(e);ly.existsSync(r)||iT.mkdirsSync(r),ly.writeFileSync(e,...t)}cT.exports={outputFile:PG(DG),outputFileSync:qG}});var uT=J((uee,aT)=>{"use strict";u();var{stringify:HG}=xf(),{outputFile:WG}=bf();async function UG(e,t,r={}){let o=HG(t,r);await WG(e,o,r)}aT.exports=UG});var pT=J((pee,lT)=>{"use strict";u();var{stringify:BG}=xf(),{outputFileSync:jG}=bf();function zG(e,t,r){let o=BG(t,r);jG(e,o,r)}lT.exports=zG});var mT=J((mee,fT)=>{"use strict";u();var GG=st().fromPromise,It=nT();It.outputJson=GG(uT());It.outputJsonSync=pT();It.outputJSON=It.outputJson;It.outputJSONSync=It.outputJsonSync;It.writeJSON=It.writeJson;It.writeJSONSync=It.writeJsonSync;It.readJSON=It.readJson;It.readJSONSync=It.readJsonSync;fT.exports=It});var yT=J((dee,gT)=>{"use strict";u();var $G=Tt(),hT=rt("path"),{copy:VG}=df(),{remove:xT}=Ga(),{mkdirp:KG}=Rr(),{pathExists:JG}=An(),dT=Js();async function YG(e,t,r={}){let o=r.overwrite||r.clobber||!1,{srcStat:n,isChangingCase:s=!1}=await dT.checkPaths(e,t,"move",r);await dT.checkParentPaths(e,n,t,"move");let i=hT.dirname(t);return hT.parse(i).root!==i&&await KG(i),QG(e,t,o,s)}async function QG(e,t,r,o){if(!o){if(r)await xT(t);else if(await JG(t))throw new Error("dest already exists.")}try{await $G.rename(e,t)}catch(n){if(n.code!=="EXDEV")throw n;await ZG(e,t,r)}}async function ZG(e,t,r){return await VG(e,t,{overwrite:r,errorOnExist:!0,preserveTimestamps:!0}),xT(e)}gT.exports=YG});var OT=J((gee,ET)=>{"use strict";u();var ST=sc(),fy=rt("path"),XG=df().copySync,_T=Ga().removeSync,e3=Rr().mkdirpSync,bT=Js();function t3(e,t,r){r=r||{};let o=r.overwrite||r.clobber||!1,{srcStat:n,isChangingCase:s=!1}=bT.checkPathsSync(e,t,"move",r);return bT.checkParentPathsSync(e,n,t,"move"),r3(t)||e3(fy.dirname(t)),o3(e,t,o,s)}function r3(e){let t=fy.dirname(e);return fy.parse(t).root===t}function o3(e,t,r,o){if(o)return py(e,t,r);if(r)return _T(t),py(e,t,r);if(ST.existsSync(t))throw new Error("dest already exists.");return py(e,t,r)}function py(e,t,r){try{ST.renameSync(e,t)}catch(o){if(o.code!=="EXDEV")throw o;return n3(e,t,r)}}function n3(e,t,r){return XG(e,t,{overwrite:r,errorOnExist:!0,preserveTimestamps:!0}),_T(e)}ET.exports=t3});var vT=J((bee,CT)=>{"use strict";u();var s3=st().fromPromise;CT.exports={move:s3(yT()),moveSync:OT()}});var my=J((_ee,kT)=>{"use strict";u();kT.exports={...Tt(),...df(),...vF(),...QF(),...mT(),...Rr(),...vT(),...bf(),...An(),...Ga()}});var TT=J(hy=>{u();var FT="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");hy.encode=function(e){if(0<=e&&e<FT.length)return FT[e];throw new TypeError("Must be between 0 and 63: "+e)};hy.decode=function(e){var t=65,r=90,o=97,n=122,s=48,i=57,c=43,a=47,p=26,f=52;return t<=e&&e<=r?e-t:o<=e&&e<=n?e-o+p:s<=e&&e<=i?e-s+f:e==c?62:e==a?63:-1}});var gy=J(xy=>{u();var AT=TT(),dy=5,IT=1<<dy,NT=IT-1,PT=IT;function c3(e){return e<0?(-e<<1)+1:(e<<1)+0}function a3(e){var t=(e&1)===1,r=e>>1;return t?-r:r}xy.encode=function(t){var r="",o,n=c3(t);do o=n&NT,n>>>=dy,n>0&&(o|=PT),r+=AT.encode(o);while(n>0);return r};xy.decode=function(t,r,o){var n=t.length,s=0,i=0,c,a;do{if(r>=n)throw new Error("Expected more digits in base 64 VLQ value.");if(a=AT.decode(t.charCodeAt(r++)),a===-1)throw new Error("Invalid base64 digit: "+t.charAt(r-1));c=!!(a&PT),a&=NT,s=s+(a<<i),i+=dy}while(c);o.value=a3(s),o.rest=r}});var pc=J(ct=>{u();function u3(e,t,r){if(t in e)return e[t];if(arguments.length===3)return r;throw new Error('"'+t+'" is a required argument.')}ct.getArg=u3;var LT=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,l3=/^data:.+\,.+$/;function Va(e){var t=e.match(LT);return t?{scheme:t[1],auth:t[2],host:t[3],port:t[4],path:t[5]}:null}ct.urlParse=Va;function lc(e){var t="";return e.scheme&&(t+=e.scheme+":"),t+="//",e.auth&&(t+=e.auth+"@"),e.host&&(t+=e.host),e.port&&(t+=":"+e.port),e.path&&(t+=e.path),t}ct.urlGenerate=lc;var p3=32;function f3(e){var t=[];return function(r){for(var o=0;o<t.length;o++)if(t[o].input===r){var n=t[0];return t[0]=t[o],t[o]=n,t[0].result}var s=e(r);return t.unshift({input:r,result:s}),t.length>p3&&t.pop(),s}}var yy=f3(function(t){var r=t,o=Va(t);if(o){if(!o.path)return t;r=o.path}for(var n=ct.isAbsolute(r),s=[],i=0,c=0;;)if(i=c,c=r.indexOf("/",i),c===-1){s.push(r.slice(i));break}else for(s.push(r.slice(i,c));c<r.length&&r[c]==="/";)c++;for(var a,p=0,c=s.length-1;c>=0;c--)a=s[c],a==="."?s.splice(c,1):a===".."?p++:p>0&&(a===""?(s.splice(c+1,p),p=0):(s.splice(c,2),p--));return r=s.join("/"),r===""&&(r=n?"/":"."),o?(o.path=r,lc(o)):r});ct.normalize=yy;function DT(e,t){e===""&&(e="."),t===""&&(t=".");var r=Va(t),o=Va(e);if(o&&(e=o.path||"/"),r&&!r.scheme)return o&&(r.scheme=o.scheme),lc(r);if(r||t.match(l3))return t;if(o&&!o.host&&!o.path)return o.host=t,lc(o);var n=t.charAt(0)==="/"?t:yy(e.replace(/\/+$/,"")+"/"+t);return o?(o.path=n,lc(o)):n}ct.join=DT;ct.isAbsolute=function(e){return e.charAt(0)==="/"||LT.test(e)};function m3(e,t){e===""&&(e="."),e=e.replace(/\/$/,"");for(var r=0;t.indexOf(e+"/")!==0;){var o=e.lastIndexOf("/");if(o<0||(e=e.slice(0,o),e.match(/^([^\/]+:\/)?\/*$/)))return t;++r}return Array(r+1).join("../")+t.substr(e.length+1)}ct.relative=m3;var qT=function(){var e=Object.create(null);return!("__proto__"in e)}();function HT(e){return e}function h3(e){return WT(e)?"$"+e:e}ct.toSetString=qT?HT:h3;function d3(e){return WT(e)?e.slice(1):e}ct.fromSetString=qT?HT:d3;function WT(e){if(!e)return!1;var t=e.length;if(t<9||e.charCodeAt(t-1)!==95||e.charCodeAt(t-2)!==95||e.charCodeAt(t-3)!==111||e.charCodeAt(t-4)!==116||e.charCodeAt(t-5)!==111||e.charCodeAt(t-6)!==114||e.charCodeAt(t-7)!==112||e.charCodeAt(t-8)!==95||e.charCodeAt(t-9)!==95)return!1;for(var r=t-10;r>=0;r--)if(e.charCodeAt(r)!==36)return!1;return!0}function x3(e,t,r){var o=qo(e.source,t.source);return o!==0||(o=e.originalLine-t.originalLine,o!==0)||(o=e.originalColumn-t.originalColumn,o!==0||r)||(o=e.generatedColumn-t.generatedColumn,o!==0)||(o=e.generatedLine-t.generatedLine,o!==0)?o:qo(e.name,t.name)}ct.compareByOriginalPositions=x3;function g3(e,t,r){var o;return o=e.originalLine-t.originalLine,o!==0||(o=e.originalColumn-t.originalColumn,o!==0||r)||(o=e.generatedColumn-t.generatedColumn,o!==0)||(o=e.generatedLine-t.generatedLine,o!==0)?o:qo(e.name,t.name)}ct.compareByOriginalPositionsNoSource=g3;function y3(e,t,r){var o=e.generatedLine-t.generatedLine;return o!==0||(o=e.generatedColumn-t.generatedColumn,o!==0||r)||(o=qo(e.source,t.source),o!==0)||(o=e.originalLine-t.originalLine,o!==0)||(o=e.originalColumn-t.originalColumn,o!==0)?o:qo(e.name,t.name)}ct.compareByGeneratedPositionsDeflated=y3;function b3(e,t,r){var o=e.generatedColumn-t.generatedColumn;return o!==0||r||(o=qo(e.source,t.source),o!==0)||(o=e.originalLine-t.originalLine,o!==0)||(o=e.originalColumn-t.originalColumn,o!==0)?o:qo(e.name,t.name)}ct.compareByGeneratedPositionsDeflatedNoLine=b3;function qo(e,t){return e===t?0:e===null?1:t===null?-1:e>t?1:-1}function S3(e,t){var r=e.generatedLine-t.generatedLine;return r!==0||(r=e.generatedColumn-t.generatedColumn,r!==0)||(r=qo(e.source,t.source),r!==0)||(r=e.originalLine-t.originalLine,r!==0)||(r=e.originalColumn-t.originalColumn,r!==0)?r:qo(e.name,t.name)}ct.compareByGeneratedPositionsInflated=S3;function _3(e){return JSON.parse(e.replace(/^\)]}'[^\n]*\n/,""))}ct.parseSourceMapInput=_3;function E3(e,t,r){if(t=t||"",e&&(e[e.length-1]!=="/"&&t[0]!=="/"&&(e+="/"),t=e+t),r){var o=Va(r);if(!o)throw new Error("sourceMapURL could not be parsed");if(o.path){var n=o.path.lastIndexOf("/");n>=0&&(o.path=o.path.substring(0,n+1))}t=DT(lc(o),t)}return yy(t)}ct.computeSourceURL=E3});var _y=J(UT=>{u();var by=pc(),Sy=Object.prototype.hasOwnProperty,Ys=typeof Map<"u";function Ho(){this._array=[],this._set=Ys?new Map:Object.create(null)}Ho.fromArray=function(t,r){for(var o=new Ho,n=0,s=t.length;n<s;n++)o.add(t[n],r);return o};Ho.prototype.size=function(){return Ys?this._set.size:Object.getOwnPropertyNames(this._set).length};Ho.prototype.add=function(t,r){var o=Ys?t:by.toSetString(t),n=Ys?this.has(t):Sy.call(this._set,o),s=this._array.length;(!n||r)&&this._array.push(t),n||(Ys?this._set.set(t,s):this._set[o]=s)};Ho.prototype.has=function(t){if(Ys)return this._set.has(t);var r=by.toSetString(t);return Sy.call(this._set,r)};Ho.prototype.indexOf=function(t){if(Ys){var r=this._set.get(t);if(r>=0)return r}else{var o=by.toSetString(t);if(Sy.call(this._set,o))return this._set[o]}throw new Error('"'+t+'" is not in the set.')};Ho.prototype.at=function(t){if(t>=0&&t<this._array.length)return this._array[t];throw new Error("No element indexed by "+t)};Ho.prototype.toArray=function(){return this._array.slice()};UT.ArraySet=Ho});var zT=J(jT=>{u();var BT=pc();function O3(e,t){var r=e.generatedLine,o=t.generatedLine,n=e.generatedColumn,s=t.generatedColumn;return o>r||o==r&&s>=n||BT.compareByGeneratedPositionsInflated(e,t)<=0}function Ef(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}Ef.prototype.unsortedForEach=function(t,r){this._array.forEach(t,r)};Ef.prototype.add=function(t){O3(this._last,t)?(this._last=t,this._array.push(t)):(this._sorted=!1,this._array.push(t))};Ef.prototype.toArray=function(){return this._sorted||(this._array.sort(BT.compareByGeneratedPositionsInflated),this._sorted=!0),this._array};jT.MappingList=Ef});var Ey=J(GT=>{u();var Ka=gy(),ze=pc(),Of=_y().ArraySet,C3=zT().MappingList;function fr(e){e||(e={}),this._file=ze.getArg(e,"file",null),this._sourceRoot=ze.getArg(e,"sourceRoot",null),this._skipValidation=ze.getArg(e,"skipValidation",!1),this._ignoreInvalidMapping=ze.getArg(e,"ignoreInvalidMapping",!1),this._sources=new Of,this._names=new Of,this._mappings=new C3,this._sourcesContents=null}fr.prototype._version=3;fr.fromSourceMap=function(t,r){var o=t.sourceRoot,n=new fr(Object.assign(r||{},{file:t.file,sourceRoot:o}));return t.eachMapping(function(s){var i={generated:{line:s.generatedLine,column:s.generatedColumn}};s.source!=null&&(i.source=s.source,o!=null&&(i.source=ze.relative(o,i.source)),i.original={line:s.originalLine,column:s.originalColumn},s.name!=null&&(i.name=s.name)),n.addMapping(i)}),t.sources.forEach(function(s){var i=s;o!==null&&(i=ze.relative(o,s)),n._sources.has(i)||n._sources.add(i);var c=t.sourceContentFor(s);c!=null&&n.setSourceContent(s,c)}),n};fr.prototype.addMapping=function(t){var r=ze.getArg(t,"generated"),o=ze.getArg(t,"original",null),n=ze.getArg(t,"source",null),s=ze.getArg(t,"name",null);!this._skipValidation&&this._validateMapping(r,o,n,s)===!1||(n!=null&&(n=String(n),this._sources.has(n)||this._sources.add(n)),s!=null&&(s=String(s),this._names.has(s)||this._names.add(s)),this._mappings.add({generatedLine:r.line,generatedColumn:r.column,originalLine:o!=null&&o.line,originalColumn:o!=null&&o.column,source:n,name:s}))};fr.prototype.setSourceContent=function(t,r){var o=t;this._sourceRoot!=null&&(o=ze.relative(this._sourceRoot,o)),r!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[ze.toSetString(o)]=r):this._sourcesContents&&(delete this._sourcesContents[ze.toSetString(o)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))};fr.prototype.applySourceMap=function(t,r,o){var n=r;if(r==null){if(t.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);n=t.file}var s=this._sourceRoot;s!=null&&(n=ze.relative(s,n));var i=new Of,c=new Of;this._mappings.unsortedForEach(function(a){if(a.source===n&&a.originalLine!=null){var p=t.originalPositionFor({line:a.originalLine,column:a.originalColumn});p.source!=null&&(a.source=p.source,o!=null&&(a.source=ze.join(o,a.source)),s!=null&&(a.source=ze.relative(s,a.source)),a.originalLine=p.line,a.originalColumn=p.column,p.name!=null&&(a.name=p.name))}var f=a.source;f!=null&&!i.has(f)&&i.add(f);var h=a.name;h!=null&&!c.has(h)&&c.add(h)},this),this._sources=i,this._names=c,t.sources.forEach(function(a){var p=t.sourceContentFor(a);p!=null&&(o!=null&&(a=ze.join(o,a)),s!=null&&(a=ze.relative(s,a)),this.setSourceContent(a,p))},this)};fr.prototype._validateMapping=function(t,r,o,n){if(r&&typeof r.line!="number"&&typeof r.column!="number"){var s="original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.";if(this._ignoreInvalidMapping)return typeof console<"u"&&console.warn&&console.warn(s),!1;throw new Error(s)}if(!(t&&"line"in t&&"column"in t&&t.line>0&&t.column>=0&&!r&&!o&&!n)){if(t&&"line"in t&&"column"in t&&r&&"line"in r&&"column"in r&&t.line>0&&t.column>=0&&r.line>0&&r.column>=0&&o)return;var s="Invalid mapping: "+JSON.stringify({generated:t,source:o,original:r,name:n});if(this._ignoreInvalidMapping)return typeof console<"u"&&console.warn&&console.warn(s),!1;throw new Error(s)}};fr.prototype._serializeMappings=function(){for(var t=0,r=1,o=0,n=0,s=0,i=0,c="",a,p,f,h,d=this._mappings.toArray(),g=0,b=d.length;g<b;g++){if(p=d[g],a="",p.generatedLine!==r)for(t=0;p.generatedLine!==r;)a+=";",r++;else if(g>0){if(!ze.compareByGeneratedPositionsInflated(p,d[g-1]))continue;a+=","}a+=Ka.encode(p.generatedColumn-t),t=p.generatedColumn,p.source!=null&&(h=this._sources.indexOf(p.source),a+=Ka.encode(h-i),i=h,a+=Ka.encode(p.originalLine-1-n),n=p.originalLine-1,a+=Ka.encode(p.originalColumn-o),o=p.originalColumn,p.name!=null&&(f=this._names.indexOf(p.name),a+=Ka.encode(f-s),s=f)),c+=a}return c};fr.prototype._generateSourcesContent=function(t,r){return t.map(function(o){if(!this._sourcesContents)return null;r!=null&&(o=ze.relative(r,o));var n=ze.toSetString(o);return Object.prototype.hasOwnProperty.call(this._sourcesContents,n)?this._sourcesContents[n]:null},this)};fr.prototype.toJSON=function(){var t={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(t.file=this._file),this._sourceRoot!=null&&(t.sourceRoot=this._sourceRoot),this._sourcesContents&&(t.sourcesContent=this._generateSourcesContent(t.sources,t.sourceRoot)),t};fr.prototype.toString=function(){return JSON.stringify(this.toJSON())};GT.SourceMapGenerator=fr});var $T=J(Qs=>{u();Qs.GREATEST_LOWER_BOUND=1;Qs.LEAST_UPPER_BOUND=2;function Oy(e,t,r,o,n,s){var i=Math.floor((t-e)/2)+e,c=n(r,o[i],!0);return c===0?i:c>0?t-i>1?Oy(i,t,r,o,n,s):s==Qs.LEAST_UPPER_BOUND?t<o.length?t:-1:i:i-e>1?Oy(e,i,r,o,n,s):s==Qs.LEAST_UPPER_BOUND?i:e<0?-1:e}Qs.search=function(t,r,o,n){if(r.length===0)return-1;var s=Oy(-1,r.length,t,r,o,n||Qs.GREATEST_LOWER_BOUND);if(s<0)return-1;for(;s-1>=0&&o(r[s],r[s-1],!0)===0;)--s;return s}});var JT=J(KT=>{u();function v3(e){function t(n,s,i){var c=n[s];n[s]=n[i],n[i]=c}function r(n,s){return Math.round(n+Math.random()*(s-n))}function o(n,s,i,c){if(i<c){var a=r(i,c),p=i-1;t(n,a,c);for(var f=n[c],h=i;h<c;h++)s(n[h],f,!1)<=0&&(p+=1,t(n,p,h));t(n,p+1,h);var d=p+1;o(n,s,i,d-1),o(n,s,d+1,c)}}return o}function k3(e){let t=v3.toString();return new Function(`return ${t}`)()(e)}var VT=new WeakMap;KT.quickSort=function(e,t,r=0){let o=VT.get(t);o===void 0&&(o=k3(t),VT.set(t,o)),o(e,t,r,e.length-1)}});var ZT=J(Cf=>{u();var A=pc(),vy=$T(),fc=_y().ArraySet,w3=gy(),Ja=JT().quickSort;function Ee(e,t){var r=e;return typeof e=="string"&&(r=A.parseSourceMapInput(e)),r.sections!=null?new Mr(r,t):new ht(r,t)}Ee.fromSourceMap=function(e,t){return ht.fromSourceMap(e,t)};Ee.prototype._version=3;Ee.prototype.__generatedMappings=null;Object.defineProperty(Ee.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}});Ee.prototype.__originalMappings=null;Object.defineProperty(Ee.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}});Ee.prototype._charIsMappingSeparator=function(t,r){var o=t.charAt(r);return o===";"||o===","};Ee.prototype._parseMappings=function(t,r){throw new Error("Subclasses must implement _parseMappings")};Ee.GENERATED_ORDER=1;Ee.ORIGINAL_ORDER=2;Ee.GREATEST_LOWER_BOUND=1;Ee.LEAST_UPPER_BOUND=2;Ee.prototype.eachMapping=function(t,r,o){var n=r||null,s=o||Ee.GENERATED_ORDER,i;switch(s){case Ee.GENERATED_ORDER:i=this._generatedMappings;break;case Ee.ORIGINAL_ORDER:i=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}for(var c=this.sourceRoot,a=t.bind(n),p=this._names,f=this._sources,h=this._sourceMapURL,d=0,g=i.length;d<g;d++){var b=i[d],R=b.source===null?null:f.at(b.source);R!==null&&(R=A.computeSourceURL(c,R,h)),a({source:R,generatedLine:b.generatedLine,generatedColumn:b.generatedColumn,originalLine:b.originalLine,originalColumn:b.originalColumn,name:b.name===null?null:p.at(b.name)})}};Ee.prototype.allGeneratedPositionsFor=function(t){var r=A.getArg(t,"line"),o={source:A.getArg(t,"source"),originalLine:r,originalColumn:A.getArg(t,"column",0)};if(o.source=this._findSourceIndex(o.source),o.source<0)return[];var n=[],s=this._findMapping(o,this._originalMappings,"originalLine","originalColumn",A.compareByOriginalPositions,vy.LEAST_UPPER_BOUND);if(s>=0){var i=this._originalMappings[s];if(t.column===void 0)for(var c=i.originalLine;i&&i.originalLine===c;)n.push({line:A.getArg(i,"generatedLine",null),column:A.getArg(i,"generatedColumn",null),lastColumn:A.getArg(i,"lastGeneratedColumn",null)}),i=this._originalMappings[++s];else for(var a=i.originalColumn;i&&i.originalLine===r&&i.originalColumn==a;)n.push({line:A.getArg(i,"generatedLine",null),column:A.getArg(i,"generatedColumn",null),lastColumn:A.getArg(i,"lastGeneratedColumn",null)}),i=this._originalMappings[++s]}return n};Cf.SourceMapConsumer=Ee;function ht(e,t){var r=e;typeof e=="string"&&(r=A.parseSourceMapInput(e));var o=A.getArg(r,"version"),n=A.getArg(r,"sources"),s=A.getArg(r,"names",[]),i=A.getArg(r,"sourceRoot",null),c=A.getArg(r,"sourcesContent",null),a=A.getArg(r,"mappings"),p=A.getArg(r,"file",null);if(o!=this._version)throw new Error("Unsupported version: "+o);i&&(i=A.normalize(i)),n=n.map(String).map(A.normalize).map(function(f){return i&&A.isAbsolute(i)&&A.isAbsolute(f)?A.relative(i,f):f}),this._names=fc.fromArray(s.map(String),!0),this._sources=fc.fromArray(n,!0),this._absoluteSources=this._sources.toArray().map(function(f){return A.computeSourceURL(i,f,t)}),this.sourceRoot=i,this.sourcesContent=c,this._mappings=a,this._sourceMapURL=t,this.file=p}ht.prototype=Object.create(Ee.prototype);ht.prototype.consumer=Ee;ht.prototype._findSourceIndex=function(e){var t=e;if(this.sourceRoot!=null&&(t=A.relative(this.sourceRoot,t)),this._sources.has(t))return this._sources.indexOf(t);var r;for(r=0;r<this._absoluteSources.length;++r)if(this._absoluteSources[r]==e)return r;return-1};ht.fromSourceMap=function(t,r){var o=Object.create(ht.prototype),n=o._names=fc.fromArray(t._names.toArray(),!0),s=o._sources=fc.fromArray(t._sources.toArray(),!0);o.sourceRoot=t._sourceRoot,o.sourcesContent=t._generateSourcesContent(o._sources.toArray(),o.sourceRoot),o.file=t._file,o._sourceMapURL=r,o._absoluteSources=o._sources.toArray().map(function(g){return A.computeSourceURL(o.sourceRoot,g,r)});for(var i=t._mappings.toArray().slice(),c=o.__generatedMappings=[],a=o.__originalMappings=[],p=0,f=i.length;p<f;p++){var h=i[p],d=new QT;d.generatedLine=h.generatedLine,d.generatedColumn=h.generatedColumn,h.source&&(d.source=s.indexOf(h.source),d.originalLine=h.originalLine,d.originalColumn=h.originalColumn,h.name&&(d.name=n.indexOf(h.name)),a.push(d)),c.push(d)}return Ja(o.__originalMappings,A.compareByOriginalPositions),o};ht.prototype._version=3;Object.defineProperty(ht.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function QT(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}var Cy=A.compareByGeneratedPositionsDeflatedNoLine;function YT(e,t){let r=e.length,o=e.length-t;if(!(o<=1))if(o==2){let n=e[t],s=e[t+1];Cy(n,s)>0&&(e[t]=s,e[t+1]=n)}else if(o<20)for(let n=t;n<r;n++)for(let s=n;s>t;s--){let i=e[s-1],c=e[s];if(Cy(i,c)<=0)break;e[s-1]=c,e[s]=i}else Ja(e,Cy,t)}ht.prototype._parseMappings=function(t,r){var o=1,n=0,s=0,i=0,c=0,a=0,p=t.length,f=0,h={},d={},g=[],b=[],R,I,P,K,ue;let Se=0;for(;f<p;)if(t.charAt(f)===";")o++,f++,n=0,YT(b,Se),Se=b.length;else if(t.charAt(f)===",")f++;else{for(R=new QT,R.generatedLine=o,K=f;K<p&&!this._charIsMappingSeparator(t,K);K++);for(I=t.slice(f,K),P=[];f<K;)w3.decode(t,f,d),ue=d.value,f=d.rest,P.push(ue);if(P.length===2)throw new Error("Found a source, but no line and column");if(P.length===3)throw new Error("Found a source and line, but no column");if(R.generatedColumn=n+P[0],n=R.generatedColumn,P.length>1&&(R.source=c+P[1],c+=P[1],R.originalLine=s+P[2],s=R.originalLine,R.originalLine+=1,R.originalColumn=i+P[3],i=R.originalColumn,P.length>4&&(R.name=a+P[4],a+=P[4])),b.push(R),typeof R.originalLine=="number"){let er=R.source;for(;g.length<=er;)g.push(null);g[er]===null&&(g[er]=[]),g[er].push(R)}}YT(b,Se),this.__generatedMappings=b;for(var at=0;at<g.length;at++)g[at]!=null&&Ja(g[at],A.compareByOriginalPositionsNoSource);this.__originalMappings=[].concat(...g)};ht.prototype._findMapping=function(t,r,o,n,s,i){if(t[o]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+t[o]);if(t[n]<0)throw new TypeError("Column must be greater than or equal to 0, got "+t[n]);return vy.search(t,r,s,i)};ht.prototype.computeColumnSpans=function(){for(var t=0;t<this._generatedMappings.length;++t){var r=this._generatedMappings[t];if(t+1<this._generatedMappings.length){var o=this._generatedMappings[t+1];if(r.generatedLine===o.generatedLine){r.lastGeneratedColumn=o.generatedColumn-1;continue}}r.lastGeneratedColumn=1/0}};ht.prototype.originalPositionFor=function(t){var r={generatedLine:A.getArg(t,"line"),generatedColumn:A.getArg(t,"column")},o=this._findMapping(r,this._generatedMappings,"generatedLine","generatedColumn",A.compareByGeneratedPositionsDeflated,A.getArg(t,"bias",Ee.GREATEST_LOWER_BOUND));if(o>=0){var n=this._generatedMappings[o];if(n.generatedLine===r.generatedLine){var s=A.getArg(n,"source",null);s!==null&&(s=this._sources.at(s),s=A.computeSourceURL(this.sourceRoot,s,this._sourceMapURL));var i=A.getArg(n,"name",null);return i!==null&&(i=this._names.at(i)),{source:s,line:A.getArg(n,"originalLine",null),column:A.getArg(n,"originalColumn",null),name:i}}}return{source:null,line:null,column:null,name:null}};ht.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(t){return t==null}):!1};ht.prototype.sourceContentFor=function(t,r){if(!this.sourcesContent)return null;var o=this._findSourceIndex(t);if(o>=0)return this.sourcesContent[o];var n=t;this.sourceRoot!=null&&(n=A.relative(this.sourceRoot,n));var s;if(this.sourceRoot!=null&&(s=A.urlParse(this.sourceRoot))){var i=n.replace(/^file:\/\//,"");if(s.scheme=="file"&&this._sources.has(i))return this.sourcesContent[this._sources.indexOf(i)];if((!s.path||s.path=="/")&&this._sources.has("/"+n))return this.sourcesContent[this._sources.indexOf("/"+n)]}if(r)return null;throw new Error('"'+n+'" is not in the SourceMap.')};ht.prototype.generatedPositionFor=function(t){var r=A.getArg(t,"source");if(r=this._findSourceIndex(r),r<0)return{line:null,column:null,lastColumn:null};var o={source:r,originalLine:A.getArg(t,"line"),originalColumn:A.getArg(t,"column")},n=this._findMapping(o,this._originalMappings,"originalLine","originalColumn",A.compareByOriginalPositions,A.getArg(t,"bias",Ee.GREATEST_LOWER_BOUND));if(n>=0){var s=this._originalMappings[n];if(s.source===o.source)return{line:A.getArg(s,"generatedLine",null),column:A.getArg(s,"generatedColumn",null),lastColumn:A.getArg(s,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}};Cf.BasicSourceMapConsumer=ht;function Mr(e,t){var r=e;typeof e=="string"&&(r=A.parseSourceMapInput(e));var o=A.getArg(r,"version"),n=A.getArg(r,"sections");if(o!=this._version)throw new Error("Unsupported version: "+o);this._sources=new fc,this._names=new fc;var s={line:-1,column:0};this._sections=n.map(function(i){if(i.url)throw new Error("Support for url field in sections not implemented.");var c=A.getArg(i,"offset"),a=A.getArg(c,"line"),p=A.getArg(c,"column");if(a<s.line||a===s.line&&p<s.column)throw new Error("Section offsets must be ordered and non-overlapping.");return s=c,{generatedOffset:{generatedLine:a+1,generatedColumn:p+1},consumer:new Ee(A.getArg(i,"map"),t)}})}Mr.prototype=Object.create(Ee.prototype);Mr.prototype.constructor=Ee;Mr.prototype._version=3;Object.defineProperty(Mr.prototype,"sources",{get:function(){for(var e=[],t=0;t<this._sections.length;t++)for(var r=0;r<this._sections[t].consumer.sources.length;r++)e.push(this._sections[t].consumer.sources[r]);return e}});Mr.prototype.originalPositionFor=function(t){var r={generatedLine:A.getArg(t,"line"),generatedColumn:A.getArg(t,"column")},o=vy.search(r,this._sections,function(s,i){var c=s.generatedLine-i.generatedOffset.generatedLine;return c||s.generatedColumn-i.generatedOffset.generatedColumn}),n=this._sections[o];return n?n.consumer.originalPositionFor({line:r.generatedLine-(n.generatedOffset.generatedLine-1),column:r.generatedColumn-(n.generatedOffset.generatedLine===r.generatedLine?n.generatedOffset.generatedColumn-1:0),bias:t.bias}):{source:null,line:null,column:null,name:null}};Mr.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(t){return t.consumer.hasContentsOfAllSources()})};Mr.prototype.sourceContentFor=function(t,r){for(var o=0;o<this._sections.length;o++){var n=this._sections[o],s=n.consumer.sourceContentFor(t,!0);if(s||s==="")return s}if(r)return null;throw new Error('"'+t+'" is not in the SourceMap.')};Mr.prototype.generatedPositionFor=function(t){for(var r=0;r<this._sections.length;r++){var o=this._sections[r];if(o.consumer._findSourceIndex(A.getArg(t,"source"))!==-1){var n=o.consumer.generatedPositionFor(t);if(n){var s={line:n.line+(o.generatedOffset.generatedLine-1),column:n.column+(o.generatedOffset.generatedLine===n.line?o.generatedOffset.generatedColumn-1:0)};return s}}}return{line:null,column:null}};Mr.prototype._parseMappings=function(t,r){this.__generatedMappings=[],this.__originalMappings=[];for(var o=0;o<this._sections.length;o++)for(var n=this._sections[o],s=n.consumer._generatedMappings,i=0;i<s.length;i++){var c=s[i],a=n.consumer._sources.at(c.source);a!==null&&(a=A.computeSourceURL(n.consumer.sourceRoot,a,this._sourceMapURL)),this._sources.add(a),a=this._sources.indexOf(a);var p=null;c.name&&(p=n.consumer._names.at(c.name),this._names.add(p),p=this._names.indexOf(p));var f={source:a,generatedLine:c.generatedLine+(n.generatedOffset.generatedLine-1),generatedColumn:c.generatedColumn+(n.generatedOffset.generatedLine===c.generatedLine?n.generatedOffset.generatedColumn-1:0),originalLine:c.originalLine,originalColumn:c.originalColumn,name:p};this.__generatedMappings.push(f),typeof f.originalLine=="number"&&this.__originalMappings.push(f)}Ja(this.__generatedMappings,A.compareByGeneratedPositionsDeflated),Ja(this.__originalMappings,A.compareByOriginalPositions)};Cf.IndexedSourceMapConsumer=Mr});var eA=J(XT=>{u();var R3=Ey().SourceMapGenerator,vf=pc(),M3=/(\r?\n)/,F3=10,mc="$$$isSourceNode$$$";function Xt(e,t,r,o,n){this.children=[],this.sourceContents={},this.line=e??null,this.column=t??null,this.source=r??null,this.name=n??null,this[mc]=!0,o!=null&&this.add(o)}Xt.fromStringWithSourceMap=function(t,r,o){var n=new Xt,s=t.split(M3),i=0,c=function(){var d=b(),g=b()||"";return d+g;function b(){return i<s.length?s[i++]:void 0}},a=1,p=0,f=null;return r.eachMapping(function(d){if(f!==null)if(a<d.generatedLine)h(f,c()),a++,p=0;else{var g=s[i]||"",b=g.substr(0,d.generatedColumn-p);s[i]=g.substr(d.generatedColumn-p),p=d.generatedColumn,h(f,b),f=d;return}for(;a<d.generatedLine;)n.add(c()),a++;if(p<d.generatedColumn){var g=s[i]||"";n.add(g.substr(0,d.generatedColumn)),s[i]=g.substr(d.generatedColumn),p=d.generatedColumn}f=d},this),i<s.length&&(f&&h(f,c()),n.add(s.splice(i).join(""))),r.sources.forEach(function(d){var g=r.sourceContentFor(d);g!=null&&(o!=null&&(d=vf.join(o,d)),n.setSourceContent(d,g))}),n;function h(d,g){if(d===null||d.source===void 0)n.add(g);else{var b=o?vf.join(o,d.source):d.source;n.add(new Xt(d.originalLine,d.originalColumn,b,g,d.name))}}};Xt.prototype.add=function(t){if(Array.isArray(t))t.forEach(function(r){this.add(r)},this);else if(t[mc]||typeof t=="string")t&&this.children.push(t);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+t);return this};Xt.prototype.prepend=function(t){if(Array.isArray(t))for(var r=t.length-1;r>=0;r--)this.prepend(t[r]);else if(t[mc]||typeof t=="string")this.children.unshift(t);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+t);return this};Xt.prototype.walk=function(t){for(var r,o=0,n=this.children.length;o<n;o++)r=this.children[o],r[mc]?r.walk(t):r!==""&&t(r,{source:this.source,line:this.line,column:this.column,name:this.name})};Xt.prototype.join=function(t){var r,o,n=this.children.length;if(n>0){for(r=[],o=0;o<n-1;o++)r.push(this.children[o]),r.push(t);r.push(this.children[o]),this.children=r}return this};Xt.prototype.replaceRight=function(t,r){var o=this.children[this.children.length-1];return o[mc]?o.replaceRight(t,r):typeof o=="string"?this.children[this.children.length-1]=o.replace(t,r):this.children.push("".replace(t,r)),this};Xt.prototype.setSourceContent=function(t,r){this.sourceContents[vf.toSetString(t)]=r};Xt.prototype.walkSourceContents=function(t){for(var r=0,o=this.children.length;r<o;r++)this.children[r][mc]&&this.children[r].walkSourceContents(t);for(var n=Object.keys(this.sourceContents),r=0,o=n.length;r<o;r++)t(vf.fromSetString(n[r]),this.sourceContents[n[r]])};Xt.prototype.toString=function(){var t="";return this.walk(function(r){t+=r}),t};Xt.prototype.toStringWithSourceMap=function(t){var r={code:"",line:1,column:0},o=new R3(t),n=!1,s=null,i=null,c=null,a=null;return this.walk(function(p,f){r.code+=p,f.source!==null&&f.line!==null&&f.column!==null?((s!==f.source||i!==f.line||c!==f.column||a!==f.name)&&o.addMapping({source:f.source,original:{line:f.line,column:f.column},generated:{line:r.line,column:r.column},name:f.name}),s=f.source,i=f.line,c=f.column,a=f.name,n=!0):n&&(o.addMapping({generated:{line:r.line,column:r.column}}),s=null,n=!1);for(var h=0,d=p.length;h<d;h++)p.charCodeAt(h)===F3?(r.line++,r.column=0,h+1===d?(s=null,n=!1):n&&o.addMapping({source:f.source,original:{line:f.line,column:f.column},generated:{line:r.line,column:r.column},name:f.name})):r.column++}),this.walkSourceContents(function(p,f){o.setSourceContent(p,f)}),{code:r.code,map:o}};XT.SourceNode=Xt});var tA=J(kf=>{u();kf.SourceMapGenerator=Ey().SourceMapGenerator;kf.SourceMapConsumer=ZT().SourceMapConsumer;kf.SourceNode=eA().SourceNode});u();u();u();var Xs=e=>typeof e=="function",l=function(e,t){if(typeof e=="function")return function(){return e(arguments)?t.apply(this,arguments):r=>t(r,...arguments)};switch(e){case 0:case 1:throw new RangeError(`Invalid arity ${e}`);case 2:return function(r,o){return arguments.length>=2?t(r,o):function(n){return t(n,r)}};case 3:return function(r,o,n){return arguments.length>=3?t(r,o,n):function(s){return t(s,r,o)}};case 4:return function(r,o,n,s){return arguments.length>=4?t(r,o,n,s):function(i){return t(i,r,o,n)}};case 5:return function(r,o,n,s,i){return arguments.length>=5?t(r,o,n,s,i):function(c){return t(c,r,o,n,s)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);let r=arguments;return function(o){return t(o,...r)}}}};var W=e=>e;var ei=e=>()=>e,Uo=ei(!0),to=ei(!1),Tf=ei(null),Qa=ei(void 0),Bo=Qa;function m(e,t,r,o,n,s,i,c,a){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return r(t(e));case 4:return o(r(t(e)));case 5:return n(o(r(t(e))));case 6:return s(n(o(r(t(e)))));case 7:return i(s(n(o(r(t(e))))));case 8:return c(i(s(n(o(r(t(e)))))));case 9:return a(c(i(s(n(o(r(t(e))))))));default:{let p=arguments[0];for(let f=1;f<arguments.length;f++)p=arguments[f](p);return p}}}u();u();u();var ti=e=>(t,r)=>t===r||e(t,r);var wy=l(2,(e,t)=>ti((r,o)=>e(t(r),t(o))));var Ry=e=>ti((t,r)=>{if(t.length!==r.length)return!1;for(let o=0;o<t.length;o++)if(!e(t[o],r[o]))return!1;return!0});u();var Za=e=>l(3,(t,r,o)=>e(t,n=>Object.assign({},n,{[r]:o(n)}))),Xa=e=>l(2,(t,r)=>e(t,o=>({[r]:o}))),eu=(e,t)=>l(3,(r,o,n)=>t(r,s=>e(n(s),i=>Object.assign({},s,{[o]:i}))));u();u();u();u();u();var CA="3.10.4",Pn=()=>CA;var Nf=Symbol.for(`effect/GlobalValue/globalStoreId/${Pn()}`);Nf in globalThis||(globalThis[Nf]=new Map);var If=globalThis[Nf],H=(e,t)=>(If.has(e)||If.set(e,t()),If.get(e));u();var tu=e=>typeof e=="string",dc=e=>typeof e=="number";var Fy=e=>typeof e=="bigint";var jo=Xs;var kA=e=>typeof e=="object"&&e!==null,Ln=e=>kA(e)||jo(e),k=l(2,(e,t)=>Ln(e)&&t in e),Dn=l(2,(e,t)=>k(e,"_tag")&&e._tag===t),qn=e=>e==null;var mr=e=>k(e,Symbol.iterator);var Pf=e=>k(e,"then")&&jo(e.then);u();u();var Hn=e=>`BUG: ${e} - please report an issue at https://github.com/Effect-TS/effect/issues`;var Lf=Symbol.for("effect/Gen/GenKind"),Hf=e=>Ln(e)&&Lf in e,Df=class{value;constructor(t){this.value=t}get _F(){return W}get _R(){return t=>t}get _O(){return t=>t}get _E(){return t=>t}[Lf]=Lf;[Symbol.iterator](){return new xc(this)}},xc=class e{self;called=!1;constructor(t){this.self=t}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new e(this.self)}};var Ay=()=>function(){let e=arguments[0];for(let t=1;t<arguments.length;t++)e=arguments[t](e);return new Df(e)},wA=335903614,RA=4150755663,MA=1481765933,FA=1284865837,TA=9007199254740992,AA=134217728,ou=class{_state;constructor(t,r,o,n){return qn(r)&&qn(t)?(r=Math.random()*4294967295>>>0,t=0):qn(r)&&(r=t,t=0),qn(n)&&qn(o)?(n=this._state?this._state[3]:RA,o=this._state?this._state[2]:wA):qn(n)&&(n=o,o=0),this._state=new Int32Array([0,0,o>>>0,((n||0)|1)>>>0]),this._next(),Ty(this._state,this._state[0],this._state[1],t>>>0,r>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(t){this._state[0]=t[0],this._state[1]=t[1],this._state[2]=t[2],this._state[3]=t[3]|1}integer(t){return Math.round(this.number()*Number.MAX_SAFE_INTEGER)%t}number(){let t=(this._next()&67108863)*1,r=(this._next()&134217727)*1;return(t*AA+r)/TA}_next(){let t=this._state[0]>>>0,r=this._state[1]>>>0;IA(this._state,t,r,MA,FA),Ty(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let o=t>>>18,n=(r>>>18|t<<14)>>>0;o=(o^t)>>>0,n=(n^r)>>>0;let s=(n>>>27|o<<5)>>>0,i=t>>>27,c=(-i>>>0&31)>>>0;return(s>>>i|s<<c)>>>0}};function IA(e,t,r,o,n){let s=(r>>>16)*(n&65535)>>>0,i=(r&65535)*(n>>>16)>>>0,c=(r&65535)*(n&65535)>>>0,a=(r>>>16)*(n>>>16)+((i>>>16)+(s>>>16))>>>0;i=i<<16>>>0,c=c+i>>>0,c>>>0<i>>>0&&(a=a+1>>>0),s=s<<16>>>0,c=c+s>>>0,c>>>0<s>>>0&&(a=a+1>>>0),a=a+Math.imul(r,o)>>>0,a=a+Math.imul(t,n)>>>0,e[0]=a,e[1]=c}function Ty(e,t,r,o,n){let s=t+o>>>0,i=r+n>>>0;i>>>0<r>>>0&&(s=s+1|0),e[0]=s,e[1]=i}var qf=Symbol.for("effect/Utils/YieldWrap"),Fr=class{#e;constructor(t){this.#e=t}[qf](){return this.#e}};function ri(e){if(typeof e=="object"&&e!==null&&qf in e)return e[qf]();throw new Error(Hn("yieldWrapGet"))}var Nt=H("effect/Utils/isStructuralRegion",()=>({enabled:!1,tester:void 0}));var NA=e=>{let t={[e](r){return r()}};return function(r){return t[e](r)}},Ae=NA("effect_internal_function");var Uf=H(Symbol.for("effect/Hash/randomHashCache"),()=>new WeakMap),F=Symbol.for("effect/Hash"),w=e=>{if(Nt.enabled===!0)return 0;switch(typeof e){case"number":return su(e);case"bigint":return ae(e.toString(10));case"boolean":return ae(String(e));case"symbol":return ae(String(e));case"string":return ae(e);case"undefined":return ae("undefined");case"function":case"object":return e===null?ae("null"):e instanceof Date?w(e.toISOString()):PA(e)?e[F]():oi(e);default:throw new Error(`BUG: unhandled typeof ${typeof e} - please report an issue at https://github.com/Effect-TS/effect/issues`)}},oi=e=>(Uf.has(e)||Uf.set(e,su(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER))),Uf.get(e)),L=e=>t=>t*53^e,nu=e=>e&3221225471|e>>>1&1073741824,PA=e=>k(e,F),su=e=>{if(e!==e||e===1/0)return 0;let t=e|0;for(t!==e&&(t^=e*4294967295);e>4294967295;)t^=e/=4294967295;return nu(t)},ae=e=>{let t=5381,r=e.length;for(;r;)t=t*33^e.charCodeAt(--r);return nu(t)},LA=(e,t)=>{let r=12289;for(let o=0;o<t.length;o++)r^=m(ae(t[o]),L(w(e[t[o]])));return nu(r)},iu=e=>LA(e,Object.keys(e)),Pt=e=>{let t=6151;for(let r=0;r<e.length;r++)t=m(t,L(w(e[r])));return nu(t)},V=function(){if(arguments.length===1){let r=arguments[0];return function(o){return Object.defineProperty(r,F,{value(){return o},enumerable:!1}),o}}let e=arguments[0],t=arguments[1];return Object.defineProperty(e,F,{value(){return t},enumerable:!1}),t};var M=Symbol.for("effect/Equal");function C(){return arguments.length===1?e=>cu(e,arguments[0]):cu(arguments[0],arguments[1])}function cu(e,t){if(e===t)return!0;let r=typeof e;if(r!==typeof t)return!1;if(r==="object"||r==="function"){if(e!==null&&t!==null){if(ni(e)&&ni(t))return w(e)===w(t)&&e[M](t)?!0:Nt.enabled&&Nt.tester?Nt.tester(e,t):!1;if(e instanceof Date&&t instanceof Date)return e.toISOString()===t.toISOString()}if(Nt.enabled){if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&e.every((o,n)=>cu(o,t[n]));if(Object.getPrototypeOf(e)===Object.prototype&&Object.getPrototypeOf(e)===Object.prototype){let o=Object.keys(e),n=Object.keys(t);if(o.length===n.length){for(let s of o)if(!(s in t&&cu(e[s],t[s])))return Nt.tester?Nt.tester(e,t):!1;return!0}}return Nt.tester?Nt.tester(e,t):!1}}return Nt.enabled&&Nt.tester?Nt.tester(e,t):!1}var ni=e=>k(e,M),gc=()=>C;u();var z=Symbol.for("nodejs.util.inspect.custom"),Y=e=>k(e,"toJSON")&&jo(e.toJSON)&&e.toJSON.length===0?e.toJSON():Array.isArray(e)?e.map(Y):Ly(e),re=e=>JSON.stringify(e,null,2),d$={toJSON(){return Y(this)},[z](){return this.toJSON()},toString(){return re(this.toJSON())}},Iy=class{[z](){return this.toJSON()}toString(){return re(this.toJSON())}},zo=(e,t=2)=>{if(typeof e=="string")return e;try{return typeof e=="object"?au(e,t):String(e)}catch{return String(e)}},au=(e,t)=>{let r=[],o=JSON.stringify(e,(n,s)=>typeof s=="object"&&s!==null?r.includes(s)?void 0:r.push(s)&&(Wn.fiberRefs!==void 0&&Ny(s)?s[Bf](Wn.fiberRefs):s):s,t);return r=void 0,o},Bf=Symbol.for("effect/Inspectable/Redactable"),Ny=e=>typeof e=="object"&&e!==null&&Bf in e,Wn=H("effect/Inspectable/redactableState",()=>({fiberRefs:void 0})),Py=(e,t)=>{let r=Wn.fiberRefs;Wn.fiberRefs=e;try{return t()}finally{Wn.fiberRefs=r}},Ly=e=>Ny(e)&&Wn.fiberRefs!==void 0?e[Bf](Wn.fiberRefs):e;u();u();var v=(e,t)=>{switch(t.length){case 0:return e;case 1:return t[0](e);case 2:return t[1](t[0](e));case 3:return t[2](t[1](t[0](e)));case 4:return t[3](t[2](t[1](t[0](e))));case 5:return t[4](t[3](t[2](t[1](t[0](e)))));case 6:return t[5](t[4](t[3](t[2](t[1](t[0](e))))));case 7:return t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))));case 8:return t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e))))))));case 9:return t[8](t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))))));default:{let r=e;for(let o=0,n=t.length;o<n;o++)r=t[o](r);return r}}};u();var Un="Async",si="Commit",Ie="Failure",ii="OnFailure",ci="OnSuccess",ai="OnSuccessAndFailure",Ne="Success",lu="Sync",Dy="Tag",oo="UpdateRuntimeFlags",ui="While",pu="WithRuntime",li="Yield",yc="RevertFlags";var qy=Symbol.for("effect/Effect"),Hy=Symbol.for("effect/Stream"),Wy=Symbol.for("effect/Sink"),Uy=Symbol.for("effect/Channel"),Go={_R:e=>e,_E:e=>e,_A:e=>e,_V:Pn()},qA={_A:e=>e,_In:e=>e,_L:e=>e,_E:e=>e,_R:e=>e},HA={_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},no={[qy]:Go,[Hy]:Go,[Wy]:qA,[Uy]:HA,[M](e){return this===e},[F](){return V(this,oi(this))},[Symbol.iterator](){return new xc(new Fr(this))},pipe(){return v(this,arguments)}},pi={[F](){return V(this,iu(this))},[M](e){let t=Object.keys(this),r=Object.keys(e);if(t.length!==r.length)return!1;for(let o of t)if(!(o in e&&C(this[o],e[o])))return!1;return!0}},so={...no,_op:si},jf={...so,...pi},By=function(){function e(){}return e.prototype=so,e}();u();var zy=Symbol.for("effect/Option"),Gy={...no,[zy]:{_A:e=>e},[z](){return this.toJSON()},toString(){return re(this.toJSON())}},WA=Object.assign(Object.create(Gy),{_tag:"Some",_op:"Some",[M](e){return fu(e)&&zf(e)&&C(this.value,e.value)},[F](){return V(this,L(w(this._tag))(w(this.value)))},toJSON(){return{_id:"Option",_tag:this._tag,value:Y(this.value)}}}),UA=w("None"),BA=Object.assign(Object.create(Gy),{_tag:"None",_op:"None",[M](e){return fu(e)&&mu(e)},[F](){return UA},toJSON(){return{_id:"Option",_tag:this._tag}}}),fu=e=>k(e,zy),mu=e=>e._tag==="None",zf=e=>e._tag==="Some",$o=Object.create(BA),Vo=e=>{let t=Object.create(WA);return t.value=e,t};var $f=Symbol.for("effect/Either"),$y={...no,[$f]:{_R:e=>e},[z](){return this.toJSON()},toString(){return re(this.toJSON())}},jA=Object.assign(Object.create($y),{_tag:"Right",_op:"Right",[M](e){return Vf(e)&&hu(e)&&C(this.right,e.right)},[F](){return L(w(this._tag))(w(this.right))},toJSON(){return{_id:"Either",_tag:this._tag,right:Y(this.right)}}}),zA=Object.assign(Object.create($y),{_tag:"Left",_op:"Left",[M](e){return Vf(e)&&fi(e)&&C(this.left,e.left)},[F](){return L(w(this._tag))(w(this.left))},toJSON(){return{_id:"Either",_tag:this._tag,left:Y(this.left)}}}),Vf=e=>k(e,$f),fi=e=>e._tag==="Left",hu=e=>e._tag==="Right",du=e=>{let t=Object.create(zA);return t.left=e,t},xu=e=>{let t=Object.create(jA);return t.right=e,t},Kf=e=>hu(e)?$o:Vo(e.left),Jf=e=>fi(e)?$o:Vo(e.right);var Pe=xu,bt=du;var hr=fi,Bn=hu;var GA=l(2,(e,{onLeft:t,onRight:r})=>hr(e)?t(e.left):r(e.right));var gu=GA({onLeft:W,onRight:W});var Ky=e=>{if(Symbol.iterator in e){let r=[];for(let o of e){if(hr(o))return o;r.push(o.right)}return Pe(r)}let t={};for(let r of Object.keys(e)){let o=e[r];if(hr(o))return o;t[r]=o.right}return Pe(t)};u();var Yf=e=>e.length>0;var xe={};ky(xe,{Do:()=>kI,TypeId:()=>VA,all:()=>rb,andThen:()=>iI,ap:()=>mI,as:()=>Xy,asVoid:()=>nI,bind:()=>vI,bindTo:()=>OI,composeK:()=>lI,contains:()=>em,containsWith:()=>sb,exists:()=>EI,filter:()=>xI,filterMap:()=>nb,firstSomeOf:()=>eI,flatMap:()=>xr,flatMapNullable:()=>cI,flatten:()=>aI,fromIterable:()=>JA,fromNullable:()=>dr,gen:()=>RI,getEquivalence:()=>gI,getLeft:()=>QA,getOrElse:()=>De,getOrNull:()=>rI,getOrThrow:()=>Sc,getOrThrowWith:()=>Zy,getOrUndefined:()=>ut,getOrder:()=>yI,getRight:()=>YA,isNone:()=>G,isOption:()=>Qy,isSome:()=>U,let:()=>CI,lift2:()=>bI,liftNullable:()=>tI,liftPredicate:()=>SI,liftThrowable:()=>oI,map:()=>Le,match:()=>Ge,none:()=>S,orElse:()=>ZA,orElseEither:()=>XA,orElseSome:()=>Zf,partitionMap:()=>dI,product:()=>tb,productMany:()=>fI,reduceCompact:()=>hI,some:()=>E,tap:()=>eb,toArray:()=>ob,toRefinement:()=>KA,void:()=>sI,zipLeft:()=>pI,zipRight:()=>uI,zipWith:()=>Xf});u();u();var yu=e=>(t,r)=>t===r?0:e(t,r);var Jy=yu((e,t)=>e<t?-1:1);var Yy=l(2,(e,t)=>yu((r,o)=>e(t(r),t(o))));var Qf=e=>l(2,(t,r)=>e(t,r)===1);var VA=Symbol.for("effect/Option"),S=()=>$o,E=Vo,Qy=fu,G=mu,U=zf,Ge=l(2,(e,{onNone:t,onSome:r})=>G(e)?t():r(e.value)),KA=e=>t=>U(e(t)),JA=e=>{for(let t of e)return E(t);return S()},YA=Jf,QA=Kf,De=l(2,(e,t)=>G(e)?t():e.value),ZA=l(2,(e,t)=>G(e)?t():e),Zf=l(2,(e,t)=>G(e)?E(t()):e),XA=l(2,(e,t)=>G(e)?Le(t(),xu):Le(e,du)),eI=e=>{let t=S();for(t of e)if(U(t))return t;return t},dr=e=>e==null?S():E(e),tI=e=>(...t)=>dr(e(...t)),rI=De(Tf),ut=De(Qa),oI=e=>(...t)=>{try{return E(e(...t))}catch{return S()}},Zy=l(2,(e,t)=>{if(U(e))return e.value;throw t()}),Sc=Zy(()=>new Error("getOrThrow called on a None")),Le=l(2,(e,t)=>G(e)?S():E(t(e.value))),Xy=l(2,(e,t)=>Le(e,()=>t)),nI=Xy(void 0),sI=E(void 0);var xr=l(2,(e,t)=>G(e)?S():t(e.value)),iI=l(2,(e,t)=>xr(e,r=>{let o=Xs(t)?t(r):t;return Qy(o)?o:E(o)})),cI=l(2,(e,t)=>G(e)?S():dr(t(e.value))),aI=xr(W),uI=l(2,(e,t)=>xr(e,()=>t)),lI=l(2,(e,t)=>r=>xr(e(r),t)),pI=l(2,(e,t)=>eb(e,()=>t)),eb=l(2,(e,t)=>xr(e,r=>Le(t(r),()=>r))),tb=(e,t)=>U(e)&&U(t)?E([e.value,t.value]):S(),fI=(e,t)=>{if(G(e))return S();let r=[e.value];for(let o of t){if(G(o))return S();r.push(o.value)}return E(r)},rb=e=>{if(Symbol.iterator in e){let r=[];for(let o of e){if(G(o))return S();r.push(o.value)}return E(r)}let t={};for(let r of Object.keys(e)){let o=e[r];if(G(o))return S();t[r]=o.value}return E(t)},Xf=l(3,(e,t,r)=>Le(tb(e,t),([o,n])=>r(o,n))),mI=l(2,(e,t)=>Xf(e,t,(r,o)=>r(o))),hI=l(3,(e,t,r)=>{let o=t;for(let n of e)U(n)&&(o=r(o,n.value));return o}),ob=e=>G(e)?[]:[e.value],dI=l(2,(e,t)=>{if(G(e))return[S(),S()];let r=t(e.value);return fi(r)?[E(r.left),S()]:[S(),E(r.right)]}),nb=l(2,(e,t)=>G(e)?S():t(e.value)),xI=l(2,(e,t)=>nb(e,r=>t(r)?Vo(r):$o)),gI=e=>ti((t,r)=>G(t)?G(r):G(r)?!1:e(t.value,r.value)),yI=e=>yu((t,r)=>U(t)?U(r)?e(t.value,r.value):1:-1),bI=e=>l(2,(t,r)=>Xf(t,r,e)),SI=l(2,(e,t)=>t(e)?E(e):S()),sb=e=>l(2,(t,r)=>G(t)?!1:e(t.value,r)),_I=gc(),em=sb(_I),EI=l(2,(e,t)=>G(e)?!1:t(e.value)),OI=Xa(Le),CI=Za(Le);var vI=eu(Le,xr),kI=E({}),wI=Ay(),RI=(...e)=>{let t;e.length===1?t=e[0]:t=e[1].bind(e[0]);let r=t(wI),o=r.next();if(o.done)return E(o.value);{let n=o.value;if(Hf(n)?n=n.value:n=ri(n),G(n))return n;for(;!o.done;)if(o=r.next(n.value),!o.done&&(n=o.value,Hf(n)?n=n.value:n=ri(n),G(n)))return n;return E(o.value)}};u();var ib=(...e)=>e;var _c=e=>new Array(e),tm=(e,t)=>{let r=Math.max(1,Math.floor(e)),o=new Array(r);for(let n=0;n<r;n++)o[n]=t(n);return o};var te=e=>Array.isArray(e)?e:Array.from(e),ab=e=>Array.isArray(e)?e:[e];var mi=l(2,(e,t)=>[t,...e]);var ub=l(2,(e,t)=>[...e,t]),rm=l(2,(e,t)=>te(e).concat(te(t)));var MI=Array.isArray,FI=e=>e.length===0,lb=FI,pb=Yf,dt=Yf;var fb=(e,t)=>e<0||e>=t.length,TI=(e,t)=>Math.floor(Math.min(Math.max(0,e),t.length)),AI=l(2,(e,t)=>{let r=Math.floor(t);return fb(r,e)?S():E(e[r])}),om=l(2,(e,t)=>{let r=Math.floor(t);if(fb(r,e))throw new Error(`Index ${r} out of bounds`);return e[r]});var Jo=AI(0),xt=om(0),Su=e=>dt(e)?E(nm(e)):S(),nm=e=>e[e.length-1];var Tr=e=>e.slice(1);var II=(e,t)=>{let r=0;for(let o of e){if(!t(o,r))break;r++}return r},mb=l(2,(e,t)=>PI(e,II(e,t))),hb=l(2,(e,t)=>{let r=te(e);return r.slice(TI(t,r),r.length)});var sm=e=>Array.from(e).reverse(),jn=l(2,(e,t)=>{let r=Array.from(e);return r.sort(t),r});var im=l(2,(e,t)=>db(e,t,ib)),db=l(3,(e,t,r)=>{let o=te(e),n=te(t);if(dt(o)&&dt(n)){let s=[r(xt(o),xt(n))],i=Math.min(o.length,n.length);for(let c=1;c<i;c++)s[c]=r(o[c],n[c]);return s}return[]});var NI=gc();var PI=l(2,(e,t)=>{let r=Array.from(e),o=Math.floor(t);return dt(r)?o>=1?LI(r,o):[[],r]:[r,[]]}),LI=l(2,(e,t)=>{let r=Math.max(1,Math.floor(t));return r>=e.length?[DI(e),[]]:[mi(e.slice(1,r),xt(e)),e.slice(r)]});var DI=e=>e.slice();var qI=l(3,(e,t,r)=>{let o=te(e),n=te(t);return dt(o)?dt(n)?yb(r)(rm(o,n)):o:n}),gr=l(2,(e,t)=>qI(e,t,NI));var yr=()=>[],St=e=>[e],Ar=l(2,(e,t)=>e.map(t)),xb=l(2,(e,t)=>{if(lb(e))return[];let r=[];for(let o=0;o<e.length;o++){let n=t(e[o],o);for(let s=0;s<n.length;s++)r.push(n[s])}return r}),_u=xb(W),hi=l(2,(e,t)=>{let r=te(e),o=[];for(let n=0;n<r.length;n++){let s=t(r[n],n);U(s)&&o.push(s.value)}return o});var cm=l(2,(e,t)=>{let r=[],o=[],n=te(e);for(let s=0;s<n.length;s++){let i=t(n[s],s);hr(i)?r.push(i.left):o.push(i.right)}return[r,o]}),gb=hi(W);var tr=l(3,(e,t,r)=>te(e).reduce((o,n,s)=>r(o,n,s),t)),Eu=l(3,(e,t,r)=>te(e).reduceRight((o,n,s)=>r(o,n,s),t));var am=(e,t)=>{let r=[],o=e,n;for(;U(n=t(o));){let[s,i]=n.value;r.push(s),o=i}return r};var di=Ry;var yb=l(2,(e,t)=>{let r=te(e);if(dt(r)){let o=[xt(r)],n=Tr(r);for(let s of n)o.every(i=>!t(s,i))&&o.push(s);return o}return[]}),um=e=>yb(e,gc());var io=l(2,(e,t)=>te(e).join(t));u();var Yo=Jy;u();var bb=e=>e.replace(/[/\\^$*+?.()|[\]{}]/g,"\\$&");u();var _b=e=>!e;u();u();u();var lm=Symbol.for("effect/Context/Tag"),BI="effect/STM",jI=Symbol.for(BI),Cu={...no,_op:"Tag",[jI]:Go,[lm]:{_Service:e=>e,_Identifier:e=>e},toString(){return re(this.toJSON())},toJSON(){return{_id:"Tag",key:this.key,stack:this.stack}},[z](){return this.toJSON()},of(e){return e},context(e){return mm(this,e)}},Ob=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=2;let r=new Error;Error.stackTraceLimit=t;let o=Object.create(Cu);return Object.defineProperty(o,"stack",{get(){return r.stack}}),o.key=e,o};var pm=Symbol.for("effect/Context"),zI={[pm]:{_Services:e=>e},[M](e){if(fm(e)&&this.unsafeMap.size===e.unsafeMap.size){for(let t of this.unsafeMap.keys())if(!e.unsafeMap.has(t)||!C(this.unsafeMap.get(t),e.unsafeMap.get(t)))return!1;return!0}return!1},[F](){return V(this,su(this.unsafeMap.size))},pipe(){return v(this,arguments)},toString(){return re(this.toJSON())},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(Y)}},[z](){return this.toJSON()}},Qo=e=>{let t=Object.create(zI);return t.unsafeMap=e,t},GI=e=>{let t=new Error(`Service not found${e.key?`: ${String(e.key)}`:""}`);if(e.stack){let r=e.stack.split(`
`);if(r.length>2){let o=r[2].match(/at (.*)/);o&&(t.message=t.message+` (defined at ${o[1]})`)}}if(t.stack){let r=t.stack.split(`
`);r.splice(1,3),t.stack=r.join(`
`)}return t},fm=e=>k(e,pm),Cb=e=>k(e,lm),$I=Qo(new Map),vb=()=>$I,mm=(e,t)=>Qo(new Map([[e.key,t]])),kb=l(3,(e,t,r)=>{let o=new Map(e.unsafeMap);return o.set(t.key,r),Qo(o)}),hm=l(2,(e,t)=>{if(!e.unsafeMap.has(t.key))throw GI(t);return e.unsafeMap.get(t.key)}),wb=hm;var Rb=l(2,(e,t)=>e.unsafeMap.has(t.key)?Vo(e.unsafeMap.get(t.key)):$o),Mb=l(2,(e,t)=>{let r=new Map(e.unsafeMap);for(let[o,n]of t.unsafeMap)r.set(o,n);return Qo(r)});var _t=Ob;var Fb=fm,Ec=Cb,Et=vb,zn=mm,Oe=kb,Bt=wb;var Gn=hm,br=Rb,co=Mb;u();u();u();var Tb=Symbol.for("effect/Chunk");function KI(e,t,r,o,n){for(let s=t;s<Math.min(e.length,t+n);s++)r[o+s-t]=e[s];return r}var Ab=[],JI=e=>ti((t,r)=>t.length===r.length&&rr(t).every((o,n)=>e(o,$n(r,n)))),YI=JI(C),QI={[Tb]:{_A:e=>e},toString(){return re(this.toJSON())},toJSON(){return{_id:"Chunk",values:rr(this).map(Y)}},[z](){return this.toJSON()},[M](e){return Ib(e)&&YI(this,e)},[F](){return V(this,Pt(rr(this)))},[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return Ab[Symbol.iterator]();default:return rr(this)[Symbol.iterator]()}},pipe(){return v(this,arguments)}},Ve=e=>{let t=Object.create(QI);switch(t.backing=e,e._tag){case"IEmpty":{t.length=0,t.depth=0,t.left=t,t.right=t;break}case"IConcat":{t.length=e.left.length+e.right.length,t.depth=1+Math.max(e.left.depth,e.right.depth),t.left=e.left,t.right=e.right;break}case"IArray":{t.length=e.array.length,t.depth=0,t.left=Ir,t.right=Ir;break}case"ISingleton":{t.length=1,t.depth=0,t.left=Ir,t.right=Ir;break}case"ISlice":{t.length=e.length,t.depth=e.chunk.depth+1,t.left=Ir,t.right=Ir;break}}return t},Ib=e=>k(e,Tb),Ir=Ve({_tag:"IEmpty"}),Lt=()=>Ir,Oc=(...e)=>e.length===1?Re(e[0]):tN(e),Re=e=>Ve({_tag:"ISingleton",a:e}),Pr=e=>Ib(e)?e:Ve({_tag:"IArray",array:te(e)}),dm=(e,t,r)=>{switch(e.backing._tag){case"IArray":{KI(e.backing.array,0,t,r,e.length);break}case"IConcat":{dm(e.left,t,r),dm(e.right,t,r+e.left.length);break}case"ISingleton":{t[r]=e.backing.a;break}case"ISlice":{let o=0,n=r;for(;o<e.length;)t[n]=$n(e,o),o+=1,n+=1;break}}};var ZI=e=>{switch(e.backing._tag){case"IEmpty":return Ab;case"IArray":return e.backing.array;default:{let t=new Array(e.length);return dm(e,t,0),e.backing={_tag:"IArray",array:t},e.left=Ir,e.right=Ir,e.depth=0,t}}},rr=ZI,XI=e=>{switch(e.backing._tag){case"IEmpty":case"ISingleton":return e;case"IArray":return Ve({_tag:"IArray",array:sm(e.backing.array)});case"IConcat":return Ve({_tag:"IConcat",left:Nr(e.backing.right),right:Nr(e.backing.left)});case"ISlice":return xi(sm(rr(e)))}},Nr=XI,eN=l(2,(e,t)=>t<0||t>=e.length?S():E($n(e,t))),xi=e=>Ve({_tag:"IArray",array:e}),tN=e=>xi(e),$n=l(2,(e,t)=>{switch(e.backing._tag){case"IEmpty":throw new Error("Index out of bounds");case"ISingleton":{if(t!==0)throw new Error("Index out of bounds");return e.backing.a}case"IArray":{if(t>=e.length||t<0)throw new Error("Index out of bounds");return e.backing.array[t]}case"IConcat":return t<e.left.length?$n(e.left,t):$n(e.right,t-e.left.length);case"ISlice":return $n(e.backing.chunk,t+e.backing.offset)}}),vu=l(2,(e,t)=>jt(e,Re(t))),Ke=l(2,(e,t)=>jt(Re(t),e));var xm=l(2,(e,t)=>{if(t<=0)return e;if(t>=e.length)return Ir;switch(e.backing._tag){case"ISlice":return Ve({_tag:"ISlice",chunk:e.backing.chunk,offset:e.backing.offset+t,length:e.backing.length-t});case"IConcat":return t>e.left.length?xm(e.right,t-e.left.length):Ve({_tag:"IConcat",left:xm(e.left,t),right:e.right});default:return Ve({_tag:"ISlice",chunk:e,offset:t,length:e.length-t})}});var jt=l(2,(e,t)=>{if(e.backing._tag==="IEmpty")return t;if(t.backing._tag==="IEmpty")return e;let r=t.depth-e.depth;if(Math.abs(r)<=1)return Ve({_tag:"IConcat",left:e,right:t});if(r<-1)if(e.left.depth>=e.right.depth){let o=jt(e.right,t);return Ve({_tag:"IConcat",left:e.left,right:o})}else{let o=jt(e.right.right,t);if(o.depth===e.depth-3){let n=Ve({_tag:"IConcat",left:e.right.left,right:o});return Ve({_tag:"IConcat",left:e.left,right:n})}else{let n=Ve({_tag:"IConcat",left:e.left,right:e.right.left});return Ve({_tag:"IConcat",left:n,right:o})}}else if(t.right.depth>=t.left.depth){let o=jt(e,t.left);return Ve({_tag:"IConcat",left:o,right:t.right})}else{let o=jt(e,t.left.left);if(o.depth===t.depth-3){let n=Ve({_tag:"IConcat",left:o,right:t.left.right});return Ve({_tag:"IConcat",left:n,right:t.right})}else{let n=Ve({_tag:"IConcat",left:t.left.right,right:t.right});return Ve({_tag:"IConcat",left:o,right:n})}}});var gm=e=>e.length===0,Ze=e=>e.length>0,ku=eN(0),ym=e=>$n(e,0),Je=ym;var ot=e=>xm(e,1);u();var bm=Symbol.for("effect/Duration"),rN=BigInt(0),Nb=BigInt(24),wu=BigInt(60),Sm=BigInt(1e3),Pb=BigInt(1e6),_m=BigInt(1e9),Lb=/^(-?\d+(?:\.\d+)?)\s+(nanos?|micros?|millis?|seconds?|minutes?|hours?|days?|weeks?)$/,Xe=e=>{if(qb(e))return e;if(dc(e))return gi(e);if(Fy(e))return Cc(e);if(Array.isArray(e)){if(e.length===2&&dc(e[0])&&dc(e[1]))return Cc(BigInt(e[0])*_m+BigInt(e[1]))}else if(tu(e)){Lb.lastIndex=0;let t=Lb.exec(e);if(t){let[r,o,n]=t,s=Number(o);switch(n){case"nano":case"nanos":return Cc(BigInt(o));case"micro":case"micros":return sN(BigInt(o));case"milli":case"millis":return gi(s);case"second":case"seconds":return Om(s);case"minute":case"minutes":return iN(s);case"hour":case"hours":return cN(s);case"day":case"days":return aN(s);case"week":case"weeks":return uN(s)}}}throw new Error("Invalid DurationInput")};var Db={_tag:"Millis",millis:0},oN={_tag:"Infinity"},nN={[bm]:bm,[F](){return V(this,iu(this.value))},[M](e){return qb(e)&&hN(this,e)},toString(){return`Duration(${vm(this)})`},toJSON(){switch(this.value._tag){case"Millis":return{_id:"Duration",_tag:"Millis",millis:this.value.millis};case"Nanos":return{_id:"Duration",_tag:"Nanos",hrtime:pN(this)};case"Infinity":return{_id:"Duration",_tag:"Infinity"}}},[z](){return this.toJSON()},pipe(){return v(this,arguments)}},ao=e=>{let t=Object.create(nN);return dc(e)?isNaN(e)||e<=0?t.value=Db:Number.isFinite(e)?Number.isInteger(e)?t.value={_tag:"Millis",millis:e}:t.value={_tag:"Nanos",nanos:BigInt(Math.round(e*1e6))}:t.value=oN:e<=rN?t.value=Db:t.value={_tag:"Nanos",nanos:e},t},qb=e=>k(e,bm);var Em=ao(0);var Cc=e=>ao(e),sN=e=>ao(e*Sm),gi=e=>ao(e),Om=e=>ao(e*1e3),iN=e=>ao(e*6e4),cN=e=>ao(e*36e5),aN=e=>ao(e*864e5),uN=e=>ao(e*6048e5),Lr=e=>fN(e,{onMillis:t=>t,onNanos:t=>Number(t)/1e6});var lN=e=>{let t=Xe(e);switch(t.value._tag){case"Infinity":throw new Error("Cannot convert infinite duration to nanos");case"Nanos":return t.value.nanos;case"Millis":return BigInt(Math.round(t.value.millis*1e6))}},pN=e=>{let t=Xe(e);switch(t.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(t.value.nanos/_m),Number(t.value.nanos%_m)];case"Millis":return[Math.floor(t.value.millis/1e3),Math.round(t.value.millis%1e3*1e6)]}},fN=l(2,(e,t)=>{let r=Xe(e);switch(r.value._tag){case"Nanos":return t.onNanos(r.value.nanos);case"Infinity":return t.onMillis(1/0);case"Millis":return t.onMillis(r.value.millis)}}),Hb=l(3,(e,t,r)=>{let o=Xe(e),n=Xe(t);if(o.value._tag==="Infinity"||n.value._tag==="Infinity")return r.onMillis(Lr(o),Lr(n));if(o.value._tag==="Nanos"||n.value._tag==="Nanos"){let s=o.value._tag==="Nanos"?o.value.nanos:BigInt(Math.round(o.value.millis*1e6)),i=n.value._tag==="Nanos"?n.value.nanos:BigInt(Math.round(n.value.millis*1e6));return r.onNanos(s,i)}return r.onMillis(o.value.millis,n.value.millis)});var mN=(e,t)=>Hb(e,t,{onMillis:(r,o)=>r===o,onNanos:(r,o)=>r===o});var Cm=l(2,(e,t)=>Hb(e,t,{onMillis:(r,o)=>r>=o,onNanos:(r,o)=>r>=o})),hN=l(2,(e,t)=>mN(Xe(e),Xe(t))),dN=e=>{let t=Xe(e);if(t.value._tag==="Infinity")return{days:1/0,hours:1/0,minutes:1/0,seconds:1/0,millis:1/0,nanos:1/0};let r=lN(t),o=r/Pb,n=o/Sm,s=n/wu,i=s/wu,c=i/Nb;return{days:Number(c),hours:Number(i%Nb),minutes:Number(s%wu),seconds:Number(n%wu),millis:Number(o%Sm),nanos:Number(r%Pb)}},vm=e=>{let t=Xe(e);if(t.value._tag==="Infinity")return"Infinity";let r=dN(t),o=[];return r.days!==0&&o.push(`${r.days}d`),r.hours!==0&&o.push(`${r.hours}h`),r.minutes!==0&&o.push(`${r.minutes}m`),r.seconds!==0&&o.push(`${r.seconds}s`),r.millis!==0&&o.push(`${r.millis}ms`),r.nanos!==0&&o.push(`${r.nanos}ns`),o.join(" ")};u();u();u();u();u();u();u();var km=Math.pow(2,5),Wb=km-1,Ub=km/2,Bb=km/4;function xN(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function Zo(e,t){return t>>>e&Wb}function Xo(e){return 1<<e}function Ru(e,t){return xN(e&t-1)}u();u();var jb=(e,t)=>({value:e,previous:t});u();function Vn(e,t,r,o){let n=o;if(!e){let s=o.length;n=new Array(s);for(let i=0;i<s;++i)n[i]=o[i]}return n[t]=r,n}function wm(e,t,r){let o=r.length-1,n=0,s=0,i=r;if(e)n=s=t;else for(i=new Array(o);n<t;)i[s++]=r[n++];for(++n;n<=o;)i[s++]=r[n++];return e&&(i.length=o),i}function zb(e,t,r,o){let n=o.length;if(e){let a=n;for(;a>=t;)o[a--]=o[a];return o[t]=r,o}let s=0,i=0,c=new Array(n+1);for(;s<t;)c[i++]=o[s++];for(c[t]=r;s<n;)c[++i]=o[s++];return c}var lo=class e{_tag="EmptyNode";modify(t,r,o,n,s,i){let c=o(S());return G(c)?new e:(++i.value,new yi(t,n,s,c))}};function or(e){return Dn(e,"EmptyNode")}function yN(e){return or(e)||e._tag==="LeafNode"||e._tag==="CollisionNode"}function Mu(e,t){return or(e)?!1:t===e.edit}var yi=class e{edit;hash;key;value;_tag="LeafNode";constructor(t,r,o,n){this.edit=t,this.hash=r,this.key=o,this.value=n}modify(t,r,o,n,s,i){if(C(s,this.key)){let a=o(this.value);return a===this.value?this:G(a)?(--i.value,new lo):Mu(this,t)?(this.value=a,this):new e(t,n,s,a)}let c=o(S());return G(c)?this:(++i.value,Gb(t,r,this.hash,this,n,new e(t,n,s,c)))}},Rm=class e{edit;hash;children;_tag="CollisionNode";constructor(t,r,o){this.edit=t,this.hash=r,this.children=o}modify(t,r,o,n,s,i){if(n===this.hash){let a=Mu(this,t),p=this.updateCollisionList(a,t,this.hash,this.children,o,s,i);return p===this.children?this:p.length>1?new e(t,this.hash,p):p[0]}let c=o(S());return G(c)?this:(++i.value,Gb(t,r,this.hash,this,n,new yi(t,n,s,c)))}updateCollisionList(t,r,o,n,s,i,c){let a=n.length;for(let f=0;f<a;++f){let h=n[f];if("key"in h&&C(i,h.key)){let d=h.value,g=s(d);return g===d?n:G(g)?(--c.value,wm(t,f,n)):Vn(t,f,new yi(r,o,i,g),n)}}let p=s(S());return G(p)?n:(++c.value,Vn(t,a,new yi(r,o,i,p),n))}},vc=class e{edit;mask;children;_tag="IndexedNode";constructor(t,r,o){this.edit=t,this.mask=r,this.children=o}modify(t,r,o,n,s,i){let c=this.mask,a=this.children,p=Zo(r,n),f=Xo(p),h=Ru(c,f),d=c&f,g=Mu(this,t);if(!d){let K=new lo().modify(t,r+5,o,n,s,i);return K?a.length>=Ub?SN(t,p,K,c,a):new e(t,c|f,zb(g,h,K,a)):this}let b=a[h],R=b.modify(t,r+5,o,n,s,i);if(b===R)return this;let I=c,P;if(or(R)){if(I&=~f,!I)return new lo;if(a.length<=2&&yN(a[h^1]))return a[h^1];P=wm(g,h,a)}else P=Vn(g,h,R,a);return g?(this.mask=I,this.children=P,this):new e(t,I,P)}},Mm=class e{edit;size;children;_tag="ArrayNode";constructor(t,r,o){this.edit=t,this.size=r,this.children=o}modify(t,r,o,n,s,i){let c=this.size,a=this.children,p=Zo(r,n),f=a[p],h=(f||new lo).modify(t,r+5,o,n,s,i);if(f===h)return this;let d=Mu(this,t),g;if(or(f)&&!or(h))++c,g=Vn(d,p,h,a);else if(!or(f)&&or(h)){if(--c,c<=Bb)return bN(t,c,p,a);g=Vn(d,p,new lo,a)}else g=Vn(d,p,h,a);return d?(this.size=c,this.children=g,this):new e(t,c,g)}};function bN(e,t,r,o){let n=new Array(t-1),s=0,i=0;for(let c=0,a=o.length;c<a;++c)if(c!==r){let p=o[c];p&&!or(p)&&(n[s++]=p,i|=1<<c)}return new vc(e,i,n)}function SN(e,t,r,o,n){let s=[],i=o,c=0;for(let a=0;i;++a)i&1&&(s[a]=n[c++]),i>>>=1;return s[t]=r,new Mm(e,c+1,s)}function _N(e,t,r,o,n,s){if(r===n)return new Rm(e,r,[s,o]);let i=Zo(t,r),c=Zo(t,n);if(i===c)return a=>new vc(e,Xo(i)|Xo(c),[a]);{let a=i<c?[o,s]:[s,o];return new vc(e,Xo(i)|Xo(c),a)}}function Gb(e,t,r,o,n,s){let i,c=t;for(;;){let a=_N(e,c,r,o,n,s);if(typeof a=="function")i=jb(a,i),c=c+5;else{let p=a;for(;i!=null;)p=i.value(p),i=i.previous;return p}}}var $b="effect/HashMap",Fu=Symbol.for($b),ON={[Fu]:Fu,[Symbol.iterator](){return new Tu(this,(e,t)=>[e,t])},[F](){let e=w($b);for(let t of this)e^=m(w(t[0]),L(w(t[1])));return V(this,e)},[M](e){if(Yb(e)){if(e._size!==this._size)return!1;for(let t of this){let r=m(e,Iu(t[0],w(t[0])));if(G(r))return!1;if(!C(t[1],r.value))return!1}return!0}return!1},toString(){return re(this.toJSON())},toJSON(){return{_id:"HashMap",values:Array.from(this).map(Y)}},[z](){return this.toJSON()},pipe(){return v(this,arguments)}},Fm=(e,t,r,o)=>{let n=Object.create(ON);return n._editable=e,n._edit=t,n._root=r,n._size=o,n},Tu=class e{map;f;v;constructor(t,r){this.map=t,this.f=r,this.v=Vb(this.map._root,this.f,void 0)}next(){if(G(this.v))return{done:!0,value:void 0};let t=this.v.value;return this.v=Au(t.cont),{done:!1,value:t.value}}[Symbol.iterator](){return new e(this.map,this.f)}},Au=e=>e?Kb(e[0],e[1],e[2],e[3],e[4]):S(),Vb=(e,t,r=void 0)=>{switch(e._tag){case"LeafNode":return U(e.value)?E({value:t(e.key,e.value.value),cont:r}):Au(r);case"CollisionNode":case"ArrayNode":case"IndexedNode":{let o=e.children;return Kb(o.length,o,0,t,r)}default:return Au(r)}},Kb=(e,t,r,o,n)=>{for(;r<e;){let s=t[r++];if(s&&!or(s))return Vb(s,o,[e,t,r,o,n])}return Au(n)},CN=Fm(!1,0,new lo,0),Si=()=>CN;var Jb=e=>{let t=kc(Si());for(let r of e)Kn(t,r[0],r[1]);return Am(t)},Yb=e=>k(e,Fu),Qb=e=>e&&or(e._root),Zb=l(2,(e,t)=>Iu(e,t,w(t))),Iu=l(3,(e,t,r)=>{let o=e._root,n=0;for(;;)switch(o._tag){case"LeafNode":return C(t,o.key)?o.value:S();case"CollisionNode":{if(r===o.hash){let s=o.children;for(let i=0,c=s.length;i<c;++i){let a=s[i];if("key"in a&&C(t,a.key))return a.value}}return S()}case"IndexedNode":{let s=Zo(n,r),i=Xo(s);if(o.mask&i){o=o.children[Ru(o.mask,i)],n+=5;break}return S()}case"ArrayNode":{if(o=o.children[Zo(n,r)],o){n+=5;break}return S()}default:return S()}});var Tm=l(2,(e,t)=>U(Iu(e,t,w(t))));var Kn=l(3,(e,t,r)=>Pu(e,t,()=>E(r))),vN=l(3,(e,t,r)=>e._editable?(e._root=t,e._size=r,e):t===e._root?e:Fm(e._editable,e._edit,t,r)),Nu=e=>new Tu(e,t=>t);var _i=e=>e._size,kc=e=>Fm(!0,e._edit+1,e._root,e._size),Am=e=>(e._editable=!1,e),Xb=l(2,(e,t)=>{let r=kc(e);return t(r),Am(r)}),Pu=l(3,(e,t,r)=>eS(e,t,w(t),r)),eS=l(4,(e,t,r,o)=>{let n={value:e._size},s=e._root.modify(e._editable?e._edit:NaN,0,o,r,t,n);return m(e,vN(s,n.value))});var Lu=l(2,(e,t)=>Pu(e,t,S));var tS=l(2,(e,t)=>Ei(e,Si(),(r,o,n)=>Kn(r,n,t(o,n))));var Du=l(2,(e,t)=>Ei(e,void 0,(r,o,n)=>t(o,n))),Ei=l(3,(e,t,r)=>{let o=e._root;if(o._tag==="LeafNode")return U(o.value)?r(t,o.value.value,o.key):t;if(o._tag==="EmptyNode")return t;let n=[o.children],s;for(;s=n.pop();)for(let i=0,c=s.length;i<c;){let a=s[i++];a&&!or(a)&&(a._tag==="LeafNode"?U(a.value)&&(t=r(t,a.value.value,a.key)):n.push(a.children))}return t});var oS="effect/HashSet",qu=Symbol.for(oS),kN={[qu]:qu,[Symbol.iterator](){return Nu(this._keyMap)},[F](){return V(this,L(w(this._keyMap))(w(oS)))},[M](e){return nS(e)?_i(this._keyMap)===_i(e._keyMap)&&C(this._keyMap,e._keyMap):!1},toString(){return re(this.toJSON())},toJSON(){return{_id:"HashSet",values:Array.from(this).map(Y)}},[z](){return this.toJSON()},pipe(){return v(this,arguments)}},Hu=e=>{let t=Object.create(kN);return t._keyMap=e,t},nS=e=>k(e,qu),wN=Hu(Si()),wc=()=>wN,sS=e=>{let t=Wu(wc());for(let r of e)Oi(t,r);return Uu(t)},iS=(...e)=>{let t=Wu(wc());for(let r of e)Oi(t,r);return Uu(t)},cS=l(2,(e,t)=>Tm(e._keyMap,t));var aS=e=>_i(e._keyMap),Wu=e=>Hu(kc(e._keyMap)),Uu=e=>(e._keyMap._editable=!1,e),Im=l(2,(e,t)=>{let r=Wu(e);return t(r),Uu(r)}),Oi=l(2,(e,t)=>e._keyMap._editable?(Kn(t,!0)(e._keyMap),e):Hu(Kn(t,!0)(e._keyMap))),Nm=l(2,(e,t)=>e._keyMap._editable?(Lu(t)(e._keyMap),e):Hu(Lu(t)(e._keyMap))),uS=l(2,(e,t)=>Im(e,r=>{for(let o of t)Nm(r,o)}));var lS=l(2,(e,t)=>Im(wc(),r=>{pS(e,o=>Oi(r,o));for(let o of t)Oi(r,o)}));var pS=l(2,(e,t)=>Du(e._keyMap,(r,o)=>t(o))),fS=l(3,(e,t,r)=>Ei(e._keyMap,t,(o,n,s)=>r(o,s)));var Dr=wc,Bu=sS,Jn=iS,mS=cS;var Yn=aS;var Qn=Oi,Pm=Nm,Lm=uS;var po=lS;var Zn=fS;u();var hS=Symbol.for("effect/MutableRef"),MN={[hS]:hS,toString(){return re(this.toJSON())},toJSON(){return{_id:"MutableRef",current:Y(this.current)}},[z](){return this.toJSON()},pipe(){return v(this,arguments)}},qr=e=>{let t=Object.create(MN);return t.current=e,t},ju=l(3,(e,t,r)=>C(t,e.current)?(e.current=r,!0):!1);var Dt=e=>e.current;var nr=l(2,(e,t)=>(e.current=t,e));var Gu="effect/FiberId",en=Symbol.for(Gu),Ci="None",Dm="Runtime",qm="Composite",FN=ae(`${Gu}-${Ci}`),Hm=class{[en]=en;_tag=Ci;id=-1;startTimeMillis=-1;[F](){return FN}[M](t){return Vu(t)&&t._tag===Ci}toString(){return re(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag}}[z](){return this.toJSON()}},Wm=class{id;startTimeMillis;[en]=en;_tag=Dm;constructor(t,r){this.id=t,this.startTimeMillis=r}[F](){return V(this,ae(`${Gu}-${this._tag}-${this.id}-${this.startTimeMillis}`))}[M](t){return Vu(t)&&t._tag===Dm&&this.id===t.id&&this.startTimeMillis===t.startTimeMillis}toString(){return re(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,id:this.id,startTimeMillis:this.startTimeMillis}}[z](){return this.toJSON()}},Um=class{left;right;[en]=en;_tag=qm;constructor(t,r){this.left=t,this.right=r}_hash;[F](){return m(ae(`${Gu}-${this._tag}`),L(w(this.left)),L(w(this.right)),V(this))}[M](t){return Vu(t)&&t._tag===qm&&C(this.left,t.left)&&C(this.right,t.right)}toString(){return re(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,left:Y(this.left),right:Y(this.right)}}[z](){return this.toJSON()}},$u=new Hm;var Vu=e=>k(e,en);var xS=l(2,(e,t)=>e._tag===Ci?t:t._tag===Ci?e:new Um(e,t));var zu=e=>{switch(e._tag){case Ci:return Dr();case Dm:return Jn(e.id);case qm:return m(zu(e.left),po(zu(e.right)))}},dS=H(Symbol.for("effect/Fiber/Id/_fiberCounter"),()=>qr(0));var Ku=e=>Array.from(zu(e)).map(r=>`#${r}`).join(",");var gS=()=>{let e=Dt(dS);return m(dS,nr(e+1)),new Wm(e,Date.now())};var Gt=$u;var Bm=xS;var bS=Ku;var Ju=gS;u();var es=Si;var SS=Jb,_S=Qb,jm=Zb;var Sr=Kn,zm=Nu;var ES=_i;var OS=Xb,CS=Pu;var vS=tS;var kS=Du,Gm=Ei;u();var Rc=Symbol.for("effect/List"),$m=e=>te(e),AN=e=>wy(di(e),$m),IN=AN(C),NN={[Rc]:Rc,_tag:"Cons",toString(){return re(this.toJSON())},toJSON(){return{_id:"List",_tag:"Cons",values:$m(this).map(Y)}},[z](){return this.toJSON()},[M](e){return RS(e)&&this._tag===e._tag&&IN(this,e)},[F](){return V(this,Pt($m(this)))},[Symbol.iterator](){let e=!1,t=this;return{next(){if(e)return this.return();if(t._tag==="Nil")return e=!0,this.return();let r=t.head;return t=t.tail,{done:e,value:r}},return(r){return e||(e=!0),{done:!0,value:r}}}},pipe(){return v(this,arguments)}},Yu=(e,t)=>{let r=Object.create(NN);return r.head=e,r.tail=t,r},PN=ae("Nil"),LN={[Rc]:Rc,_tag:"Nil",toString(){return re(this.toJSON())},toJSON(){return{_id:"List",_tag:"Nil"}},[z](){return this.toJSON()},[F](){return PN},[M](e){return RS(e)&&this._tag===e._tag},[Symbol.iterator](){return{next(){return{done:!0,value:void 0}}}},pipe(){return v(this,arguments)}},wS=Object.create(LN),RS=e=>k(e,Rc),Hr=e=>e._tag==="Nil",Mc=e=>e._tag==="Cons";var DN=()=>wS,mo=(e,t)=>Yu(e,t),Wr=DN,Fc=e=>Yu(e,wS);var MS=l(2,(e,t)=>qN(t,e)),Qu=l(2,(e,t)=>mo(t,e)),qN=l(2,(e,t)=>{if(Hr(e))return t;if(Hr(t))return e;{let r=Yu(t.head,e),o=r,n=t.tail;for(;!Hr(n);){let s=Yu(n.head,e);o.tail=s,o=s,n=n.tail}return r}});var FS=l(3,(e,t,r)=>{let o=t,n=e;for(;!Hr(n);)o=r(o,n.head),n=n.tail;return o});var TS=e=>{let t=Wr(),r=e;for(;!Hr(r);)t=Qu(t,r.head),r=r.tail;return t};u();u();u();u();var tJ=Object.assign(Object.create(Array.prototype),{[F](){return V(this,Pt(this))},[M](e){return Array.isArray(e)&&this.length===e.length?this.every((t,r)=>C(t,e[r])):!1}}),wi=function(){function e(t){t&&Object.assign(this,t)}return e.prototype=pi,e}(),Zu=e=>Object.assign(Object.create(pi),e);u();var HN=Symbol.for("effect/DifferContextPatch");function IS(e){return e}var Ac={...wi.prototype,[HN]:{_Value:IS,_Patch:IS}},WN=Object.assign(Object.create(Ac),{_tag:"Empty"}),UN=Object.create(WN),Vm=()=>UN,BN=Object.assign(Object.create(Ac),{_tag:"AndThen"}),jN=(e,t)=>{let r=Object.create(BN);return r.first=e,r.second=t,r},zN=Object.assign(Object.create(Ac),{_tag:"AddService"}),GN=(e,t)=>{let r=Object.create(zN);return r.key=e,r.service=t,r},$N=Object.assign(Object.create(Ac),{_tag:"RemoveService"}),VN=e=>{let t=Object.create($N);return t.key=e,t},KN=Object.assign(Object.create(Ac),{_tag:"UpdateService"}),JN=(e,t)=>{let r=Object.create(KN);return r.key=e,r.update=t,r},NS=(e,t)=>{let r=new Map(e.unsafeMap),o=Vm();for(let[n,s]of t.unsafeMap.entries())if(r.has(n)){let i=r.get(n);r.delete(n),C(i,s)||(o=Tc(JN(n,()=>s))(o))}else r.delete(n),o=Tc(GN(n,s))(o);for(let[n]of r.entries())o=Tc(VN(n))(o);return o},Tc=l(2,(e,t)=>jN(e,t)),PS=l(2,(e,t)=>{if(e._tag==="Empty")return t;let r=!1,o=Re(e),n=new Map(t.unsafeMap);for(;Ze(o);){let i=Je(o),c=ot(o);switch(i._tag){case"Empty":{o=c;break}case"AddService":{n.set(i.key,i.service),o=c;break}case"AndThen":{o=Ke(Ke(c,i.second),i.first);break}case"RemoveService":{n.delete(i.key),o=c;break}case"UpdateService":{n.set(i.key,i.update(n.get(i.key))),r=!0,o=c;break}}}if(!r)return Qo(n);let s=new Map;for(let[i]of t.unsafeMap)n.has(i)&&(s.set(i,n.get(i)),n.delete(i));for(let[i,c]of n)s.set(i,c);return Qo(s)});u();var QN=Symbol.for("effect/DifferHashSetPatch");function Km(e){return e}var el={...wi.prototype,[QN]:{_Value:Km,_Key:Km,_Patch:Km}},ZN=Object.assign(Object.create(el),{_tag:"Empty"}),XN=Object.create(ZN),Jm=()=>XN,eP=Object.assign(Object.create(el),{_tag:"AndThen"}),tP=(e,t)=>{let r=Object.create(eP);return r.first=e,r.second=t,r},rP=Object.assign(Object.create(el),{_tag:"Add"}),oP=e=>{let t=Object.create(rP);return t.value=e,t},nP=Object.assign(Object.create(el),{_tag:"Remove"}),sP=e=>{let t=Object.create(nP);return t.value=e,t},LS=(e,t)=>{let[r,o]=Zn([e,Jm()],([n,s],i)=>mS(i)(n)?[Pm(i)(n),s]:[n,Xu(oP(i))(s)])(t);return Zn(o,(n,s)=>Xu(sP(s))(n))(r)},Xu=l(2,(e,t)=>tP(e,t)),DS=l(2,(e,t)=>{if(e._tag==="Empty")return t;let r=t,o=Re(e);for(;Ze(o);){let n=Je(o),s=ot(o);switch(n._tag){case"Empty":{o=s;break}case"AndThen":{o=Ke(n.first)(Ke(n.second)(s));break}case"Add":{r=Qn(n.value)(r),o=s;break}case"Remove":r=Pm(n.value)(r),o=s}}return r});u();var cP=Symbol.for("effect/DifferReadonlyArrayPatch");function qS(e){return e}var Nc={...wi.prototype,[cP]:{_Value:qS,_Patch:qS}},aP=Object.assign(Object.create(Nc),{_tag:"Empty"}),uP=Object.create(aP),Ym=()=>uP,lP=Object.assign(Object.create(Nc),{_tag:"AndThen"}),pP=(e,t)=>{let r=Object.create(lP);return r.first=e,r.second=t,r},fP=Object.assign(Object.create(Nc),{_tag:"Append"}),mP=e=>{let t=Object.create(fP);return t.values=e,t},hP=Object.assign(Object.create(Nc),{_tag:"Slice"}),dP=(e,t)=>{let r=Object.create(hP);return r.from=e,r.until=t,r},xP=Object.assign(Object.create(Nc),{_tag:"Update"}),gP=(e,t)=>{let r=Object.create(xP);return r.index=e,r.patch=t,r},HS=e=>{let t=0,r=Ym();for(;t<e.oldValue.length&&t<e.newValue.length;){let o=e.oldValue[t],n=e.newValue[t],s=e.differ.diff(o,n);C(s,e.differ.empty)||(r=Ic(r,gP(t,s))),t=t+1}return t<e.oldValue.length&&(r=Ic(r,dP(0,t))),t<e.newValue.length&&(r=Ic(r,mP(hb(t)(e.newValue)))),r},Ic=l(2,(e,t)=>pP(e,t)),WS=l(3,(e,t,r)=>{if(e._tag==="Empty")return t;let o=t.slice(),n=St(e);for(;pb(n);){let s=xt(n),i=Tr(n);switch(s._tag){case"Empty":{n=i;break}case"AndThen":{i.unshift(s.first,s.second),n=i;break}case"Append":{for(let c of s.values)o.push(c);n=i;break}case"Slice":{o=o.slice(s.from,s.until),n=i;break}case"Update":{o[s.index]=r.patch(s.patch,o[s.index]),n=i;break}}}return o});var US=Symbol.for("effect/Differ"),bP={[US]:{_P:W,_V:W}},tn=e=>{let t=Object.create(bP);return t.empty=e.empty,t.diff=e.diff,t.combine=e.combine,t.patch=e.patch,t},Qm=()=>tn({empty:Vm(),combine:(e,t)=>Tc(t)(e),diff:(e,t)=>NS(e,t),patch:(e,t)=>PS(t)(e)});var Zm=()=>tn({empty:Jm(),combine:(e,t)=>Xu(t)(e),diff:(e,t)=>LS(e,t),patch:(e,t)=>DS(t)(e)});var Xm=e=>tn({empty:Ym(),combine:(t,r)=>Ic(t,r),diff:(t,r)=>HS({oldValue:t,newValue:r,differ:e}),patch:(t,r)=>WS(t,r,e)});var tl=()=>BS((e,t)=>t),BS=e=>tn({empty:W,combine:(t,r)=>t===W?r:r===W?t:o=>r(t(o)),diff:(t,r)=>C(t,r)?W:ei(r),patch:(t,r)=>e(r,t(r))});u();var Pc=255,jS=8,rl=e=>e&Pc,ol=e=>e>>jS&Pc,rs=(e,t)=>(e&Pc)+((t&e&Pc)<<jS),nl=rs(0,0),zS=e=>rs(e,e),GS=e=>rs(e,0);var $S=l(2,(e,t)=>rs(rl(e)&~t,ol(e)));var th=l(2,(e,t)=>e|t);var VS=e=>~e>>>0&Pc;var SP=0,Ur=1,JS=2,rh=4,sl=16,oh=32;var YS=e=>il(e,oh);var nh=l(2,(e,t)=>e|t);var ho=e=>Lc(e)&&!_P(e),Lc=e=>il(e,Ur);var il=l(2,(e,t)=>(e&t)!==0),sh=(...e)=>e.reduce((t,r)=>t|r,0),QS=sh(SP);var ih=e=>il(e,rh);var _P=e=>il(e,sl);var sr=l(2,(e,t)=>rs(e^t,t)),xo=l(2,(e,t)=>e&(VS(rl(t))|ol(t))|rl(t)&ol(t));var ch=tn({empty:nl,diff:(e,t)=>sr(e,t),combine:(e,t)=>th(t)(e),patch:(e,t)=>xo(t,e)});var ZS=nl;var ah=zS,uh=GS;var lh=$S;u();var XS={_tag:"Empty"},hh=(e,t)=>({_tag:"Par",left:e,right:t}),cl=(e,t)=>({_tag:"Seq",left:e,right:t}),dh=(e,t)=>({_tag:"Single",dataSource:e,blockedRequest:t});var e_=e=>{let t=Fc(e),r=Wr();for(;;){let[o,n]=FS(t,[t_(),Wr()],([s,i],c)=>{let[a,p]=EP(c);return[MP(s,a),MS(i,p)]});if(r=OP(r,o),Hr(n))return TS(r);t=n}throw new Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/effect/issues")},EP=e=>{let t=e,r=t_(),o=Wr(),n=Wr();for(;;)switch(t._tag){case"Empty":{if(Hr(o))return[r,n];t=o.head,o=o.tail;break}case"Par":{o=mo(t.right,o),t=t.left;break}case"Seq":{let s=t.left,i=t.right;switch(s._tag){case"Empty":{t=i;break}case"Par":{let c=s.left,a=s.right;t=hh(cl(c,i),cl(a,i));break}case"Seq":{let c=s.left,a=s.right;t=cl(c,cl(a,i));break}case"Single":{t=s,n=mo(i,n);break}}break}case"Single":{if(r=RP(r,t),Hr(o))return[r,n];t=o.head,o=o.tail;break}}throw new Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/effect/issues")},OP=(e,t)=>{if(Hr(e))return Fc(fh(t));if(FP(t))return e;let r=LP(e.head),o=TP(t);return r.length===1&&o.length===1&&C(r[0],o[0])?mo(PP(e.head,fh(t)),e.tail):mo(fh(t),e)},CP=Symbol.for("effect/RequestBlock/Entry"),mh=class{request;result;listeners;ownerId;state;[CP]=vP;constructor(t,r,o,n,s){this.request=t,this.result=r,this.listeners=o,this.ownerId=n,this.state=s}},vP={_R:e=>e};var xh=e=>new mh(e.request,e.result,e.listeners,e.ownerId,e.state),kP=Symbol.for("effect/RequestBlock/RequestBlockParallel"),wP={_R:e=>e},qc=class{map;[kP]=wP;constructor(t){this.map=t}},t_=()=>new qc(es());var RP=(e,t)=>new qc(CS(e.map,t.dataSource,r=>Zf(Le(r,vu(t.blockedRequest)),()=>Re(t.blockedRequest)))),MP=(e,t)=>new qc(Gm(e.map,t.map,(r,o,n)=>Sr(r,n,Ge(jm(r,n),{onNone:()=>o,onSome:s=>jt(o,s)})))),FP=e=>_S(e.map),TP=e=>Array.from(zm(e.map)),fh=e=>NP(vS(e.map,t=>Re(t))),AP=Symbol.for("effect/RequestBlock/RequestBlockSequential"),IP={_R:e=>e},al=class{map;[AP]=IP;constructor(t){this.map=t}},NP=e=>new al(e),PP=(e,t)=>new al(Gm(t.map,e.map,(r,o,n)=>Sr(r,n,Ge(jm(r,n),{onNone:()=>Lt(),onSome:s=>jt(s,o)}))));var LP=e=>Array.from(zm(e.map)),r_=e=>Array.from(e.map);u();u();var os="Die",ns="Empty",ss="Fail",is="Interrupt",cs="Parallel",as="Sequential";var c_="effect/Cause",yh=Symbol.for(c_),qP={_E:e=>e},Ri={[yh]:qP,[F](){return m(w(c_),L(w(WP(this))),V(this))},[M](e){return ll(e)&&HP(this,e)},pipe(){return v(this,arguments)},toJSON(){switch(this._tag){case"Empty":return{_id:"Cause",_tag:this._tag};case"Die":return{_id:"Cause",_tag:this._tag,defect:Y(this.defect)};case"Interrupt":return{_id:"Cause",_tag:this._tag,fiberId:this.fiberId.toJSON()};case"Fail":return{_id:"Cause",_tag:this._tag,failure:Y(this.error)};case"Sequential":case"Parallel":return{_id:"Cause",_tag:this._tag,left:Y(this.left),right:Y(this.right)}}},toString(){return nn(this)},[z](){return this.toJSON()}},_r=(()=>{let e=Object.create(Ri);return e._tag=ns,e})(),rn=e=>{let t=Object.create(Ri);return t._tag=ss,t.error=e,t},lt=e=>{let t=Object.create(Ri);return t._tag=os,t.defect=e,t},$t=e=>{let t=Object.create(Ri);return t._tag=is,t.fiberId=e,t},Ct=(e,t)=>{let r=Object.create(Ri);return r._tag=cs,r.left=e,r.right=t,r},Ue=(e,t)=>{let r=Object.create(Ri);return r._tag=as,r.left=e,r.right=t,r},ll=e=>k(e,yh);var Mi=e=>e._tag===os;var pl=e=>e._tag===ns?!0:us(e,!0,(t,r)=>{switch(r._tag){case ns:return E(t);case os:case ss:case is:return E(!1);default:return S()}});var fl=e=>U(a_(e)),ls=e=>Uc(void 0,BP)(e),Hc=e=>Nr(us(e,Lt(),(t,r)=>r._tag===ss?E(m(t,Ke(r.error))):S())),ml=e=>Nr(us(e,Lt(),(t,r)=>r._tag===os?E(m(t,Ke(r.defect))):S())),Wc=e=>us(e,Dr(),(t,r)=>r._tag===is?E(m(t,Qn(r.fiberId))):S()),bh=e=>on(e,t=>t._tag===ss?E(t.error):S()),Br=e=>{let t=bh(e);switch(t._tag){case"None":return Pe(e);case"Some":return bt(t.value)}};var a_=e=>on(e,t=>t._tag===is?E(t.fiberId):S()),Sh=e=>Fi(e,{onEmpty:S(),onFail:()=>S(),onDie:t=>E(lt(t)),onInterrupt:()=>S(),onSequential:(t,r)=>U(t)&&U(r)?E(Ue(t.value,r.value)):U(t)&&G(r)?E(t.value):G(t)&&U(r)?E(r.value):S(),onParallel:(t,r)=>U(t)&&U(r)?E(Ct(t.value,r.value)):U(t)&&G(r)?E(t.value):G(t)&&U(r)?E(r.value):S()}),u_=e=>Fi(e,{onEmpty:S(),onFail:t=>E(lt(t)),onDie:t=>E(lt(t)),onInterrupt:()=>S(),onSequential:(t,r)=>U(t)&&U(r)?E(Ue(t.value,r.value)):U(t)&&G(r)?E(t.value):G(t)&&U(r)?E(r.value):S(),onParallel:(t,r)=>U(t)&&U(r)?E(Ct(t.value,r.value)):U(t)&&G(r)?E(t.value):G(t)&&U(r)?E(r.value):S()});var hl=e=>Fi(e,{onEmpty:_r,onFail:()=>_r,onDie:t=>lt(t),onInterrupt:t=>$t(t),onSequential:Ue,onParallel:Ct}),l_=e=>Fi(e,{onEmpty:_r,onFail:t=>lt(t),onDie:t=>lt(t),onInterrupt:t=>$t(t),onSequential:(t,r)=>Ue(t,r),onParallel:(t,r)=>Ct(t,r)});var p_=l(2,(e,t)=>Fi(e,{onEmpty:_r,onFail:r=>t(r),onDie:r=>lt(r),onInterrupt:r=>$t(r),onSequential:(r,o)=>Ue(r,o),onParallel:(r,o)=>Ct(r,o)})),_h=e=>p_(e,W);var HP=(e,t)=>{let r=Re(e),o=Re(t);for(;Ze(r)&&Ze(o);){let[n,s]=m(Je(r),us([Dr(),Lt()],([a,p],f)=>{let[h,d]=gh(f);return E([m(a,po(h)),m(p,jt(d))])})),[i,c]=m(Je(o),us([Dr(),Lt()],([a,p],f)=>{let[h,d]=gh(f);return E([m(a,po(h)),m(p,jt(d))])}));if(!C(n,i))return!1;r=s,o=c}return!0},WP=e=>UP(Re(e),Lt()),UP=(e,t)=>{for(;;){let[r,o]=m(e,tr([Dr(),Lt()],([s,i],c)=>{let[a,p]=gh(c);return[m(s,po(a)),m(i,jt(p))]})),n=Yn(r)>0?m(t,Ke(r)):t;if(gm(o))return Nr(n);e=o,t=n}throw new Error(Hn("Cause.flattenCauseLoop"))},on=l(2,(e,t)=>{let r=[e];for(;r.length>0;){let o=r.pop(),n=t(o);switch(n._tag){case"None":{switch(o._tag){case as:case cs:{r.push(o.right),r.push(o.left);break}}break}case"Some":return n}}return S()});var gh=e=>{let t=e,r=[],o=Dr(),n=Lt();for(;t!==void 0;)switch(t._tag){case ns:{if(r.length===0)return[o,n];t=r.pop();break}case ss:{if(o=Qn(o,Oc(t._tag,t.error)),r.length===0)return[o,n];t=r.pop();break}case os:{if(o=Qn(o,Oc(t._tag,t.defect)),r.length===0)return[o,n];t=r.pop();break}case is:{if(o=Qn(o,Oc(t._tag,t.fiberId)),r.length===0)return[o,n];t=r.pop();break}case as:{switch(t.left._tag){case ns:{t=t.right;break}case as:{t=Ue(t.left.left,Ue(t.left.right,t.right));break}case cs:{t=Ct(Ue(t.left.left,t.right),Ue(t.left.right,t.right));break}default:{n=Ke(n,t.right),t=t.left;break}}break}case cs:{r.push(t.right),t=t.left;break}}throw new Error(Hn("Cause.evaluateCauseLoop"))};var BP={emptyCase:Uo,failCase:to,dieCase:to,interruptCase:Uo,sequentialCase:(e,t,r)=>t&&r,parallelCase:(e,t,r)=>t&&r};var n_="SequentialCase",s_="ParallelCase",Fi=l(2,(e,{onDie:t,onEmpty:r,onFail:o,onInterrupt:n,onParallel:s,onSequential:i})=>Uc(e,void 0,{emptyCase:()=>r,failCase:(c,a)=>o(a),dieCase:(c,a)=>t(a),interruptCase:(c,a)=>n(a),sequentialCase:(c,a,p)=>i(a,p),parallelCase:(c,a,p)=>s(a,p)})),us=l(3,(e,t,r)=>{let o=t,n=e,s=[];for(;n!==void 0;){let i=r(o,n);switch(o=U(i)?i.value:o,n._tag){case as:{s.push(n.right),n=n.left;break}case cs:{s.push(n.right),n=n.left;break}default:{n=void 0;break}}n===void 0&&s.length>0&&(n=s.pop())}return o}),Uc=l(3,(e,t,r)=>{let o=[e],n=[];for(;o.length>0;){let i=o.pop();switch(i._tag){case ns:{n.push(Pe(r.emptyCase(t)));break}case ss:{n.push(Pe(r.failCase(t,i.error)));break}case os:{n.push(Pe(r.dieCase(t,i.defect)));break}case is:{n.push(Pe(r.interruptCase(t,i.fiberId)));break}case as:{o.push(i.right),o.push(i.left),n.push(bt({_tag:n_}));break}case cs:{o.push(i.right),o.push(i.left),n.push(bt({_tag:s_}));break}}}let s=[];for(;n.length>0;){let i=n.pop();switch(i._tag){case"Left":{switch(i.left._tag){case n_:{let c=s.pop(),a=s.pop(),p=r.sequentialCase(t,c,a);s.push(p);break}case s_:{let c=s.pop(),a=s.pop(),p=r.parallelCase(t,c,a);s.push(p);break}}break}case"Right":{s.push(i.right);break}}}if(s.length===0)throw new Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return s.pop()}),nn=(e,t)=>ls(e)?"All fibers interrupted without errors.":dl(e).map(function(r){return t?.renderErrorCause!==!0||r.cause===void 0?r.stack:`${r.stack} {
${f_(r.cause,"  ")}
}`}).join(`
`),f_=(e,t)=>{let r=e.stack.split(`
`),o=`${t}[cause]: ${r[0]}`;for(let n=1,s=r.length;n<s;n++)o+=`
${t}${r[n]}`;return e.cause&&(o+=` {
${f_(e.cause,`${t}  `)}
${t}}`),o},ul=class e extends globalThis.Error{span=void 0;constructor(t){let r=typeof t=="object"&&t!==null,o=Error.stackTraceLimit;Error.stackTraceLimit=1,super(jP(t),r&&"cause"in t&&typeof t.cause<"u"?{cause:new e(t.cause)}:void 0),this.message===""&&(this.message="An error has occurred"),Error.stackTraceLimit=o,this.name=t instanceof Error?t.name:"Error",r&&(i_ in t&&(this.span=t[i_]),Object.keys(t).forEach(n=>{n in this||(this[n]=t[n])})),this.stack=GP(`${this.name}: ${this.message}`,t instanceof Error&&t.stack?t.stack:"",this.span)}},jP=e=>{if(typeof e=="string")return e;if(typeof e=="object"&&e!==null&&e instanceof Error)return e.message;try{if(k(e,"toString")&&jo(e.toString)&&e.toString!==Object.prototype.toString&&e.toString!==globalThis.Array.prototype.toString)return e.toString()}catch{}return au(e)},zP=/\((.*)\)/,Bc=H("effect/Tracer/spanToTrace",()=>new WeakMap),GP=(e,t,r)=>{let o=[e],n=t.startsWith(e)?t.slice(e.length).split(`
`):t.split(`
`);for(let s=1;s<n.length&&!n[s].includes("Generator.next");s++){if(n[s].includes("effect_internal_function")){o.pop();break}o.push(n[s].replace(/at .*effect_instruction_i.*\((.*)\)/,"at $1").replace(/EffectPrimitive\.\w+/,"<anonymous>"))}if(r){let s=r,i=0;for(;s&&s._tag==="Span"&&i<10;){let c=Bc.get(s);if(typeof c=="function"){let a=c();if(typeof a=="string"){let p=a.match(zP),f=p?p[1]:a.replace(/^at /,"");o.push(`    at ${s.name} (${f})`)}else o.push(`    at ${s.name}`)}else o.push(`    at ${s.name}`);s=ut(s.parent),i++}}return o.join(`
`)},i_=Symbol.for("effect/SpanAnnotation"),dl=e=>Uc(e,void 0,{emptyCase:()=>[],dieCase:(t,r)=>[new ul(r)],failCase:(t,r)=>[new ul(r)],interruptCase:()=>[],parallelCase:(t,r,o)=>[...r,...o],sequentialCase:(t,r,o)=>[...r,...o]});u();u();var fs="Pending",jc="Done";var $P="effect/Deferred",h_=Symbol.for($P),d_={_E:e=>e,_A:e=>e},x_=e=>({_tag:fs,joiners:e}),Eh=e=>({_tag:jc,effect:e});u();var sn=class e{self;called=!1;constructor(t){this.self=t}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new e(this.self)}};var YP="effect/EffectError",Oh=Symbol.for(YP),v_=e=>k(e,Oh),k_=e=>({[Oh]:Oh,_tag:"EffectError",cause:e}),go=(e,t)=>{let r=new Be("Blocked");return r.effect_instruction_i0=e,r.effect_instruction_i1=t,r},_l=e=>{let t=new Be("RunBlocked");return t.effect_instruction_i0=e,t},yo=Symbol.for("effect/Effect"),gl=class{patch;op;_op=yc;constructor(t,r){this.patch=t,this.op=r}},Be=class{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[yo]=Go;constructor(t){this._op=t}[M](t){return this===t}[F](){return V(this,oi(this))}pipe(){return v(this,arguments)}toJSON(){return{_id:"Effect",_op:this._op,effect_instruction_i0:Y(this.effect_instruction_i0),effect_instruction_i1:Y(this.effect_instruction_i1),effect_instruction_i2:Y(this.effect_instruction_i2)}}toString(){return re(this.toJSON())}[z](){return this.toJSON()}[Symbol.iterator](){return new sn(new Fr(this))}},yl=class{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[yo]=Go;constructor(t){this._op=t,this._tag=t}[M](t){return Qc(t)&&t._op==="Failure"&&C(this.effect_instruction_i0,t.effect_instruction_i0)}[F](){return m(ae(this._tag),L(w(this.effect_instruction_i0)),V(this))}get cause(){return this.effect_instruction_i0}pipe(){return v(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,cause:this.cause.toJSON()}}toString(){return re(this.toJSON())}[z](){return this.toJSON()}[Symbol.iterator](){return new sn(new Fr(this))}},bl=class{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[yo]=Go;constructor(t){this._op=t,this._tag=t}[M](t){return Qc(t)&&t._op==="Success"&&C(this.effect_instruction_i0,t.effect_instruction_i0)}[F](){return m(ae(this._tag),L(w(this.effect_instruction_i0)),V(this))}get value(){return this.effect_instruction_i0}pipe(){return v(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,value:Y(this.value)}}toString(){return re(this.toJSON())}[z](){return this.toJSON()}[Symbol.iterator](){return new sn(new Fr(this))}},ce=e=>k(e,yo),X=e=>{let t=new Be(pu);return t.effect_instruction_i0=e,t},cn=l(3,(e,t,r)=>ke(o=>x(e,n=>x(ve(T(()=>o(t(n)))),s=>T(()=>r(n,s)).pipe(be({onFailure:i=>{switch(s._tag){case Ie:return Q(Ct(s.effect_instruction_i0,i));case Ne:return Q(i)}},onSuccess:()=>s})))))),pe=l(2,(e,t)=>x(e,()=>y(t))),Ce=e=>pe(e,void 0),Gc=function(){let e=new Be(si);switch(arguments.length){case 2:{e.effect_instruction_i0=arguments[0],e.commit=arguments[1];break}case 3:{e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.commit=arguments[2];break}case 4:{e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.effect_instruction_i2=arguments[2],e.commit=arguments[3];break}default:throw new Error(Hn("you're not supposed to end up here"))}return e},El=(e,t=Gt)=>{let r=new Be(Un),o;return r.effect_instruction_i0=n=>{o=e(n)},r.effect_instruction_i1=t,Or(r,n=>ce(o)?o:q)},qe=(e,t=Gt)=>Gc(e,function(){let r,o;function n(a){r?r(a):o===void 0&&(o=a)}let s=new Be(Un);s.effect_instruction_i0=a=>{r=a,o&&a(o)},s.effect_instruction_i1=t;let i,c;return this.effect_instruction_i0.length!==1?(c=new AbortController,i=Ae(()=>this.effect_instruction_i0(n,c.signal))):i=Ae(()=>this.effect_instruction_i0(n)),i||c?Or(s,a=>(c&&c.abort(),i??q)):s}),jr=l(2,(e,t)=>{let r=new Be(ii);return r.effect_instruction_i0=e,r.effect_instruction_i1=t,r}),Er=l(2,(e,t)=>Ye(e,{onFailure:t,onSuccess:y})),$c=l(3,(e,t,r)=>jr(e,o=>{let n=Br(o);switch(n._tag){case"Left":return t(n.left)?r(n.left):Q(o);case"Right":return Q(n.right)}})),w_=l(2,(e,t)=>jr(e,r=>{let o=Br(r);switch(o._tag){case"Left":return m(t(o.left),De(()=>Q(r)));case"Right":return Q(o.right)}})),R_=e=>X((t,r)=>e(Lc(r.runtimeFlags))),Sl=Symbol.for("effect/SpanAnnotation"),g_=Symbol.for("effect/OriginalAnnotation");var Ol=(e,t)=>U(t)?new Proxy(e,{has(r,o){return o===Sl||o===g_||o in r},get(r,o){return o===Sl?t.value:o===g_?e:r[o]}}):e,bo=e=>Ln(e)&&!(Sl in e)?X(t=>Q(lt(Ol(e,jl(t))))):Q(lt(e)),an=e=>ln(()=>lt(new iL(e))),un=e=>x(_(e),bo),zr=e=>Ye(e,{onFailure:t=>y(bt(t)),onSuccess:t=>y(Pe(t))}),ve=e=>Vc(e,{onFailure:ie,onSuccess:le}),$=e=>Ln(e)&&!(Sl in e)?X(t=>Q(rn(Ol(e,jl(t))))):Q(rn(e)),vt=e=>x(_(e),$),Q=e=>{let t=new yl(Ie);return t.effect_instruction_i0=e,t},ln=e=>x(_(e),Q),pn=X(e=>y(e.id())),qt=e=>X(t=>e(t.id())),x=l(2,(e,t)=>{let r=new Be(ci);return r.effect_instruction_i0=e,r.effect_instruction_i1=t,r}),fn=l(2,(e,t)=>x(e,r=>{let o=typeof t=="function"?t(r):t;return ce(o)?o:Pf(o)?qe(n=>{o.then(s=>n(y(s)),s=>n($(new gn(s))))}):y(o)})),Cl=e=>{let t=new Be("OnStep");return t.effect_instruction_i0=e,t},kt=e=>x(e,W),mn=e=>Ye(e,{onFailure:y,onSuccess:$}),Vc=l(2,(e,t)=>be(e,{onFailure:r=>y(t.onFailure(r)),onSuccess:r=>y(t.onSuccess(r))})),be=l(2,(e,t)=>{let r=new Be(ai);return r.effect_instruction_i0=e,r.effect_instruction_i1=t.onFailure,r.effect_instruction_i2=t.onSuccess,r}),Ye=l(2,(e,t)=>be(e,{onFailure:r=>{if(ml(r).length>0)return Q(l_(r));let n=Hc(r);return n.length>0?t.onFailure(ym(n)):Q(r)},onSuccess:t.onSuccess})),nt=l(2,(e,t)=>T(()=>{let r=te(e),o=_c(r.length),n=0;return pe(Ii({while:()=>n<r.length,body:()=>t(r[n],n),step:s=>{o[n++]=s}}),o)})),Ht=l(2,(e,t)=>T(()=>{let r=te(e),o=0;return Ii({while:()=>o<r.length,body:()=>t(r[o],o),step:()=>{o++}})})),vl=l(e=>typeof e[0]=="boolean"||ce(e[0]),(e,t)=>ce(e)?x(e,r=>r?t.onTrue():t.onFalse()):e?t.onTrue():t.onFalse()),kl=x(pn,e=>wl(e)),wl=e=>Q($t(e)),Gr=e=>{let t=new Be(oo);return t.effect_instruction_i0=ah(Ur),t.effect_instruction_i1=()=>e,t},M_=e=>Gc(e,function(){let t=new Be(oo);return t.effect_instruction_i0=ah(Ur),t.effect_instruction_i1=r=>Lc(r)?Ae(()=>this.effect_instruction_i0(Gr)):Ae(()=>this.effect_instruction_i0(So)),t}),$r=l(2,(e,t)=>ke(r=>x(ve(r(e)),o=>Lh(t,o)))),O=l(2,(e,t)=>x(e,r=>_(()=>t(r)))),Kc=l(2,(e,t)=>Ye(e,{onFailure:r=>vt(()=>t.onFailure(r)),onSuccess:r=>_(()=>t.onSuccess(r))})),hn=l(2,(e,t)=>be(e,{onFailure:r=>{let o=Br(r);switch(o._tag){case"Left":return vt(()=>t(o.left));case"Right":return Q(o.right)}},onSuccess:y})),Rl=l(2,(e,t)=>gt(e,r=>Wl(r)?q:t(r.effect_instruction_i0))),gt=l(2,(e,t)=>ke(r=>be(r(e),{onFailure:o=>{let n=ie(o);return be(t(n),{onFailure:s=>ie(Ue(o,s)),onSuccess:()=>n})},onSuccess:o=>{let n=le(o);return oe(t(n),n)}}))),Or=l(2,(e,t)=>gt(e,Pi({onFailure:r=>ls(r)?Ce(t(Wc(r))):q,onSuccess:()=>q}))),hs=l(2,(e,t)=>QP(e,t,y)),ds=e=>kh(e,W),kh=l(2,(e,t)=>Ye(e,{onFailure:r=>bo(t(r)),onSuccess:y})),F_=cm,Ti=X((e,t)=>y(t.runtimeFlags)),y=e=>{let t=new bl(Ne);return t.effect_instruction_i0=e,t},T=e=>x(_(e),W),_=e=>{let t=new Be(lu);return t.effect_instruction_i0=e,t},Vt=l(e=>e.length===3||e.length===2&&!(Ln(e[1])&&"onlyEffect"in e[1]),(e,t)=>x(e,r=>{let o=typeof t=="function"?t(r):t;return ce(o)?pe(o,r):Pf(o)?qe(n=>{o.then(s=>n(y(r)),s=>n($(new gn(s))))}):y(r)})),Ml=e=>X(t=>{let r=t.getFiberRef(zc),o=m(r,De(()=>t.scope()));return e(He(zc,E(o)))}),QP=l(3,(e,t,r)=>be(e,{onFailure:o=>ml(o).length>0?Q(Sc(u_(o))):t(),onSuccess:r})),So=e=>{let t=new Be(oo);return t.effect_instruction_i0=uh(Ur),t.effect_instruction_i1=()=>e,t},ke=e=>Gc(e,function(){let t=new Be(oo);return t.effect_instruction_i0=uh(Ur),t.effect_instruction_i1=r=>Lc(r)?Ae(()=>this.effect_instruction_i0(Gr)):Ae(()=>this.effect_instruction_i0(So)),t}),q=y(void 0);var dn=e=>{let t=new Be(oo);return t.effect_instruction_i0=e,t.effect_instruction_i1=void 0,t},Ai=l(2,(e,t)=>x(t,r=>r?m(e,O(E)):y(S()))),Ii=e=>{let t=new Be(ui);return t.effect_instruction_i0=e.while,t.effect_instruction_i1=e.body,t.effect_instruction_i2=e.step,t},T_=l(2,(e,t)=>He(e,Nl,t)),A_=l(2,(e,t)=>He(e,Th,t)),Fl=l(2,(e,t)=>{let r=new Be(oo);return r.effect_instruction_i0=t,r.effect_instruction_i1=()=>e,r}),I_=l(2,(e,t)=>He(e,Ih,t)),N_=l(2,(e,t)=>He(e,Ni,t)),Vr=e=>{let t=new Be(li);return typeof e?.priority<"u"?Fh(t,e.priority):t},xs=l(2,(e,t)=>x(e,r=>O(t,o=>[r,o])));var gs=l(2,(e,t)=>x(e,r=>pe(t,r))),oe=l(2,(e,t)=>x(e,()=>t)),Kr=l(3,(e,t,r)=>x(e,o=>O(t,n=>r(o,n)))),ys=qe(()=>{let e=setInterval(()=>{},2147483647);return _(()=>clearInterval(e))}),bs=e=>x(pn,t=>m(e,Wt(t))),Wt=l(2,(e,t)=>x(e.interruptAsFork(t),()=>e.await)),P_={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return v(this,arguments)}},L_={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4,pipe(){return v(this,arguments)}},D_={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4,pipe(){return v(this,arguments)}},q_={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4,pipe(){return v(this,arguments)}},wh={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4,pipe(){return v(this,arguments)}},Rh={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return v(this,arguments)}},H_={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return v(this,arguments)}},W_={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return v(this,arguments)}};var ZP="effect/FiberRef",XP=Symbol.for(ZP),eL={_A:e=>e},Kt=e=>X(t=>le(t.getFiberRef(e)));var pt=l(2,(e,t)=>x(Kt(e),t)),ms=l(2,(e,t)=>tL(e,()=>[void 0,t]));var tL=l(2,(e,t)=>X(r=>{let[o,n]=t(r.getFiberRef(e));return r.setFiberRef(e,n),y(o)}));var rL="effect/RequestResolver",U_=Symbol.for(rL),oL={_A:e=>e,_R:e=>e},y_=class e{runAll;target;[U_]=oL;constructor(t,r){this.runAll=t,this.target=r}[F](){return V(this,this.target?w(this.target):oi(this))}[M](t){return this.target?nL(t)&&C(this.target,t.target):this===t}identified(...t){return new e(this.runAll,Pr(t))}pipe(){return v(this,arguments)}},nL=e=>k(e,U_);var He=l(3,(e,t,r)=>cn(gs(Kt(t),ms(t,r)),()=>e,o=>ms(t,o))),et=l(3,(e,t,r)=>pt(t,o=>He(e,t,r(o)))),Me=(e,t)=>Ss(e,{differ:tl(),fork:t?.fork??W,join:t?.join}),B_=e=>{let t=Zm();return Ss(e,{differ:t,fork:t.empty})},sL=e=>{let t=Xm(tl());return Ss(e,{differ:t,fork:t.empty})},Tl=e=>{let t=Qm();return Ss(e,{differ:t,fork:t.empty})},Ss=(e,t)=>({...so,[XP]:eL,initial:e,commit(){return Kt(this)},diff:(o,n)=>t.differ.diff(o,n),combine:(o,n)=>t.differ.combine(o,n),patch:o=>n=>t.differ.patch(o,n),fork:t.fork,join:t.join??((o,n)=>n)}),j_=e=>Ss(e,{differ:ch,fork:ch.empty}),wt=H(Symbol.for("effect/FiberRef/currentContext"),()=>Tl(Et())),_o=H(Symbol.for("effect/FiberRef/currentSchedulingPriority"),()=>Me(0)),Al=H(Symbol.for("effect/FiberRef/currentMaxOpsBeforeYield"),()=>Me(2048)),xn=H(Symbol.for("effect/FiberRef/currentLogAnnotation"),()=>Me(es())),Mh=H(Symbol.for("effect/FiberRef/currentLogLevel"),()=>Me(wh)),Il=H(Symbol.for("effect/FiberRef/currentLogSpan"),()=>Me(Wr())),Fh=l(2,(e,t)=>He(e,_o,t)),z_=l(2,(e,t)=>He(e,Al,t)),Nl=H(Symbol.for("effect/FiberRef/currentConcurrency"),()=>Me("unbounded")),Th=H(Symbol.for("effect/FiberRef/currentRequestBatching"),()=>Me(!0)),Ah=H(Symbol.for("effect/FiberRef/currentUnhandledErrorLogLevel"),()=>Me(E(Rh))),G_=l(2,(e,t)=>He(e,Ah,t)),Eo=H(Symbol.for("effect/FiberRef/currentMetricLabels"),()=>sL(yr())),$_=Kt(Eo),zc=H(Symbol.for("effect/FiberRef/currentForkScopeOverride"),()=>Me(S(),{fork:()=>S(),join:(e,t)=>e})),_s=H(Symbol.for("effect/FiberRef/currentInterruptedCause"),()=>Me(_r,{fork:()=>_r,join:(e,t)=>e})),Ih=H(Symbol.for("effect/FiberRef/currentTracerEnabled"),()=>Me(!0)),Ni=H(Symbol.for("effect/FiberRef/currentTracerTiming"),()=>Me(!0)),Jc=H(Symbol.for("effect/FiberRef/currentTracerSpanAnnotations"),()=>Me(es())),Pl=H(Symbol.for("effect/FiberRef/currentTracerSpanLinks"),()=>Me(Lt())),Ll=Symbol.for("effect/Scope"),Dl=Symbol.for("effect/CloseableScope"),ql=(e,t)=>e.addFinalizer(()=>Ce(t)),Es=(e,t)=>e.addFinalizer(t),Oo=(e,t)=>e.close(t),Os=(e,t)=>e.fork(t);var Hl=function(){class e extends globalThis.Error{commit(){return $(this)}toJSON(){return{...this}}[z](){return this.toString!==globalThis.Error.prototype.toString?this.stack?`${this.toString()}
${this.stack.split(`
`).slice(1).join(`
`)}`:this.toString():"Bun"in globalThis?nn(rn(this),{renderErrorCause:!0}):this}}return Object.assign(e.prototype,jf),e}(),Cs=(e,t)=>{class r extends Hl{_tag=t}return Object.assign(r.prototype,e),r.prototype.name=t,r},b_=Symbol.for("effect/Cause/errors/RuntimeException"),iL=Cs({[b_]:b_},"RuntimeException");var Ch=Symbol.for("effect/Cause/errors/InterruptedException"),QJ=Cs({[Ch]:Ch},"InterruptedException"),V_=e=>k(e,Ch),S_=Symbol.for("effect/Cause/errors/IllegalArgument"),Yc=Cs({[S_]:S_},"IllegalArgumentException");var vh=Symbol.for("effect/Cause/errors/NoSuchElement"),Jt=Cs({[vh]:vh},"NoSuchElementException"),K_=e=>k(e,vh),__=Symbol.for("effect/Cause/errors/InvalidPubSubCapacityException"),ZJ=Cs({[__]:__},"InvalidPubSubCapacityException"),E_=Symbol.for("effect/Cause/errors/ExceededCapacityException"),XJ=Cs({[E_]:E_},"ExceededCapacityException");var O_=Symbol.for("effect/Cause/errors/Timeout"),cL=Cs({[O_]:O_},"TimeoutException"),J_=e=>new cL(`Operation timed out before the specified duration of '${vm(e)}' elapsed`);var C_=Symbol.for("effect/Cause/errors/UnknownException"),gn=function(){class e extends Hl{cause;_tag="UnknownException";error;constructor(r,o){super(o??"An unknown error occurred",{cause:r}),this.cause=r,this.error=r}}return Object.assign(e.prototype,{[C_]:C_,name:"UnknownException"}),e}();var Qc=e=>ce(e)&&"_tag"in e&&(e._tag==="Success"||e._tag==="Failure"),Nh=e=>e._tag==="Failure",Wl=e=>e._tag==="Success";var Y_=l(2,(e,t)=>{switch(e._tag){case Ie:return ie(e.effect_instruction_i0);case Ne:return le(t)}}),Zc=e=>Y_(e,void 0);var yn=(e,t)=>aL(e,t?.parallel?Ct:Ue),bn=e=>ie(lt(e));var Xc=e=>ie(rn(e)),ie=e=>{let t=new yl(Ie);return t.effect_instruction_i0=e,t},Q_=l(2,(e,t)=>{switch(e._tag){case Ie:return ie(e.effect_instruction_i0);case Ne:return t(e.effect_instruction_i0)}});var Z_=e=>m(e,Q_(W));var Ul=e=>ie($t(e)),xl=l(2,(e,t)=>{switch(e._tag){case Ie:return ie(e.effect_instruction_i0);case Ne:return le(t(e.effect_instruction_i0))}});var Pi=l(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case Ie:return t(e.effect_instruction_i0);case Ne:return r(e.effect_instruction_i0)}}),vs=l(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case Ie:return t(e.effect_instruction_i0);case Ne:return r(e.effect_instruction_i0)}}),le=e=>{let t=new bl(Ne);return t.effect_instruction_i0=e,t},Rt=le(void 0);var ea=l(3,(e,t,{onFailure:r,onSuccess:o})=>{switch(e._tag){case Ie:switch(t._tag){case Ne:return ie(e.effect_instruction_i0);case Ie:return ie(r(e.effect_instruction_i0,t.effect_instruction_i0))}case Ne:switch(t._tag){case Ne:return le(o(e.effect_instruction_i0,t.effect_instruction_i0));case Ie:return ie(t.effect_instruction_i0)}}}),aL=(e,t)=>{let r=Pr(e);return Ze(r)?m(ot(r),tr(m(Je(r),xl(Re)),(o,n)=>m(o,ea(n,{onSuccess:(s,i)=>m(s,Ke(i)),onFailure:t}))),xl(Nr),xl(o=>rr(o)),E):S()},ta=e=>({...so,[h_]:d_,state:qr(x_([])),commit(){return tt(this)},blockingOn:e}),Mt=()=>x(pn,e=>X_(e)),X_=e=>_(()=>ta(e)),tt=e=>qe(t=>{let r=Dt(e.state);switch(r._tag){case jc:return t(r.effect);case fs:return r.joiners.push(t),uL(e,t)}},e.blockingOn),Ph=l(2,(e,t)=>$r(t,e)),ra=l(2,(e,t)=>_(()=>{let r=Dt(e.state);switch(r._tag){case jc:return!1;case fs:{nr(e.state,Eh(t));for(let o=0,n=r.joiners.length;o<n;o++)r.joiners[o](t);return!0}}})),Lh=l(2,(e,t)=>ra(e,t));var ks=l(2,(e,t)=>ra(e,Q(t)));var eE=e=>x(pn,t=>ra(e,wl(t)));var oa=l(2,(e,t)=>ra(e,y(t)));var na=(e,t)=>{let r=Dt(e.state);if(r._tag===fs){nr(e.state,Eh(t));for(let o=0,n=r.joiners.length;o<n;o++)r.joiners[o](t)}},uL=(e,t)=>_(()=>{let r=Dt(e.state);if(r._tag===fs){let o=r.joiners.indexOf(t);o>=0&&r.joiners.splice(o,1)}}),lL=X(e=>le(e.currentContext)),Yt=()=>lL;var ir=e=>x(Yt(),e),Cr=l(2,(e,t)=>He(wt,t)(e)),Bl=l(2,(e,t)=>et(wt,r=>co(r,t))(e)),ws=l(2,(e,t)=>ir(r=>Cr(e,t(r)))),jl=e=>{let t=e.currentSpan;return t!==void 0&&t._tag==="Span"?E(t):S()},pL={_tag:"Span",spanId:"noop",traceId:"noop",name:"noop",sampled:!1,parent:S(),context:Et(),status:{_tag:"Ended",startTime:BigInt(0),endTime:BigInt(0),exit:Rt},attributes:new Map,links:[],kind:"internal",attribute(){},event(){},end(){}},tE=e=>{let t=Object.create(pL);return t.name=e,t};var Rs=tt;var rE=Lh;var oE=eE;var Dh=ta;u();var nE=Z_;var sE=le;u();var iE=Symbol.for("effect/MutableHashMap"),fL={[iE]:iE,[Symbol.iterator](){return new Wh(this)},toString(){return re(this.toJSON())},toJSON(){return{_id:"MutableHashMap",values:Array.from(this).map(Y)}},[z](){return this.toJSON()},pipe(){return v(this,arguments)}},Wh=class e{self;referentialIterator;bucketIterator;constructor(t){this.self=t,this.referentialIterator=t.referential[Symbol.iterator]()}next(){if(this.bucketIterator!==void 0)return this.bucketIterator.next();let t=this.referentialIterator.next();return t.done?(this.bucketIterator=new Uh(this.self.buckets.values()),this.next()):t}[Symbol.iterator](){return new e(this.self)}},Uh=class{backing;constructor(t){this.backing=t}currentBucket;next(){if(this.currentBucket===void 0){let r=this.backing.next();if(r.done)return r;this.currentBucket=r.value[Symbol.iterator]()}let t=this.currentBucket.next();return t.done?(this.currentBucket=void 0,this.next()):t}},Ms=()=>{let e=Object.create(fL);return e.referential=new Map,e.buckets=new Map,e.bucketsSize=0,e};var je=l(2,(e,t)=>{if(ni(t)===!1)return e.referential.has(t)?E(e.referential.get(t)):S();let r=t[F](),o=e.buckets.get(r);return o===void 0?S():mL(e,o,t)});var mL=(e,t,r,o=!1)=>{for(let n=0,s=t.length;n<s;n++)if(r[M](t[n][0])){let i=t[n][1];return o&&(t.splice(n,1),e.bucketsSize--),E(i)}return S()},vr=l(2,(e,t)=>U(je(e,t))),Ut=l(3,(e,t,r)=>{if(ni(t)===!1)return e.referential.set(t,r),e;let o=t[F](),n=e.buckets.get(o);return n===void 0?(e.buckets.set(o,[[t,r]]),e.bucketsSize++,e):(cE(e,n,t),n.push([t,r]),e.bucketsSize++,e)}),cE=(e,t,r)=>{for(let o=0,n=t.length;o<n;o++)if(r[M](t[o][0])){t.splice(o,1),e.bucketsSize--;return}};var Fs=l(2,(e,t)=>{if(ni(t)===!1)return e.referential.delete(t),e;let r=t[F](),o=e.buckets.get(r);return o===void 0||(cE(e,o,t),o.length===0&&e.buckets.delete(r)),e});var zl=e=>e.referential.size+e.bucketsSize;u();u();var aE=Symbol.for("effect/MutableList"),hL={[aE]:aE,[Symbol.iterator](){let e=!1,t=this.head;return{next(){if(e)return this.return();if(t==null)return e=!0,this.return();let r=t.value;return t=t.next,{done:e,value:r}},return(r){return e||(e=!0),{done:!0,value:r}}}},toString(){return re(this.toJSON())},toJSON(){return{_id:"MutableList",values:Array.from(this).map(Y)}},[z](){return this.toJSON()},pipe(){return v(this,arguments)}},dL=e=>({value:e,removed:!1,prev:void 0,next:void 0}),uE=()=>{let e=Object.create(hL);return e.head=void 0,e.tail=void 0,e._length=0,e};var lE=e=>Bh(e)===0,Bh=e=>e._length;var pE=l(2,(e,t)=>{let r=dL(t);return e.head===void 0&&(e.head=r),e.tail===void 0||(e.tail.next=r,r.prev=e.tail),e.tail=r,e._length+=1,e}),fE=e=>{let t=e.head;if(t!==void 0)return xL(e,t),t.value};var xL=(e,t)=>{t.removed||(t.removed=!0,t.prev!==void 0&&t.next!==void 0?(t.prev.next=t.next,t.next.prev=t.prev):t.prev!==void 0?(e.tail=t.prev,t.prev.next=void 0):t.next!==void 0?(e.head=t.next,t.next.prev=void 0):(e.tail=void 0,e.head=void 0),e._length>0&&(e._length-=1))};var hE=Symbol.for("effect/MutableQueue"),jh=Symbol.for("effect/mutable/MutableQueue/Empty"),gL={[hE]:hE,[Symbol.iterator](){return Array.from(this.queue)[Symbol.iterator]()},toString(){return re(this.toJSON())},toJSON(){return{_id:"MutableQueue",values:Array.from(this).map(Y)}},[z](){return this.toJSON()},pipe(){return v(this,arguments)}},yL=e=>{let t=Object.create(gL);return t.queue=uE(),t.capacity=e,t};var dE=()=>yL(void 0);var xE=l(2,(e,t)=>{let r=Bh(e.queue);return e.capacity!==void 0&&r===e.capacity?!1:(pE(t)(e.queue),!0)});var gE=l(2,(e,t)=>lE(e.queue)?t:fE(e.queue));u();u();u();var bL="effect/Clock",zh=Symbol.for(bL),Qt=_t("effect/Clock"),SL=2**31-1,bE={unsafeSchedule(e,t){let r=Lr(t);if(r>SL)return to;let o=!1,n=setTimeout(()=>{o=!0,e()},r);return()=>(clearTimeout(n),!o)}},SE=function(){let e=BigInt(1e6);if(typeof performance>"u")return()=>BigInt(Date.now())*e;if(typeof performance.timeOrigin=="number"&&performance.timeOrigin===0)return()=>BigInt(Math.round(performance.now()*1e6));let t=BigInt(Date.now())*e-BigInt(Math.round(performance.now()*1e6));return()=>t+BigInt(Math.round(performance.now()*1e6))}(),_L=function(){let e=typeof process=="object"&&"hrtime"in process&&typeof process.hrtime.bigint=="function"?process.hrtime:void 0;if(!e)return SE;let t=SE()-e.bigint();return()=>t+e.bigint()}(),Gh=class{[zh]=zh;unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return _L()}currentTimeMillis=_(()=>this.unsafeCurrentTimeMillis());currentTimeNanos=_(()=>this.unsafeCurrentTimeNanos());scheduler(){return y(bE)}sleep(t){return qe(r=>{let o=bE.unsafeSchedule(()=>r(q),t);return Ce(_(o))})}},$h=()=>new Gh;u();u();u();u();var Kh="And",Jh="Or",Yh="InvalidData",Qh="MissingData",Zh="SourceUnavailable",Xh="Unsupported";var OL="effect/ConfigError",_E=Symbol.for(OL),Li={_tag:"ConfigError",[_E]:_E},ed=(e,t)=>{let r=Object.create(Li);return r._op=Kh,r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),r},td=(e,t)=>{let r=Object.create(Li);return r._op=Jh,r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),r},CL=(e,t,r={pathDelim:"."})=>{let o=Object.create(Li);return o._op=Yh,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Invalid data at ${m(this.path,io(r.pathDelim))}: "${this.message}")`}}),o},Co=(e,t,r={pathDelim:"."})=>{let o=Object.create(Li);return o._op=Qh,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Missing data at ${m(this.path,io(r.pathDelim))}: "${this.message}")`}}),o},vL=(e,t,r,o={pathDelim:"."})=>{let n=Object.create(Li);return n._op=Zh,n.path=e,n.message=t,n.cause=r,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`(Source unavailable at ${m(this.path,io(o.pathDelim))}: "${this.message}")`}}),n},kL=(e,t,r={pathDelim:"."})=>{let o=Object.create(Li);return o._op=Xh,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Unsupported operation at ${m(this.path,io(r.pathDelim))}: "${this.message}")`}}),o};var Sn=l(2,(e,t)=>{switch(e._op){case Kh:return ed(Sn(e.left,t),Sn(e.right,t));case Jh:return td(Sn(e.left,t),Sn(e.right,t));case Yh:return CL([...t,...e.path],e.message);case Qh:return Co([...t,...e.path],e.message);case Zh:return vL([...t,...e.path],e.message,e.cause);case Xh:return kL([...t,...e.path],e.message)}});u();var OE={_tag:"Empty"};var $l=l(2,(e,t)=>{let r=Fc(t),o=e;for(;Mc(r);){let n=r.head;switch(n._tag){case"Empty":{r=r.tail;break}case"AndThen":{r=mo(n.first,mo(n.second,r.tail));break}case"MapName":{o=Ar(o,n.f),r=r.tail;break}case"Nested":{o=mi(o,n.name),r=r.tail;break}case"Unnested":{if(m(Jo(o),em(n.name)))o=Tr(o),r=r.tail;else return bt(Co(o,`Expected ${n.name} to be in path in ConfigProvider#unnested`));break}}}return Pe(o)});u();var CE="Constant",vE="Fail",kE="Fallback",wE="Described",RE="Lazy",ME="MapOrFail",FE="Nested",TE="Primitive",AE="Sequence",IE="HashMap",NE="ZipWith";var Vl=(e,t)=>[...e,...t],ML="effect/ConfigProvider",PE=Symbol.for(ML),Di=_t("effect/ConfigProvider"),FL="effect/ConfigProviderFlat",LE=Symbol.for(FL),TL=e=>({[PE]:PE,pipe(){return v(this,arguments)},...e}),AL=e=>({[LE]:LE,patch:e.patch,load:(t,r,o=!0)=>e.load(t,r,o),enumerateChildren:e.enumerateChildren}),IL=e=>TL({load:t=>x(cr(e,yr(),t,!1),r=>Ge(Jo(r),{onNone:()=>$(Co(yr(),`Expected a single value having structure: ${t}`)),onSome:y})),flattened:e}),DE=e=>{let{pathDelim:t,seqDelim:r}=Object.assign({},{pathDelim:"_",seqDelim:","},e),o=a=>m(a,io(t)),n=a=>a.split(t),s=()=>typeof process<"u"&&"env"in process&&typeof process.env=="object"?process.env:{};return IL(AL({load:(a,p,f=!0)=>{let h=o(a),d=s(),g=h in d?E(d[h]):S();return m(g,hn(()=>Co(a,`Expected ${h} to exist in the process context`)),x(b=>qL(b,a,p,r,f)))},enumerateChildren:a=>_(()=>{let p=s(),d=Object.keys(p).map(g=>n(g.toUpperCase())).filter(g=>{for(let b=0;b<a.length;b++){let R=m(a,om(b)),I=g[b];if(I===void 0||R!==I)return!1}return!0}).flatMap(g=>g.slice(a.length,a.length+1));return Bu(d)}),patch:OE}))};var NL=(e,t,r,o)=>{let n=am(r.length,a=>a>=o.length?S():E([e(a),a+1])),s=am(o.length,a=>a>=r.length?S():E([t(a),a+1])),i=Vl(r,n),c=Vl(o,s);return[i,c]},PL=(e,t)=>{let r=t;if(r._tag==="Nested"){let o=e.slice();for(;r._tag==="Nested";)o.push(r.name),r=r.config;return o}return e},cr=(e,t,r,o)=>{let n=r;switch(n._tag){case CE:return y(St(n.value));case wE:return T(()=>cr(e,t,n.config,o));case vE:return $(Co(t,n.message));case kE:return m(T(()=>cr(e,t,n.first,o)),Er(s=>n.condition(s)?m(cr(e,t,n.second,o),Er(i=>$(td(s,i)))):$(s)));case RE:return T(()=>cr(e,t,n.config(),o));case ME:return T(()=>m(cr(e,t,n.original,o),x(nt(s=>m(n.mapOrFail(s),hn(Sn(PL(t,n.original))))))));case FE:return T(()=>cr(e,Vl(t,St(n.name)),n.config,o));case TE:return m($l(t,e.patch),x(s=>m(e.load(s,n,o),x(i=>{if(i.length===0){let c=m(Su(s),De(()=>"<n/a>"));return $(Co([],`Expected ${n.description} with name ${c}`))}return y(i)}))));case AE:return m($l(t,e.patch),x(s=>m(e.enumerateChildren(s),x(WL),x(i=>i.length===0?T(()=>O(cr(e,t,n.config,!0),St)):m(nt(i,c=>cr(e,ub(t,`[${c}]`),n.config,!0)),O(c=>{let a=_u(c);return a.length===0?St(yr()):St(a)}))))));case IE:return T(()=>m($l(t,e.patch),x(s=>m(e.enumerateChildren(s),x(i=>m(i,nt(c=>cr(e,Vl(s,St(c)),n.valueConfig,o)),O(c=>c.length===0?St(es()):m(HL(c),Ar(a=>SS(im(te(i),a)))))))))));case NE:return T(()=>m(cr(e,t,n.left,o),zr,x(s=>m(cr(e,t,n.right,o),zr,x(i=>{if(hr(s)&&hr(i))return $(ed(s.left,i.left));if(hr(s)&&Bn(i))return $(s.left);if(Bn(s)&&hr(i))return $(i.left);if(Bn(s)&&Bn(i)){let c=m(t,io(".")),a=LL(t,c),[p,f]=NL(a,a,m(s.right,Ar(Pe)),m(i.right,Ar(Pe)));return m(p,im(f),nt(([h,d])=>m(xs(h,d),O(([g,b])=>n.zip(g,b)))))}throw new Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/effect/issues")})))))}},LL=(e,t)=>r=>bt(Co(e,`The element at index ${r} in a sequence at path "${t}" was missing`));var DL=(e,t)=>e.split(new RegExp(`\\s*${bb(t)}\\s*`)),qL=(e,t,r,o,n)=>n?m(DL(e,o),nt(s=>r.parse(s.trim())),hn(Sn(t))):m(r.parse(e),Kc({onFailure:Sn(t),onSuccess:St})),HL=e=>Object.keys(e[0]).map(t=>e.map(r=>r[t])),WL=e=>m(nt(e,BL),Kc({onFailure:()=>yr(),onSuccess:jn(Yo)}),zr,O(gu));var UL=/^(\[(\d+)\])$/,BL=e=>{let t=e.match(UL);if(t!==null){let r=t[2];return m(r!==void 0&&r.length>0?E(r):S(),xr(jL))}return S()};var jL=e=>{let t=Number.parseInt(e);return Number.isNaN(t)?S():E(t)};u();var qE=Symbol.for("effect/Console"),vo=_t("effect/Console"),HE={[qE]:qE,assert(e,...t){return _(()=>{console.assert(e,...t)})},clear:_(()=>{console.clear()}),count(e){return _(()=>{console.count(e)})},countReset(e){return _(()=>{console.countReset(e)})},debug(...e){return _(()=>{console.debug(...e)})},dir(e,t){return _(()=>{console.dir(e,t)})},dirxml(...e){return _(()=>{console.dirxml(...e)})},error(...e){return _(()=>{console.error(...e)})},group(e){return e?.collapsed?_(()=>console.groupCollapsed(e?.label)):_(()=>console.group(e?.label))},groupEnd:_(()=>{console.groupEnd()}),info(...e){return _(()=>{console.info(...e)})},log(...e){return _(()=>{console.log(...e)})},table(e,t){return _(()=>{console.table(e,t)})},time(e){return _(()=>console.time(e))},timeEnd(e){return _(()=>console.timeEnd(e))},timeLog(e,...t){return _(()=>{console.timeLog(e,...t)})},trace(...e){return _(()=>{console.trace(...e)})},warn(...e){return _(()=>{console.warn(...e)})},unsafe:console};u();var GL="effect/Random",UE=Symbol.for(GL),qi=_t("effect/Random"),rd=class{seed;[UE]=UE;PRNG;constructor(t){this.seed=t,this.PRNG=new ou(t)}get next(){return _(()=>this.PRNG.number())}get nextBoolean(){return O(this.next,t=>t>.5)}get nextInt(){return _(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(t,r){return O(this.next,o=>(r-t)*o+t)}nextIntBetween(t,r){return _(()=>this.PRNG.integer(r-t)+t)}shuffle(t){return $L(t,r=>this.nextIntBetween(0,r))}},$L=(e,t)=>T(()=>m(_(()=>Array.from(e)),x(r=>{let o=[];for(let n=r.length;n>=2;n=n-1)o.push(n);return m(o,Ht(n=>m(t(n),O(s=>VL(r,n-1,s)))),pe(Pr(r)))}))),VL=(e,t,r)=>{let o=e[t];return e[t]=e[r],e[r]=o,e},BE=e=>new rd(w(e));u();var jE=Symbol.for("effect/Tracer"),JL=e=>({[jE]:jE,...e}),ko=_t("effect/Tracer"),Jr=_t("effect/ParentSpan"),zE=function(){let e="abcdef0123456789",t=e.length;return function(r){let o="";for(let n=0;n<r;n++)o+=e.charAt(Math.floor(Math.random()*t));return o}}(),od=class{name;parent;context;links;startTime;kind;_tag="Span";spanId;traceId="native";sampled=!0;status;attributes;events=[];constructor(t,r,o,n,s,i){this.name=t,this.parent=r,this.context=o,this.links=n,this.startTime=s,this.kind=i,this.status={_tag:"Started",startTime:s},this.attributes=new Map,this.traceId=r._tag==="Some"?r.value.traceId:zE(32),this.spanId=zE(16)}end(t,r){this.status={_tag:"Ended",endTime:t,exit:r,startTime:this.status.startTime}}attribute(t,r){this.attributes.set(t,r)}event(t,r,o){this.events.push([t,r,o??{}])}},GE=JL({span:(e,t,r,o,n,s)=>new od(e,t,r,o,n,s),context:e=>e()});var wo=e=>{if(e?.captureStackTrace===!1)return e;if(e?.captureStackTrace!==void 0&&typeof e.captureStackTrace!="boolean")return e;let t=Error.stackTraceLimit;Error.stackTraceLimit=3;let r=new Error;Error.stackTraceLimit=t;let o=!1;return{...e,captureStackTrace:()=>{if(o!==!1)return o;if(r.stack!==void 0){let n=r.stack.split(`
`);if(n[3]!==void 0)return o=n[3].trim(),o}}}};var YL=m(Et(),Oe(Qt,$h()),Oe(vo,HE),Oe(qi,BE(Math.random())),Oe(Di,DE()),Oe(ko,GE)),We=H(Symbol.for("effect/DefaultServices/currentServices"),()=>Tl(YL)),$E=e=>{let t=Xe(e);return sa(r=>r.sleep(t))},Kl=e=>X(t=>e(t.currentDefaultServices)),sa=e=>Kl(t=>e(t.unsafeMap.get(Qt.key))),VE=sa(e=>e.currentTimeMillis),KE=sa(e=>e.currentTimeNanos),JE=l(2,(e,t)=>et(We,Oe(Qt,t))(e)),YE=l(2,(e,t)=>et(We,Oe(Di,t))(e)),QE=e=>Kl(t=>e(t.unsafeMap.get(Di.key)));var Jl=e=>Kl(t=>e(t.unsafeMap.get(qi.key))),ZE=l(2,(e,t)=>et(We,Oe(qi,t))(e));var Yl=e=>Kl(t=>e(t.unsafeMap.get(ko.key))),XE=l(2,(e,t)=>et(We,Oe(ko,t))(e));var sd=$E,Ql=VE,eO=KE,tO=sa,rO=Qt;u();u();function oO(e){return new Yr(e)}function nO(){return oO(new Map)}var cd=Symbol.for("effect/FiberRefs"),Yr=class{locals;[cd]=cd;constructor(t){this.locals=t}pipe(){return v(this,arguments)}},QL=(e,t,r,o=!1)=>{let n=e,s=t,i=r,c=o,a;for(;a===void 0;)if(dt(s)&&dt(i)){let p=xt(s)[0],f=Tr(s),h=xt(i)[0],d=xt(i)[1],g=Tr(i);p.startTimeMillis<h.startTimeMillis?(i=g,c=!0):p.startTimeMillis>h.startTimeMillis?s=f:p.id<h.id?(i=g,c=!0):p.id>h.id?s=f:a=[d,c]}else a=[n.initial,!0];return a},Zl=l(3,(e,t,r)=>{let o=new Map(e.locals);return r.locals.forEach((n,s)=>{let i=n[0][1];if(!n[0][0][M](t)){if(!o.has(s)){if(C(i,s.initial))return;o.set(s,[[t,s.join(s.initial,i)]]);return}let c=o.get(s),[a,p]=QL(s,c,n);if(p){let f=s.diff(a,i),h=c[0][1],d=s.join(h,s.patch(f)(h));if(!C(h,d)){let g,b=c[0][0];b[M](t)?g=[[b,d],...c.slice(1)]:g=[[t,d],...c],o.set(s,g)}}}}),new Yr(o)}),ud=l(2,(e,t)=>{let r=new Map;return sO(e,r,t),new Yr(r)}),sO=(e,t,r)=>{e.locals.forEach((o,n)=>{let s=o[0][1],i=n.patch(n.fork)(s);C(s,i)?t.set(n,o):t.set(n,[[r,i],...o])})},iO=e=>Bu(e.locals.keys()),cO=e=>Ht(iO(e),t=>ms(t,Ro(e,t))),ia=l(2,(e,t)=>{let r=new Map(e.locals);return r.delete(t),new Yr(r)}),Xl=l(2,(e,t)=>e.locals.has(t)?E(xt(e.locals.get(t))[1]):S()),Ro=l(2,(e,t)=>m(Xl(e,t),De(()=>t.initial))),Wi=l(2,(e,{fiberId:t,fiberRef:r,value:o})=>{if(e.locals.size===0)return new Yr(new Map([[r,[[t,o]]]]));let n=new Map(e.locals);return ad(n,t,r,o),new Yr(n)}),ad=(e,t,r,o)=>{let n=e.get(r)??[],s;if(dt(n)){let[i,c]=xt(n);if(i[M](t)){if(C(c,o))return;s=[[t,o],...n.slice(1)]}else s=[[t,o],...n]}else s=[[t,o]];e.set(r,s)},aO=l(2,(e,{entries:t,forkAs:r})=>{if(e.locals.size===0)return new Yr(new Map(t));let o=new Map(e.locals);return r!==void 0&&sO(e,o,r),t.forEach(([n,s])=>{s.length===1?ad(o,s[0][0],n,s[0][1]):s.forEach(([i,c])=>{ad(o,i,n,c)})}),new Yr(o)});var pd=Xl,uO=Ro,lO=Zl,pO=cO;var fO=aO;var mO=nO;u();var ZL=P_,fd=L_,md=D_,hd=q_,dd=wh,xd=Rh,gd=H_,XL=W_;var eD=m(Yo,Yy(e=>e.ordinal));var hO=Qf(eD);var dO=e=>{switch(e){case"All":return ZL;case"Debug":return xd;case"Error":return md;case"Fatal":return fd;case"Info":return dd;case"Trace":return gd;case"None":return XL;case"Warning":return hd}};u();u();var xO=(e,t)=>({label:e,startTime:t}),gO=e=>t=>`${t.label.replace(/[\s="]/g,"_")}=${e-t.startTime}ms`;var yO=xO,bO=gO;u();u();u();var SO=no,Sd=so;var rD=By;var Mo=class extends rD{};u();var _n=Symbol.for("effect/Readable");var _4={[_n]:_n,pipe(){return v(this,arguments)}};var tp=Symbol.for("effect/Ref"),Od={_A:e=>e},Ed=class extends Mo{ref;commit(){return this.get}[tp]=Od;[_n]=_n;constructor(t){super(),this.ref=t,this.get=_(()=>Dt(this.ref))}get;modify(t){return _(()=>{let r=Dt(this.ref),[o,n]=t(r);return r!==n&&nr(n)(this.ref),o})}},rp=e=>new Ed(qr(e)),Ts=e=>_(()=>rp(e)),ar=e=>e.get,Fo=l(2,(e,t)=>e.modify(()=>[void 0,t])),_O=l(2,(e,t)=>e.modify(r=>[r,t]));var op=l(2,(e,t)=>e.modify(t));var aa=l(2,(e,t)=>e.modify(r=>[void 0,t(r)]));var ua=Ts,sp=ar,EO=_O;var OO=op;var CO=aa;u();var vO=Yl;u();var wO="Empty",RO="Add",MO="Remove",FO="Update",TO="AndThen",AO={_tag:wO},la=(e,t)=>{let r=new Map(e.locals),o=AO;for(let[n,s]of t.locals.entries()){let i=xt(s)[1],c=r.get(n);if(c!==void 0){let a=xt(c)[1];C(a,i)||(o=ip({_tag:FO,fiberRef:n,patch:n.diff(a,i)})(o))}else o=ip({_tag:RO,fiberRef:n,value:i})(o);r.delete(n)}for(let[n]of r.entries())o=ip({_tag:MO,fiberRef:n})(o);return o},ip=l(2,(e,t)=>({_tag:TO,first:e,second:t})),cp=l(3,(e,t,r)=>{let o=r,n=St(e);for(;dt(n);){let s=xt(n),i=Tr(n);switch(s._tag){case wO:{n=i;break}case RO:{o=Wi(o,{fiberId:t,fiberRef:s.fiberRef,value:s.value}),n=i;break}case MO:{o=ia(o,s.fiberRef),n=i;break}case FO:{let c=Ro(o,s.fiberRef);o=Wi(o,{fiberId:t,fiberRef:s.fiberRef,value:s.fiberRef.patch(s.patch)(c)}),n=i;break}case TO:{n=mi(s.first)(mi(s.second)(i));break}}}return o});u();var NO="effect/MetricLabel",vd=Symbol.for(NO),kd=class{key;value;[vd]=vd;_hash;constructor(t,r){this.key=t,this.value=r,this._hash=ae(NO+this.key+this.value)}[F](){return this._hash}[M](t){return oD(t)&&this.key===t.key&&this.value===t.value}pipe(){return v(this,arguments)}},As=(e,t)=>new kd(e,t),oD=e=>k(e,vd);var PO=l(e=>ce(e[0]),function(){let e=arguments;return et(e[0],xn,typeof e[1]=="string"?Sr(e[1],e[2]):t=>Object.entries(e[1]).reduce((r,[o,n])=>Sr(r,o,n),t))}),Ui=e=>O(e,E),LO=e=>hn(e,E),Rd=e=>{let t,r;return typeof e=="function"?t=e:(t=e.try,r=e.catch),_(()=>{try{return t()}catch(o){throw k_(rn(r?r(o):new gn(o)))}})},DO=l(3,(e,t,r)=>Er(e,o=>k(o,t)&&o[t]===r.failure?r.onFailure(o):$(o))),qO=l(2,(e,t)=>jr(e,r=>{let o=on(r,n=>Mi(n)?E(n):S());switch(o._tag){case"None":return Q(r);case"Some":return t(o.value.defect)}})),HO=l(2,(e,t)=>be(e,{onFailure:r=>{let o=t(r);switch(o._tag){case"None":return Q(r);case"Some":return o.value}},onSuccess:y})),WO=l(2,(e,t)=>jr(e,r=>{let o=on(r,n=>Mi(n)?E(n):S());switch(o._tag){case"None":return Q(r);case"Some":{let n=t(o.value.defect);return n._tag==="Some"?n.value:Q(r)}}})),UO=l(3,(e,t,r)=>$c(e,Dn(t),r)),BO=l(2,(e,t)=>{let r;return $c(e,o=>(r??=Object.keys(t),k(o,"_tag")&&tu(o._tag)&&r.includes(o._tag)),o=>t[o._tag](o))}),jO=e=>Vc(e,{onFailure:W,onSuccess:()=>_r}),Qr=tO,zO=Qr(y),GO=l(2,(e,t)=>oe(sd(t),e)),lp=e=>X((t,r)=>e({id:t.id(),status:r,interruptors:Wc(t.getFiberRef(_s))})),$O=lp(e=>Yn(e.interruptors)>0?kl:q),VO=lp(y),Bi=e=>ma(e,pp,la),nD=e=>ma(e,xs(pp,Ti),([t,r],[o,n])=>[la(t,o),sr(r,n)]),KO=y({}),JO=eu(O,x),YO=Xa(O),QO=Za(O),ZO=l(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=[],n,s=y(!1),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,a=i++;s=x(s,p=>p?(o.push(c),y(!0)):t(c,a))}return O(s,()=>o)})),XO=l(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=[],n,s=y(!0),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,a=i++;s=x(s,p=>O(p?t(c,a):y(!1),f=>(f||o.push(c),f)))}return O(s,()=>o)})),eC=e=>O(Yt(),e),Md=e=>hs(e,()=>x(Vr(),()=>Md(e))),tC=l(2,(e,t)=>O(nt(e,W),hi(t))),rC=l(3,(e,t,r)=>pa(e,t,o=>un(()=>r(o)))),oC=l(3,(e,t,r)=>pa(e,t,()=>an(r))),pa=l(3,(e,t,r)=>x(e,o=>t(o)?y(o):r(o))),nC=l(3,(e,t,r)=>T(()=>t(e)?y(e):$(r(e)))),sC=l(e=>ce(e[0]),(e,t,r)=>pa(e,t,o=>r===void 0?$(new Jt):vt(()=>r(o)))),iC=l(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=r.next();return o.done?y(S()):cC(r,0,t,o.value)})),cC=(e,t,r,o)=>x(r(o,t),n=>{if(n)return y(E(o));let s=e.next();return s.done?y(S()):cC(e,t+1,r,s.value)}),aC=e=>T(()=>{let t=Pr(e);return Ze(t)?m(ot(t),tr(Je(t),(r,o)=>hs(r,()=>o))):un(()=>new Yc("Received an empty collection of effects"))}),uC=l(2,(e,t)=>mn(t(mn(e)))),fa=l(2,(e,t)=>Ye(e,{onFailure:r=>y(t.onFailure(r)),onSuccess:r=>y(t.onSuccess(r))})),lC=l(2,(e,t)=>T(()=>pC(e[Symbol.iterator](),0,t))),pC=(e,t,r)=>{let o=e.next();return o.done?y(!0):x(r(o.value,t),n=>n?pC(e,t+1,r):y(n))},Fd=e=>{let t=x(x(e,()=>Vr()),()=>t);return t},fC=function(){let e;return arguments.length===1?e=arguments[0]:e=arguments[1].bind(arguments[0]),T(()=>{let t=e(m),r=Ae(()=>t.next()),o=n=>n.done?y(n.value):x(ri(n.value),s=>o(Ae(()=>t.next(s))));return o(r)})},pp=X(e=>y(e.getFiberRefs())),mC=e=>x(e,t=>{let o=t[Symbol.iterator]().next();return o.done?$(new Jt):y(o.value)}),Td=e=>fa(e,{onFailure:Bo,onSuccess:Bo}),hC=e=>be(e,{onFailure:t=>Id(t,"An error was silently ignored because it is not anticipated to be useful"),onSuccess:()=>q}),dC=e=>mp((t,r)=>lO(r,t,e)),xC=e=>fa(e,{onFailure:Uo,onSuccess:to}),gC=e=>fa(e,{onFailure:to,onSuccess:Uo}),Ad=(e,t)=>T(()=>t.while(e)?x(t.body(e),r=>Ad(r,t)):y(e)),To=e=>(...t)=>{let r=dr(e),o;for(let n=0,s=t.length;n<s;n++){let i=t[n];ll(i)&&(o!==void 0?o=Ue(o,i):o=i,t=[...t.slice(0,n),...t.slice(n+1)],n--)}return o===void 0&&(o=_r),X(n=>(n.log(t,o,r),q))},yC=To(),bC=To(gd),Id=To(xd),SC=To(dd),_C=To(hd),EC=To(md),OC=To(fd),CC=l(2,(e,t)=>x(Ql,r=>et(e,Il,Qu(yO(t,r))))),vC=Kt(xn),kC=(e,t)=>t.discard?RC(e,t.while,t.step,t.body):O(wC(e,t.while,t.step,t.body),te),wC=(e,t,r,o)=>T(()=>t(e)?x(o(e),n=>O(wC(r(e),t,r,o),Qu(n))):_(()=>Wr())),RC=(e,t,r,o)=>T(()=>t(e)?x(o(e),()=>RC(r(e),t,r,o)):q),MC=l(3,(e,t,r)=>T(()=>{let o=e[Symbol.iterator](),n=[],s=y(t),i,c=0;for(;!(i=o.next()).done;){let a=c++,p=i.value;s=x(s,f=>O(r(f,p,a),([h,d])=>(n.push(d),h)))}return O(s,a=>[a,n])})),ji=l(2,(e,t)=>be(e,{onFailure:r=>ln(()=>t(r)),onSuccess:y})),Nd=e=>m(Mt(),x(t=>m(nD(e),$r(t),Pd,O(r=>oe(r,m(tt(t),x(([o,n])=>pe(xs(Is(o[0]),dn(o[1])),n)))))))),FC=e=>Ye(e,{onFailure:t=>y(t),onSuccess:y}),fp=e=>O(e,t=>!t),TC=e=>x(e,t=>{switch(t._tag){case"None":return q;case"Some":return $(new Jt)}}),Pd=e=>O(ua(!0),t=>Ce(Ai(e,EO(t,!1)))),AC=e=>Ye(e,{onFailure:()=>y(S()),onSuccess:t=>y(E(t))}),IC=l(2,(e,t)=>hs(e,()=>vt(t))),NC=l(2,(e,t)=>hs(e,()=>_(t))),PC=e=>be(e,{onFailure:t=>{let r=te(Hc(t));return r.length===0?Q(t):$(r)},onSuccess:y}),Is=e=>mp((t,r)=>m(e,cp(t,r))),LC=e=>e.length>=1?qe((t,r)=>{try{e(r).then(o=>t(le(o)),o=>t(bn(o)))}catch(o){t(bn(o))}}):qe(t=>{try{e().then(r=>t(le(r)),r=>t(bn(r)))}catch(r){t(bn(r))}}),zi=l(3,(e,t,r)=>ir(o=>Cr(e,Oe(o,t,r)))),DC=l(3,(e,t,r)=>ir(o=>x(r,n=>Cr(e,m(o,Oe(t,n)))))),qC=Jl(y),HC=l(3,(e,t,r)=>te(e).reduce((o,n,s)=>x(o,i=>r(i,n,s)),y(t))),WC=l(3,(e,t,r)=>te(e).reduceRight((o,n,s)=>x(o,i=>r(n,i,s)),y(t))),UC=l(3,(e,t,r)=>x(_(()=>e[Symbol.iterator]()),o=>BC(o,0,t,r.while,r.body))),BC=(e,t,r,o,n)=>{let s=e.next();return!s.done&&o(r)?x(n(r,s.value,t),i=>BC(e,t+1,i,o,n)):y(r)},jC=l(2,(e,t)=>T(()=>zC(e,t))),zC=(e,t)=>x(e,r=>t<=0?y(r):oe(Vr(),zC(e,t-1))),GC=e=>be(e,{onFailure:$,onSuccess:y}),$C=e=>T(()=>pO(e)),Ns=sd,Ps=y(S()),VC=e=>y(E(e)),ma=l(3,(e,t,r)=>x(t,o=>x(e,n=>O(t,s=>[r(o,s),n])))),KC=l(e=>ce(e[0]),function(){return Ld(arguments[0],typeof arguments[1]=="string"?[As(arguments[1],arguments[2])]:Object.entries(arguments[1]).map(([e,t])=>As(e,t)))}),Ld=l(2,(e,t)=>et(e,Eo,r=>gr(r,t))),JC=l(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=[],n,s=y(!1),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,a=i++;s=x(s,p=>p?y(!0):(o.push(c),t(c,a)))}return O(s,()=>o)})),YC=l(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=[],n,s=y(!0),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,a=i++;s=x(s,p=>m(p?t(c,a):y(!1),O(f=>(f&&o.push(c),f))))}return O(s,()=>o)})),QC=l(2,(e,{onFailure:t,onSuccess:r})=>be(e,{onFailure:o=>{let n=Br(o);switch(n._tag){case"Left":return oe(t(n.left),Q(o));case"Right":return Q(o)}},onSuccess:o=>pe(r(o),o)})),ZC=l(2,(e,t)=>jr(e,r=>Ge(Sh(r),{onNone:()=>Q(r),onSome:o=>oe(t(o),Q(r))}))),Dd=l(2,(e,t)=>be(e,{onFailure:r=>{let o=Br(r);switch(o._tag){case"Left":return oe(t(o.left),Q(r));case"Right":return Q(r)}},onSuccess:y})),XC=l(3,(e,t,r)=>Dd(e,o=>Dn(o,t)?r(o):q)),ev=l(2,(e,t)=>be(e,{onFailure:r=>oe(t(r),Q(r)),onSuccess:y})),tv=e=>qd(e,eO),qd=l(2,(e,t)=>ma(e,t,(r,o)=>Cc(o-r))),sD=vO,rv=sD(y),Hd=e=>{let t,r;return typeof e=="function"?t=e:(t=e.try,r=e.catch),t.length>=1?qe((o,n)=>{try{t(n).then(s=>o(le(s)),s=>o(r?vt(()=>r(s)):$(new gn(s))))}catch(s){o(r?vt(()=>r(s)):$(new gn(s)))}}):qe(o=>{try{t().then(n=>o(le(n)),n=>o(r?vt(()=>r(n)):$(new gn(n))))}catch(n){o(r?vt(()=>r(n)):$(new gn(n)))}})},ov=l(2,(e,t)=>x(e,r=>Rd({try:()=>t.try(r),catch:t.catch}))),nv=l(2,(e,t)=>x(e,r=>Hd({try:t.try.length>=1?o=>t.try(r,o):()=>t.try(r),catch:t.catch}))),sv=l(2,(e,t)=>T(()=>t()?Ps:Ui(e))),iv=l(2,(e,t)=>x(t,r=>r?Ps:Ui(e))),cv=e=>ji(e,_h),mp=e=>X(t=>(t.setFiberRefs(e(t.id(),t.getFiberRefs())),q)),av=l(3,(e,t,r)=>ws(e,o=>Oe(o,t,r(Gn(o,t))))),hp=l(2,(e,t)=>T(()=>t()?O(e,E):y(S()))),uv=l(3,(e,t,r)=>x(Kt(t),o=>r(o)?O(e,n=>[o,E(n)]):y([o,S()]))),lv=l(3,(e,t,r)=>x(sp(t),o=>r(o)?O(e,n=>[o,E(n)]):y([o,S()]))),pv=l(2,(e,t)=>t(e)),fv=(e,t)=>(...r)=>x(e,o=>t(o)(...r)),mv=(e,t)=>(...r)=>O(e,o=>t(o)(...r)),Wd=e=>new Proxy({},{get(t,r,o){return(...n)=>x(e,s=>s[r](...n))}}),Ud=e=>new Proxy({},{get(t,r,o){return x(e,n=>ce(n[r])?n[r]:y(n[r]))}}),hv=e=>({functions:Wd(e),constants:Ud(e)}),dv=e=>O(Yt(),br(e)),Bd=e=>x(Yt(),br(e)),xv=function(){let e=arguments;return Td(x(jd,t=>_(()=>{if(typeof e[0]=="string")t.attribute(e[0],e[1]);else for(let r in e[0])t.attribute(r,e[0][r])})))},gv=l(e=>ce(e[0]),function(){let e=arguments;return et(e[0],Jc,typeof e[1]=="string"?Sr(e[1],e[2]):t=>Object.entries(e[1]).reduce((r,[o,n])=>Sr(r,o,n),t))}),yv=Bd(Jr),jd=x(Yt(),e=>{let t=e.unsafeMap.get(Jr.key);return t!==void 0&&t._tag==="Span"?y(t):$(new Jt)}),bv=l(e=>ce(e[0]),(e,t,r)=>et(e,Pl,vu({_tag:"SpanLink",span:t,attributes:r??{}}))),Sv=BigInt(0),dp=(e,t,r)=>{if(e.getFiberRef(Ih)===!1)return tE(t);let n=e.getFiberRef(wt),s=e.getFiberRef(We),i=Bt(s,ko),c=Bt(s,rO),a=e.getFiberRef(Ni),p=e.getFiberRefs(),f=pd(p,Jc),h=pd(p,Pl),d=r.parent?E(r.parent):r.root?S():br(n,Jr),g=h._tag==="Some"?r.links!==void 0?[...rr(h.value),...r.links??[]]:rr(h.value):r.links??yr(),b=i.span(t,d,r.context??Et(),g,a?c.unsafeCurrentTimeNanos():Sv,r.kind??"internal");return typeof r.captureStackTrace=="function"&&Bc.set(b,r.captureStackTrace),f._tag==="Some"&&kS(f.value,(R,I)=>b.attribute(I,R)),r.attributes!==void 0&&Object.entries(r.attributes).forEach(([R,I])=>b.attribute(R,I)),b},_v=(e,t)=>(t=wo(t),X(r=>y(dp(r,e,t)))),Ev=Kt(Jc),Ov=Kt(Pl),zd=(e,t,r,o)=>_(()=>{e.status._tag!=="Ended"&&(Nh(t)&&Bc.has(e)&&e.attribute("code.stacktrace",Bc.get(e)()),e.end(o?r.unsafeCurrentTimeNanos():Sv,t))}),ap=(e,...t)=>{let r=wo(t.length===1?void 0:t[0]),o=t[t.length-1];return X(n=>{let s=dp(n,e,r),i=n.getFiberRef(Ni),c=Bt(n.getFiberRef(We),Qt);return gt(o(s),a=>zd(s,a,c,i))})},up=l(2,(e,t)=>zi(e,Jr,t)),Gd=function(){let e=typeof arguments[0]!="string",t=e?arguments[1]:arguments[0],r=wo(e?arguments[2]:arguments[1]);if(e){let o=arguments[0];return ap(t,r,n=>up(o,n))}return o=>ap(t,r,n=>up(o,n))},Cv=e=>function(){let t=e.captureStackTrace??!1;if(e.captureStackTrace!==!1){let r=Error.stackTraceLimit;Error.stackTraceLimit=2;let o=new Error;Error.stackTraceLimit=r;let n=!1;t=()=>{if(n!==!1)return n;if(o.stack)return n=o.stack.trim().split(`
`).slice(2).join(`
`).trim(),n}}return T(()=>{let r=typeof e.options=="function"?e.options.apply(null,arguments):e.options;return Gd(T(()=>Ae(()=>e.body.apply(this,arguments))),r.name,{...r,captureStackTrace:t})})},vv=e=>e==null?$(new Jt):y(e),kv=e=>Er(O(e,E),t=>K_(t)?Ps:$(t));u();u();u();var wv="Sequential",Rv="Parallel",iD="ParallelN",Zr={_tag:wv},Mv={_tag:Rv},Fv=e=>({_tag:iD,parallelism:e}),$d=e=>e._tag===wv,Vd=e=>e._tag===Rv;var gp=Zr,yp=Mv,bp=Fv;u();var Ls=la;var Ds=cp;u();u();var _p="effect/FiberStatus",En=Symbol.for(_p),Sp="Done",Av="Running",Iv="Suspended",cD=ae(`${_p}-${Sp}`),Jd=class{[En]=En;_tag=Sp;[F](){return cD}[M](t){return Ep(t)&&t._tag===Sp}},Yd=class{runtimeFlags;[En]=En;_tag=Av;constructor(t){this.runtimeFlags=t}[F](){return m(w(_p),L(w(this._tag)),L(w(this.runtimeFlags)),V(this))}[M](t){return Ep(t)&&t._tag===Av&&this.runtimeFlags===t.runtimeFlags}},Qd=class{runtimeFlags;blockingOn;[En]=En;_tag=Iv;constructor(t,r){this.runtimeFlags=t,this.blockingOn=r}[F](){return m(w(_p),L(w(this._tag)),L(w(this.runtimeFlags)),L(w(this.blockingOn)),V(this))}[M](t){return Ep(t)&&t._tag===Iv&&this.runtimeFlags===t.runtimeFlags&&C(this.blockingOn,t.blockingOn)}},Nv=new Jd,Pv=e=>new Yd(e),Lv=(e,t)=>new Qd(e,t),Ep=e=>k(e,En),Dv=e=>e._tag===Sp;var qv=Nv,Zd=Pv,Hv=Lv;var Wv=Dv;u();var Kv=Symbol.for("effect/Micro"),ft=Symbol.for("effect/Micro/runSymbol"),Bv=e=>typeof e=="object"&&e!==null&&Kv in e,ix={...SO,_op:"Micro",[Kv]:{_A:W,_E:W,_R:W},[Symbol.iterator](){return new sn(new Fr(this))}},uD=function(){function e(){}return e.prototype=ix,e}(),tx=class extends uD{[ft](t,r){this.asMicro()[ft](t,r)}},jv=Symbol.for("effect/Micro/MicroCause");var lD={_E:W},Op=class extends globalThis.Error{_tag;traces;[jv];constructor(t,r,o){let n=`MicroCause.${t}`,s,i,c;if(r instanceof globalThis.Error){s=`(${n}) ${r.name}`,i=r.message;let a=i.split(`
`).length;c=r.stack?`(${n}) ${r.stack.split(`
`).slice(0,a+3).join(`
`)}`:`${s}: ${i}`}else s=n,i=zo(r,0),c=`${s}: ${i}`;o.length>0&&(c+=`
    ${o.join(`
    `)}`),super(i),this._tag=t,this.traces=o,this[jv]=lD,this.name=s,this.stack=c}pipe(){return v(this,arguments)}toString(){return this.stack}[z](){return this.stack}};var rx=class extends Op{defect;constructor(t,r=[]){super("Die",t,r),this.defect=t}},pD=(e,t=[])=>new rx(e,t),ox=class extends Op{constructor(t=[]){super("Interrupt","interrupted",t)}},fD=(e=[])=>new ox(e);var Cp=bt(fD()),da=Pe;var Jv=e=>bt(pD(e));var mD=Symbol.for("effect/Micro/Env"),hD={[mD]:{_R:W},pipe(){return v(this,arguments)}},cx=e=>{let t=Object.create(hD);return t.refs=e,t},Yv=()=>{let e=new AbortController,t=Object.create(null);return t[wp.key]=e,t[qs.key]=e.signal,t[rk.key]=new vp,cx(t)},On=l(2,(e,t)=>t.key in e.refs?e.refs[t.key]:t.initial),Qv=l(3,(e,t,r)=>{let o=Object.assign(Object.create(null),e.refs);return o[t.key]=r,cx(o)}),Zv=l(2,(e,t)=>cx(t(Object.assign(Object.create(null),e.refs))));var dD=e=>Xr((t,r)=>r(Pe(On(t,e))));var xD="setImmediate"in globalThis?globalThis.setImmediate:e=>setTimeout(e,0),vp=class{tasks=[];running=!1;scheduleTask(t,r){this.tasks.push(t),this.running||(this.running=!0,xD(this.afterScheduled))}afterScheduled=()=>{this.running=!1,this.runTasks()};runTasks(){let t=this.tasks;this.tasks=[];for(let r=0,o=t.length;r<o;r++)t[r]()}shouldYield(t){return!1}flush(){for(;this.tasks.length>0;)this.runTasks()}},zv=Symbol.for("effect/Micro/EnvRef"),gD={...ix,[zv]:zv,[ft](e,t){dD(this)[ft](e,t)}},Hs=(e,t)=>H(e,()=>{let r=Object.create(gD);return r.key=e,r.initial=t(),r}),wp=Hs("effect/Micro/currentAbortController",()=>{}),qs=Hs("effect/Micro/currentAbortSignal",()=>{}),Xv=Hs("effect/Micro/currentContext",()=>Et()),yD=Hs("effect/Micro/currentConcurrency",()=>"unbounded"),ek=Hs("effect/Micro/currentMaxDepthBeforeYield",()=>2048),tk=Hs("effect/Micro/currentInterruptible",()=>!0),rk=Hs("effect/Micro/currentScheduler",()=>new vp);var $i=H("effect/Micro/microDepthState",()=>({depth:0,maxDepthBeforeYield:ek.initial})),bD=e=>{let t=Object.create(ix);return t[ft]=e,t},ok=(e,t)=>bD(function r(o,n){if(t&&o.refs[tk.key]!==!1&&o.refs[qs.key].aborted)return n(Cp);$i.depth++,$i.depth===1&&($i.maxDepthBeforeYield=On(o,ek));let s=o.refs[rk.key];if($i.depth>=$i.maxDepthBeforeYield||s.shouldYield(o))s.scheduleTask(()=>r(o,n),0);else try{e(o,n)}catch(i){n(Jv(i))}$i.depth--}),Xr=e=>ok(e,!0),ha=e=>Xr(function(t,r){r(e)});var nx=e=>ha(da(e));var sx=e=>Xr(function(t,r){r(da(e()))});var kp=e=>Xr(function(t,r){e()[ft](t,r)}),Gv=nx(void 0);var SD=e=>Xr(function(t,r){let o=!1,n=e.length>1?new AbortController:void 0,s=On(t,qs),i;function c(){a(i?kD(ED(i,ha(Cp))):ha(Cp)),n!==void 0&&n.abort()}function a(p){o||(o=!0,s.removeEventListener("abort",c),p[ft](t,r))}i=n===void 0?e(a):e(a,n.signal),!o&&s.addEventListener("abort",c)});var _D=l(2,(e,t)=>Xr(function(r,o){e[ft](r,function(n){o(n._tag==="Left"?n:da(t(n.right)))})}));var nk=l(2,(e,t)=>Xr(function(r,o){e[ft](r,function(n){if(n._tag==="Left")return o(n);t(n.right)[ft](r,o)})}));var ED=l(2,(e,t)=>Xr(function(r,o){e[ft](r,function(n){if(n._tag==="Left")return o(n);if(On(r,qs).aborted)return o(Cp);let s=Bv(t)?t:typeof t=="function"?t(n.right):t;Bv(s)?s[ft](r,o):o(da(s))})}));var OD=e=>_D(e,t=>{}),CD=e=>Xr(function(t,r){e[ft](t,function(o){r(da(o))})});function vD(e){let t=new AbortController,r=On(e,qs);function o(){t.abort(),r.removeEventListener("abort",o)}return r.addEventListener("abort",o),[Zv(e,function(s){return s[wp.key]=t,s[qs.key]=t.signal,s}),o]}var Xd=Symbol.for("effect/Micro/MicroScope");var $v=class e{[Xd];state={_tag:"Open",finalizers:new Set};constructor(){this[Xd]=Xd}unsafeAddFinalizer(t){this.state._tag==="Open"&&this.state.finalizers.add(t)}addFinalizer(t){return kp(()=>this.state._tag==="Open"?(this.state.finalizers.add(t),Gv):t(this.state.exit))}unsafeRemoveFinalizer(t){this.state._tag==="Open"&&this.state.finalizers.delete(t)}close(t){return kp(()=>{if(this.state._tag==="Open"){let r=Array.from(this.state.finalizers).reverse();return this.state={_tag:"Closed",exit:t},nk(wD(r,o=>CD(o(t))),o=>OD(ha(Ky(o))))}return Gv})}get fork(){return sx(()=>{let t=new e;if(this.state._tag==="Closed")return t.state=this.state,t;function r(o){return t.close(o)}return this.state.finalizers.add(r),t.unsafeAddFinalizer(o=>sx(()=>this.unsafeRemoveFinalizer(r))),t})}};var kD=e=>ok(function(t,r){let o=Zv(t,function(n){return n[tk.key]=!1,n[qs.key]=new AbortController().signal,n});e[ft](o,r)},!1);var wD=(e,t,r)=>Xr(function(o,n){let s=r?.concurrency==="inherit"?On(o,yD):r?.concurrency??1,i=s==="unbounded"?Number.POSITIVE_INFINITY:Math.max(1,s),[c,a]=vD(o),p,f=Array.from(e),h=f.length;if(h===0)return n(Pe(r?.discard?void 0:[]));let d=r?.discard?void 0:new Array(h),g=0,b=0,R=0,I=!1;function P(){for(I=!0;b<i&&g<h;){let K=g,ue=f[K];g++,b++;try{t(ue,K)[ft](c,function(Se){Se._tag==="Left"?p===void 0&&(p=Se,h=g,a()):d!==void 0&&(d[K]=Se.right),R++,b--,R===h?n(p??Pe(d)):!I&&b<i&&P()})}catch(Se){p=Jv(Se),h=g,a()}}I=!1}P()});var ex=Symbol.for("effect/Micro/Handle");var Vv=class extends tx{parentSignal;[ex];observers=new Set;_exit=void 0;_controller;isRoot;constructor(t,r){super(),this.parentSignal=t,this[ex]=ex,this.isRoot=r!==void 0,this._controller=r??new AbortController,this.isRoot||t.addEventListener("abort",this.unsafeInterrupt)}unsafePoll(){return this._exit??null}unsafeInterrupt=()=>{this._controller.abort()};emit(t){this._exit||(this._exit=t,this.isRoot||this.parentSignal.removeEventListener("abort",this.unsafeInterrupt),this.observers.forEach(r=>r(t)),this.observers.clear())}addObserver(t){if(this._exit)return t(this._exit);this.observers.add(t)}removeObserver(t){this.observers.delete(t)}get await(){return kp(()=>this._exit?nx(this._exit):SD(t=>{function r(o){t(nx(o))}return this.addObserver(r),sx(()=>{this.removeObserver(r)})}))}get join(){return nk(this.await,ha)}get interrupt(){return kp(()=>(this.unsafeInterrupt(),this.await))}asMicro(){return this.join}};u();var Rp=class{buckets=[];scheduleTask(t,r){let o=this.buckets.length,n,s=0;for(;s<o&&this.buckets[s][0]<=r;s++)n=this.buckets[s];n&&n[0]===r?n[1].push(t):s===o?this.buckets.push([r,[t]]):this.buckets.splice(s,0,[r,[t]])}},ax=class{maxNextTickBeforeTimer;running=!1;tasks=new Rp;constructor(t){this.maxNextTickBeforeTimer=t}starveInternal(t){let r=this.tasks.buckets;this.tasks.buckets=[];for(let[o,n]of r)for(let s=0;s<n.length;s++)n[s]();this.tasks.buckets.length===0?this.running=!1:this.starve(t)}starve(t=0){t>=this.maxNextTickBeforeTimer?setTimeout(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(t+1))}shouldYield(t){return t.currentOpCount>t.getFiberRef(Al)?t.getFiberRef(_o):!1}scheduleTask(t,r){this.tasks.scheduleTask(t,r),this.running||(this.running=!0,this.starve())}},ik=H(Symbol.for("effect/Scheduler/defaultScheduler"),()=>new ax(2048)),Mp=class{tasks=new Rp;deferred=!1;scheduleTask(t,r){this.deferred?ik.scheduleTask(t,r):this.tasks.scheduleTask(t,r)}shouldYield(t){return t.currentOpCount>t.getFiberRef(Al)?t.getFiberRef(_o):!1}flush(){for(;this.tasks.buckets.length>0;){let t=this.tasks.buckets;this.tasks.buckets=[];for(let[r,o]of t)for(let n=0;n<o.length;n++)o[n]()}this.deferred=!0}};var Ws=H(Symbol.for("effect/FiberRef/currentScheduler"),()=>Me(ik)),ck=l(2,(e,t)=>He(e,Ws,t));u();var Fp=H(Symbol.for("effect/FiberRef/currentRequestMap"),()=>Me(new Map));u();var lx=(e,t,r,o)=>{switch(e){case void 0:return t();case"unbounded":return r();case"inherit":return pt(Nl,n=>n==="unbounded"?r():n>1?o(n):t());default:return e>1?o(e):t()}},xa=(e,t,r)=>{switch(e){case void 0:return t();case"unbounded":return r();case"inherit":return pt(Nl,o=>o==="unbounded"||o>1?r():t());default:return e>1?r():t()}};u();u();u();var Tp="InterruptSignal",Ap="Stateful",Ip="Resume",Np="YieldNow",Pp=e=>({_tag:Tp,cause:e}),Vi=e=>({_tag:Ap,onFiber:e}),Us=e=>({_tag:Ip,effect:e}),ak=()=>({_tag:Np});var FD="effect/FiberScope",Lp=Symbol.for(FD),px=class{[Lp]=Lp;fiberId=Gt;roots=new Set;add(t,r){this.roots.add(r),r.addObserver(()=>{this.roots.delete(r)})}},fx=class{fiberId;parent;[Lp]=Lp;constructor(t,r){this.fiberId=t,this.parent=r}add(t,r){this.parent.tell(Vi(o=>{o.addChild(r),r.addObserver(()=>{o.removeChild(r)})}))}},lk=e=>new fx(e.id(),e),Cn=H(Symbol.for("effect/FiberScope/Global"),()=>new px);var TD="effect/Fiber",ga=Symbol.for(TD),ya={_E:e=>e,_A:e=>e},AD={[ga]:ya,pipe(){return v(this,arguments)}},ID="effect/Fiber",fk=Symbol.for(ID);var mx=e=>e.await;var mk=e=>e.inheritAll;var hk=l(2,(e,t)=>e.interruptAsFork(t)),kr=e=>gs(kt(e.await),e.inheritAll);var E6={...so,commit(){return kr(this)},...AD,id:()=>Gt,await:ys,children:y([]),inheritAll:ys,poll:y(S()),interruptAsFork:()=>ys};var vn="effect/FiberCurrent";u();var ND="effect/Logger",xk=Symbol.for(ND),gk={_Message:e=>e,_Output:e=>e},Dp=e=>({[xk]:gk,log:e,pipe(){return v(this,arguments)}});var k6={[xk]:gk,log:Bo,pipe(){return v(this,arguments)}};var yk=Dp(({annotations:e,cause:t,date:r,fiberId:o,logLevel:n,message:s,spans:i})=>{let c=r.getTime(),p=[`timestamp=${r.toISOString()}`,`level=${n.label}`,`fiber=${Ku(o)}`].join(" "),f=ab(s);for(let h=0;h<f.length;h++){let d=zo(f[h]);d.length>0&&(p=p+" message=",p=hx(d,p))}if(t!=null&&t._tag!=="Empty"&&(p=p+" cause=",p=hx(nn(t,{renderErrorCause:!0}),p)),Mc(i)){p=p+" ";let h=!0;for(let d of i)h?h=!1:p=p+" ",p=p+m(d,bO(c))}if(ES(e)>0){p=p+" ";let h=!0;for(let[d,g]of e)h?h=!1:p=p+" ",p=p+DD(d),p=p+"=",p=hx(zo(g),p)}return p}),PD=e=>`"${e.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`,LD=/^[^\s"=]+$/,hx=(e,t)=>t+(e.match(LD)?e:PD(e));var DD=e=>e.replace(/[\s="]/g,"_");var Bs={bold:"1",red:"31",green:"32",yellow:"33",blue:"34",cyan:"36",white:"37",gray:"90",black:"30",bgBrightRed:"101"},w6={None:[],All:[],Trace:[Bs.gray],Debug:[Bs.blue],Info:[Bs.green],Warning:[Bs.yellow],Error:[Bs.red],Fatal:[Bs.bgBrightRed,Bs.black]};var bk=typeof process=="object"&&process!==null&&typeof process.stdout=="object"&&process.stdout!==null,R6=bk&&process.stdout.isTTY===!0,M6=bk||"Deno"in globalThis;u();u();var Sk="effect/MetricBoundaries",dx=Symbol.for(Sk),xx=class{values;[dx]=dx;constructor(t){this.values=t,this._hash=m(ae(Sk),L(Pt(this.values)))}_hash;[F](){return this._hash}[M](t){return HD(t)&&C(this.values,t.values)}pipe(){return v(this,arguments)}},HD=e=>k(e,dx),WD=e=>{let t=m(e,rm(Re(Number.POSITIVE_INFINITY)),um);return new xx(t)};var _k=e=>m(tm(e.count-1,t=>e.start*Math.pow(e.factor,t)),xi,WD);u();u();var BD="effect/MetricKeyType",ba=Symbol.for(BD),vk="effect/MetricKeyType/Counter",gx=Symbol.for(vk),kk="effect/MetricKeyType/Frequency",yx=Symbol.for(kk),wk="effect/MetricKeyType/Gauge",bx=Symbol.for(wk),Rk="effect/MetricKeyType/Histogram",Sx=Symbol.for(Rk),Mk="effect/MetricKeyType/Summary",_x=Symbol.for(Mk),Sa={_In:e=>e,_Out:e=>e},Ex=class{incremental;bigint;[ba]=Sa;[gx]=gx;constructor(t,r){this.incremental=t,this.bigint=r,this._hash=ae(vk)}_hash;[F](){return this._hash}[M](t){return Cx(t)}pipe(){return v(this,arguments)}},jD=ae(kk),Ek=class{preregisteredWords;[ba]=Sa;[yx]=yx;constructor(t){this.preregisteredWords=t}[F](){return jD}[M](t){return vx(t)}pipe(){return v(this,arguments)}},zD=ae(wk),Ok=class{bigint;[ba]=Sa;[bx]=bx;constructor(t){this.bigint=t}[F](){return zD}[M](t){return kx(t)}pipe(){return v(this,arguments)}},Ox=class{boundaries;[ba]=Sa;[Sx]=Sx;constructor(t){this.boundaries=t,this._hash=m(ae(Rk),L(w(this.boundaries)))}_hash;[F](){return this._hash}[M](t){return wx(t)&&C(this.boundaries,t.boundaries)}pipe(){return v(this,arguments)}},Ck=class{maxAge;maxSize;error;quantiles;[ba]=Sa;[_x]=_x;constructor(t,r,o,n){this.maxAge=t,this.maxSize=r,this.error=o,this.quantiles=n,this._hash=m(ae(Mk),L(w(this.maxAge)),L(w(this.maxSize)),L(w(this.error)),L(Pt(this.quantiles)))}_hash;[F](){return this._hash}[M](t){return Rx(t)&&C(this.maxAge,t.maxAge)&&this.maxSize===t.maxSize&&this.error===t.error&&C(this.quantiles,t.quantiles)}pipe(){return v(this,arguments)}},Fk=e=>new Ex(e?.incremental??!1,e?.bigint??!1);var Tk=e=>new Ox(e);var Cx=e=>k(e,gx),vx=e=>k(e,yx),kx=e=>k(e,bx),wx=e=>k(e,Sx),Rx=e=>k(e,_x);var GD="effect/MetricKey",Ik=Symbol.for(GD),$D={_Type:e=>e},VD=di(C),_a=class{name;keyType;description;tags;[Ik]=$D;constructor(t,r,o,n=[]){this.name=t,this.keyType=r,this.description=o,this.tags=n,this._hash=m(ae(this.name+this.description),L(w(this.keyType)),L(Pt(this.tags)))}_hash;[F](){return this._hash}[M](t){return KD(t)&&this.name===t.name&&C(this.keyType,t.keyType)&&C(this.description,t.description)&&VD(this.tags,t.tags)}pipe(){return v(this,arguments)}},KD=e=>k(e,Ik),Nk=(e,t)=>new _a(e,Fk(t),dr(t?.description));var Pk=(e,t,r)=>new _a(e,Tk(t),dr(r));var Lk=l(2,(e,t)=>t.length===0?e:new _a(e.name,e.keyType,e.description,gr(e.tags,t)));u();u();u();var YD="effect/MetricState",Ea=Symbol.for(YD),Dk="effect/MetricState/Counter",Mx=Symbol.for(Dk),qk="effect/MetricState/Frequency",Fx=Symbol.for(qk),Hk="effect/MetricState/Gauge",Tx=Symbol.for(Hk),Wk="effect/MetricState/Histogram",Ax=Symbol.for(Wk),Uk="effect/MetricState/Summary",Ix=Symbol.for(Uk),Oa={_A:e=>e},Nx=class{count;[Ea]=Oa;[Mx]=Mx;constructor(t){this.count=t}[F](){return m(w(Dk),L(w(this.count)),V(this))}[M](t){return ZD(t)&&this.count===t.count}pipe(){return v(this,arguments)}},QD=di(C),Px=class{occurrences;[Ea]=Oa;[Fx]=Fx;constructor(t){this.occurrences=t}_hash;[F](){return m(ae(qk),L(Pt(te(this.occurrences.entries()))),V(this))}[M](t){return XD(t)&&QD(te(this.occurrences.entries()),te(t.occurrences.entries()))}pipe(){return v(this,arguments)}},Lx=class{value;[Ea]=Oa;[Tx]=Tx;constructor(t){this.value=t}[F](){return m(w(Hk),L(w(this.value)),V(this))}[M](t){return e2(t)&&this.value===t.value}pipe(){return v(this,arguments)}},Dx=class{buckets;count;min;max;sum;[Ea]=Oa;[Ax]=Ax;constructor(t,r,o,n,s){this.buckets=t,this.count=r,this.min=o,this.max=n,this.sum=s}[F](){return m(w(Wk),L(w(this.buckets)),L(w(this.count)),L(w(this.min)),L(w(this.max)),L(w(this.sum)),V(this))}[M](t){return t2(t)&&C(this.buckets,t.buckets)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return v(this,arguments)}},qx=class{error;quantiles;count;min;max;sum;[Ea]=Oa;[Ix]=Ix;constructor(t,r,o,n,s,i){this.error=t,this.quantiles=r,this.count=o,this.min=n,this.max=s,this.sum=i}[F](){return m(w(Uk),L(w(this.error)),L(w(this.quantiles)),L(w(this.count)),L(w(this.min)),L(w(this.max)),L(w(this.sum)),V(this))}[M](t){return r2(t)&&this.error===t.error&&C(this.quantiles,t.quantiles)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return v(this,arguments)}},Bk=e=>new Nx(e),jk=e=>new Px(e),zk=e=>new Lx(e),Gk=e=>new Dx(e.buckets,e.count,e.min,e.max,e.sum),$k=e=>new qx(e.error,e.quantiles,e.count,e.min,e.max,e.sum);var ZD=e=>k(e,Mx),XD=e=>k(e,Fx),e2=e=>k(e,Tx),t2=e=>k(e,Ax),r2=e=>k(e,Ix);var n2="effect/MetricHook",s2=Symbol.for(n2),i2={_In:e=>e,_Out:e=>e},Ca=e=>({[s2]:i2,pipe(){return v(this,arguments)},...e});var Vk=BigInt(0),Jk=e=>{let t=e.keyType.bigint?Vk:0,r=e.keyType.incremental?e.keyType.bigint?n=>n>=Vk:n=>n>=0:n=>!0,o=n=>{r(n)&&(t=t+n)};return Ca({get:()=>Bk(t),update:o,modify:o})},Yk=e=>{let t=new Map;for(let o of e.keyType.preregisteredWords)t.set(o,0);let r=o=>{let n=t.get(o)??0;t.set(o,n+1)};return Ca({get:()=>jk(t),update:r,modify:r})},Qk=(e,t)=>{let r=t;return Ca({get:()=>zk(r),update:o=>{r=o},modify:o=>{r=r+o}})},Zk=e=>{let t=e.keyType.boundaries.values,r=t.length,o=new Uint32Array(r+1),n=new Float32Array(r),s=0,i=0,c=Number.MAX_VALUE,a=Number.MIN_VALUE;m(t,jn(Yo),Ar((h,d)=>{n[d]=h}));let p=h=>{let d=0,g=r;for(;d!==g;){let b=Math.floor(d+(g-d)/2),R=n[b];h<=R?g=b:d=b,g===d+1&&(h<=n[d]?g=d:d=g)}o[d]=o[d]+1,s=s+1,i=i+h,h<c&&(c=h),h>a&&(a=h)},f=()=>{let h=_c(r),d=0;for(let g=0;g<r;g++){let b=n[g],R=o[g];d=d+R,h[g]=[b,d]}return h};return Ca({get:()=>Gk({buckets:f(),count:s,min:c,max:a,sum:i}),update:p,modify:p})},Xk=e=>{let{error:t,maxAge:r,maxSize:o,quantiles:n}=e.keyType,s=m(n,jn(Yo)),i=_c(o),c=0,a=0,p=0,f=Number.MAX_VALUE,h=Number.MIN_VALUE,d=b=>{let R=[],I=0;for(;I!==o-1;){let P=i[I];if(P!=null){let[K,ue]=P,Se=gi(b-K);Cm(Se,Em)&&Se<=r&&R.push(ue)}I=I+1}return c2(t,s,jn(R,Yo))},g=(b,R)=>{if(o>0){c=c+1;let I=c%o;i[I]=[R,b]}a=a+1,p=p+b,b<f&&(f=b),b>h&&(h=b)};return Ca({get:()=>$k({error:t,quantiles:d(Date.now()),count:a,min:f,max:h,sum:p}),update:([b,R])=>g(b,R),modify:([b,R])=>g(b,R)})},c2=(e,t,r)=>{let o=r.length;if(!dt(t))return yr();let n=t[0],s=t.slice(1),i=Kk(e,o,S(),0,n,r),c=St(i);return s.forEach(a=>{c.push(Kk(e,o,i.value,i.consumed,a,i.rest))}),Ar(c,a=>[a.quantile,a.value])},Kk=(e,t,r,o,n,s)=>{let i=e,c=t,a=r,p=o,f=n,h=s,d=e,g=t,b=r,R=o,I=n,P=s;for(;;){if(!dt(h))return{quantile:f,value:S(),consumed:p,rest:[]};if(f===1)return{quantile:f,value:E(nm(h)),consumed:p+h.length,rest:[]};let K=mb(h,Wo=>Wo<=h[0]),ue=f*c,Se=i/2*ue,at=p+K[0].length,er=Math.abs(at-ue);if(at<ue-Se){d=i,g=c,b=Jo(h),R=at,I=f,P=K[1],i=d,c=g,a=b,p=R,f=I,h=P;continue}if(at>ue+Se)return{quantile:f,value:a,consumed:p,rest:h};switch(a._tag){case"None":{d=i,g=c,b=Jo(h),R=at,I=f,P=K[1],i=d,c=g,a=b,p=R,f=I,h=P;continue}case"Some":{let Wo=Math.abs(ue-a.value);if(er<Wo){d=i,g=c,b=Jo(h),R=at,I=f,P=K[1],i=d,c=g,a=b,p=R,f=I,h=P;continue}return{quantile:f,value:E(a.value),consumed:p,rest:h}}}}throw new Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/effect/issues")};u();var u2="effect/MetricPair",l2=Symbol.for(u2),p2={_Type:e=>e};var ew=(e,t)=>({[l2]:p2,metricKey:e,metricState:t,pipe(){return v(this,arguments)}});var m2="effect/MetricRegistry",tw=Symbol.for(m2),Hx=class{[tw]=tw;map=Ms();snapshot(){let t=[];for(let[r,o]of this.map)t.push(ew(r,o.get()));return t}get(t){let r=m(this.map,je(t),ut);if(r==null){if(Cx(t.keyType))return this.getCounter(t);if(kx(t.keyType))return this.getGauge(t);if(vx(t.keyType))return this.getFrequency(t);if(wx(t.keyType))return this.getHistogram(t);if(Rx(t.keyType))return this.getSummary(t);throw new Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/effect/issues")}else return r}getCounter(t){let r=m(this.map,je(t),ut);if(r==null){let o=Jk(t);m(this.map,vr(t))||m(this.map,Ut(t,o)),r=o}return r}getFrequency(t){let r=m(this.map,je(t),ut);if(r==null){let o=Yk(t);m(this.map,vr(t))||m(this.map,Ut(t,o)),r=o}return r}getGauge(t){let r=m(this.map,je(t),ut);if(r==null){let o=Qk(t,t.keyType.bigint?BigInt(0):0);m(this.map,vr(t))||m(this.map,Ut(t,o)),r=o}return r}getHistogram(t){let r=m(this.map,je(t),ut);if(r==null){let o=Zk(t);m(this.map,vr(t))||m(this.map,Ut(t,o)),r=o}return r}getSummary(t){let r=m(this.map,je(t),ut);if(r==null){let o=Xk(t);m(this.map,vr(t))||m(this.map,Ut(t,o)),r=o}return r}},rw=()=>new Hx;var d2="effect/Metric",x2=Symbol.for(d2),g2={_Type:e=>e,_In:e=>e,_Out:e=>e},ow=H(Symbol.for("effect/Metric/globalMetricRegistry"),()=>rw()),nw=function(e,t,r,o){let n=Object.assign(s=>Vt(s,i=>b2(n,i)),{[x2]:g2,keyType:e,unsafeUpdate:t,unsafeValue:r,unsafeModify:o,register(){return this.unsafeValue([]),this},pipe(){return v(this,arguments)}});return n};var va=(e,t)=>sw(Nk(e,t));var sw=e=>{let t,r=new WeakMap,o=n=>{if(n.length===0)return t!==void 0||(t=ow.get(e)),t;let s=r.get(n);return s!==void 0||(s=ow.get(Lk(e,n)),r.set(n,s)),s};return nw(e.keyType,(n,s)=>o(s).update(n),n=>o(n).get(),(n,s)=>o(s).modify(n))};var iw=(e,t,r)=>sw(Pk(e,t,r));var cw=l(3,(e,t,r)=>y2(e,[As(t,r)]));var y2=l(2,(e,t)=>nw(e.keyType,(r,o)=>e.unsafeUpdate(r,gr(t,o)),r=>e.unsafeValue(gr(t,r)),(r,o)=>e.unsafeModify(r,gr(t,o))));var b2=l(2,(e,t)=>pt(Eo,r=>_(()=>e.unsafeUpdate(t,r))));u();var _2="effect/Request",Wx=Symbol.for(_2),E2={_E:e=>e,_A:e=>e},mQ={...pi,[Wx]:E2},aw=e=>k(e,Wx);var Ux=l(2,(e,t)=>pt(Fp,r=>_(()=>{if(r.has(e)){let o=r.get(e);o.state.completed||(o.state.completed=!0,na(o.result,t))}})));var Ki=class{count=0;observers=new Set;interrupted=!1;addObserver(t){this.observers.add(t)}removeObserver(t){this.observers.delete(t)}increment(){this.count++,this.observers.forEach(t=>t(this.count))}decrement(){this.count--,this.observers.forEach(t=>t(this.count))}};u();u();u();u();u();var kn={Forward:0,Backward:1},qp=class e{self;stack;direction;count=0;constructor(t,r,o){this.self=t,this.stack=r,this.direction=o}clone(){return new e(this.self,this.stack.slice(),this.direction)}reversed(){return new e(this.self,this.stack.slice(),this.direction===kn.Forward?kn.Backward:kn.Forward)}next(){let t=this.entry;switch(this.count++,this.direction===kn.Forward?this.moveNext():this.movePrev(),t._tag){case"None":return{done:!0,value:this.count};case"Some":return{done:!1,value:t.value}}}get key(){return this.stack.length>0?E(this.stack[this.stack.length-1].key):S()}get value(){return this.stack.length>0?E(this.stack[this.stack.length-1].value):S()}get entry(){return Le(Su(this.stack),t=>[t.key,t.value])}get index(){let t=0,r=this.stack;if(r.length===0){let o=this.self._root;return o!=null?o.count:0}else r[r.length-1].left!=null&&(t=r[r.length-1].left.count);for(let o=r.length-2;o>=0;--o)r[o+1]===r[o].right&&(++t,r[o].left!=null&&(t+=r[o].left.count));return t}moveNext(){let t=this.stack;if(t.length===0)return;let r=t[t.length-1];if(r.right!=null)for(r=r.right;r!=null;)t.push(r),r=r.left;else for(t.pop();t.length>0&&t[t.length-1].right===r;)r=t[t.length-1],t.pop()}get hasNext(){let t=this.stack;if(t.length===0)return!1;if(t[t.length-1].right!=null)return!0;for(let r=t.length-1;r>0;--r)if(t[r-1].left===t[r])return!0;return!1}movePrev(){let t=this.stack;if(t.length===0)return;let r=t[t.length-1];if(r!=null&&r.left!=null)for(r=r.left;r!=null;)t.push(r),r=r.right;else for(t.pop();t.length>0&&t[t.length-1].left===r;)r=t[t.length-1],t.pop()}get hasPrev(){let t=this.stack;if(t.length===0)return!1;if(t[t.length-1].left!=null)return!0;for(let r=t.length-1;r>0;--r)if(t[r-1].right===t[r])return!0;return!1}};u();var N={Red:0,Black:1},wr=({color:e,count:t,key:r,left:o,right:n,value:s})=>({color:e,key:r,value:s,left:o,right:n,count:t});function Bx(e,t){e.key=t.key,e.value=t.value,e.left=t.left,e.right=t.right,e.color=t.color,e.count=t.count}var Ao=({count:e,key:t,left:r,right:o,value:n},s)=>({color:s,key:t,value:n,left:r,right:o,count:e}),_e=e=>{e.count=1+(e.left?.count??0)+(e.right?.count??0)};var uw="effect/RedBlackTree",jx=Symbol.for(uw),v2={_Key:e=>e,_Value:e=>e},k2={[jx]:v2,[F](){let e=w(uw);for(let t of this)e^=m(w(t[0]),L(w(t[1])));return V(this,e)},[M](e){if(lw(e)){if((this._root?.count??0)!==(e._root?.count??0))return!1;let t=Array.from(e);return Array.from(this).every((r,o)=>{let n=t[o];return C(r[0],n[0])&&C(r[1],n[1])})}return!1},[Symbol.iterator](){let e=[],t=this._root;for(;t!=null;)e.push(t),t=t.left;return new qp(this,e,kn.Forward)},toString(){return re(this.toJSON())},toJSON(){return{_id:"RedBlackTree",values:Array.from(this).map(Y)}},[z](){return this.toJSON()},pipe(){return v(this,arguments)}},ka=(e,t)=>{let r=Object.create(k2);return r._ord=e,r._root=t,r},lw=e=>k(e,jx);var pw=l(2,(e,t)=>{let r=e._ord,o=e._root;for(;o!==void 0;){let n=r(t,o.key);if(C(t,o.key))return E(o.value);n<=0?o=o.left:o=o.right}return S()});var zx=l(2,(e,t)=>U(pw(e,t))),fw=l(3,(e,t,r)=>{let o=e._ord,n=e._root,s=[],i=[];for(;n!=null;){let c=o(t,n.key);s.push(n),i.push(c),c<=0?n=n.left:n=n.right}s.push({color:N.Red,key:t,value:r,left:void 0,right:void 0,count:1});for(let c=s.length-2;c>=0;--c){let a=s[c];i[c]<=0?s[c]={color:a.color,key:a.key,value:a.value,left:s[c+1],right:a.right,count:a.count+1}:s[c]={color:a.color,key:a.key,value:a.value,left:a.left,right:s[c+1],count:a.count+1}}for(let c=s.length-1;c>1;--c){let a=s[c-1],p=s[c];if(a.color===N.Black||p.color===N.Black)break;let f=s[c-2];if(f.left===a)if(a.left===p){let h=f.right;if(h&&h.color===N.Red)a.color=N.Black,f.right=Ao(h,N.Black),f.color=N.Red,c-=1;else{if(f.color=N.Red,f.left=a.right,a.color=N.Black,a.right=f,s[c-2]=a,s[c-1]=p,_e(f),_e(a),c>=3){let d=s[c-3];d.left===f?d.left=a:d.right=a}break}}else{let h=f.right;if(h&&h.color===N.Red)a.color=N.Black,f.right=Ao(h,N.Black),f.color=N.Red,c-=1;else{if(a.right=p.left,f.color=N.Red,f.left=p.right,p.color=N.Black,p.left=a,p.right=f,s[c-2]=p,s[c-1]=a,_e(f),_e(a),_e(p),c>=3){let d=s[c-3];d.left===f?d.left=p:d.right=p}break}}else if(a.right===p){let h=f.left;if(h&&h.color===N.Red)a.color=N.Black,f.left=Ao(h,N.Black),f.color=N.Red,c-=1;else{if(f.color=N.Red,f.right=a.left,a.color=N.Black,a.left=f,s[c-2]=a,s[c-1]=p,_e(f),_e(a),c>=3){let d=s[c-3];d.right===f?d.right=a:d.left=a}break}}else{let h=f.left;if(h&&h.color===N.Red)a.color=N.Black,f.left=Ao(h,N.Black),f.color=N.Red,c-=1;else{if(a.left=p.right,f.color=N.Red,f.right=p.left,p.color=N.Black,p.right=a,p.left=f,s[c-2]=p,s[c-1]=a,_e(f),_e(a),_e(p),c>=3){let d=s[c-3];d.right===f?d.right=p:d.left=p}break}}}return s[0].color=N.Black,ka(e._ord,s[0])}),mw=e=>hw(e,kn.Forward);var hw=(e,t)=>{let r=e[Symbol.iterator](),o=0;return{[Symbol.iterator]:()=>hw(e,t),next:()=>{o++;let n=r.key;switch(t===kn.Forward?r.moveNext():r.movePrev(),n._tag){case"None":return{done:!0,value:o};case"Some":return{done:!1,value:n.value}}}}};var dw=l(2,(e,t)=>{if(!zx(e,t))return e;let r=e._ord,o=r,n=e._root,s=[];for(;n!==void 0;){let a=o(t,n.key);s.push(n),C(t,n.key)?n=void 0:a<=0?n=n.left:n=n.right}if(s.length===0)return e;let i=new Array(s.length),c=s[s.length-1];i[i.length-1]={color:c.color,key:c.key,value:c.value,left:c.left,right:c.right,count:c.count};for(let a=s.length-2;a>=0;--a)c=s[a],c.left===s[a+1]?i[a]={color:c.color,key:c.key,value:c.value,left:i[a+1],right:c.right,count:c.count}:i[a]={color:c.color,key:c.key,value:c.value,left:c.left,right:i[a+1],count:c.count};if(c=i[i.length-1],c.left!==void 0&&c.right!==void 0){let a=i.length;for(c=c.left;c.right!=null;)i.push(c),c=c.right;let p=i[a-1];i.push({color:c.color,key:p.key,value:p.value,left:c.left,right:c.right,count:c.count}),i[a-1].key=c.key,i[a-1].value=c.value;for(let f=i.length-2;f>=a;--f)c=i[f],i[f]={color:c.color,key:c.key,value:c.value,left:c.left,right:i[f+1],count:c.count};i[a-1].left=i[a]}if(c=i[i.length-1],c.color===N.Red){let a=i[i.length-2];a.left===c?a.left=void 0:a.right===c&&(a.right=void 0),i.pop();for(let p=0;p<i.length;++p)i[p].count--;return ka(r,i[0])}else if(c.left!==void 0||c.right!==void 0){c.left!==void 0?Bx(c,c.left):c.right!==void 0&&Bx(c,c.right),c.color=N.Black;for(let a=0;a<i.length-1;++a)i[a].count--;return ka(r,i[0])}else{if(i.length===1)return ka(r,void 0);{for(let p=0;p<i.length;++p)i[p].count--;let a=i[i.length-2];w2(i),a.left===c?a.left=void 0:a.right=void 0}}return ka(r,i[0])});var w2=e=>{let t,r,o,n;for(let s=e.length-1;s>=0;--s){if(t=e[s],s===0){t.color=N.Black;return}if(r=e[s-1],r.left===t){if(o=r.right,o!==void 0&&o.right!==void 0&&o.right.color===N.Red){if(o=r.right=wr(o),n=o.right=wr(o.right),r.right=o.left,o.left=r,o.right=n,o.color=r.color,t.color=N.Black,r.color=N.Black,n.color=N.Black,_e(r),_e(o),s>1){let i=e[s-2];i.left===r?i.left=o:i.right=o}e[s-1]=o;return}else if(o!==void 0&&o.left!==void 0&&o.left.color===N.Red){if(o=r.right=wr(o),n=o.left=wr(o.left),r.right=n.left,o.left=n.right,n.left=r,n.right=o,n.color=r.color,r.color=N.Black,o.color=N.Black,t.color=N.Black,_e(r),_e(o),_e(n),s>1){let i=e[s-2];i.left===r?i.left=n:i.right=n}e[s-1]=n;return}if(o!==void 0&&o.color===N.Black)if(r.color===N.Red){r.color=N.Black,r.right=Ao(o,N.Red);return}else{r.right=Ao(o,N.Red);continue}else if(o!==void 0){if(o=wr(o),r.right=o.left,o.left=r,o.color=r.color,r.color=N.Red,_e(r),_e(o),s>1){let i=e[s-2];i.left===r?i.left=o:i.right=o}e[s-1]=o,e[s]=r,s+1<e.length?e[s+1]=t:e.push(t),s=s+2}}else{if(o=r.left,o!==void 0&&o.left!==void 0&&o.left.color===N.Red){if(o=r.left=wr(o),n=o.left=wr(o.left),r.left=o.right,o.right=r,o.left=n,o.color=r.color,t.color=N.Black,r.color=N.Black,n.color=N.Black,_e(r),_e(o),s>1){let i=e[s-2];i.right===r?i.right=o:i.left=o}e[s-1]=o;return}else if(o!==void 0&&o.right!==void 0&&o.right.color===N.Red){if(o=r.left=wr(o),n=o.right=wr(o.right),r.left=n.right,o.right=n.left,n.right=r,n.left=o,n.color=r.color,r.color=N.Black,o.color=N.Black,t.color=N.Black,_e(r),_e(o),_e(n),s>1){let i=e[s-2];i.right===r?i.right=n:i.left=n}e[s-1]=n;return}if(o!==void 0&&o.color===N.Black)if(r.color===N.Red){r.color=N.Black,r.left=Ao(o,N.Red);return}else{r.left=Ao(o,N.Red);continue}else if(o!==void 0){if(o=wr(o),r.left=o.right,o.right=r,o.color=r.color,r.color=N.Red,_e(r),_e(o),s>1){let i=e[s-2];i.right===r?i.right=o:i.left=o}e[s-1]=o,e[s]=r,s+1<e.length?e[s+1]=t:e.push(t),s=s+2}}}};var xw=zx,gw=fw,yw=mw;var bw=dw;var Gx=Symbol.for("effect/SortedSet"),M2={[Gx]:{_A:e=>e},[F](){return m(w(this.keyTree),L(w(Gx)),V(this))},[M](e){return F2(e)&&C(this.keyTree,e.keyTree)},[Symbol.iterator](){return yw(this.keyTree)},toString(){return re(this.toJSON())},toJSON(){return{_id:"SortedSet",values:Array.from(this).map(Y)}},[z](){return this.toJSON()},pipe(){return v(this,arguments)}},_w=e=>{let t=Object.create(M2);return t.keyTree=e,t},F2=e=>k(e,Gx);var Ew=l(2,(e,t)=>xw(e.keyTree,t)?e:_w(gw(e.keyTree,t,!0)));var Ow=l(2,(e,t)=>_w(bw(e.keyTree,t)));var T2="effect/Supervisor",Qi=Symbol.for(T2),wa={_T:e=>e},Ji=class e{underlying;value0;[Qi]=wa;constructor(t,r){this.underlying=t,this.value0=r}get value(){return this.value0}onStart(t,r,o,n){this.underlying.onStart(t,r,o,n)}onEnd(t,r){this.underlying.onEnd(t,r)}onEffect(t,r){this.underlying.onEffect(t,r)}onSuspend(t){this.underlying.onSuspend(t)}onResume(t){this.underlying.onResume(t)}map(t){return new e(this,m(this.value,O(t)))}zip(t){return new Yi(this,t)}},Yi=class e{left;right;_tag="Zip";[Qi]=wa;constructor(t,r){this.left=t,this.right=r}get value(){return xs(this.left.value,this.right.value)}onStart(t,r,o,n){this.left.onStart(t,r,o,n),this.right.onStart(t,r,o,n)}onEnd(t,r){this.left.onEnd(t,r),this.right.onEnd(t,r)}onEffect(t,r){this.left.onEffect(t,r),this.right.onEffect(t,r)}onSuspend(t){this.left.onSuspend(t),this.right.onSuspend(t)}onResume(t){this.left.onResume(t),this.right.onResume(t)}map(t){return new Ji(this,m(this.value,O(t)))}zip(t){return new e(this,t)}},Kx=e=>k(e,Qi)&&Dn(e,"Zip"),$x=class{[Qi]=wa;fibers=new Set;get value(){return _(()=>Array.from(this.fibers))}onStart(t,r,o,n){this.fibers.add(n)}onEnd(t,r){this.fibers.delete(r)}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new Ji(this,m(this.value,O(t)))}zip(t){return new Yi(this,t)}onRun(t,r){return t()}},Vx=class{effect;[Qi]=wa;constructor(t){this.effect=t}get value(){return this.effect}onStart(t,r,o,n){}onEnd(t,r){}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new Ji(this,m(this.value,O(t)))}zip(t){return new Yi(this,t)}onRun(t,r){return t()}},vw=class{ref;[Qi]=wa;constructor(t){this.ref=t}get value(){return _(()=>Dt(this.ref))}onStart(t,r,o,n){m(this.ref,nr(m(Dt(this.ref),Ew(n))))}onEnd(t,r){m(this.ref,nr(m(Dt(this.ref),Ow(r))))}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new Ji(this,m(this.value,O(t)))}zip(t){return new Yi(this,t)}onRun(t,r){return t()}},A2=()=>new $x,kw=_(A2),I2=e=>new Vx(e),js=H("effect/Supervisor/none",()=>I2(q));u();u();var ww=tn;var Mw="Empty",Fw="AddSupervisor",Tw="RemoveSupervisor",Aw="AndThen",Zi={_tag:Mw},Wp=(e,t)=>({_tag:Aw,first:e,second:t}),N2=(e,t)=>P2(t,Re(e)),P2=(e,t)=>{let r=e,o=t;for(;Ze(o);){let n=Je(o);switch(n._tag){case Mw:{o=ot(o);break}case Fw:{r=r.zip(n.supervisor),o=ot(o);break}case Tw:{r=Jx(r,n.supervisor),o=ot(o);break}case Aw:{o=Ke(n.first)(Ke(n.second)(ot(o)));break}}}return r},Jx=(e,t)=>C(e,t)?js:Kx(e)?Jx(e.left,t).zip(Jx(e.right,t)):e,Up=e=>C(e,js)?Dr():Kx(e)?m(Up(e.left),po(Up(e.right))):Jn(e),L2=(e,t)=>{if(C(e,t))return Zi;let r=Up(e),o=Up(t),n=m(o,Lm(r),Zn(Zi,(i,c)=>Wp(i,{_tag:Fw,supervisor:c}))),s=m(r,Lm(o),Zn(Zi,(i,c)=>Wp(i,{_tag:Tw,supervisor:c})));return Wp(n,s)},Iw=ww({empty:Zi,patch:N2,combine:Wp,diff:L2});var q2=va("effect_fiber_started",{incremental:!0}),Nw=va("effect_fiber_active"),H2=va("effect_fiber_successes",{incremental:!0}),W2=va("effect_fiber_failures",{incremental:!0}),U2=cw(iw("effect_fiber_lifetimes",_k({start:.5,factor:2,count:35})),"time_unit","milliseconds"),Ra="Continue",B2="Done",Pw="Yield",j2={_E:e=>e,_A:e=>e},Ma=e=>{throw new Error(`BUG: FiberRuntime - ${zo(e)} - please report an issue at https://github.com/Effect-TS/effect/issues`)},wn=Symbol.for("effect/internal/fiberRuntime/YieldedOp"),Io=H("effect/internal/fiberRuntime/yieldedOpChannel",()=>({currentOp:null})),Bp={[ci]:(e,t,r)=>Ae(()=>t.effect_instruction_i1(r)),OnStep:(e,t,r)=>le(le(r)),[ai]:(e,t,r)=>Ae(()=>t.effect_instruction_i2(r)),[yc]:(e,t,r)=>(e.patchRuntimeFlags(e.currentRuntimeFlags,t.patch),ho(e.currentRuntimeFlags)&&e.isInterrupted()?ie(e.getInterruptedCause()):le(r)),[ui]:(e,t,r)=>(Ae(()=>t.effect_instruction_i2(r)),Ae(()=>t.effect_instruction_i0())?(e.pushStack(t),Ae(()=>t.effect_instruction_i1())):q)},z2={[Tp]:(e,t,r,o)=>(e.processNewInterruptSignal(o.cause),ho(t)?ie(o.cause):r),[Ip]:(e,t,r,o)=>{throw new Error("It is illegal to have multiple concurrent run loops in a single fiber")},[Ap]:(e,t,r,o)=>(o.onFiber(e,Zd(t)),r),[Np]:(e,t,r,o)=>x(Vr(),()=>r)},G2=e=>Ht(e_(e),t=>Gs(r_(t),([r,o])=>{let n=new Map,s=[];for(let c of o){s.push(rr(c));for(let a of c)n.set(a.request,a)}let i=s.flat();return He(cq(r.runAll(s),i,()=>i.forEach(c=>{c.listeners.interrupted=!0})),Fp,n)},!1,!1)),Fa=class extends Mo{[ga]=ya;[fk]=j2;_fiberRefs;_fiberId;_queue=new Array;_children=null;_observers=new Array;_running=!1;_stack=[];_asyncInterruptor=null;_asyncBlockingOn=null;_exitValue=null;_steps=[];_isYielding=!1;currentRuntimeFlags;currentOpCount=0;currentSupervisor;currentScheduler;currentTracer;currentSpan;currentContext;currentDefaultServices;constructor(t,r,o){if(super(),this.currentRuntimeFlags=o,this._fiberId=t,this._fiberRefs=r,ih(o)){let n=this.getFiberRef(Eo);q2.unsafeUpdate(1,n),Nw.unsafeUpdate(1,n)}this.refreshRefCache()}commit(){return kr(this)}id(){return this._fiberId}resume(t){this.tell(Us(t))}get status(){return this.ask((t,r)=>r)}get runtimeFlags(){return this.ask((t,r)=>Wv(r)?t.currentRuntimeFlags:r.runtimeFlags)}scope(){return lk(this)}get children(){return this.ask(t=>Array.from(t.getChildren()))}getChildren(){return this._children===null&&(this._children=new Set),this._children}getInterruptedCause(){return this.getFiberRef(_s)}fiberRefs(){return this.ask(t=>t.getFiberRefs())}ask(t){return T(()=>{let r=ta(this._fiberId);return this.tell(Vi((o,n)=>{na(r,_(()=>t(o,n)))})),tt(r)})}tell(t){this._queue.push(t),this._running||(this._running=!0,this.drainQueueLaterOnExecutor())}get await(){return qe(t=>{let r=o=>t(y(o));return this.tell(Vi((o,n)=>{o._exitValue!==null?r(this._exitValue):o.addObserver(r)})),_(()=>this.tell(Vi((o,n)=>{o.removeObserver(r)})))},this.id())}get inheritAll(){return X((t,r)=>{let o=t.id(),n=t.getFiberRefs(),s=r.runtimeFlags,i=this.getFiberRefs(),c=Zl(n,o,i);t.setFiberRefs(c);let a=t.getFiberRef(qw),p=m(sr(s,a),lh(Ur),lh(sl));return dn(p)})}get poll(){return _(()=>dr(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(t){return _(()=>this.tell(Pp($t(t))))}unsafeInterruptAsFork(t){this.tell(Pp($t(t)))}addObserver(t){this._exitValue!==null?t(this._exitValue):this._observers.push(t)}removeObserver(t){this._observers=this._observers.filter(r=>r!==t)}getFiberRefs(){return this.setFiberRef(qw,this.currentRuntimeFlags),this._fiberRefs}unsafeDeleteFiberRef(t){this._fiberRefs=ia(this._fiberRefs,t)}getFiberRef(t){return this._fiberRefs.locals.has(t)?this._fiberRefs.locals.get(t)[0][1]:t.initial}setFiberRef(t,r){this._fiberRefs=Wi(this._fiberRefs,{fiberId:this._fiberId,fiberRef:t,value:r}),this.refreshRefCache()}refreshRefCache(){this.currentDefaultServices=this.getFiberRef(We),this.currentTracer=this.currentDefaultServices.unsafeMap.get(ko.key),this.currentSupervisor=this.getFiberRef(ng),this.currentScheduler=this.getFiberRef(Ws),this.currentContext=this.getFiberRef(wt),this.currentSpan=this.currentContext.unsafeMap.get(Jr.key)}setFiberRefs(t){this._fiberRefs=t,this.refreshRefCache()}addChild(t){this.getChildren().add(t)}removeChild(t){this.getChildren().delete(t)}drainQueueOnCurrentThread(){let t=!0;for(;t;){let r=Ra,o=globalThis[vn];globalThis[vn]=this;try{for(;r===Ra;)r=this._queue.length===0?B2:this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[vn]=o}this._queue.length>0&&!this._running?(this._running=!0,r===Pw?(this.drainQueueLaterOnExecutor(),t=!1):t=!0):t=!1}}drainQueueLaterOnExecutor(){this.currentScheduler.scheduleTask(this.run,this.getFiberRef(_o))}drainQueueWhileRunning(t,r){let o=r;for(;this._queue.length>0;){let n=this._queue.splice(0,1)[0];o=z2[n._tag](this,t,o,n)}return o}isInterrupted(){return!pl(this.getFiberRef(_s))}addInterruptedCause(t){let r=this.getFiberRef(_s);this.setFiberRef(_s,Ue(r,t))}processNewInterruptSignal(t){this.addInterruptedCause(t),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(this._children===null||this._children.size===0)return!1;let t=!1;for(let r of this._children)r.tell(Pp($t(this.id()))),t=!0;return t}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){let t=this._children.values();this._children=null;let r=!1;return Ii({while:()=>!r,body:()=>{let n=t.next();return n.done?_(()=>{r=!0}):Ce(n.value.await)},step:()=>{}})}return null}reportExitValue(t){if(ih(this.currentRuntimeFlags)){let r=this.getFiberRef(Eo),o=this.id().startTimeMillis,n=Date.now();switch(U2.unsafeUpdate(n-o,r),Nw.unsafeUpdate(-1,r),t._tag){case Ne:{H2.unsafeUpdate(1,r);break}case Ie:{W2.unsafeUpdate(1,r);break}}}if(t._tag==="Failure"){let r=this.getFiberRef(Ah);!ls(t.cause)&&r._tag==="Some"&&this.log("Fiber terminated with an unhandled error",t.cause,r)}}setExitValue(t){this._exitValue=t,this.reportExitValue(t);for(let r=this._observers.length-1;r>=0;r--)this._observers[r](t)}getLoggers(){return this.getFiberRef(Y2)}log(t,r,o){let n=U(o)?o.value:this.getFiberRef(Mh),s=this.getFiberRef($2);if(hO(s,n))return;let i=this.getFiberRef(Il),c=this.getFiberRef(xn),a=this.getLoggers(),p=this.getFiberRefs();if(Yn(a)>0){let f=Bt(this.getFiberRef(We),Qt),h=new Date(f.unsafeCurrentTimeMillis());Py(p,()=>{for(let d of a)d.log({fiberId:this.id(),logLevel:n,message:t,cause:r,context:p,spans:i,annotations:c,date:h})})}}evaluateMessageWhileSuspended(t){switch(t._tag){case Np:return Pw;case Tp:return this.processNewInterruptSignal(t.cause),this._asyncInterruptor!==null&&(this._asyncInterruptor(ie(t.cause)),this._asyncInterruptor=null),Ra;case Ip:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(t.effect),Ra;case Ap:return t.onFiber(this,this._exitValue!==null?qv:Hv(this.currentRuntimeFlags,this._asyncBlockingOn)),Ra;default:return Ma(t)}}evaluateEffect(t){this.currentSupervisor.onResume(this);try{let r=ho(this.currentRuntimeFlags)&&this.isInterrupted()?ie(this.getInterruptedCause()):t;for(;r!==null;){let o=r,n=this.runLoop(o);if(n===wn){let s=Io.currentOp;Io.currentOp=null,s._op===li?YS(this.currentRuntimeFlags)?(this.tell(ak()),this.tell(Us(Rt)),r=null):r=Rt:s._op===Un&&(r=null)}else{this.currentRuntimeFlags=m(this.currentRuntimeFlags,nh(sl));let s=this.interruptAllChildren();s!==null?r=x(s,()=>n):(this._queue.length===0?this.setExitValue(n):this.tell(Us(n)),r=null)}}}finally{this.currentSupervisor.onSuspend(this)}}start(t){if(this._running)this.tell(Us(t));else{this._running=!0;let r=globalThis[vn];globalThis[vn]=this;try{this.evaluateEffect(t)}finally{this._running=!1,globalThis[vn]=r,this._queue.length>0&&this.drainQueueLaterOnExecutor()}}}startFork(t){this.tell(Us(t))}patchRuntimeFlags(t,r){let o=xo(t,r);return globalThis[vn]=this,this.currentRuntimeFlags=o,o}initiateAsync(t,r){let o=!1,n=s=>{o||(o=!0,this.tell(Us(s)))};ho(t)&&(this._asyncInterruptor=n);try{r(n)}catch(s){n(Q(lt(s)))}}pushStack(t){this._stack.push(t),t._op==="OnStep"&&this._steps.push({refs:this.getFiberRefs(),flags:this.currentRuntimeFlags})}popStack(){let t=this._stack.pop();if(t)return t._op==="OnStep"&&this._steps.pop(),t}getNextSuccessCont(){let t=this.popStack();for(;t;){if(t._op!==ii)return t;t=this.popStack()}}getNextFailCont(){let t=this.popStack();for(;t;){if(t._op!==ci&&t._op!==ui)return t;t=this.popStack()}}[Dy](t){return _(()=>Gn(this.currentContext,t))}Left(t){return $(t.left)}None(t){return $(new Jt)}Right(t){return le(t.right)}Some(t){return le(t.value)}Micro(t){return El(r=>{let o=Yv().pipe(Qv(Xv,this.getFiberRef(wt))),n=r;return t[ft](o,s=>{if(s._tag==="Right")return n(le(s.right));switch(s.left._tag){case"Interrupt":return n(ie($t(Gt)));case"Fail":return n($(s.left.error));case"Die":return n(bo(s.left.defect))}}),qe(s=>{n=i=>{s(q)},On(o,wp).abort()})})}[lu](t){let r=Ae(()=>t.effect_instruction_i0()),o=this.getNextSuccessCont();return o!==void 0?(o._op in Bp||Ma(o),Bp[o._op](this,o,r)):(Io.currentOp=le(r),wn)}[Ne](t){let r=t,o=this.getNextSuccessCont();return o!==void 0?(o._op in Bp||Ma(o),Bp[o._op](this,o,r.effect_instruction_i0)):(Io.currentOp=r,wn)}[Ie](t){let r=t.effect_instruction_i0,o=this.getNextFailCont();if(o!==void 0)switch(o._op){case ii:case ai:return ho(this.currentRuntimeFlags)&&this.isInterrupted()?ie(hl(r)):Ae(()=>o.effect_instruction_i1(r));case"OnStep":return ho(this.currentRuntimeFlags)&&this.isInterrupted()?ie(hl(r)):le(ie(r));case yc:return this.patchRuntimeFlags(this.currentRuntimeFlags,o.patch),ho(this.currentRuntimeFlags)&&this.isInterrupted()?ie(Ue(r,this.getInterruptedCause())):ie(r);default:Ma(o)}else return Io.currentOp=ie(r),wn}[pu](t){return Ae(()=>t.effect_instruction_i0(this,Zd(this.currentRuntimeFlags)))}Blocked(t){let r=this.getFiberRefs(),o=this.currentRuntimeFlags;if(this._steps.length>0){let n=[],s=this._steps[this._steps.length-1],i=this.popStack();for(;i&&i._op!=="OnStep";)n.push(i),i=this.popStack();this.setFiberRefs(s.refs),this.currentRuntimeFlags=s.flags;let c=Ls(s.refs,r),a=sr(s.flags,o);return le(go(t.effect_instruction_i0,X(p=>{for(;n.length>0;)p.pushStack(n.pop());return p.setFiberRefs(Ds(p.id(),p.getFiberRefs())(c)),p.currentRuntimeFlags=xo(a)(p.currentRuntimeFlags),t.effect_instruction_i1})))}return ke(n=>x($s(_l(t.effect_instruction_i0)),()=>n(t.effect_instruction_i1)))}RunBlocked(t){return G2(t.effect_instruction_i0)}[oo](t){let r=t.effect_instruction_i0,o=this.currentRuntimeFlags,n=xo(o,r);if(ho(n)&&this.isInterrupted())return ie(this.getInterruptedCause());if(this.patchRuntimeFlags(this.currentRuntimeFlags,r),t.effect_instruction_i1){let s=sr(n,o);return this.pushStack(new gl(s,t)),Ae(()=>t.effect_instruction_i1(o))}else return Rt}[ci](t){return this.pushStack(t),t.effect_instruction_i0}OnStep(t){return this.pushStack(t),t.effect_instruction_i0}[ii](t){return this.pushStack(t),t.effect_instruction_i0}[ai](t){return this.pushStack(t),t.effect_instruction_i0}[Un](t){return this._asyncBlockingOn=t.effect_instruction_i1,this.initiateAsync(this.currentRuntimeFlags,t.effect_instruction_i0),Io.currentOp=t,wn}[li](t){return this._isYielding=!1,Io.currentOp=t,wn}[ui](t){let r=t.effect_instruction_i0,o=t.effect_instruction_i1;return r()?(this.pushStack(t),o()):Rt}[si](t){return Ae(()=>t.commit())}runLoop(t){let r=t;for(this.currentOpCount=0;;){if(this.currentRuntimeFlags&JS&&this.currentSupervisor.onEffect(this,r),this._queue.length>0&&(r=this.drainQueueWhileRunning(this.currentRuntimeFlags,r)),!this._isYielding){this.currentOpCount+=1;let o=this.currentScheduler.shouldYield(this);if(o!==!1){this._isYielding=!0,this.currentOpCount=0;let n=r;r=x(Vr({priority:o}),()=>n)}}try{if((!("_op"in r)||!(r._op in this))&&Ma(r),r=this.currentTracer.context(()=>Pn()!==r[yo]._V?an(`Cannot execute an Effect versioned ${r[yo]._V} with a Runtime of version ${Pn()}`):this[r._op](r),this),r===wn){let o=Io.currentOp;return o._op===li||o._op===Un?wn:(Io.currentOp=null,o._op===Ne||o._op===Ie?o:ie(lt(o)))}}catch(o){v_(o)?r=ie(o.cause):V_(o)?r=ie(Ue(lt(o),$t(Gt))):r=bo(o)}}}run=()=>{this.drainQueueOnCurrentThread()}},$2=H("effect/FiberRef/currentMinimumLogLevel",()=>Me(dO("Info"))),V2=e=>Dp(t=>{let r=uO(t.context,We);Bt(r,vo).unsafe.log(e.log(t))});var K2=H(Symbol.for("effect/Logger/defaultLogger"),()=>V2(yk));var J2=H(Symbol.for("effect/Logger/tracerLogger"),()=>Dp(({annotations:e,cause:t,context:r,fiberId:o,logLevel:n,message:s})=>{let i=br(Ro(r,wt),Jr);if(i._tag==="None"||i.value._tag==="ExternalSpan")return;let c=Gn(Ro(r,We),Qt),a={};for(let[p,f]of e)a[p]=f;a["effect.fiberId"]=bS(o),a["effect.logLevel"]=n.label,t!==null&&t._tag!=="Empty"&&(a["effect.cause"]=nn(t,{renderErrorCause:!0})),i.value.event(zo(Array.isArray(s)?s[0]:s),c.unsafeCurrentTimeNanos(),a)}));var Y2=H(Symbol.for("effect/FiberRef/currentLoggers"),()=>B_(Jn(K2,J2)));var Ww=function(){if(typeof arguments[0]=="string")return lr(xn,Sr(arguments[0],arguments[1]));let e=Object.entries(arguments[0]);return lr(xn,OS(t=>{for(let r=0;r<e.length;r++){let[o,n]=e[r];Sr(t,o,n)}return t}))},Aa=l(e=>ce(e[0]),(e,t)=>So(Vt(e,r=>Xi(o=>t(r,o))))),Uw=l(e=>ce(e[0]),(e,t)=>pr(e,Xi(r=>t(r)))),Xi=e=>X(t=>{let r=t.getFiberRefs(),o=t.currentRuntimeFlags;return x(og,n=>Es(n,s=>X(i=>{let c=i.getFiberRefs(),a=i.currentRuntimeFlags,p=Ls(c,r),f=sr(a,o),h=Ls(r,c);return i.setFiberRefs(Ds(p,i.id(),r)),pr(Fl(e(s),f),_(()=>{i.setFiberRefs(Ds(h,i.id(),i.getFiberRefs()))}))})))}),Bw=e=>He(zc,E(Cn))(e),Lw=Symbol.for("effect/Effect/existsPar/found"),jw=l(e=>mr(e[0])&&!ce(e[0]),(e,t,r)=>xa(r?.concurrency,()=>T(()=>zw(e[Symbol.iterator](),0,t)),()=>Ye(Zt(e,(o,n)=>vl(t(o,n),{onTrue:()=>$(Lw),onFalse:()=>q}),r),{onFailure:o=>o===Lw?y(!0):$(o),onSuccess:()=>y(!1)}))),zw=(e,t,r)=>{let o=e.next();return o.done?y(!1):m(x(r(o.value,t),n=>n?y(n):zw(e,t+1,r)))},Gw=l(e=>mr(e[0])&&!ce(e[0]),(e,t,r)=>{let o=r?.negate?(n,s)=>O(t(n,s),_b):t;return xa(r?.concurrency,()=>T(()=>te(e).reduceRight((n,s,i)=>Kr(n,T(()=>o(s,i)),(c,a)=>a?[s,...c]:c),_(()=>new Array))),()=>O(Zt(e,(n,s)=>O(o(n,s),i=>i?E(n):S()),r),gb))}),Q2=e=>{if(Array.isArray(e)||mr(e))return[e,S()];let t=Object.keys(e),r=t.length;return[t.map(o=>e[o]),E(o=>{let n={};for(let s=0;s<r;s++)n[t[s]]=o[s];return n})]},Z2=(e,t,r)=>{let o=[];for(let n of e)o.push(zr(n));return x(Zt(o,W,{concurrency:r?.concurrency,batching:r?.batching}),n=>{let s=S(),i=n.length,c=new Array(i),a=new Array(i),p=!1;for(let f=0;f<i;f++){let h=n[f];h._tag==="Left"?(c[f]=E(h.left),p=!0):(a[f]=h.right,c[f]=s)}return p?t._tag==="Some"?$(t.value(c)):$(c):r?.discard?q:t._tag==="Some"?y(t.value(a)):y(a)})},X2=(e,t,r)=>{let o=[];for(let n of e)o.push(zr(n));return r?.discard?Zt(o,W,{concurrency:r?.concurrency,batching:r?.batching,discard:!0}):O(Zt(o,W,{concurrency:r?.concurrency,batching:r?.batching}),n=>t._tag==="Some"?t.value(n):n)},Rn=(e,t)=>{let[r,o]=Q2(e);return t?.mode==="validate"?Z2(r,o,t):t?.mode==="either"?X2(r,o,t):t?.discard!==!0&&o._tag==="Some"?O(Zt(r,W,t),o.value):Zt(r,W,t)},$w=e=>t=>Rn(t,e),Vw=(e,t)=>O(Rn(te(e).map(ve),t),hi(r=>Wl(r)?E(r.effect_instruction_i0):S())),Qx=l(2,(e,t)=>Array.from({length:t},()=>e)),Kw=l(e=>ce(e[0]),(e,t,r)=>Rn(Qx(e,t),r)),Zt=l(e=>mr(e[0]),(e,t,r)=>X(o=>{let n=r?.batching===!0||r?.batching==="inherit"&&o.getFiberRef(Th);return r?.discard?lx(r.concurrency,()=>zs(gp,r?.concurrentFinalizers)(s=>n?Gs(e,(i,c)=>s(t(i,c)),!0,!1,1):Ht(e,(i,c)=>s(t(i,c)))),()=>zs(yp,r?.concurrentFinalizers)(s=>Gs(e,(i,c)=>s(t(i,c)),n,!1)),s=>zs(bp(s),r?.concurrentFinalizers)(i=>Gs(e,(c,a)=>i(t(c,a)),n,!1,s))):lx(r?.concurrency,()=>zs(gp,r?.concurrentFinalizers)(s=>n?Yx(e,1,(i,c)=>s(t(i,c)),!0):nt(e,(i,c)=>s(t(i,c)))),()=>zs(yp,r?.concurrentFinalizers)(s=>jp(e,(i,c)=>s(t(i,c)),n)),s=>zs(bp(s),r?.concurrentFinalizers)(i=>Yx(e,s,(c,a)=>i(t(c,a)),n)))})),jp=(e,t,r)=>T(()=>{let o=te(e),n=new Array(o.length);return oe(Gs(o,(i,c)=>x(t(i,c),a=>_(()=>n[c]=a)),r,!1),y(n))}),Gs=(e,t,r,o,n)=>ke(s=>Ml(i=>X(c=>{let a=Array.from(e).reverse(),p=a.length;if(p===0)return q;let f=0,h=!1,d=n?Math.min(a.length,n):a.length,g=new Set,b=new Array,R=()=>g.forEach(Qe=>{Qe.currentScheduler.scheduleTask(()=>{Qe.unsafeInterruptAsFork(c.id())},0)}),I=new Array,P=new Array,K=new Array,ue=()=>{let Qe=b.filter(({exit:D})=>D._tag==="Failure").sort((D,Z)=>D.index<Z.index?-1:D.index===Z.index?0:1).map(({exit:D})=>D);return Qe.length===0&&Qe.push(Rt),Qe},Se=(Qe,D=!1)=>{let Z=So(i(Qe)),j=eq(Z,c,c.currentRuntimeFlags,Cn);return c.currentScheduler.scheduleTask(()=>{D&&j.unsafeInterruptAsFork(c.id()),j.resume(Z)},0),j},at=()=>{o||(p-=a.length,a=[]),h=!0,R()},er=r?Cl:ve,Wo=Se(qe(Qe=>{let D=(j,me)=>{j._op==="Blocked"?K.push(j):(b.push({index:me,exit:j}),j._op==="Failure"&&!h&&at())},Z=()=>{if(a.length>0){let j=a.pop(),me=f++,Te=()=>{let ee=a.pop();return me=f++,x(Vr(),()=>x(er(s(t(ee,me))),ye))},ye=ee=>a.length>0&&(D(ee,me),a.length>0)?Te():y(ee),he=x(er(s(t(j,me))),ye),se=Se(he);I.push(se),g.add(se),h&&se.currentScheduler.scheduleTask(()=>{se.unsafeInterruptAsFork(c.id())},0),se.addObserver(ee=>{let we;if(ee._op==="Failure"?we=ee:we=ee.effect_instruction_i0,P.push(se),g.delete(se),D(we,me),b.length===p)Qe(y(De(yn(ue(),{parallel:!0}),()=>Rt)));else if(K.length+b.length===p){let de=K.map(Zs=>Zs.effect_instruction_i0).reduce(hh);Qe(y(go(de,Gs([De(yn(ue(),{parallel:!0}),()=>Rt),...K.map(Zs=>Zs.effect_instruction_i1)],Zs=>Zs,r,!0,n))))}else Z()})}};for(let j=0;j<d;j++)Z()}));return Ce(gt(kt(s(kr(Wo))),Pi({onFailure:()=>{at();let Qe=K.length+1,D=Math.min(typeof n=="number"?n:K.length,K.length),Z=Array.from(K);return qe(j=>{let me=[],Te=0,ye=0,he=(ee,we)=>de=>{me[ee]=de,Te++,Te===Qe&&j(Sc(yn(me,{parallel:!0}))),Z.length>0&&we&&se()},se=()=>{Se(Z.pop(),!0).addObserver(he(ye,!0)),ye++};Wo.addObserver(he(ye,!1)),ye++;for(let ee=0;ee<D;ee++)se()})},onSuccess:()=>nt(P,Qe=>Qe.inheritAll)})))}))),Yx=(e,t,r,o)=>T(()=>{let n=te(e),s=new Array(n.length);return oe(Gs(n,(c,a)=>O(r(c,a),p=>s[a]=p),o,!1,t),y(s))}),ur=e=>X((t,r)=>y(Yw(e,t,r.runtimeFlags))),$s=e=>tq(e,Cn),Jw=l(2,(e,t)=>ur(Rl(e,r=>{let o=Br(r);switch(o._tag){case"Left":return t(o.left);case"Right":return Q(o.right)}}))),Yw=(e,t,r,o=null)=>{let n=zp(e,t,r,o);return n.resume(e),n},eq=(e,t,r,o=null)=>zp(e,t,r,o),zp=(e,t,r,o=null)=>{let n=Ju(),s=t.getFiberRefs(),i=ud(s,n),c=new Fa(n,i,r),a=Ro(i,wt),p=c.currentSupervisor;return p.onStart(a,e,E(t),c),c.addObserver(h=>p.onEnd(h,c)),(o!==null?o:m(t.getFiberRef(zc),De(()=>t.scope()))).add(r,c),c},tq=(e,t)=>X((r,o)=>y(Yw(e,r,o.runtimeFlags,t))),Zx=l(e=>jo(e[2]),(e,t,r,o)=>xa(o?.concurrency,()=>te(e).reduce((n,s,i)=>Kr(n,s,(c,a)=>r(c,a,i)),y(t)),()=>x(ua(t),n=>x(Zt(e,(s,i)=>x(s,c=>CO(n,a=>r(a,c,i))),o),()=>sp(n))))),Xx=l(e=>mr(e[0]),(e,t,r)=>m(Zt(e,(o,n)=>zr(t(o,n)),r),O(o=>F_(o,W)))),Qw=l(e=>mr(e[0]),(e,t,r)=>x(Xx(e,t,{concurrency:r?.concurrency,batching:r?.batching}),([o,n])=>o.length===0?r?.discard?q:y(n):$(o))),Zw=e=>{let t=Pr(e);if(!Ze(t))return un(()=>new Yc("Received an empty collection of effects"));let r=Je(t),o=ot(t),n=s=>m(mk(s[1]),pe(s[0]));return m(Mt(),x(s=>m(ua(o.length),x(i=>ke(c=>m(ur(Gr(r)),x(a=>m(o,nt(p=>ur(Gr(p))),O(p=>xi(p)),O(p=>m(p,Ke(a))),Vt(p=>m(p,tr(q,(f,h)=>m(f,oe(m(mx(h),x(rq(p,h,s,i)),ur,Ce)))))),x(p=>m(c(m(Rs(s),x(n))),Or(()=>m(p,tr(q,(f,h)=>m(f,gs(bs(h))))))))))))))))},rq=(e,t,r,o)=>n=>vs(n,{onFailure:s=>m(OO(o,i=>[i===0?m(ks(r,s),Ce):q,i-1]),kt),onSuccess:s=>m(oa(r,[s,t]),x(i=>i?m(Pr(e),tr(q,(c,a)=>a===t?c:m(c,gs(bs(a))))):q))}),Xw=l(e=>mr(e[0])&&!ce(e[0]),(e,t,r,o)=>xa(o?.concurrency,()=>te(e).reduce((n,s,i)=>Kr(n,s,(c,a)=>r(c,a,i)),t),()=>T(()=>m(Zx([t,...e],S(),(n,s,i)=>{switch(n._tag){case"None":return E(s);case"Some":return E(r(n.value,s,i))}},o),O(n=>{switch(n._tag){case"None":throw new Error("BUG: Effect.reduceEffect - please report an issue at https://github.com/Effect-TS/effect/issues");case"Some":return n.value}}))))),Gp=e=>ir(t=>Ge(br(t,Mn),{onNone:()=>e,onSome:r=>{switch(r.strategy._tag){case"Parallel":return e;case"Sequential":case"ParallelN":return x(Os(r,yp),o=>Fn(e,o))}}})),Dw=e=>t=>ir(r=>Ge(br(r,Mn),{onNone:()=>t,onSome:o=>o.strategy._tag==="ParallelN"&&o.strategy.parallelism===e?t:x(Os(o,bp(e)),n=>Fn(t,n))})),eR=e=>t=>zs(e,!0)(t),zs=(e,t)=>r=>ir(o=>Ge(br(o,Mn),{onNone:()=>r(W),onSome:n=>{if(t===!0){let s=e._tag==="Parallel"?Gp:e._tag==="Sequential"?$p:Dw(e.parallelism);switch(n.strategy._tag){case"Parallel":return s(r(Gp));case"Sequential":return s(r($p));case"ParallelN":return s(r(Dw(n.strategy.parallelism)))}}else return r(W)}})),Vs=e=>x(Mn,e),eg=e=>x(Ia(),t=>sq(e,t)),$p=e=>ir(t=>Ge(br(t,Mn),{onNone:()=>e,onSome:r=>{switch(r.strategy._tag){case"Sequential":return e;case"Parallel":case"ParallelN":return x(Os(r,gp),o=>Fn(e,o))}}})),tR=(e,t)=>tg([As(e,t)]),tg=e=>lr(Eo,t=>gr(t,e)),rR=l(2,(e,t)=>cn(Ia(),r=>x(Fn(e,r),t),(r,o)=>Oo(r,o))),oR=l(e=>ce(e[1]),(e,t,r)=>rg(e,t,(o,n)=>[o,n],r)),rg=l(e=>ce(e[1]),(e,t,r,o)=>kt(No(ve(e),ve(t),(n,s)=>ea(n,s,{onSuccess:r,onFailure:(i,c)=>o?.concurrent?Ct(i,c):Ue(i,c)}),o)));var nR=l(e=>mr(e[0]),(e,t,r)=>mn(Zt(e,(o,n)=>mn(t(o,n)),r))),sR=e=>lr(We,Oe(Qt,e)),iR=e=>lr(We,Oe(qi,e)),cR=e=>lr(We,Oe(Di,e)),aR=e=>Vs(t=>x(Os(t,Zr),r=>m(e,Fn(r),O(o=>[qt(n=>Oo(r,Ul(n))),o])))),uR=l(e=>ce(e[1]),(e,t,r)=>No(e,t,(o,n)=>[o,n],r)),lR=l(e=>ce(e[1]),(e,t,r)=>r?.concurrent!==!0&&(r?.batching===void 0||r.batching===!1)?gs(e,t):No(e,t,(o,n)=>o,r)),pR=l(e=>ce(e[1]),(e,t,r)=>r?.concurrent!==!0&&(r?.batching===void 0||r.batching===!1)?oe(e,t):No(e,t,(o,n)=>n,r)),No=l(e=>ce(e[1]),(e,t,r,o)=>O(Rn([e,t],{concurrency:o?.concurrent?2:1,batching:o?.batching,concurrentFinalizers:o?.concurrentFinalizers}),([n,s])=>r(n,s))),fR=e=>e===ZS?q:m(Ti,x(t=>{let r=xo(t,e),o=sr(r,t);return m(dn(e),oe(Xi(()=>dn(o))),Ce)}),So),Mn=_t("effect/Scope"),og=Mn,oq=(e,t)=>{e.state._tag==="Open"&&e.state.finalizers.add(t)},nq={[Ll]:Ll,[Dl]:Dl,pipe(){return v(this,arguments)},fork(e){return _(()=>{let t=mR(e);if(this.state._tag==="Closed")return t.state=this.state,t;let r=o=>t.close(o);return this.state.finalizers.add(r),oq(t,o=>_(()=>{this.state._tag==="Open"&&this.state.finalizers.delete(r)})),t})},close(e){return T(()=>{if(this.state._tag==="Closed")return q;let t=Array.from(this.state.finalizers.values()).reverse();return this.state={_tag:"Closed",exit:e},t.length===0?q:$d(this.strategy)?m(nt(t,r=>ve(r(e))),x(r=>m(yn(r),Le(Zc),De(()=>Rt)))):Vd(this.strategy)?m(jp(t,r=>ve(r(e)),!1),x(r=>m(yn(r,{parallel:!0}),Le(Zc),De(()=>Rt)))):m(Yx(t,this.strategy.parallelism,r=>ve(r(e)),!1),x(r=>m(yn(r,{parallel:!0}),Le(Zc),De(()=>Rt))))})},addFinalizer(e){return T(()=>this.state._tag==="Closed"?e(this.state.exit):(this.state.finalizers.add(e),q))}},mR=(e=Zr)=>{let t=Object.create(nq);return t.strategy=e,t.state={_tag:"Open",finalizers:new Set},t},Ia=(e=Zr)=>_(()=>mR(e)),Fn=l(2,(e,t)=>ws(e,co(zn(Mn,t)))),sq=l(2,(e,t)=>m(e,Fn(t),gt(r=>t.close(r)))),iq=e=>Ss(e,{differ:Iw,fork:Zi}),Vp=l(2,(e,t)=>Ce(Aa(x(Kt(e),r=>pe(ms(e,t),r)),r=>ms(e,r)))),lr=l(2,(e,t)=>pt(e,r=>Vp(e,t(r))));var qw=j_(QS),ng=iq(js),hR=e=>Zt(e,mx),sg=e=>({...Sd,commit(){return kr(this)},[ga]:ya,id:()=>te(e).reduce((r,o)=>Bm(r,o.id()),Gt),await:ve(jp(e,r=>kt(r.await),!1)),children:O(jp(e,r=>r.children,!1),_u),inheritAll:Ht(e,r=>r.inheritAll),poll:O(nt(e,r=>r.poll),Eu(E(le(new Array)),(r,o)=>{switch(o._tag){case"None":return S();case"Some":switch(r._tag){case"None":return S();case"Some":return E(ea(o.value,r.value,{onSuccess:(n,s)=>[n,...s],onFailure:Ct}))}}})),interruptAsFork:r=>Ht(e,o=>o.interruptAsFork(r))});var ig=l(3,(e,t,r)=>cg(e,t,{onSelfWin:(o,n)=>x(o.await,s=>{switch(s._tag){case Ne:return x(o.inheritAll,()=>r.onSelfDone(s,n));case Ie:return r.onSelfDone(s,n)}}),onOtherWin:(o,n)=>x(o.await,s=>{switch(s._tag){case Ne:return x(o.inheritAll,()=>r.onOtherDone(s,n));case Ie:return r.onOtherDone(s,n)}})})),dR=e=>ke(t=>qt(r=>x($s(t(e)),o=>m(t(kr(o)),Or(()=>m(o,hk(r))))))),Kp=l(2,(e,t)=>qt(r=>ig(e,t,{onSelfDone:(o,n)=>vs(o,{onFailure:s=>m(kr(n),ji(i=>Ct(s,i))),onSuccess:s=>m(n,Wt(r),pe(s))}),onOtherDone:(o,n)=>vs(o,{onFailure:s=>m(kr(n),ji(i=>Ct(i,s))),onSuccess:s=>m(n,Wt(r),pe(s))})}))),cg=l(3,(e,t,r)=>X((o,n)=>{let s=n.runtimeFlags,i=qr(!0),c=zp(e,o,s,r.selfScope),a=zp(t,o,s,r.otherScope);return qe(p=>{c.addObserver(()=>Hw(c,a,r.onSelfWin,i,p)),a.addObserver(()=>Hw(a,c,r.onOtherWin,i,p)),c.startFork(e),a.startFork(t)},Bm(c.id(),a.id()))})),Hw=(e,t,r,o,n)=>{ju(!0,!1)(o)&&n(r(e,t))},pr=l(2,(e,t)=>ke(r=>be(r(e),{onFailure:o=>be(t,{onFailure:n=>Q(Ue(o,n)),onSuccess:()=>Q(o)}),onSuccess:o=>pe(t,o)}))),cq=(e,t,r)=>qt(o=>x(x($s(Gr(e)),n=>qe(s=>{let i=t.map(p=>p.listeners.count),c=()=>{i.every(p=>p===0)&&t.every(p=>p.result.state.current._tag==="Pending"?!0:!!(p.result.state.current._tag==="Done"&&Qc(p.result.state.current.effect)&&p.result.state.current.effect._tag==="Failure"&&fl(p.result.state.current.effect.cause)))&&(a.forEach(p=>p()),r?.(),s(bs(n)))};n.addObserver(p=>{a.forEach(f=>f()),s(p)});let a=t.map((p,f)=>{let h=d=>{i[f]=d,c()};return p.listeners.addObserver(h),()=>p.listeners.removeObserver(h)});return c(),_(()=>{a.forEach(p=>p())})})),()=>T(()=>{let n=t.flatMap(s=>s.state.completed?[]:[s]);return Ht(n,s=>Ux(s.request,Ul(o)))})));var Ta=(e,t)=>(t=wo(t),So(X(r=>{let o=Gn(r.getFiberRef(wt),Mn),n=dp(r,e,t),s=r.getFiberRef(Ni),i=Bt(r.getFiberRef(We),Qt);return pe(Es(o,c=>zd(n,c,i,s)),n)}))),xR=e=>lr(We,Oe(ko,e)),gR=function(){let e=typeof arguments[0]!="string",t=e?arguments[1]:arguments[0],r=wo(e?arguments[2]:arguments[1]);if(e){let o=arguments[0];return x(Ta(t,wo(r)),n=>zi(o,Jr,n))}return o=>x(Ta(t,wo(r)),n=>zi(o,Jr,n))};var yR=(e,t,r,o)=>Zu({_tag:"Complete",key:e,exit:t,entryStats:r,timeToLiveMillis:o}),bR=(e,t)=>Zu({_tag:"Pending",key:e,deferred:t}),aq=(e,t)=>Zu({_tag:"Refreshing",deferred:e,complete:t}),ag=Symbol.for("effect/Cache/MapKey"),ug=class{current;[ag]=ag;previous=void 0;next=void 0;constructor(t){this.current=t}[F](){return m(w(this.current),L(w(this.previous)),L(w(this.next)),V(this))}[M](t){return this===t?!0:uq(t)&&C(this.current,t.current)&&C(this.previous,t.previous)&&C(this.next,t.next)}},ec=e=>new ug(e),uq=e=>k(e,ag),lg=class{head=void 0;tail=void 0;add(t){if(t!==this.tail)if(this.tail===void 0)this.head=t,this.tail=t;else{let r=t.previous,o=t.next;o!==void 0&&(t.next=void 0,r!==void 0?(r.next=o,o.previous=r):(this.head=o,this.head.previous=void 0)),this.tail.next=t,t.previous=this.tail,this.tail=t}}remove(){let t=this.head;if(t!==void 0){let r=t.next;r!==void 0?(t.next=void 0,this.head=r,this.head.previous=void 0):(this.head=void 0,this.tail=void 0)}return t}},lq=()=>new lg,pq=(e,t,r,o,n,s)=>({map:e,keys:t,accesses:r,updating:o,hits:n,misses:s}),fq=()=>pq(Ms(),lq(),dE(),qr(!1),0,0),mq="effect/Cache",hq=Symbol.for(mq),dq={_Key:e=>e,_Error:e=>e,_Value:e=>e},xq="effect/ConsumerCache",gq=Symbol.for(xq),yq={_Key:e=>e,_Error:e=>e,_Value:e=>e},bq=e=>e,Jp=e=>({loadedMillis:e}),pg=class{capacity;context;fiberId;lookup;timeToLive;[hq]=dq;[gq]=yq;cacheState;constructor(t,r,o,n,s){this.capacity=t,this.context=r,this.fiberId=o,this.lookup=n,this.timeToLive=s,this.cacheState=fq()}get(t){return O(this.getEither(t),gu)}get cacheStats(){return _(()=>bq({hits:this.cacheState.hits,misses:this.cacheState.misses,size:zl(this.cacheState.map)}))}getOption(t){return T(()=>Ge(je(this.cacheState.map,t),{onNone:()=>{let r=ec(t);return this.trackAccess(r),this.trackMiss(),y(S())},onSome:r=>this.resolveMapValue(r)}))}getOptionComplete(t){return T(()=>Ge(je(this.cacheState.map,t),{onNone:()=>{let r=ec(t);return this.trackAccess(r),this.trackMiss(),y(S())},onSome:r=>this.resolveMapValue(r,!0)}))}contains(t){return _(()=>vr(this.cacheState.map,t))}entryStats(t){return _(()=>{let r=je(this.cacheState.map,t);if(U(r))switch(r.value._tag){case"Complete":{let o=r.value.entryStats.loadedMillis;return E(Jp(o))}case"Pending":return S();case"Refreshing":{let o=r.value.complete.entryStats.loadedMillis;return E(Jp(o))}}return S()})}getEither(t){return T(()=>{let r=t,o,n,s=ut(je(this.cacheState.map,r));return s===void 0&&(n=Dh(this.fiberId),o=ec(r),vr(this.cacheState.map,r)?s=ut(je(this.cacheState.map,r)):Ut(this.cacheState.map,r,bR(o,n))),s===void 0?(this.trackAccess(o),this.trackMiss(),O(this.lookupValueOf(t,n),Pe)):x(this.resolveMapValue(s),Ge({onNone:()=>this.getEither(t),onSome:i=>y(bt(i))}))})}invalidate(t){return _(()=>{Fs(this.cacheState.map,t)})}invalidateWhen(t,r){return _(()=>{let o=je(this.cacheState.map,t);U(o)&&o.value._tag==="Complete"&&o.value.exit._tag==="Success"&&r(o.value.exit.value)&&Fs(this.cacheState.map,t)})}get invalidateAll(){return _(()=>{this.cacheState.map=Ms()})}refresh(t){return Qr(r=>T(()=>{let o=t,n=Dh(this.fiberId),s=ut(je(this.cacheState.map,o));if(s===void 0&&(vr(this.cacheState.map,o)?s=ut(je(this.cacheState.map,o)):Ut(this.cacheState.map,o,bR(ec(o),n))),s===void 0)return Ce(this.lookupValueOf(t,n));switch(s._tag){case"Complete":{if(this.hasExpired(r,s.timeToLiveMillis)){let i=ut(je(this.cacheState.map,o));return C(i,s)&&Fs(this.cacheState.map,o),Ce(this.get(t))}return m(this.lookupValueOf(t,n),hp(()=>{let i=ut(je(this.cacheState.map,o));if(C(i,s)){let c=aq(n,s);return Ut(this.cacheState.map,o,c),!0}return!1}),Ce)}case"Pending":return Rs(s.deferred);case"Refreshing":return Rs(s.deferred)}}))}set(t,r){return Qr(o=>_(()=>{let n=o.unsafeCurrentTimeMillis(),s=t,i=sE(r),c=yR(ec(s),i,Jp(n),n+Lr(Xe(this.timeToLive(i))));Ut(this.cacheState.map,s,c)}))}get size(){return _(()=>zl(this.cacheState.map))}get values(){return _(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push(r[1].exit.value);return t})}get entries(){return _(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push([r[0],r[1].exit.value]);return t})}get keys(){return _(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push(r[0]);return t})}resolveMapValue(t,r=!1){return Qr(o=>{switch(t._tag){case"Complete":return this.trackAccess(t.key),this.hasExpired(o,t.timeToLiveMillis)?(Fs(this.cacheState.map,t.key.current),y(S())):(this.trackHit(),O(t.exit,E));case"Pending":return this.trackAccess(t.key),this.trackHit(),r?y(S()):O(Rs(t.deferred),E);case"Refreshing":return this.trackAccess(t.complete.key),this.trackHit(),this.hasExpired(o,t.complete.timeToLiveMillis)?r?y(S()):O(Rs(t.deferred),E):O(t.complete.exit,E)}})}trackHit(){this.cacheState.hits=this.cacheState.hits+1}trackMiss(){this.cacheState.misses=this.cacheState.misses+1}trackAccess(t){if(xE(this.cacheState.accesses,t),ju(this.cacheState.updating,!1,!0)){let r=!0;for(;r;){let n=gE(this.cacheState.accesses,jh);n===jh?r=!1:this.cacheState.keys.add(n)}let o=zl(this.cacheState.map);for(r=o>this.capacity;r;){let n=this.cacheState.keys.remove();n!==void 0?vr(this.cacheState.map,n.current)&&(Fs(this.cacheState.map,n.current),o=o-1,r=o>this.capacity):r=!1}nr(this.cacheState.updating,!1)}}hasExpired(t,r){return t.unsafeCurrentTimeMillis()>r}lookupValueOf(t,r){return Qr(o=>T(()=>{let n=t;return m(this.lookup(t),Cr(this.context),ve,x(s=>{let i=o.unsafeCurrentTimeMillis(),c=Jp(i),a=yR(ec(n),s,c,i+Lr(Xe(this.timeToLive(s))));return Ut(this.cacheState.map,n,a),oe(rE(r,s),s)}),Or(()=>oe(oE(r),_(()=>{Fs(this.cacheState.map,n)}))))}))}};var SR=(e,t,r)=>new pg(e,Et(),$u,t,o=>Xe(r(o)));u();var _R=ls;var ER=Uc;var B={};ky(B,{Do:()=>vU,EffectTypeId:()=>h1,Service:()=>rz,Tag:()=>tz,acquireRelease:()=>iW,acquireReleaseInterruptible:()=>cW,acquireUseRelease:()=>aW,addFinalizer:()=>uW,all:()=>_1,allSuccesses:()=>O1,allWith:()=>E1,allowInterrupt:()=>DH,andThen:()=>$U,annotateCurrentSpan:()=>Wj,annotateLogs:()=>HB,annotateLogsScoped:()=>WB,annotateSpans:()=>Hj,ap:()=>Cj,as:()=>KH,asSome:()=>JH,asSomeError:()=>YH,asVoid:()=>QH,async:()=>$1,asyncEffect:()=>V1,awaitAllChildren:()=>_W,bind:()=>kU,bindAll:()=>wU,bindTo:()=>RU,blocked:()=>vj,cacheRequestResult:()=>Mj,cached:()=>y1,cachedFunction:()=>b1,cachedInvalidateWithTTL:()=>g1,cachedWithTTL:()=>x1,catch:()=>hH,catchAll:()=>dH,catchAllCause:()=>xH,catchAllDefect:()=>gH,catchIf:()=>yH,catchSome:()=>bH,catchSomeCause:()=>SH,catchSomeDefect:()=>_H,catchTag:()=>EH,catchTags:()=>OH,cause:()=>CH,checkInterruptible:()=>qH,clock:()=>zW,clockWith:()=>GW,configProviderWith:()=>cU,console:()=>KW,consoleWith:()=>JW,context:()=>lU,contextWith:()=>pU,contextWithEffect:()=>fU,currentParentSpan:()=>Bj,currentSpan:()=>Uj,custom:()=>K1,daemonChildren:()=>EW,delay:()=>ZW,descriptor:()=>OW,descriptorWith:()=>CW,die:()=>eH,dieMessage:()=>tH,dieSync:()=>rH,diffFiberRefs:()=>vW,disconnect:()=>HH,dropUntil:()=>C1,dropWhile:()=>v1,either:()=>FU,ensuring:()=>lW,ensuringChild:()=>kW,ensuringChildren:()=>wW,eventually:()=>vH,every:()=>k1,exists:()=>w1,exit:()=>TU,fail:()=>Y1,failCause:()=>Z1,failCauseSync:()=>X1,failSync:()=>Q1,fiberId:()=>RW,fiberIdWith:()=>MW,filter:()=>R1,filterMap:()=>M1,filterOrDie:()=>PU,filterOrDieMessage:()=>LU,filterOrElse:()=>DU,filterOrFail:()=>qU,finalizersMask:()=>hW,findFirst:()=>F1,firstSuccessOf:()=>T1,flatMap:()=>GU,flatten:()=>VU,flip:()=>ZH,flipWith:()=>XH,forEach:()=>A1,forever:()=>sB,fork:()=>FW,forkAll:()=>AW,forkDaemon:()=>TW,forkIn:()=>IW,forkScoped:()=>NW,forkWithErrorHandler:()=>PW,fromFiber:()=>LW,fromFiberEffect:()=>DW,fromNullable:()=>Xj,functionWithSpan:()=>Yj,gen:()=>oH,getFiberRefs:()=>dB,getRuntimeFlags:()=>XB,head:()=>I1,if:()=>NU,ignore:()=>kH,ignoreLogged:()=>wH,inheritFiberRefs:()=>xB,interrupt:()=>WH,interruptWith:()=>UH,interruptible:()=>BH,interruptibleMask:()=>jH,intoDeferred:()=>AU,isEffect:()=>d1,isFailure:()=>CB,isSuccess:()=>vB,iterate:()=>iB,labelMetrics:()=>nj,labelMetricsScoped:()=>ij,let:()=>MU,liftPredicate:()=>VH,linkSpans:()=>Gj,locally:()=>gB,locallyScoped:()=>bB,locallyScopedWith:()=>SB,locallyWith:()=>yB,log:()=>FB,logAnnotations:()=>UB,logDebug:()=>IB,logError:()=>LB,logFatal:()=>DB,logInfo:()=>NB,logTrace:()=>AB,logWarning:()=>PB,logWithLevel:()=>TB,loop:()=>cB,makeLatch:()=>fj,makeSemaphore:()=>lj,makeSpan:()=>$j,makeSpanScoped:()=>Vj,map:()=>Qg,mapAccum:()=>eW,mapBoth:()=>tW,mapError:()=>rW,mapErrorCause:()=>oW,mapInputContext:()=>mU,match:()=>kB,matchCause:()=>wB,matchCauseEffect:()=>RB,matchEffect:()=>MB,merge:()=>nW,mergeAll:()=>N1,metricLabels:()=>cj,negate:()=>sW,never:()=>nH,none:()=>sH,onError:()=>pW,onExit:()=>fW,onInterrupt:()=>zH,once:()=>S1,option:()=>IU,optionFromOptional:()=>ez,orDie:()=>jB,orDieWith:()=>zB,orElse:()=>GB,orElseFail:()=>$B,orElseSucceed:()=>VB,parallelErrors:()=>RH,parallelFinalizers:()=>mW,partition:()=>P1,patchFiberRefs:()=>_B,patchRuntimeFlags:()=>ej,promise:()=>iH,provide:()=>hU,provideService:()=>dU,provideServiceEffect:()=>xU,race:()=>JU,raceAll:()=>KU,raceFirst:()=>YU,raceWith:()=>QU,random:()=>KB,randomWith:()=>JB,reduce:()=>L1,reduceEffect:()=>D1,reduceRight:()=>q1,reduceWhile:()=>H1,repeat:()=>aB,repeatN:()=>uB,repeatOrElse:()=>lB,replicate:()=>W1,replicateEffect:()=>U1,request:()=>Rj,retry:()=>FH,retryOrElse:()=>TH,runCallback:()=>hj,runFork:()=>mj,runPromise:()=>dj,runPromiseExit:()=>xj,runRequestBlock:()=>kj,runSync:()=>gj,runSyncExit:()=>yj,runtime:()=>ZB,sandbox:()=>MH,schedule:()=>pB,scheduleForked:()=>fB,scheduleFrom:()=>mB,scope:()=>xW,scopeWith:()=>gW,scoped:()=>yW,sequentialFinalizers:()=>dW,serviceConstants:()=>SU,serviceFunction:()=>gU,serviceFunctionEffect:()=>yU,serviceFunctions:()=>bU,serviceMembers:()=>_U,serviceOption:()=>EU,serviceOptional:()=>OU,setFiberRefs:()=>EB,sleep:()=>XW,spanAnnotations:()=>jj,spanLinks:()=>zj,step:()=>wj,succeed:()=>cH,succeedNone:()=>aH,succeedSome:()=>uH,summarized:()=>ZU,supervised:()=>qW,suspend:()=>lH,sync:()=>pH,tagMetrics:()=>oj,tagMetricsScoped:()=>sj,takeUntil:()=>B1,takeWhile:()=>j1,tap:()=>XU,tapBoth:()=>eB,tapDefect:()=>tB,tapError:()=>rB,tapErrorCause:()=>nB,tapErrorTag:()=>oB,timed:()=>eU,timedWith:()=>tU,timeout:()=>rU,timeoutFail:()=>nU,timeoutFailCause:()=>sU,timeoutOption:()=>oU,timeoutTo:()=>iU,tracer:()=>Ij,tracerWith:()=>Nj,transplant:()=>HW,try:()=>AH,tryMap:()=>IH,tryMapPromise:()=>NH,tryPromise:()=>PH,uninterruptible:()=>GH,uninterruptibleMask:()=>$H,unless:()=>HU,unlessEffect:()=>WU,unsafeMakeLatch:()=>pj,unsafeMakeSemaphore:()=>uj,unsandbox:()=>LH,updateFiberRefs:()=>OB,updateService:()=>CU,useSpan:()=>Kj,using:()=>bW,validate:()=>bj,validateAll:()=>z1,validateFirst:()=>G1,validateWith:()=>Sj,void:()=>fH,when:()=>UU,whenEffect:()=>BU,whenFiberRef:()=>jU,whenRef:()=>zU,whileLoop:()=>hB,withClock:()=>VW,withClockScoped:()=>$W,withConcurrency:()=>WW,withConfigProvider:()=>aU,withConfigProviderScoped:()=>uU,withConsole:()=>QW,withConsoleScoped:()=>YW,withEarlyRelease:()=>SW,withFiberRuntime:()=>J1,withLogSpan:()=>qB,withMaxOpsBeforeYield:()=>jW,withMetric:()=>aj,withParentSpan:()=>Zj,withRandom:()=>YB,withRandomScoped:()=>QB,withRequestBatching:()=>Fj,withRequestCache:()=>Aj,withRequestCaching:()=>Tj,withRuntimeFlagsPatch:()=>tj,withRuntimeFlagsPatchScoped:()=>rj,withScheduler:()=>UW,withSchedulingPriority:()=>BW,withSpan:()=>Jj,withSpanScoped:()=>Qj,withTracer:()=>Pj,withTracerEnabled:()=>Dj,withTracerScoped:()=>Lj,withTracerTiming:()=>qj,withUnhandledErrorLogLevel:()=>BB,yieldNow:()=>mH,zip:()=>_j,zipLeft:()=>Ej,zipRight:()=>Oj,zipWith:()=>C0});u();u();u();u();u();u();u();u();u();var _q="effect/ScheduleInterval",Pa=Symbol.for(_q),fg={[Pa]:Pa,startMillis:0,endMillis:0},mg=(e,t)=>e>t?fg:{[Pa]:Pa,startMillis:e,endMillis:t},OR=l(2,(e,t)=>CR(e,t)===e),CR=l(2,(e,t)=>e.endMillis<=t.startMillis?e:t.endMillis<=e.startMillis?t:e.startMillis<t.startMillis?e:t.startMillis<e.startMillis?t:e.endMillis<=t.endMillis?e:t);var vR=e=>e.startMillis>=e.endMillis;var kR=l(2,(e,t)=>{let r=Math.max(e.startMillis,t.startMillis),o=Math.min(e.endMillis,t.endMillis);return mg(r,o)});var wR=e=>mg(e,Number.POSITIVE_INFINITY);var hg=fg,RR=OR;var MR=vR;var FR=kR;var TR=wR;var Cq="effect/ScheduleIntervals",xg=Symbol.for(Cq),gg=e=>({[xg]:xg,intervals:e});var AR=l(2,(e,t)=>vq(e.intervals,t.intervals,Lt())),vq=(e,t,r)=>{let o=e,n=t,s=r;for(;Ze(o)&&Ze(n);){let i=m(Je(o),FR(Je(n))),c=MR(i)?s:m(s,Ke(i));m(Je(o),RR(Je(n)))?o=ot(o):n=ot(n),s=c}return gg(Nr(s))},Yp=e=>m(e.intervals,ku,De(()=>hg)).startMillis,IR=e=>m(e.intervals,ku,De(()=>hg)).endMillis,NR=l(2,(e,t)=>Yp(e)<Yp(t)),PR=e=>Ze(e.intervals);var LR=gg;var DR=AR,qR=Yp,yg=IR,HR=NR,WR=PR;var Sg="Continue",UR="Done",BR=e=>({_tag:Sg,intervals:e}),jR=e=>({_tag:Sg,intervals:LR(Re(e))}),zR={_tag:UR},GR=e=>e._tag===Sg,$R=e=>e._tag===UR;var VR=BR;var KR=jR,tc=zR,_g=GR,La=$R;u();var YR=Oo;var QR=Os;u();u();var Rq="effect/Schedule",tM=Symbol.for(Rq),rM=e=>k(e,tM),Mq="effect/ScheduleDriver",Fq=Symbol.for(Mq),Tq={_Out:e=>e,_In:e=>e,_R:e=>e},Aq={_Out:e=>e,_In:e=>e,_R:e=>e},Eg=class{initial;step;[tM]=Tq;constructor(t,r){this.initial=t,this.step=r}pipe(){return v(this,arguments)}},Og=class{schedule;ref;[Fq]=Aq;constructor(t,r){this.schedule=t,this.ref=r}get state(){return O(ar(this.ref),t=>t[1])}get last(){return x(ar(this.ref),([t,r])=>{switch(t._tag){case"None":return vt(()=>new Jt);case"Some":return y(t.value)}})}get reset(){return Fo(this.ref,[S(),this.schedule.initial])}next(t){return m(O(ar(this.ref),r=>r[1]),x(r=>m(Ql,x(o=>m(T(()=>this.schedule.step(o,t,r)),x(([n,s,i])=>{let c=Fo(this.ref,[E(s),n]);if(La(i))return oe(c,$(S()));let a=qR(i.intervals)-o;return a<=0?pe(c,s):m(c,oe(Ns(gi(a))),pe(s))}))))))}},Da=(e,t)=>new Eg(e,t);var Iq=l(2,(e,t)=>kg(e,(r,o)=>_(()=>t(r,o)))),kg=l(2,(e,t)=>Da(e.initial,(r,o,n)=>x(e.step(r,o,n),([s,i,c])=>La(c)?y([s,i,tc]):O(t(o,i),a=>a?[s,i,c]:[s,i,tc]))));var wg=e=>m(Ts([S(),e.initial]),O(t=>new Og(e,t)));var oM=l(2,(e,t)=>Nq(e,t,DR)),Nq=l(3,(e,t,r)=>Da([e.initial,t.initial],(o,n,s)=>m(Kr(e.step(o,n,s[0]),t.step(o,n,s[1]),(i,c)=>[i,c]),x(([[i,c,a],[p,f,h]])=>_g(a)&&_g(h)?Cg(e,t,n,i,c,a.intervals,p,f,h.intervals,r):y([[i,p],[c,f],tc]))))),Cg=(e,t,r,o,n,s,i,c,a,p)=>{let f=p(s,a);return WR(f)?y([[o,i],[n,c],VR(f)]):m(s,HR(a))?x(e.step(yg(s),r,o),([h,d,g])=>La(g)?y([[h,i],[d,c],tc]):Cg(e,t,r,h,d,g.intervals,i,c,a,p)):x(t.step(yg(a),r,i),([h,d,g])=>La(g)?y([[o,h],[n,d],tc]):Cg(e,t,r,o,n,s,h,d,g.intervals,p))};var Pq=l(2,(e,t)=>Lq(e,r=>_(()=>t(r)))),Lq=l(2,(e,t)=>Da(e.initial,(r,o,n)=>x(e.step(r,o,n),([s,i,c])=>O(t(i),a=>[s,a,c]))));var Dq=e=>Da(e.initial,(t,r,o)=>m(e.step(t,r,o),O(([n,s,i])=>[n,r,i])));var nM=e=>Hq(Tg,t=>t<e);var qq=(e,t)=>Da(e,(r,o,n)=>_(()=>[t(n),n,KR(TR(r))]));var sM=l(2,(e,t)=>kg(e,(r,o)=>fp(t(r))));var iM=l(2,(e,t)=>kg(e,(r,o)=>t(r))),Hq=l(2,(e,t)=>Iq(e,(r,o)=>t(o)));var Qp=Symbol.for("effect/Schedule/ScheduleDefect"),vg=class{error;[Qp];constructor(t){this.error=t,this[Qp]=Qp}},Wq=e=>k(e,Qp),Zp=e=>Er(e,t=>bo(new vg(t))),cM=e=>jr(e,t=>Ge(on(t,r=>Mi(r)&&Wq(r.defect)?E(r.defect):S()),{onNone:()=>Q(t),onSome:r=>$(r.error)})),XR=l(2,(e,t)=>Rg(e,t,(r,o)=>$(r))),aM=l(2,(e,t)=>{if(rM(t))return XR(e,t);let r=t.schedule??Dq(Tg),o=t.while?iM(r,i=>{let c=t.while(i);return typeof c=="boolean"?y(c):Zp(c)}):r,n=t.until?sM(o,i=>{let c=t.until(i);return typeof c=="boolean"?y(c):Zp(c)}):o,s=t.times?oM(n,nM(t.times)).pipe(Pq(i=>i[0])):n;return cM(XR(e,s))}),Rg=l(3,(e,t,r)=>x(wg(t),o=>Ye(e,{onFailure:n=>r(n,S()),onSuccess:n=>uM(e,o,r,n)}))),uM=(e,t,r,o)=>Ye(t.next(o),{onFailure:()=>ds(t.last),onSuccess:n=>Ye(e,{onFailure:s=>r(s,E(n)),onSuccess:s=>uM(e,t,r,s)})}),eM=l(2,(e,t)=>Mg(e,t,(r,o)=>$(r))),lM=l(2,(e,t)=>{if(rM(t))return eM(e,t);let r=t.schedule??Tg,o=t.while?iM(r,i=>{let c=t.while(i);return typeof c=="boolean"?y(c):Zp(c)}):r,n=t.until?sM(o,i=>{let c=t.until(i);return typeof c=="boolean"?y(c):Zp(c)}):o,s=t.times?oM(n,nM(t.times)):n;return cM(eM(e,s))}),Mg=l(3,(e,t,r)=>x(wg(t),o=>pM(e,o,r))),pM=(e,t,r)=>Er(e,o=>Ye(t.next(o),{onFailure:()=>m(t.last,ds,x(n=>r(o,n))),onSuccess:()=>pM(e,t,r)})),Xp=l(2,(e,t)=>Fg(e,void 0,t)),Fg=l(3,(e,t,r)=>x(wg(r),o=>fM(e,t,o))),fM=(e,t,r)=>Ye(r.next(t),{onFailure:()=>ds(r.last),onSuccess:()=>x(e,o=>fM(e,o,r))});var Tg=qq(0,e=>e+1);var Ig=class{permits;waiters=new Set;taken=0;constructor(t){this.permits=t}get free(){return this.permits-this.taken}take=t=>qe(r=>{if(this.free<t){let o=()=>{this.free<t||(this.waiters.delete(o),this.taken+=t,r(y(t)))};return this.waiters.add(o),_(()=>{this.waiters.delete(o)})}return this.taken+=t,r(y(t))});updateTaken=t=>X(r=>(this.taken=t(this.taken),this.waiters.size>0&&r.getFiberRef(Ws).scheduleTask(()=>{let o=this.waiters.values(),n=o.next();for(;n.done===!1&&this.free>0;)n.value(),n=o.next()},r.getFiberRef(_o)),y(this.free)));release=t=>this.updateTaken(r=>r-t);releaseAll=this.updateTaken(t=>0);withPermits=t=>r=>ke(o=>x(o(this.take(t)),n=>pr(o(r),this.release(n))));withPermitsIfAvailable=t=>r=>ke(o=>T(()=>this.free<t?Ps:(this.taken+=t,pr(o(Ui(r)),this.release(t)))))},tf=e=>new Ig(e),dM=e=>_(()=>tf(e)),Ng=class extends Mo{isOpen;waiters=[];scheduled=!1;constructor(t){super(),this.isOpen=t}commit(){return this.await}unsafeSchedule(t){return this.scheduled||this.waiters.length===0?q:(this.scheduled=!0,t.currentScheduler.scheduleTask(this.flushWaiters,t.getFiberRef(_o)),q)}flushWaiters=()=>{this.scheduled=!1;let t=this.waiters;this.waiters=[];for(let r=0;r<t.length;r++)t[r](Rt)};open=X(t=>this.isOpen?q:(this.isOpen=!0,this.unsafeSchedule(t)));release=X(t=>this.isOpen?q:this.unsafeSchedule(t));await=El(t=>this.isOpen?t(q):(this.waiters.push(t),_(()=>{let r=this.waiters.indexOf(t);r!==-1&&this.waiters.splice(r,1)})));close=_(()=>{this.isOpen=!1});whenOpen=t=>oe(this.await,t)},Lg=e=>new Ng(e??!1),xM=e=>_(()=>Lg(e)),gM=e=>rf(e,hR),yM=l(2,(e,t)=>O(Dg(e,t),r=>r[0])),Dg=l(2,(e,t)=>{let r=Xe(t);return x(Yt(),o=>O(of(S()),n=>[Cr(Uq(e,r,n),o),Bq(n)]))}),hM=(e,t,r)=>{let o=Lr(Xe(t));return m(Mt(),Vt(n=>$r(e,n)),O(n=>E([r+o,n])))},Uq=(e,t,r)=>ke(o=>m(Qr(n=>n.currentTimeMillis),x(n=>$q(r,s=>{switch(s._tag){case"None":return E(hM(e,t,n));case"Some":{let[i]=s.value;return i-n<=0?E(hM(e,t,n)):S()}}})),x(n=>G(n)?an("BUG: Effect.cachedInvalidate - please report an issue at https://github.com/Effect-TS/effect/issues"):o(tt(n.value[1]))))),Bq=e=>Fo(e,S()),bM=l(2,(e,t)=>rf(e,r=>t(sg(r)))),rf=l(2,(e,t)=>x(kw,r=>m(Wg(e,r),pr(x(r.value,t))))),SM=l(e=>mr(e[0]),(e,t)=>t?.discard?Ht(e,ur):O(nt(e,ur),sg)),qg=l(2,(e,t)=>ke(r=>x(t.fork(Zr),o=>m(r(e),gt(n=>o.close(n)),$s,Vt(n=>o.addFinalizer(()=>qt(s=>C(s,n.id())?q:Ce(bs(n))))))))),Hg=e=>Vs(t=>qg(e,t)),_M=e=>kr(e),EM=e=>T(()=>x(e,kr)),Ag=Symbol.for("effect/Effect/memoizeFunction.key"),ef=class{a;eq;[Ag]=Ag;constructor(t,r){this.a=t,this.eq=r}[M](t){return k(t,Ag)?this.eq?this.eq(this.a,t.a):C(this.a,t.a):!1}[F](){return this.eq?0:V(this,w(this.a))}},OM=(e,t)=>m(_(()=>Ms()),x(of),O(r=>o=>m(r.modifyEffect(n=>{let s=m(n,je(new ef(o,t)));return G(s)?m(Mt(),Vt(i=>m(Bi(e(o)),$r(i),ur)),O(i=>[i,m(n,Ut(new ef(o,t),i))])):y([s.value,n])}),x(tt),x(([n,s])=>m(Is(n),pe(s)))))),CM=l(2,(e,t)=>m(ve(e),Kp(ve(t)),r=>kt(r))),vM=l(2,(e,t)=>m(e,Xp(t),Hg)),Wg=l(2,(e,t)=>et(ng,o=>o.zip(t))(e)),kM=l(2,(e,t)=>Ug(e,{onTimeout:()=>J_(t),duration:t})),Ug=l(2,(e,{duration:t,onTimeout:r})=>kt(qa(e,{onTimeout:()=>vt(r),onSuccess:y,duration:t}))),wM=l(2,(e,{duration:t,onTimeout:r})=>kt(qa(e,{onTimeout:()=>ln(r),onSuccess:y,duration:t}))),RM=l(2,(e,t)=>qa(e,{duration:t,onSuccess:E,onTimeout:S})),qa=l(2,(e,{duration:t,onSuccess:r,onTimeout:o})=>qt(n=>cg(e,Gr(Ns(t)),{onSelfWin:(s,i)=>x(s.await,c=>c._tag==="Success"?x(s.inheritAll,()=>pe(Wt(i,n),r(c.value))):x(Wt(i,n),()=>ie(c.cause))),onOtherWin:(s,i)=>x(s.await,c=>c._tag==="Success"?x(s.inheritAll,()=>pe(Wt(i,n),o())):x(Wt(i,n),()=>ie(c.cause))),otherScope:Cn}))),jq="effect/Ref/SynchronizedRef",zq=Symbol.for(jq),Gq={_A:e=>e},Pg=class extends Mo{ref;withLock;[zq]=Gq;[tp]=Od;[_n]=_n;constructor(t,r){super(),this.ref=t,this.withLock=r,this.get=ar(this.ref)}get;commit(){return this.get}modify(t){return this.modifyEffect(r=>y(t(r)))}modifyEffect(t){return this.withLock(m(x(ar(this.ref),t),x(([r,o])=>pe(Fo(this.ref,o),r))))}},of=e=>_(()=>MM(e)),MM=e=>{let t=rp(e),r=tf(1);return new Pg(t,r.withPermits(1))},$q=l(2,(e,t)=>e.modifyEffect(r=>{let o=t(r);switch(o._tag){case"None":return y([r,r]);case"Some":return O(o.value,n=>[n,n])}}));var FM=l(e=>ce(e[0]),(e,t,r)=>x(e,o=>Rn(t(o),r).pipe(O(n=>Object.assign({},o,n)))));u();var AM=Symbol.for("effect/ManagedRuntime");u();var IM="Fresh",NM="FromEffect",PM="Scoped",LM="Suspend",DM="Provide",qM="ProvideMerge",HM="ZipWith";u();u();var WM=Wt;var sf=e=>(t,r)=>{let o=Ju(),n=[[wt,[[o,e.context]]]];r?.scheduler&&n.push([Ws,[[o,r.scheduler]]]);let s=fO(e.fiberRefs,{entries:n,forkAs:o});r?.updateRefs&&(s=r.updateRefs(s,o));let i=new Fa(o,s,e.runtimeFlags),c=t;r?.scope&&(c=x(QR(r.scope,Zr),p=>oe(ql(p,qt(f=>C(f,i.id())?q:Wt(i,f))),gt(t,f=>YR(p,f)))));let a=i.currentSupervisor;return a!==js&&(a.onStart(e.context,c,S(),i),i.addObserver(p=>a.onEnd(p,i))),Cn.add(e.runtimeFlags,i),r?.immediate===!1?i.resume(c):i.start(c),i},$g=e=>(t,r={})=>{let o=sf(e)(t,r);return r.onExit&&o.addObserver(n=>{r.onExit(n)}),(n,s)=>$g(e)(m(o,WM(n??Gt)),{...s,onExit:s?.onExit?i=>s.onExit(nE(i)):void 0})},Jq=e=>t=>{let r=zM(e)(t);if(r._tag==="Failure")throw BM(r.effect_instruction_i0);return r.effect_instruction_i0},zg=class extends Error{fiber;_tag="AsyncFiberException";constructor(t){super(`Fiber #${t.id().id} cannot be resolved synchronously. This is caused by using runSync on an effect that performs async work`),this.fiber=t,this.name=this._tag,this.stack=this.message}},Yq=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=0;let r=new zg(e);return Error.stackTraceLimit=t,r};var Bg=Symbol.for("effect/Runtime/FiberFailure"),jg=Symbol.for("effect/Runtime/FiberFailure/Cause"),Gg=class extends Error{[Bg];[jg];constructor(t){super(),this[Bg]=Bg,this[jg]=t;let r=dl(t);if(r.length>0){let o=r[0];this.name=o.name,this.message=o.message,this.stack=o.stack}this.name=`(FiberFailure) ${this.name}`,(this.message===void 0||this.message.length===0)&&(this.message="An error has occurred")}toJSON(){return{_id:"FiberFailure",cause:this[jg].toJSON()}}toString(){return"(FiberFailure) "+(this.stack??this.message)}[z](){return this.toString()}},BM=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=0;let r=new Gg(e);return Error.stackTraceLimit=t,r};var jM=e=>{let t=e;switch(t._op){case"Failure":case"Success":return t;case"Left":return Xc(t.left);case"Right":return le(t.right);case"Some":return le(t.value);case"None":return Xc(Jt())}},zM=e=>t=>{let r=jM(t);if(r)return r;let o=new Mp,n=sf(e)(t,{scheduler:o});o.flush();let s=n.unsafePoll();return s||bn(Ol(Yq(n),jl(n)))},Qq=e=>(t,r)=>GM(e)(t,r).then(o=>{switch(o._tag){case Ne:return o.effect_instruction_i0;case Ie:throw BM(o.effect_instruction_i0)}}),GM=e=>(t,r)=>new Promise(o=>{let n=jM(t);n&&o(n);let s=sf(e)(t);s.addObserver(i=>{o(i)}),r?.signal!==void 0&&(r.signal.aborted?s.unsafeInterruptAsFork(s.id()):r.signal.addEventListener("abort",()=>{s.unsafeInterruptAsFork(s.id())},{once:!0}))}),nf=class{context;runtimeFlags;fiberRefs;constructor(t,r,o){this.context=t,this.runtimeFlags=r,this.fiberRefs=o}pipe(){return v(this,arguments)}},Zq=e=>new nf(e.context,e.runtimeFlags,e.fiberRefs),cf=()=>X((e,t)=>y(new nf(e.getFiberRef(wt),t.runtimeFlags,e.getFiberRefs()))),Xq=sh(Ur,oh,rh),Po=Zq({context:Et(),runtimeFlags:Xq,fiberRefs:mO()});var $M=$g(Po),VM=sf(Po),KM=Qq(Po),JM=GM(Po),YM=Jq(Po),QM=zM(Po),ZM=e=>T(()=>{let t;return x(Mt(),r=>x(cf(),o=>ke(n=>oe(ur(n(be(e(s=>$g(o)($r(s,r))),{onFailure:s=>ks(r,s),onSuccess:s=>(t=s,q)}))),n(Or(tt(r),()=>t??q))))))});u();var e0=l(2,(e,t)=>e.modifyEffect(t));var t1="effect/Layer",o0=Symbol.for(t1),r1={_RIn:e=>e,_E:e=>e,_ROut:e=>e},rc={[o0]:r1,pipe(){return v(this,arguments)}},o1="effect/Layer/MemoMap",Vg=Symbol.for(o1),n1=e=>k(e,o0),s1=e=>e._op_layer===IM,Kg=class{ref;[Vg];constructor(t){this.ref=t,this[Vg]=Vg}getOrElseMemoize(t,r){return m(e0(this.ref,o=>{let n=o.get(t);if(n!==void 0){let[s,i]=n,c=m(s,x(([a,p])=>m(Is(a),pe(p))),gt(Pi({onFailure:()=>q,onSuccess:()=>Es(r,i)})));return y([c,o])}return m(Ts(0),x(s=>m(Mt(),x(i=>m(Ts(()=>q),O(c=>{let a=ke(f=>m(Ia(),x(h=>m(f(x(s0(t,h,!0),d=>Bi(d(this)))),ve,x(d=>{switch(d._tag){case Ie:return m(ks(i,d.effect_instruction_i0),oe(Oo(h,d)),oe(Q(d.effect_instruction_i0)));case Ne:return m(Fo(c,g=>m(Oo(h,g),Ai(op(s,b=>[b===1,b-1])),Ce)),oe(aa(s,g=>g+1)),oe(Es(r,g=>m(_(()=>o.delete(t)),oe(ar(c)),x(b=>b(g))))),oe(oa(i,d.effect_instruction_i0)),pe(d.effect_instruction_i0[1]))}}))))),p=[m(tt(i),gt(vs({onFailure:()=>q,onSuccess:()=>aa(s,f=>f+1)}))),f=>m(ar(c),x(h=>h(f)))];return[a,s1(t)?o:o.set(t,p)]}))))))}),kt)}},i1=T(()=>O(of(new Map),e=>new Kg(e)));var n0=l(2,(e,t)=>x(i1,r=>x(s0(e,t),o=>o(r))));var s0=(e,t,r=!1)=>{let o=e;switch(o._op_layer){case"Locally":return _(()=>n=>o.f(n.getOrElseMemoize(o.self,t)));case"ExtendScope":return _(()=>n=>Vs(s=>n.getOrElseMemoize(o.layer,s)));case"Fold":return _(()=>n=>m(n.getOrElseMemoize(o.layer,t),be({onFailure:s=>n.getOrElseMemoize(o.failureK(s),t),onSuccess:s=>n.getOrElseMemoize(o.successK(s),t)})));case"Fresh":return _(()=>n=>m(o.layer,n0(t)));case"FromEffect":return r?_(()=>n=>o.effect):_(()=>n=>n.getOrElseMemoize(e,t));case"Provide":return _(()=>n=>m(n.getOrElseMemoize(o.first,t),x(s=>m(n.getOrElseMemoize(o.second,t),Cr(s)))));case"Scoped":return r?_(()=>n=>Fn(o.effect,t)):_(()=>n=>n.getOrElseMemoize(e,t));case"Suspend":return _(()=>n=>n.getOrElseMemoize(o.evaluate(),t));case"ProvideMerge":return _(()=>n=>m(n.getOrElseMemoize(o.first,t),Kr(n.getOrElseMemoize(o.second,t),o.zipK)));case"ZipWith":return _(()=>n=>m(n.getOrElseMemoize(o.first,t),No(n.getOrElseMemoize(o.second,t),o.zipK,{concurrent:!0})))}};var c1=()=>af(Yt());var i0=l(2,(e,t)=>{let r=Ec(e),o=r?e:t;return af(O(r?t:e,s=>zn(o,s)))});function af(e){let t=Object.create(rc);return t._op_layer=NM,t.effect=e,t}var a1=l(2,(e,t)=>l1(e,t,(r,o)=>co(r,o))),c0=(...e)=>{let t=e[0];for(let r=1;r<e.length;r++)t=a1(t,e[r]);return t};var a0=l(2,(e,t)=>{let r=Ec(e),o=r?e:t;return u1(O(r?t:e,s=>zn(o,s)))});var u1=e=>{let t=Object.create(rc);return t._op_layer=PM,t.effect=e,t};var u0=l(2,(e,t)=>{let r=Ec(e);return af(y(zn(r?e:t,r?t:e)))});var l0=e=>{let t=Object.create(rc);return t._op_layer=LM,t.evaluate=e,t},p0=l(2,(e,t)=>{let r=Ec(e),o=r?e:t,n=r?t:e;return af(_(()=>zn(o,n())))});var f0=l(2,(e,t)=>l0(()=>{let r=Object.create(rc);return r._op_layer=DM,r.first=Object.create(rc,{_op_layer:{value:qM,enumerable:!0},first:{value:c1(),enumerable:!0},second:{value:Array.isArray(t)?c0(...t):t},zipK:{value:(o,n)=>m(o,co(n))}}),r.second=e,r}));var l1=l(3,(e,t,r)=>l0(()=>{let o=Object.create(rc);return o._op_layer=HM,o.first=e,o.second=t,o.zipK=r,o}));var t0=l(2,(e,t)=>cn(Ia(),r=>x(n0(t,r),o=>Bl(e,o)),(r,o)=>Oo(r,o))),r0=l(2,(e,t)=>{let r=Ls(Po.fiberRefs,t.fiberRefs),o=sr(Po.runtimeFlags,t.runtimeFlags);return ke(n=>X(s=>{let i=s.getFiberRef(wt),c=s.getFiberRefs(),a=Ds(s.id(),c)(r),p=s.currentRuntimeFlags,f=xo(o)(p),h=Ls(a,c),d=sr(f,p);return s.setFiberRefs(a),s.currentRuntimeFlags=f,pr(Bl(n(e),co(i,t.context)),X(g=>(g.setFiberRefs(Ds(g.id(),g.getFiberRefs())(h)),g.currentRuntimeFlags=xo(d)(g.currentRuntimeFlags),q)))}))}),m0=l(2,(e,t)=>Array.isArray(t)?t0(e,c0(...t)):n1(t)?t0(e,t):Fb(t)?Bl(e,t):AM in t?x(t.runtimeEffect,r=>r0(e,r)):r0(e,t));var h0=O(Kt(We),Bt(vo)),d0=e=>pt(We,t=>e(Bt(t,vo))),x0=l(2,(e,t)=>et(e,We,Oe(vo,t))),g0=e=>lr(We,Oe(vo,e));u();var Jg=H(Symbol.for("effect/FiberRef/currentCache"),()=>Me(SR(65536,()=>O(Mt(),e=>({listeners:new Ki,handle:e})),()=>Om(60)))),Yg=H(Symbol.for("effect/FiberRef/currentCacheEnabled"),()=>Me(!1)),y0=(e,t)=>x(ce(t)?t:y(t),r=>qt(o=>{let n=new Proxy(e,{});return pt(Yg,s=>{if(s){let c=pt(Jg,a=>x(a.getEither(n),p=>{switch(p._tag){case"Left":return p.left.listeners.interrupted?x(a.invalidateWhen(n,f=>f.handle===p.left.handle),()=>c):(p.left.listeners.increment(),ke(f=>x(ve(go(XS,f(tt(p.left.handle)))),h=>(p.left.listeners.decrement(),h))));case"Right":return p.right.listeners.increment(),ke(f=>x(ve(go(dh(r,xh({request:n,result:p.right.handle,listeners:p.right.listeners,ownerId:o,state:{completed:!1}})),f(tt(p.right.handle)))),()=>(p.right.listeners.decrement(),tt(p.right.handle))))}}));return c}let i=new Ki;return i.increment(),x(Mt(),c=>pr(go(dh(r,xh({request:n,result:c,listeners:i,ownerId:o,state:{completed:!1}})),tt(c)),_(()=>i.decrement())))})})),b0=(e,t)=>pt(Yg,r=>r?pt(Jg,o=>x(o.getEither(e),n=>{switch(n._tag){case"Left":return q;case"Right":return Ph(n.right.handle,t)}})):q),S0=l(2,(e,t)=>He(e,Yg,t)),_0=l(2,(e,t)=>He(e,Jg,t));u();var E0=aw;var h1=yo,d1=ce,x1=yM,g1=Dg,y1=Nd,b1=OM,S1=Pd,_1=Rn,E1=$w,O1=Vw,C1=ZO,v1=XO,k1=lC,w1=jw,R1=Gw,M1=tC,F1=iC,T1=aC,A1=Zt,I1=mC,N1=Zx,P1=Xx,L1=HC,D1=Xw,q1=WC,H1=UC,W1=Qx,U1=Kw,B1=JC,j1=YC,z1=Qw,G1=nR,$1=qe,V1=ZM,K1=Gc,J1=X,Y1=$,Q1=vt,Z1=Q,X1=ln,eH=bo,tH=an,rH=un,oH=fC,nH=ys,sH=TC,iH=LC,cH=y,aH=Ps,uH=VC,lH=T,pH=_,fH=q;var mH=Vr,hH=DO;var dH=Er,xH=jr,gH=qO,yH=$c,bH=w_,SH=HO,_H=WO,EH=UO,OH=BO,CH=jO,vH=Md,kH=Td,wH=hC,RH=PC,MH=GC,FH=lM,TH=Mg,AH=Rd;var IH=ov,NH=nv,PH=Hd,LH=cv,DH=$O,qH=R_,HH=dR,WH=kl,UH=wl,BH=Gr,jH=M_,zH=Or,GH=So,$H=ke,VH=nC,KH=pe,JH=Ui,YH=LO,QH=Ce,ZH=mn,XH=uC,Qg=O,eW=MC,tW=Kc,rW=hn,oW=ji,nW=FC,sW=fp,iW=Aa,cW=Uw,aW=cn,uW=Xi,lW=pr,pW=Rl,fW=gt,mW=Gp,hW=eR,dW=$p,xW=og,gW=Vs,yW=eg,bW=rR,SW=aR,_W=gM,EW=Bw,OW=VO,CW=lp,vW=Bi,kW=bM,wW=rf,RW=pn,MW=qt,FW=ur,TW=$s,AW=SM,IW=qg,NW=Hg,PW=Jw,LW=_M,DW=EM,qW=Wg,HW=Ml,WW=T_,UW=ck,BW=Fh,jW=z_,zW=zO,GW=Qr,$W=sR,VW=JE,KW=h0,JW=d0,YW=g0,QW=x0,ZW=GO,XW=Ns,eU=tv,tU=qd,rU=kM,oU=RM,nU=Ug,sU=wM,iU=qa,cU=QE,aU=YE,uU=cR,lU=Yt,pU=eC,fU=ir,mU=ws,hU=m0,dU=zi,xU=DC,gU=mv,yU=fv,bU=Wd,SU=Ud,_U=hv,EU=dv,OU=Bd,CU=av,vU=KO,kU=JO,wU=FM,RU=YO,MU=QO;var FU=zr,TU=ve,AU=$r,IU=AC,NU=vl;var PU=rC,LU=oC,DU=pa,qU=sC,HU=sv,WU=iv,UU=hp,BU=Ai,jU=uv,zU=lv,GU=x,$U=fn,VU=kt,KU=Zw,JU=Kp,YU=CM,QU=ig,ZU=ma,XU=Vt,eB=QC,tB=ZC,rB=Dd,oB=XC,nB=ev,sB=Fd,iB=Ad,cB=kC,aB=aM,uB=jC,lB=Rg,pB=Xp,fB=vM,mB=Fg,hB=Ii,dB=pp,xB=dC,gB=He,yB=et,bB=Vp,SB=lr,_B=Is,EB=$C,OB=mp,CB=xC,vB=gC,kB=fa,wB=Vc,RB=be,MB=Ye,FB=yC,TB=(e,...t)=>To(e)(...t),AB=bC,IB=Id,NB=SC,PB=_C,LB=EC,DB=OC,qB=CC,HB=PO,WB=Ww,UB=vC,BB=G_,jB=ds,zB=kh,GB=hs,$B=IC,VB=NC,KB=qC,JB=Jl,YB=ZE,QB=iR,ZB=cf,XB=Ti,ej=dn,tj=Fl,rj=fR,oj=KC,nj=Ld,sj=tR,ij=tg,cj=$_,aj=pv,uj=tf,lj=dM,pj=Lg,fj=xM,mj=VM,hj=$M,dj=KM,xj=JM,gj=YM,yj=QM,bj=oR,Sj=rg,_j=uR,Ej=lR,Oj=pR,C0=No,Cj=l(2,(e,t)=>C0(e,t,(r,o)=>r(o))),vj=go,kj=_l,wj=Cl,Rj=l(e=>E0(e[0]),y0),Mj=b0,Fj=A_,Tj=S0,Aj=_0,Ij=rv,Nj=Yl,Pj=XE,Lj=xR,Dj=I_,qj=N_,Hj=gv,Wj=xv,Uj=jd,Bj=yv,jj=Ev,zj=Ov,Gj=bv,$j=_v,Vj=Ta,Kj=ap,Jj=Gd,Yj=Cv,Qj=gR,Zj=up,Xj=vv,ez=kv,v0=e=>{let t=new Map;return new Proxy(e,{get(r,o,n){if(o in r)return Reflect.get(r,o,n);if(t.has(o))return t.get(o);let s=(...c)=>fn(r,a=>typeof a[o]=="function"?(t.set(o,(...p)=>fn(r,f=>f[o](...p))),a[o](...c)):(t.set(o,fn(r,p=>p[o])),a[o])),i=fn(r,c=>c[o]);return Object.assign(s,i),Object.setPrototypeOf(s,Object.getPrototypeOf(i)),t.set(o,s),s}})},tz=e=>()=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=2;let r=new Error;Error.stackTraceLimit=t;function o(){}return Object.setPrototypeOf(o,Cu),o.key=e,Object.defineProperty(o,"use",{get(){return n=>fn(this,n)}}),Object.defineProperty(o,"stack",{get(){return r.stack}}),v0(o)},rz=function(){return function(){let[e,t]=arguments,r="accessors"in t?t.accessors:!1,o=Error.stackTraceLimit;Error.stackTraceLimit=2;let n=new Error;Error.stackTraceLimit=o;let s="unchecked",i=function(f){if(s==="unchecked"){let h=Object.getPrototypeOf(f);if(h===Object.prototype||h===null)s="plain";else{let d=Object.getPrototypeOf(this);Object.setPrototypeOf(d,h),s="patched"}}if(s==="plain")Object.assign(this,f);else if(s==="patched")return Object.setPrototypeOf(f,Object.getPrototypeOf(this)),f};i.prototype._tag=e,Object.defineProperty(i,"make",{get(){return f=>new this(f)}}),Object.defineProperty(i,"use",{get(){return f=>fn(this,f)}}),i.key=e,Object.assign(i,Cu),Object.defineProperty(i,"stack",{get(){return n.stack}});let c="dependencies"in t&&t.dependencies.length>0,a=c?"DefaultWithoutDependencies":"Default",p;if("effect"in t?Object.defineProperty(i,a,{get(){return p??=i0(i,Qg(t.effect,f=>new this(f)))}}):"scoped"in t?Object.defineProperty(i,a,{get(){return p??=a0(i,Qg(t.scoped,f=>new this(f)))}}):"sync"in t?Object.defineProperty(i,a,{get(){return p??=p0(i,()=>new this(t.sync()))}}):Object.defineProperty(i,a,{get(){return p??=u0(i,new this(t.succeed))}}),c){let f;Object.defineProperty(i,"Default",{get(){return f??=f0(this.DefaultWithoutDependencies,t.dependencies)}})}return r===!0?v0(i):i}};u();var oz=function(){let e=Symbol.for("effect/Data/Error/plainArgs");return class extends Hl{constructor(r){super(r?.message,r?.cause?{cause:r.cause}:void 0),r&&(Object.assign(this,r),Object.defineProperty(this,e,{value:r,enumerable:!1}))}toJSON(){return{...this[e],...this}}}}(),oc=e=>{class t extends oz{_tag=e}return t.prototype.name=e,t};u();u();u();u();var Ha=class{constructor(t,r,o,n,s){this.message=t;this.stack=r;this.span=o;this.isPlainString=n;this.errorType=s}};u();var k0=e=>{if(typeof e=="string")return{isPlainString:!0,message:e};if(e instanceof Error&&k(e,"cause")&&k(e,"_tag"))return{isPlainString:!1,type:e._tag,message:e.cause};if(e instanceof Error&&k(e,"error"))return{isPlainString:!1,type:e.name,message:e.error};if(k(e,"_tag")&&k(e,"message"))return{isPlainString:!1,type:e._tag,message:e.message};if(k(e,"toString")&&Xs(e.toString)&&e.toString!==Object.prototype.toString&&e.toString!==Array.prototype.toString){let t=e.toString(),r=t.split(": ");if(r.length>1){let[o,...n]=r;return{isPlainString:!1,type:o,message:n}}return{message:t,isPlainString:!1}}return{message:`Error: ${JSON.stringify(e)}`,isPlainString:!1}};var w0=Symbol.for("effect/SpanAnnotation"),Zg=e=>{let t=k(e,w0)?e[w0]:void 0,{message:r,type:o,isPlainString:n}=k0(e);return e instanceof Error?new Ha(r,e.stack?.split(`
`).filter(s=>/at (.*)/.exec(s)).join(`\r
`),t,!1,o):new Ha(r,void 0,t,n,o)};var R0=e=>ER(e,void 0,{emptyCase:()=>[],dieCase:(t,r)=>[Zg(r)],failCase:(t,r)=>[Zg(r)],interruptCase:()=>[],parallelCase:(t,r,o)=>[...r,...o],sequentialCase:(t,r,o)=>[...r,...o]});u();u();var uf=/ {4}at /g,M0=/^(file:\/\/)?(.*.([jt])sx?)(\?.*)?:(\d*):(\d*)$/;u();var F0=global.process!==void 0?new RegExp(global.process.cwd(),"g"):null,T0=e=>F0===null?e:e.replace(F0,".");u();u();var A0=e=>Array.from(e.entries()).reduce((t,[r,o])=>r==="code.stacktrace"?{attributes:t.attributes,stacktrace:[...t.stacktrace,o]}:{attributes:new Map([...t.attributes,[r,o]]),stacktrace:t.stacktrace},{stacktrace:[],attributes:new Map});u();u();u();var I0=e=>{let t=M0.exec(e);if(t===null||t.length!==7)return;let r=t[2],o=+t[5],n=+t[6];return{filePath:r,line:o,column:n}};u();u();var Sf=Ff(my(),1);u();var uc=class extends oc("fs-error"){};var wT=e=>m(B.tryPromise({try:async()=>await Sf.default.readFile(e,{encoding:"utf8"}),catch:t=>new uc({cause:t})}),B.withSpan("readFile",{attributes:{path:e}})),RT=e=>m(B.tryPromise({try:async()=>await Sf.default.exists(e),catch:t=>new uc({cause:t})}),B.withSpan("exists",{attributes:{path:e}})),MT=e=>m(B.tryPromise({try:async()=>await Sf.default.readJson(e),catch:t=>new uc({cause:t})}),B.withSpan("readJson",{attributes:{path:e}}));var i3=7,_f=({filePath:e,line:t,column:r},o=!1)=>B.gen(function*(){let n=t>=4?t-4:0;return(yield*wT(e)).split(`
`).splice(n,i3).map((i,c)=>{let a=c+n+1,p=o?r+1:r;return{line:a,code:i,column:a===t?p:void 0}})});u();import T3 from"node:path";var rA=Ff(tA(),1);var oA=e=>B.gen(function*(){if(!(yield*RT(`${e.filePath}.map`)))return{_tag:"location",...e,filePath:e.filePath.replace(process.cwd(),"")};let r=yield*MT(`${e.filePath}.map`);if(r.version===void 0||r.sources===void 0)return;let n=new rA.SourceMapConsumer(r).originalPositionFor({column:e.column,line:e.line});if(n.source===null||n.line===null||n.column===null)return;let s=T3.resolve(e.filePath.substring(0,e.filePath.lastIndexOf("/")),n.source),i=yield*_f({filePath:s,line:n.line,column:n.column},!0);return{_tag:"sources",runPath:`${e.filePath}:${e.line}:${e.column}`,sourcesPath:`${s}:${n.line}:${n.column+1}`,source:i}});var nA=e=>B.gen(function*(){let t=I0(e);if(t===void 0)return;let{filePath:r,line:o,column:n}=t;if(r.endsWith(".ts")||r.endsWith(".tsx")){let i=yield*_f(t);return{_tag:"sources",runPath:`${r}:${o}:${n}`,sourcesPath:void 0,source:i}}return yield*oA(t)});var wf=e=>m(B.forEach(e,t=>B.gen(function*(){let r=t.trimStart().split(" "),o=r.length===2?r[1]:r[r.length-1].slice(1,-1),n=yield*nA(o);if(n===void 0)return{_tag:"stack-entry",runPath:t.replaceAll(uf,"at ")};if(n._tag==="location")return n;let s=new RegExp(`${process.cwd()}/node_modules/`);if(!n.sourcesPath?.match(s))return n})),B.map(t=>t.filter(r=>r!==void 0)));var sA=({span:e,sources:t,location:r})=>m(B.gen(function*(){if(e===void 0)return{spans:[],sources:t,location:r};let o=[],n=e;for(;n!==void 0&&n._tag==="Span";){let{name:s,attributes:i,status:c}=n,{attributes:a,stacktrace:p}=A0(i),f=yield*wf(p),h=c._tag==="Ended"?+`${(c.endTime-c.startTime)/BigInt(1e6)}`:void 0;t.push(...f.filter(d=>d._tag==="sources")),r.push(...f.filter(d=>d._tag==="location")),o.push({name:s,attributes:Object.fromEntries(a),durationInMilliseconds:h}),n=xe.getOrUndefined(n.parent)}return{spans:o,location:r,sources:t}}),B.withSpan("get-sources-from-span"));u();u();var iA=e=>e.split(`\r
`).filter(r=>r.includes(process.cwd())&&!r.includes("/node_modules/"));var cA=e=>m(B.gen(function*(){if(e===void 0)return{sources:[],location:[]};let t=iA(e),r=yield*wf(t);return{sources:r.filter(o=>o._tag==="sources"),location:r.filter(o=>o._tag==="location")}}),B.withSpan("get-sources-from-stack"));var aA=({reverseSpans:e,stripCwd:t})=>({message:r,stack:o,span:n,errorType:s,isPlainString:i})=>m(B.gen(function*(){let c=yield*cA(o),{spans:a,sources:p,location:f}=yield*sA({span:n,...c}),h;return o!==void 0&&(h=t===!0?T0(o):o),{errorType:s,message:r,stack:h?.replaceAll(uf,"at ").split(`\r
`),sources:p.length>0?p.map(({_tag:d,...g})=>g):void 0,location:f.length>0?f.map(({_tag:d,...g})=>g):void 0,spans:e===!0?a.toReversed():a,isPlainString:i}}),B.withSpan("transform-raw-error"));var uA=(e,t={reverseSpans:!0,stripCwd:!0})=>B.gen(function*(){if(_R(e))return{interrupted:!0,errors:[]};let r=R0(e);return{interrupted:!1,errors:yield*B.forEach(r,aA(t))}});u();var lA=(e,t)=>typeof t=="bigint"?{type:"bigint",value:t.toString()}:t;u();import{fileURLToPath as I3}from"node:url";var fA=Ff(my(),1);u();var Ya=class extends oc("FetchError"){};u();var Rf=class extends oc("FileError"){};u();var A3=new RegExp(process.cwd(),"g"),pA=e=>B.sync(()=>{console.info(`\r
\u{1F4C1} ${e.replace(A3,".")}`)});var N3=I3(import.meta.url),P3=m(B.tryPromise({try:async()=>await fA.default.readJson("./src/examples/data/user.json"),catch:e=>new Rf({cause:e})}),B.withSpan("readUser")),L3=e=>m(B.tryPromise({try:async()=>await fetch(`https://yolo-bro-oh-no.org/users/${e}`),catch:t=>new Ya({cause:t})}),B.withSpan("fetchUser",{attributes:{userId:e}})),D3=e=>m(B.tryPromise({try:async()=>await e.json(),catch:t=>new Ya({cause:t})}),B.withSpan("unwrapFetchUserResponse")),q3=m(B.gen(function*(){yield*pA(N3);let{id:e}=yield*P3,t=yield*L3(e);return yield*D3(t)}),B.withSpan("fromPromiseTask")),mA=q3;B.runPromise(m(mA,B.sandbox,B.catchAll(e=>B.gen(function*(){let t=yield*uA(e);return yield*B.fail(JSON.stringify(t,lA,2))})))).catch(console.error);
